// RUN: fusion_to_mlir %s | FileCheck %s
// RUN: gpu_test_correctness %s

add {
  p0 = s32[] parameter(0)
  p1 = s32[] parameter(1)
  ROOT add = s32[] add(p0, p1)
}

fusion {
  p0 = s4[64,64]{1,0:E(4)} parameter(0)
  convert = s32[64,64]{1,0} convert(p0)
  c0 = s32[] constant(0)

  reduce = s32[64]{0} reduce(convert, c0), dimensions={1}, to_apply=add
  ROOT tuple = (s32[64]{0}, s32[64,64]{1,0}) tuple(reduce, convert)
}
// CHECK: shuffle_reduce
