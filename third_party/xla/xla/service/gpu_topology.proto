syntax = "proto3";

package xla;

import "xla/stream_executor/device_description.proto";

option java_multiple_files = true;
option java_outer_classname = "GpuTopologyProto";

// A proto used to serialize GpuTopology instances.
message GpuTopologyProto {
  reserved 1;  // Was: device_ids
  reserved 2;  // Was: gpu_version

  // Name for the GPU version, e.g., "NVIDIA A100-SXM4-40GB". Returned as
  // "device_kind" of a GPU device in the PJRT client API.
  string platform_version = 3;

  // The number of partitions.
  // Devices on the same partition are connected by the fast network via
  // NVLinks, which could be within a host or span across multiple hosts.
  int32 num_partitions = 4;

  // The number of hosts for each partition.
  int32 num_hosts_per_partition = 5;

  // The number of devices for each host.
  int32 num_devices_per_host = 6;

  // The GPU target config.
  stream_executor.GpuTargetConfigProto gpu_target_config = 8;

  reserved 7;  // Was: core_count_per_chip
}
