// RUN: hlo-opt %s --platform=gpu --xla_gpu_target_config_filename=%S/../../../backends/gpu/target_config/specs/%{GPU}.txtpb | FileCheck  %s

e {
  a = s4[8,2]{1,0} parameter(0)
  b = s8[8]{0} bitcast-convert(a)
  c = s8[8]{0} copy(b)
}

// CHECK-NOT: bitcast-convert
// CHECK: ENTRY
// CHECK-NEXT: %[[p0:.*]] = s4[8,2]{1,0:E(4)} parameter(0)
// CHECK-NEXT: %[[b:.*]] = s8[8]{0} bitcast(%[[p0]])
// CHECK-NEXT: ROOT %[[c:.*]] = s8[8]{0} copy(%[[b]])
