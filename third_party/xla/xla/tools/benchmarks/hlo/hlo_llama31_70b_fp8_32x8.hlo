HloModule jit_train_step, input_output_alias={ {0}: (0, {}, may-alias), {1}: (1, {}, may-alias), {2}: (2, {}, may-alias), {3}: (3, {}, may-alias), {4}: (4, {}, may-alias), {5}: (5, {}, may-alias), {6}: (6, {}, may-alias), {7}: (7, {}, may-alias), {8}: (8, {}, may-alias), {9}: (9, {}, may-alias), {10}: (10, {}, may-alias), {11}: (11, {}, may-alias), {12}: (12, {}, may-alias), {13}: (13, {}, may-alias), {14}: (14, {}, may-alias), {15}: (15, {}, may-alias), {16}: (16, {}, may-alias), {17}: (17, {}, may-alias), {18}: (18, {}, may-alias), {19}: (19, {}, may-alias), {20}: (20, {}, may-alias), {21}: (21, {}, may-alias), {22}: (22, {}, may-alias), {23}: (23, {}, may-alias), {24}: (24, {}, may-alias), {25}: (25, {}, may-alias), {26}: (26, {}, may-alias), {27}: (27, {}, may-alias), {28}: (28, {}, may-alias), {29}: (29, {}, may-alias), {30}: (30, {}, may-alias), {31}: (31, {}, may-alias), {32}: (32, {}, may-alias), {33}: (33, {}, may-alias), {34}: (34, {}, may-alias), {35}: (35, {}, may-alias), {36}: (36, {}, may-alias), {37}: (37, {}, may-alias), {38}: (38, {}, may-alias), {39}: (39, {}, may-alias), {40}: (40, {}, may-alias), {41}: (41, {}, may-alias), {42}: (42, {}, may-alias), {43}: (43, {}, may-alias), {44}: (44, {}, may-alias), {45}: (45, {}, may-alias), {46}: (46, {}, may-alias), {47}: (47, {}, may-alias), {48}: (48, {}, may-alias), {49}: (49, {}, may-alias), {50}: (50, {}, may-alias), {51}: (51, {}, may-alias), {52}: (52, {}, may-alias), {53}: (53, {}, may-alias), {54}: (54, {}, may-alias), {55}: (55, {}, may-alias), {56}: (56, {}, may-alias), {57}: (57, {}, may-alias), {58}: (58, {}, may-alias), {59}: (59, {}, may-alias), {60}: (60, {}, may-alias), {61}: (61, {}, may-alias), {62}: (62, {}, may-alias), {63}: (63, {}, may-alias), {64}: (64, {}, may-alias), {65}: (65, {}, may-alias), {66}: (66, {}, may-alias), {67}: (67, {}, may-alias), {68}: (68, {}, may-alias), {69}: (69, {}, may-alias), {70}: (70, {}, may-alias), {71}: (71, {}, may-alias), {72}: (72, {}, may-alias), {73}: (73, {}, may-alias), {74}: (74, {}, may-alias), {75}: (75, {}, may-alias), {76}: (76, {}, may-alias), {77}: (77, {}, may-alias), {78}: (78, {}, may-alias), {79}: (79, {}, may-alias), {80}: (80, {}, may-alias) }, entry_computation_layout={(s32[], f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=5*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=10*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[8192]{0}, f32[64,80,28672]{2,1,0}, /*index=45*/f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, /*index=50*/f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, /*index=55*/s32[], f32[8192]{0}, f32[64,80,28672]{2,1,0}, f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, /*index=60*/f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, /*index=65*/f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, f32[8192]{0}, f32[64,80,28672]{2,1,0}, /*index=70*/f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, /*index=75*/f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, /*index=80*/s32[], s32[2,8192]{1,0}, s32[2,8192]{1,0}, s32[2,8192]{1,0}, s32[2,8192]{1,0}, /*index=85*/s32[2,8192]{1,0})->(s32[], f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=5*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=10*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[8192]{0}, f32[64,80,28672]{2,1,0}, /*index=45*/f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, /*index=50*/f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, /*index=55*/s32[], f32[8192]{0}, f32[64,80,28672]{2,1,0}, f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, /*index=60*/f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, /*index=65*/f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, f32[8192]{0}, f32[64,80,28672]{2,1,0}, /*index=70*/f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, /*index=75*/f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, /*index=80*/s32[], f32[], f32[], f32[], f32[], /*index=85*/f32[], s32[])}

%region_34.1844 (Arg_0.1841: bf16[], Arg_1.1842: bf16[]) -> bf16[] {
  %Arg_0.1841 = bf16[] parameter(0)
  %Arg_1.1842 = bf16[] parameter(1)
  ROOT %maximum.1843 = bf16[] maximum(%Arg_0.1841, %Arg_1.1842)
}

%region_46.2017 (Arg_0.2014: bf16[], Arg_1.2015: bf16[]) -> bf16[] {
  %Arg_0.2014 = bf16[] parameter(0)
  %Arg_1.2015 = bf16[] parameter(1)
  ROOT %maximum.2016 = bf16[] maximum(%Arg_0.2014, %Arg_1.2015)
}

%region_68.2537 (Arg_0.2534: bf16[], Arg_1.2535: bf16[]) -> bf16[] {
  %Arg_0.2534 = bf16[] parameter(0)
  %Arg_1.2535 = bf16[] parameter(1)
  ROOT %maximum.2536 = bf16[] maximum(%Arg_0.2534, %Arg_1.2535)
}

%region_175.4369 (Arg_0.4366: f32[], Arg_1.4367: f32[]) -> f32[] {
  %Arg_0.4366 = f32[] parameter(0)
  %Arg_1.4367 = f32[] parameter(1)
  ROOT %add.4368 = f32[] add(%Arg_0.4366, %Arg_1.4367)
}

%region_176.4375 (Arg_0.4372: f32[], Arg_1.4373: f32[]) -> f32[] {
  %Arg_0.4372 = f32[] parameter(0)
  %Arg_1.4373 = f32[] parameter(1)
  ROOT %add.4374 = f32[] add(%Arg_0.4372, %Arg_1.4373)
}

%region_177.4382 (Arg_0.4379: f32[], Arg_1.4380: f32[]) -> f32[] {
  %Arg_0.4379 = f32[] parameter(0)
  %Arg_1.4380 = f32[] parameter(1)
  ROOT %add.4381 = f32[] add(%Arg_0.4379, %Arg_1.4380)
}

%region_178.4389 (Arg_0.4386: f32[], Arg_1.4387: f32[]) -> f32[] {
  %Arg_0.4386 = f32[] parameter(0)
  %Arg_1.4387 = f32[] parameter(1)
  ROOT %add.4388 = f32[] add(%Arg_0.4386, %Arg_1.4387)
}

%region_179.4396 (Arg_0.4393: f32[], Arg_1.4394: f32[]) -> f32[] {
  %Arg_0.4393 = f32[] parameter(0)
  %Arg_1.4394 = f32[] parameter(1)
  ROOT %add.4395 = f32[] add(%Arg_0.4393, %Arg_1.4394)
}

%region_180.4403 (Arg_0.4400: f32[], Arg_1.4401: f32[]) -> f32[] {
  %Arg_0.4400 = f32[] parameter(0)
  %Arg_1.4401 = f32[] parameter(1)
  ROOT %add.4402 = f32[] add(%Arg_0.4400, %Arg_1.4401)
}

%region_181.4410 (Arg_0.4407: f32[], Arg_1.4408: f32[]) -> f32[] {
  %Arg_0.4407 = f32[] parameter(0)
  %Arg_1.4408 = f32[] parameter(1)
  ROOT %add.4409 = f32[] add(%Arg_0.4407, %Arg_1.4408)
}

%region_182.4417 (Arg_0.4414: f32[], Arg_1.4415: f32[]) -> f32[] {
  %Arg_0.4414 = f32[] parameter(0)
  %Arg_1.4415 = f32[] parameter(1)
  ROOT %add.4416 = f32[] add(%Arg_0.4414, %Arg_1.4415)
}

%region_183.4424 (Arg_0.4421: f32[], Arg_1.4422: f32[]) -> f32[] {
  %Arg_0.4421 = f32[] parameter(0)
  %Arg_1.4422 = f32[] parameter(1)
  ROOT %add.4423 = f32[] add(%Arg_0.4421, %Arg_1.4422)
}

%region_184.4431 (Arg_0.4428: f32[], Arg_1.4429: f32[]) -> f32[] {
  %Arg_0.4428 = f32[] parameter(0)
  %Arg_1.4429 = f32[] parameter(1)
  ROOT %add.4430 = f32[] add(%Arg_0.4428, %Arg_1.4429)
}

%region_185.4438 (Arg_0.4435: f32[], Arg_1.4436: f32[]) -> f32[] {
  %Arg_0.4435 = f32[] parameter(0)
  %Arg_1.4436 = f32[] parameter(1)
  ROOT %add.4437 = f32[] add(%Arg_0.4435, %Arg_1.4436)
}

%region_186.4445 (Arg_0.4442: f32[], Arg_1.4443: f32[]) -> f32[] {
  %Arg_0.4442 = f32[] parameter(0)
  %Arg_1.4443 = f32[] parameter(1)
  ROOT %add.4444 = f32[] add(%Arg_0.4442, %Arg_1.4443)
}

%region_187.4452 (Arg_0.4449: f32[], Arg_1.4450: f32[]) -> f32[] {
  %Arg_0.4449 = f32[] parameter(0)
  %Arg_1.4450 = f32[] parameter(1)
  ROOT %add.4451 = f32[] add(%Arg_0.4449, %Arg_1.4450)
}

%region_188.4459 (Arg_0.4456: f32[], Arg_1.4457: f32[]) -> f32[] {
  %Arg_0.4456 = f32[] parameter(0)
  %Arg_1.4457 = f32[] parameter(1)
  ROOT %add.4458 = f32[] add(%Arg_0.4456, %Arg_1.4457)
}

%region_189.4466 (Arg_0.4463: f32[], Arg_1.4464: f32[]) -> f32[] {
  %Arg_0.4463 = f32[] parameter(0)
  %Arg_1.4464 = f32[] parameter(1)
  ROOT %add.4465 = f32[] add(%Arg_0.4463, %Arg_1.4464)
}

%region_190.4473 (Arg_0.4470: f32[], Arg_1.4471: f32[]) -> f32[] {
  %Arg_0.4470 = f32[] parameter(0)
  %Arg_1.4471 = f32[] parameter(1)
  ROOT %add.4472 = f32[] add(%Arg_0.4470, %Arg_1.4471)
}

%region_191.4480 (Arg_0.4477: f32[], Arg_1.4478: f32[]) -> f32[] {
  %Arg_0.4477 = f32[] parameter(0)
  %Arg_1.4478 = f32[] parameter(1)
  ROOT %add.4479 = f32[] add(%Arg_0.4477, %Arg_1.4478)
}

%region_192.4487 (Arg_0.4484: f32[], Arg_1.4485: f32[]) -> f32[] {
  %Arg_0.4484 = f32[] parameter(0)
  %Arg_1.4485 = f32[] parameter(1)
  ROOT %add.4486 = f32[] add(%Arg_0.4484, %Arg_1.4485)
}

%region_193.4494 (Arg_0.4491: f32[], Arg_1.4492: f32[]) -> f32[] {
  %Arg_0.4491 = f32[] parameter(0)
  %Arg_1.4492 = f32[] parameter(1)
  ROOT %add.4493 = f32[] add(%Arg_0.4491, %Arg_1.4492)
}

%region_194.4501 (Arg_0.4498: f32[], Arg_1.4499: f32[]) -> f32[] {
  %Arg_0.4498 = f32[] parameter(0)
  %Arg_1.4499 = f32[] parameter(1)
  ROOT %add.4500 = f32[] add(%Arg_0.4498, %Arg_1.4499)
}

%region_195.4508 (Arg_0.4505: f32[], Arg_1.4506: f32[]) -> f32[] {
  %Arg_0.4505 = f32[] parameter(0)
  %Arg_1.4506 = f32[] parameter(1)
  ROOT %add.4507 = f32[] add(%Arg_0.4505, %Arg_1.4506)
}

%region_196.4515 (Arg_0.4512: f32[], Arg_1.4513: f32[]) -> f32[] {
  %Arg_0.4512 = f32[] parameter(0)
  %Arg_1.4513 = f32[] parameter(1)
  ROOT %add.4514 = f32[] add(%Arg_0.4512, %Arg_1.4513)
}

%region_197.4522 (Arg_0.4519: f32[], Arg_1.4520: f32[]) -> f32[] {
  %Arg_0.4519 = f32[] parameter(0)
  %Arg_1.4520 = f32[] parameter(1)
  ROOT %add.4521 = f32[] add(%Arg_0.4519, %Arg_1.4520)
}

%region_198.4529 (Arg_0.4526: f32[], Arg_1.4527: f32[]) -> f32[] {
  %Arg_0.4526 = f32[] parameter(0)
  %Arg_1.4527 = f32[] parameter(1)
  ROOT %add.4528 = f32[] add(%Arg_0.4526, %Arg_1.4527)
}

%region_199.4536 (Arg_0.4533: f32[], Arg_1.4534: f32[]) -> f32[] {
  %Arg_0.4533 = f32[] parameter(0)
  %Arg_1.4534 = f32[] parameter(1)
  ROOT %add.4535 = f32[] add(%Arg_0.4533, %Arg_1.4534)
}

%region_200.4543 (Arg_0.4540: f32[], Arg_1.4541: f32[]) -> f32[] {
  %Arg_0.4540 = f32[] parameter(0)
  %Arg_1.4541 = f32[] parameter(1)
  ROOT %add.4542 = f32[] add(%Arg_0.4540, %Arg_1.4541)
}

%region_201.4550 (Arg_0.4547: f32[], Arg_1.4548: f32[]) -> f32[] {
  %Arg_0.4547 = f32[] parameter(0)
  %Arg_1.4548 = f32[] parameter(1)
  ROOT %add.4549 = f32[] add(%Arg_0.4547, %Arg_1.4548)
}

%region_202.4557 (Arg_0.4554: f32[], Arg_1.4555: f32[]) -> f32[] {
  %Arg_0.4554 = f32[] parameter(0)
  %Arg_1.4555 = f32[] parameter(1)
  ROOT %add.4556 = f32[] add(%Arg_0.4554, %Arg_1.4555)
}

%region_203.4564 (Arg_0.4561: f32[], Arg_1.4562: f32[]) -> f32[] {
  %Arg_0.4561 = f32[] parameter(0)
  %Arg_1.4562 = f32[] parameter(1)
  ROOT %add.4563 = f32[] add(%Arg_0.4561, %Arg_1.4562)
}

%region_204.4571 (Arg_0.4568: f32[], Arg_1.4569: f32[]) -> f32[] {
  %Arg_0.4568 = f32[] parameter(0)
  %Arg_1.4569 = f32[] parameter(1)
  ROOT %add.4570 = f32[] add(%Arg_0.4568, %Arg_1.4569)
}

%region_205.4578 (Arg_0.4575: f32[], Arg_1.4576: f32[]) -> f32[] {
  %Arg_0.4575 = f32[] parameter(0)
  %Arg_1.4576 = f32[] parameter(1)
  ROOT %add.4577 = f32[] add(%Arg_0.4575, %Arg_1.4576)
}

%region_206.4585 (Arg_0.4582: f32[], Arg_1.4583: f32[]) -> f32[] {
  %Arg_0.4582 = f32[] parameter(0)
  %Arg_1.4583 = f32[] parameter(1)
  ROOT %add.4584 = f32[] add(%Arg_0.4582, %Arg_1.4583)
}

%region_207.4592 (Arg_0.4589: f32[], Arg_1.4590: f32[]) -> f32[] {
  %Arg_0.4589 = f32[] parameter(0)
  %Arg_1.4590 = f32[] parameter(1)
  ROOT %add.4591 = f32[] add(%Arg_0.4589, %Arg_1.4590)
}

%region_208.4599 (Arg_0.4596: f32[], Arg_1.4597: f32[]) -> f32[] {
  %Arg_0.4596 = f32[] parameter(0)
  %Arg_1.4597 = f32[] parameter(1)
  ROOT %add.4598 = f32[] add(%Arg_0.4596, %Arg_1.4597)
}

%region_209.4606 (Arg_0.4603: f32[], Arg_1.4604: f32[]) -> f32[] {
  %Arg_0.4603 = f32[] parameter(0)
  %Arg_1.4604 = f32[] parameter(1)
  ROOT %add.4605 = f32[] add(%Arg_0.4603, %Arg_1.4604)
}

%region_210.4613 (Arg_0.4610: f32[], Arg_1.4611: f32[]) -> f32[] {
  %Arg_0.4610 = f32[] parameter(0)
  %Arg_1.4611 = f32[] parameter(1)
  ROOT %add.4612 = f32[] add(%Arg_0.4610, %Arg_1.4611)
}

%region_211.4620 (Arg_0.4617: f32[], Arg_1.4618: f32[]) -> f32[] {
  %Arg_0.4617 = f32[] parameter(0)
  %Arg_1.4618 = f32[] parameter(1)
  ROOT %add.4619 = f32[] add(%Arg_0.4617, %Arg_1.4618)
}

%region_212.4627 (Arg_0.4624: f32[], Arg_1.4625: f32[]) -> f32[] {
  %Arg_0.4624 = f32[] parameter(0)
  %Arg_1.4625 = f32[] parameter(1)
  ROOT %add.4626 = f32[] add(%Arg_0.4624, %Arg_1.4625)
}

%region_213.4634 (Arg_0.4631: f32[], Arg_1.4632: f32[]) -> f32[] {
  %Arg_0.4631 = f32[] parameter(0)
  %Arg_1.4632 = f32[] parameter(1)
  ROOT %add.4633 = f32[] add(%Arg_0.4631, %Arg_1.4632)
}

%region_214.4641 (Arg_0.4638: f32[], Arg_1.4639: f32[]) -> f32[] {
  %Arg_0.4638 = f32[] parameter(0)
  %Arg_1.4639 = f32[] parameter(1)
  ROOT %add.4640 = f32[] add(%Arg_0.4638, %Arg_1.4639)
}

%region_215.4648 (Arg_0.4645: f32[], Arg_1.4646: f32[]) -> f32[] {
  %Arg_0.4645 = f32[] parameter(0)
  %Arg_1.4646 = f32[] parameter(1)
  ROOT %add.4647 = f32[] add(%Arg_0.4645, %Arg_1.4646)
}

%region_216.4655 (Arg_0.4652: f32[], Arg_1.4653: f32[]) -> f32[] {
  %Arg_0.4652 = f32[] parameter(0)
  %Arg_1.4653 = f32[] parameter(1)
  ROOT %add.4654 = f32[] add(%Arg_0.4652, %Arg_1.4653)
}

%region_217.4662 (Arg_0.4659: f32[], Arg_1.4660: f32[]) -> f32[] {
  %Arg_0.4659 = f32[] parameter(0)
  %Arg_1.4660 = f32[] parameter(1)
  ROOT %add.4661 = f32[] add(%Arg_0.4659, %Arg_1.4660)
}

%region_218.4669 (Arg_0.4666: f32[], Arg_1.4667: f32[]) -> f32[] {
  %Arg_0.4666 = f32[] parameter(0)
  %Arg_1.4667 = f32[] parameter(1)
  ROOT %add.4668 = f32[] add(%Arg_0.4666, %Arg_1.4667)
}

%region_219.4676 (Arg_0.4673: f32[], Arg_1.4674: f32[]) -> f32[] {
  %Arg_0.4673 = f32[] parameter(0)
  %Arg_1.4674 = f32[] parameter(1)
  ROOT %add.4675 = f32[] add(%Arg_0.4673, %Arg_1.4674)
}

%region_220.4683 (Arg_0.4680: f32[], Arg_1.4681: f32[]) -> f32[] {
  %Arg_0.4680 = f32[] parameter(0)
  %Arg_1.4681 = f32[] parameter(1)
  ROOT %add.4682 = f32[] add(%Arg_0.4680, %Arg_1.4681)
}

%region_221.4690 (Arg_0.4687: f32[], Arg_1.4688: f32[]) -> f32[] {
  %Arg_0.4687 = f32[] parameter(0)
  %Arg_1.4688 = f32[] parameter(1)
  ROOT %add.4689 = f32[] add(%Arg_0.4687, %Arg_1.4688)
}

%region_222.4697 (Arg_0.4694: f32[], Arg_1.4695: f32[]) -> f32[] {
  %Arg_0.4694 = f32[] parameter(0)
  %Arg_1.4695 = f32[] parameter(1)
  ROOT %add.4696 = f32[] add(%Arg_0.4694, %Arg_1.4695)
}

%region_223.4704 (Arg_0.4701: f32[], Arg_1.4702: f32[]) -> f32[] {
  %Arg_0.4701 = f32[] parameter(0)
  %Arg_1.4702 = f32[] parameter(1)
  ROOT %add.4703 = f32[] add(%Arg_0.4701, %Arg_1.4702)
}

%region_224.4711 (Arg_0.4708: f32[], Arg_1.4709: f32[]) -> f32[] {
  %Arg_0.4708 = f32[] parameter(0)
  %Arg_1.4709 = f32[] parameter(1)
  ROOT %add.4710 = f32[] add(%Arg_0.4708, %Arg_1.4709)
}

%region_225.4718 (Arg_0.4715: f32[], Arg_1.4716: f32[]) -> f32[] {
  %Arg_0.4715 = f32[] parameter(0)
  %Arg_1.4716 = f32[] parameter(1)
  ROOT %add.4717 = f32[] add(%Arg_0.4715, %Arg_1.4716)
}

%region_226.4725 (Arg_0.4722: f32[], Arg_1.4723: f32[]) -> f32[] {
  %Arg_0.4722 = f32[] parameter(0)
  %Arg_1.4723 = f32[] parameter(1)
  ROOT %add.4724 = f32[] add(%Arg_0.4722, %Arg_1.4723)
}

%region_227.4732 (Arg_0.4729: f32[], Arg_1.4730: f32[]) -> f32[] {
  %Arg_0.4729 = f32[] parameter(0)
  %Arg_1.4730 = f32[] parameter(1)
  ROOT %add.4731 = f32[] add(%Arg_0.4729, %Arg_1.4730)
}

%region_228.4739 (Arg_0.4736: f32[], Arg_1.4737: f32[]) -> f32[] {
  %Arg_0.4736 = f32[] parameter(0)
  %Arg_1.4737 = f32[] parameter(1)
  ROOT %add.4738 = f32[] add(%Arg_0.4736, %Arg_1.4737)
}

%region_229.4747 (Arg_0.4744: f32[], Arg_1.4745: f32[]) -> f32[] {
  %Arg_0.4744 = f32[] parameter(0)
  %Arg_1.4745 = f32[] parameter(1)
  ROOT %add.4746 = f32[] add(%Arg_0.4744, %Arg_1.4745)
}

%region_230.4753 (Arg_0.4750: f32[], Arg_1.4751: f32[]) -> f32[] {
  %Arg_0.4750 = f32[] parameter(0)
  %Arg_1.4751 = f32[] parameter(1)
  ROOT %add.4752 = f32[] add(%Arg_0.4750, %Arg_1.4751)
}

%region_231.4760 (Arg_0.4757: f32[], Arg_1.4758: f32[]) -> f32[] {
  %Arg_0.4757 = f32[] parameter(0)
  %Arg_1.4758 = f32[] parameter(1)
  ROOT %add.4759 = f32[] add(%Arg_0.4757, %Arg_1.4758)
}

%region_232.4767 (Arg_0.4764: f32[], Arg_1.4765: f32[]) -> f32[] {
  %Arg_0.4764 = f32[] parameter(0)
  %Arg_1.4765 = f32[] parameter(1)
  ROOT %add.4766 = f32[] add(%Arg_0.4764, %Arg_1.4765)
}

%region_233.4774 (Arg_0.4771: f32[], Arg_1.4772: f32[]) -> f32[] {
  %Arg_0.4771 = f32[] parameter(0)
  %Arg_1.4772 = f32[] parameter(1)
  ROOT %add.4773 = f32[] add(%Arg_0.4771, %Arg_1.4772)
}

%region_234.4781 (Arg_0.4778: f32[], Arg_1.4779: f32[]) -> f32[] {
  %Arg_0.4778 = f32[] parameter(0)
  %Arg_1.4779 = f32[] parameter(1)
  ROOT %add.4780 = f32[] add(%Arg_0.4778, %Arg_1.4779)
}

%region_235.4788 (Arg_0.4785: f32[], Arg_1.4786: f32[]) -> f32[] {
  %Arg_0.4785 = f32[] parameter(0)
  %Arg_1.4786 = f32[] parameter(1)
  ROOT %add.4787 = f32[] add(%Arg_0.4785, %Arg_1.4786)
}

%region_236.4795 (Arg_0.4792: f32[], Arg_1.4793: f32[]) -> f32[] {
  %Arg_0.4792 = f32[] parameter(0)
  %Arg_1.4793 = f32[] parameter(1)
  ROOT %add.4794 = f32[] add(%Arg_0.4792, %Arg_1.4793)
}

%region_237.4802 (Arg_0.4799: f32[], Arg_1.4800: f32[]) -> f32[] {
  %Arg_0.4799 = f32[] parameter(0)
  %Arg_1.4800 = f32[] parameter(1)
  ROOT %add.4801 = f32[] add(%Arg_0.4799, %Arg_1.4800)
}

%region_238.4809 (Arg_0.4806: f32[], Arg_1.4807: f32[]) -> f32[] {
  %Arg_0.4806 = f32[] parameter(0)
  %Arg_1.4807 = f32[] parameter(1)
  ROOT %add.4808 = f32[] add(%Arg_0.4806, %Arg_1.4807)
}

%region_239.4816 (Arg_0.4813: f32[], Arg_1.4814: f32[]) -> f32[] {
  %Arg_0.4813 = f32[] parameter(0)
  %Arg_1.4814 = f32[] parameter(1)
  ROOT %add.4815 = f32[] add(%Arg_0.4813, %Arg_1.4814)
}

%region_240.4823 (Arg_0.4820: f32[], Arg_1.4821: f32[]) -> f32[] {
  %Arg_0.4820 = f32[] parameter(0)
  %Arg_1.4821 = f32[] parameter(1)
  ROOT %add.4822 = f32[] add(%Arg_0.4820, %Arg_1.4821)
}

%region_241.4830 (Arg_0.4827: f32[], Arg_1.4828: f32[]) -> f32[] {
  %Arg_0.4827 = f32[] parameter(0)
  %Arg_1.4828 = f32[] parameter(1)
  ROOT %add.4829 = f32[] add(%Arg_0.4827, %Arg_1.4828)
}

%region_242.4837 (Arg_0.4834: f32[], Arg_1.4835: f32[]) -> f32[] {
  %Arg_0.4834 = f32[] parameter(0)
  %Arg_1.4835 = f32[] parameter(1)
  ROOT %add.4836 = f32[] add(%Arg_0.4834, %Arg_1.4835)
}

%region_243.4844 (Arg_0.4841: f32[], Arg_1.4842: f32[]) -> f32[] {
  %Arg_0.4841 = f32[] parameter(0)
  %Arg_1.4842 = f32[] parameter(1)
  ROOT %add.4843 = f32[] add(%Arg_0.4841, %Arg_1.4842)
}

%region_244.4851 (Arg_0.4848: f32[], Arg_1.4849: f32[]) -> f32[] {
  %Arg_0.4848 = f32[] parameter(0)
  %Arg_1.4849 = f32[] parameter(1)
  ROOT %add.4850 = f32[] add(%Arg_0.4848, %Arg_1.4849)
}

%region_245.4858 (Arg_0.4855: f32[], Arg_1.4856: f32[]) -> f32[] {
  %Arg_0.4855 = f32[] parameter(0)
  %Arg_1.4856 = f32[] parameter(1)
  ROOT %add.4857 = f32[] add(%Arg_0.4855, %Arg_1.4856)
}

%region_246.4865 (Arg_0.4862: f32[], Arg_1.4863: f32[]) -> f32[] {
  %Arg_0.4862 = f32[] parameter(0)
  %Arg_1.4863 = f32[] parameter(1)
  ROOT %add.4864 = f32[] add(%Arg_0.4862, %Arg_1.4863)
}

%region_247.4872 (Arg_0.4869: f32[], Arg_1.4870: f32[]) -> f32[] {
  %Arg_0.4869 = f32[] parameter(0)
  %Arg_1.4870 = f32[] parameter(1)
  ROOT %add.4871 = f32[] add(%Arg_0.4869, %Arg_1.4870)
}

%region_248.4879 (Arg_0.4876: f32[], Arg_1.4877: f32[]) -> f32[] {
  %Arg_0.4876 = f32[] parameter(0)
  %Arg_1.4877 = f32[] parameter(1)
  ROOT %add.4878 = f32[] add(%Arg_0.4876, %Arg_1.4877)
}

%region_249.4886 (Arg_0.4883: f32[], Arg_1.4884: f32[]) -> f32[] {
  %Arg_0.4883 = f32[] parameter(0)
  %Arg_1.4884 = f32[] parameter(1)
  ROOT %add.4885 = f32[] add(%Arg_0.4883, %Arg_1.4884)
}

%region_250.4893 (Arg_0.4890: f32[], Arg_1.4891: f32[]) -> f32[] {
  %Arg_0.4890 = f32[] parameter(0)
  %Arg_1.4891 = f32[] parameter(1)
  ROOT %add.4892 = f32[] add(%Arg_0.4890, %Arg_1.4891)
}

%region_251.4900 (Arg_0.4897: f32[], Arg_1.4898: f32[]) -> f32[] {
  %Arg_0.4897 = f32[] parameter(0)
  %Arg_1.4898 = f32[] parameter(1)
  ROOT %add.4899 = f32[] add(%Arg_0.4897, %Arg_1.4898)
}

%region_252.4907 (Arg_0.4904: f32[], Arg_1.4905: f32[]) -> f32[] {
  %Arg_0.4904 = f32[] parameter(0)
  %Arg_1.4905 = f32[] parameter(1)
  ROOT %add.4906 = f32[] add(%Arg_0.4904, %Arg_1.4905)
}

%region_253.4914 (Arg_0.4911: f32[], Arg_1.4912: f32[]) -> f32[] {
  %Arg_0.4911 = f32[] parameter(0)
  %Arg_1.4912 = f32[] parameter(1)
  ROOT %add.4913 = f32[] add(%Arg_0.4911, %Arg_1.4912)
}

%region_254.4921 (Arg_0.4918: f32[], Arg_1.4919: f32[]) -> f32[] {
  %Arg_0.4918 = f32[] parameter(0)
  %Arg_1.4919 = f32[] parameter(1)
  ROOT %add.4920 = f32[] add(%Arg_0.4918, %Arg_1.4919)
}

%region_255.4928 (Arg_0.4925: f32[], Arg_1.4926: f32[]) -> f32[] {
  %Arg_0.4925 = f32[] parameter(0)
  %Arg_1.4926 = f32[] parameter(1)
  ROOT %add.4927 = f32[] add(%Arg_0.4925, %Arg_1.4926)
}

%region_256.4935 (Arg_0.4932: f32[], Arg_1.4933: f32[]) -> f32[] {
  %Arg_0.4932 = f32[] parameter(0)
  %Arg_1.4933 = f32[] parameter(1)
  ROOT %add.4934 = f32[] add(%Arg_0.4932, %Arg_1.4933)
}

%region_257.4942 (Arg_0.4939: f32[], Arg_1.4940: f32[]) -> f32[] {
  %Arg_0.4939 = f32[] parameter(0)
  %Arg_1.4940 = f32[] parameter(1)
  ROOT %add.4941 = f32[] add(%Arg_0.4939, %Arg_1.4940)
}

%region_258.4949 (Arg_0.4946: f32[], Arg_1.4947: f32[]) -> f32[] {
  %Arg_0.4946 = f32[] parameter(0)
  %Arg_1.4947 = f32[] parameter(1)
  ROOT %add.4948 = f32[] add(%Arg_0.4946, %Arg_1.4947)
}

%region_259.4956 (Arg_0.4953: f32[], Arg_1.4954: f32[]) -> f32[] {
  %Arg_0.4953 = f32[] parameter(0)
  %Arg_1.4954 = f32[] parameter(1)
  ROOT %add.4955 = f32[] add(%Arg_0.4953, %Arg_1.4954)
}

%region_260.4963 (Arg_0.4960: f32[], Arg_1.4961: f32[]) -> f32[] {
  %Arg_0.4960 = f32[] parameter(0)
  %Arg_1.4961 = f32[] parameter(1)
  ROOT %add.4962 = f32[] add(%Arg_0.4960, %Arg_1.4961)
}

%region_261.4970 (Arg_0.4967: f32[], Arg_1.4968: f32[]) -> f32[] {
  %Arg_0.4967 = f32[] parameter(0)
  %Arg_1.4968 = f32[] parameter(1)
  ROOT %add.4969 = f32[] add(%Arg_0.4967, %Arg_1.4968)
}

%region_262.4977 (Arg_0.4974: f32[], Arg_1.4975: f32[]) -> f32[] {
  %Arg_0.4974 = f32[] parameter(0)
  %Arg_1.4975 = f32[] parameter(1)
  ROOT %add.4976 = f32[] add(%Arg_0.4974, %Arg_1.4975)
}

%region_263.4984 (Arg_0.4981: f32[], Arg_1.4982: f32[]) -> f32[] {
  %Arg_0.4981 = f32[] parameter(0)
  %Arg_1.4982 = f32[] parameter(1)
  ROOT %add.4983 = f32[] add(%Arg_0.4981, %Arg_1.4982)
}

%region_264.4991 (Arg_0.4988: f32[], Arg_1.4989: f32[]) -> f32[] {
  %Arg_0.4988 = f32[] parameter(0)
  %Arg_1.4989 = f32[] parameter(1)
  ROOT %add.4990 = f32[] add(%Arg_0.4988, %Arg_1.4989)
}

%region_265.4998 (Arg_0.4995: f32[], Arg_1.4996: f32[]) -> f32[] {
  %Arg_0.4995 = f32[] parameter(0)
  %Arg_1.4996 = f32[] parameter(1)
  ROOT %add.4997 = f32[] add(%Arg_0.4995, %Arg_1.4996)
}

%region_266.5005 (Arg_0.5002: f32[], Arg_1.5003: f32[]) -> f32[] {
  %Arg_0.5002 = f32[] parameter(0)
  %Arg_1.5003 = f32[] parameter(1)
  ROOT %add.5004 = f32[] add(%Arg_0.5002, %Arg_1.5003)
}

%region_267.5012 (Arg_0.5009: f32[], Arg_1.5010: f32[]) -> f32[] {
  %Arg_0.5009 = f32[] parameter(0)
  %Arg_1.5010 = f32[] parameter(1)
  ROOT %add.5011 = f32[] add(%Arg_0.5009, %Arg_1.5010)
}

%region_268.5019 (Arg_0.5016: f32[], Arg_1.5017: f32[]) -> f32[] {
  %Arg_0.5016 = f32[] parameter(0)
  %Arg_1.5017 = f32[] parameter(1)
  ROOT %add.5018 = f32[] add(%Arg_0.5016, %Arg_1.5017)
}

%region_269.5026 (Arg_0.5023: f32[], Arg_1.5024: f32[]) -> f32[] {
  %Arg_0.5023 = f32[] parameter(0)
  %Arg_1.5024 = f32[] parameter(1)
  ROOT %add.5025 = f32[] add(%Arg_0.5023, %Arg_1.5024)
}

%region_270.5033 (Arg_0.5030: f32[], Arg_1.5031: f32[]) -> f32[] {
  %Arg_0.5030 = f32[] parameter(0)
  %Arg_1.5031 = f32[] parameter(1)
  ROOT %add.5032 = f32[] add(%Arg_0.5030, %Arg_1.5031)
}

%region_8.211._custom_call_lowering_rule (Arg_0.208: s32[], Arg_1.209: s32[]) -> s32[] {
  %Arg_0.208 = s32[] parameter(0)
  %Arg_1.209 = s32[] parameter(1)
  ROOT %add.210 = s32[] add(%Arg_0.208, %Arg_1.209)
}

%region_11.241._custom_call_lowering_rule (Arg_0.239: s32[], Arg_1.240: s32[]) -> s32[] {
  %Arg_0.239 = s32[] parameter(0)
  ROOT %Arg_1.240 = s32[] parameter(1)
}

%region_9.219._custom_call_lowering_rule (Arg_0.217: pred[], Arg_1.218: pred[]) -> pred[] {
  %Arg_0.217 = pred[] parameter(0)
  ROOT %Arg_1.218 = pred[] parameter(1)
}

%region_10.230._custom_call_lowering_rule (Arg_0.227: s32[], Arg_1.228: s32[]) -> s32[] {
  %Arg_0.227 = s32[] parameter(0)
  %Arg_1.228 = s32[] parameter(1)
  ROOT %add.229 = s32[] add(%Arg_0.227, %Arg_1.228)
}

%region_8.211._custom_call_lowering_rule.1 (Arg_0.118: s32[], Arg_1.98: s32[]) -> s32[] {
  %Arg_0.118 = s32[] parameter(0)
  %Arg_1.98 = s32[] parameter(1)
  ROOT %add.120 = s32[] add(%Arg_0.118, %Arg_1.98)
}

%region_11.241._custom_call_lowering_rule.1 (Arg_0.119: s32[], Arg_1.99: s32[]) -> s32[] {
  %Arg_0.119 = s32[] parameter(0)
  ROOT %Arg_1.99 = s32[] parameter(1)
}

%region_9.219._custom_call_lowering_rule.1 (Arg_0.120: pred[], Arg_1.100: pred[]) -> pred[] {
  %Arg_0.120 = pred[] parameter(0)
  ROOT %Arg_1.100 = pred[] parameter(1)
}

%region_10.230._custom_call_lowering_rule.1 (Arg_0.122: s32[], Arg_1.101: s32[]) -> s32[] {
  %Arg_0.122 = s32[] parameter(0)
  %Arg_1.101 = s32[] parameter(1)
  ROOT %add.121 = s32[] add(%Arg_0.122, %Arg_1.101)
}

%region_1.78._custom_call_lowering_rule (Arg_0.124: s32[], Arg_1.104: s32[], Arg_2.85: s32[], Arg_3.76: s32[]) -> pred[] {
  %Arg_2.85 = s32[] parameter(2)
  %Arg_3.76 = s32[] parameter(3)
  %Arg_0.124 = s32[] parameter(0)
  %Arg_1.104 = s32[] parameter(1)
  ROOT %compare.258 = pred[] compare(%Arg_0.124, %Arg_1.104), direction=LT
}

%region_2.91._custom_call_lowering_rule (Arg_0.125: s32[], Arg_1.105: s32[]) -> s32[] {
  %Arg_0.125 = s32[] parameter(0)
  %Arg_1.105 = s32[] parameter(1)
  ROOT %add.122 = s32[] add(%Arg_0.125, %Arg_1.105)
}

%region_6.190._custom_call_lowering_rule (Arg_0.188: s32[], Arg_1.189: s32[]) -> s32[] {
  %Arg_0.188 = s32[] parameter(0)
  ROOT %Arg_1.189 = s32[] parameter(1)
}

%region_3.99._custom_call_lowering_rule (Arg_0.126: pred[], Arg_1.106: pred[]) -> pred[] {
  %Arg_0.126 = pred[] parameter(0)
  ROOT %Arg_1.106 = pred[] parameter(1)
}

%region_4.108._custom_call_lowering_rule (Arg_0.127: s32[], Arg_1.107: s32[]) -> s32[] {
  %Arg_0.127 = s32[] parameter(0)
  %Arg_1.107 = s32[] parameter(1)
  ROOT %add.124 = s32[] add(%Arg_0.127, %Arg_1.107)
}

%region_5.127._custom_call_lowering_rule (Arg_0.128: s32[], Arg_1.125: s32[]) -> s32[] {
  %Arg_0.128 = s32[] parameter(0)
  %Arg_1.125 = s32[] parameter(1)
  ROOT %add.126 = s32[] add(%Arg_0.128, %Arg_1.125)
}

%region_0.42._custom_call_lowering_rule (Arg_0.129: s32[], Arg_1.108: s32[]) -> s32[] {
  %Arg_0.129 = s32[] parameter(0)
  %Arg_1.108 = s32[] parameter(1)
  ROOT %add.125 = s32[] add(%Arg_0.129, %Arg_1.108)
}

%region_7.198._custom_call_lowering_rule (Arg_0.196: s32[], Arg_1.197: s32[]) -> s32[] {
  %Arg_0.196 = s32[] parameter(0)
  ROOT %Arg_1.197 = s32[] parameter(1)
}

%region_8.214._custom_call_lowering_rule (Arg_0.211: s32[], Arg_1.212: s32[]) -> s32[] {
  %Arg_0.211 = s32[] parameter(0)
  %Arg_1.212 = s32[] parameter(1)
  ROOT %add.213 = s32[] add(%Arg_0.211, %Arg_1.212)
}

%region_11.244._custom_call_lowering_rule (Arg_0.242: s32[], Arg_1.243: s32[]) -> s32[] {
  %Arg_0.242 = s32[] parameter(0)
  ROOT %Arg_1.243 = s32[] parameter(1)
}

%region_9.222._custom_call_lowering_rule (Arg_0.220: pred[], Arg_1.221: pred[]) -> pred[] {
  %Arg_0.220 = pred[] parameter(0)
  ROOT %Arg_1.221 = pred[] parameter(1)
}

%region_10.233._custom_call_lowering_rule (Arg_0.230: s32[], Arg_1.231: s32[]) -> s32[] {
  %Arg_0.230 = s32[] parameter(0)
  %Arg_1.231 = s32[] parameter(1)
  ROOT %add.232 = s32[] add(%Arg_0.230, %Arg_1.231)
}

%region_12.252._custom_call_lowering_rule (Arg_0.250: s32[], Arg_1.251: s32[]) -> s32[] {
  %Arg_0.250 = s32[] parameter(0)
  ROOT %Arg_1.251 = s32[] parameter(1)
}

%region_26.1375 (Arg_0.1372: s32[], Arg_1.1373: s32[]) -> s32[] {
  %Arg_0.1372 = s32[] parameter(0)
  %Arg_1.1373 = s32[] parameter(1)
  ROOT %add.1374 = s32[] add(%Arg_0.1372, %Arg_1.1373)
}

%region_26.1375.clone (Arg_0.104: s32[], Arg_1.85: s32[]) -> s32[] {
  %Arg_0.104 = s32[] parameter(0)
  %Arg_1.85 = s32[] parameter(1)
  ROOT %add.99 = s32[] add(%Arg_0.104, %Arg_1.85)
}

%region_0.440 (Arg_0.437: s32[], Arg_1.438: s32[]) -> s32[] {
  %Arg_0.437 = s32[] parameter(0)
  %Arg_1.438 = s32[] parameter(1)
  ROOT %add.439 = s32[] add(%Arg_0.437, %Arg_1.438)
}

%region_1.448 (Arg_0.445: s32[], Arg_1.446: s32[]) -> s32[] {
  %Arg_0.445 = s32[] parameter(0)
  %Arg_1.446 = s32[] parameter(1)
  ROOT %add.447 = s32[] add(%Arg_0.445, %Arg_1.446)
}

%region_2.453 (Arg_0.450: s32[], Arg_1.451: s32[]) -> s32[] {
  %Arg_0.450 = s32[] parameter(0)
  %Arg_1.451 = s32[] parameter(1)
  ROOT %maximum.452 = s32[] maximum(%Arg_0.450, %Arg_1.451)
}

%region_4.685 (Arg_0.682: f32[], Arg_1.683: f32[]) -> f32[] {
  %Arg_0.682 = f32[] parameter(0)
  %Arg_1.683 = f32[] parameter(1)
  ROOT %add.684 = f32[] add(%Arg_0.682, %Arg_1.683)
}

%region_5.709 (Arg_0.706: f32[], Arg_1.707: f32[]) -> f32[] {
  %Arg_0.706 = f32[] parameter(0)
  %Arg_1.707 = f32[] parameter(1)
  ROOT %maximum.708 = f32[] maximum(%Arg_0.706, %Arg_1.707)
}

%region_6.750 (Arg_0.747: f32[], Arg_1.748: f32[]) -> f32[] {
  %Arg_0.747 = f32[] parameter(0)
  %Arg_1.748 = f32[] parameter(1)
  ROOT %maximum.749 = f32[] maximum(%Arg_0.747, %Arg_1.748)
}

%region_7.786 (Arg_0.783: f32[], Arg_1.784: f32[]) -> f32[] {
  %Arg_0.783 = f32[] parameter(0)
  %Arg_1.784 = f32[] parameter(1)
  ROOT %maximum.785 = f32[] maximum(%Arg_0.783, %Arg_1.784)
}

%region_8.806 (Arg_0.803: f32[], Arg_1.804: f32[]) -> f32[] {
  %Arg_0.803 = f32[] parameter(0)
  %Arg_1.804 = f32[] parameter(1)
  ROOT %maximum.805 = f32[] maximum(%Arg_0.803, %Arg_1.804)
}

%region_9.842 (Arg_0.839: f32[], Arg_1.840: f32[]) -> f32[] {
  %Arg_0.839 = f32[] parameter(0)
  %Arg_1.840 = f32[] parameter(1)
  ROOT %maximum.841 = f32[] maximum(%Arg_0.839, %Arg_1.840)
}

%region_10.862 (Arg_0.859: f32[], Arg_1.860: f32[]) -> f32[] {
  %Arg_0.859 = f32[] parameter(0)
  %Arg_1.860 = f32[] parameter(1)
  ROOT %maximum.861 = f32[] maximum(%Arg_0.859, %Arg_1.860)
}

%region_1.75._custom_call_lowering_rule (Arg_0.105: s32[], Arg_1.86: s32[], Arg_2.83: s32[], Arg_3.73: s32[]) -> pred[] {
  %Arg_2.83 = s32[] parameter(2)
  %Arg_3.73 = s32[] parameter(3)
  %Arg_0.105 = s32[] parameter(0)
  %Arg_1.86 = s32[] parameter(1)
  ROOT %compare.213 = pred[] compare(%Arg_0.105, %Arg_1.86), direction=LT
}

%region_2.88._custom_call_lowering_rule (Arg_0.106: s32[], Arg_1.87: s32[]) -> s32[] {
  %Arg_0.106 = s32[] parameter(0)
  %Arg_1.87 = s32[] parameter(1)
  ROOT %add.100 = s32[] add(%Arg_0.106, %Arg_1.87)
}

%region_6.187._custom_call_lowering_rule (Arg_0.185: s32[], Arg_1.186: s32[]) -> s32[] {
  %Arg_0.185 = s32[] parameter(0)
  ROOT %Arg_1.186 = s32[] parameter(1)
}

%region_3.96._custom_call_lowering_rule (Arg_0.107: pred[], Arg_1.95: pred[]) -> pred[] {
  %Arg_0.107 = pred[] parameter(0)
  ROOT %Arg_1.95 = pred[] parameter(1)
}

%region_4.105._custom_call_lowering_rule (Arg_0.108: s32[], Arg_1.103: s32[]) -> s32[] {
  %Arg_0.108 = s32[] parameter(0)
  %Arg_1.103 = s32[] parameter(1)
  ROOT %add.104 = s32[] add(%Arg_0.108, %Arg_1.103)
}

%region_5.124._custom_call_lowering_rule (Arg_0.121: s32[], Arg_1.122: s32[]) -> s32[] {
  %Arg_0.121 = s32[] parameter(0)
  %Arg_1.122 = s32[] parameter(1)
  ROOT %add.123 = s32[] add(%Arg_0.121, %Arg_1.122)
}

%region_0.39._custom_call_lowering_rule (Arg_0.109: s32[], Arg_1.88: s32[]) -> s32[] {
  %Arg_0.109 = s32[] parameter(0)
  %Arg_1.88 = s32[] parameter(1)
  ROOT %add.101 = s32[] add(%Arg_0.109, %Arg_1.88)
}

%region_0.39._custom_call_lowering_rule.clone (Arg_0.194: s32[], Arg_1.172: s32[]) -> s32[] {
  %Arg_0.194 = s32[] parameter(0)
  %Arg_1.172 = s32[] parameter(1)
  ROOT %add.521 = s32[] add(%Arg_0.194, %Arg_1.172)
}

%region_7.195._custom_call_lowering_rule (Arg_0.193: s32[], Arg_1.194: s32[]) -> s32[] {
  %Arg_0.193 = s32[] parameter(0)
  ROOT %Arg_1.194 = s32[] parameter(1)
}

%region_0.39._custom_call_lowering_rule.clone.1 (Arg_0.195: s32[], Arg_1.173: s32[]) -> s32[] {
  %Arg_0.195 = s32[] parameter(0)
  %Arg_1.173 = s32[] parameter(1)
  ROOT %add.522 = s32[] add(%Arg_0.195, %Arg_1.173)
}

%region_12.249._custom_call_lowering_rule (Arg_0.247: s32[], Arg_1.248: s32[]) -> s32[] {
  %Arg_0.247 = s32[] parameter(0)
  ROOT %Arg_1.248 = s32[] parameter(1)
}

%region_11.946 (Arg_0.943: f32[], Arg_1.944: f32[]) -> f32[] {
  %Arg_0.943 = f32[] parameter(0)
  %Arg_1.944 = f32[] parameter(1)
  ROOT %maximum.945 = f32[] maximum(%Arg_0.943, %Arg_1.944)
}

%region_12.974 (Arg_0.971: f32[], Arg_1.972: f32[]) -> f32[] {
  %Arg_0.971 = f32[] parameter(0)
  %Arg_1.972 = f32[] parameter(1)
  ROOT %maximum.973 = f32[] maximum(%Arg_0.971, %Arg_1.972)
}

%region_13.1013 (Arg_0.1010: f32[], Arg_1.1011: f32[]) -> f32[] {
  %Arg_0.1010 = f32[] parameter(0)
  %Arg_1.1011 = f32[] parameter(1)
  ROOT %add.1012 = f32[] add(%Arg_0.1010, %Arg_1.1011)
}

%region_14.1035 (Arg_0.1032: f32[], Arg_1.1033: f32[]) -> f32[] {
  %Arg_0.1032 = f32[] parameter(0)
  %Arg_1.1033 = f32[] parameter(1)
  ROOT %maximum.1034 = f32[] maximum(%Arg_0.1032, %Arg_1.1033)
}

%region_15.1055 (Arg_0.1052: f32[], Arg_1.1053: f32[]) -> f32[] {
  %Arg_0.1052 = f32[] parameter(0)
  %Arg_1.1053 = f32[] parameter(1)
  ROOT %maximum.1054 = f32[] maximum(%Arg_0.1052, %Arg_1.1053)
}

%region_16.1101 (Arg_0.1098: f32[], Arg_1.1099: f32[]) -> f32[] {
  %Arg_0.1098 = f32[] parameter(0)
  %Arg_1.1099 = f32[] parameter(1)
  ROOT %maximum.1100 = f32[] maximum(%Arg_0.1098, %Arg_1.1099)
}

%region_17.1121 (Arg_0.1118: f32[], Arg_1.1119: f32[]) -> f32[] {
  %Arg_0.1118 = f32[] parameter(0)
  %Arg_1.1119 = f32[] parameter(1)
  ROOT %maximum.1120 = f32[] maximum(%Arg_0.1118, %Arg_1.1119)
}

%region_18.1151 (Arg_0.1148: f32[], Arg_1.1149: f32[]) -> f32[] {
  %Arg_0.1148 = f32[] parameter(0)
  %Arg_1.1149 = f32[] parameter(1)
  ROOT %maximum.1150 = f32[] maximum(%Arg_0.1148, %Arg_1.1149)
}

%region_19.1179 (Arg_0.1176: f32[], Arg_1.1177: f32[]) -> f32[] {
  %Arg_0.1176 = f32[] parameter(0)
  %Arg_1.1177 = f32[] parameter(1)
  ROOT %maximum.1178 = f32[] maximum(%Arg_0.1176, %Arg_1.1177)
}

%region_3.1223_spmd (param.43: (s32[], bf16[2,8192,8192], bf16[80,2,8192,8192], f32[80,64,28672], f32[80,64,28672], /*index=5*/f32[80,28672,64], f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], /*index=10*/f32[80,64,64,128], f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], /*index=15*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=20*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=25*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=30*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=35*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=40*/f32[2,8192,1,128], s32[2,8192,64,128], f32[2,8192,1,128], f32[1,1,1,128], f32[2,8192,1,128], /*index=45*/s32[2,8192,8,128], f32[2,8192,1,128], f32[1,1,1,128], s32[2,1], s32[2,1])) -> (s32[], bf16[2,8192,8192], bf16[80,2,8192,8192], f32[80,64,28672], f32[80,64,28672], /*index=5*/f32[80,28672,64], f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], /*index=10*/f32[80,64,64,128], f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], /*index=15*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=20*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=25*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=30*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=35*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=40*/f32[2,8192,1,128], s32[2,8192,64,128], f32[2,8192,1,128], f32[1,1,1,128], f32[2,8192,1,128], /*index=45*/s32[2,8192,8,128], f32[2,8192,1,128], f32[1,1,1,128], s32[2,1], s32[2,1]) {
  %param.43 = (s32[], bf16[2,8192,8192]{2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, /*index=5*/f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, /*index=10*/f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=15*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=20*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=25*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=30*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=35*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=40*/f32[2,8192,1,128]{3,2,1,0}, s32[2,8192,64,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, /*index=45*/s32[2,8192,8,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, s32[2,1]{1,0}, s32[2,1]{1,0}) parameter(0)
  %get-tuple-element.266 = s32[] get-tuple-element(%param.43), index=0
  %constant.1524 = s32[] constant(1)
  %add.102 = s32[] add(%get-tuple-element.266, %constant.1524)
  %constant.1525 = bf16[] constant(-448)
  %broadcast.1662 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1525), dimensions={}
  %broadcast.1663 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.267 = bf16[2,8192,8192]{2,1,0} get-tuple-element(%param.43), index=1
  %copy.43 = bf16[2,8192,8192]{2,1,0} copy(%get-tuple-element.267)
  %broadcast.1664 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.1525), dimensions={}
  %convert.238 = f32[2,8192,8192]{2,1,0} convert(%copy.43)
  %multiply.210 = f32[2,8192,8192]{2,1,0} multiply(%convert.238, %convert.238)
  %constant.1529 = f32[] constant(0)
  %reduce.159 = f32[2,8192]{1,0} reduce(%multiply.210, %constant.1529), dimensions={2}, to_apply=%region_4.685
  %constant.1530 = f32[] constant(0.000122070312)
  %broadcast.1666 = f32[2,8192]{1,0} broadcast(%constant.1530), dimensions={}
  %multiply.211 = f32[2,8192]{1,0} multiply(%reduce.159, %broadcast.1666)
  %constant.1531 = f32[] constant(1e-05)
  %broadcast.1667 = f32[2,8192]{1,0} broadcast(%constant.1531), dimensions={}
  %add.103 = f32[2,8192]{1,0} add(%multiply.211, %broadcast.1667)
  %rsqrt.6 = f32[2,8192]{1,0} rsqrt(%add.103)
  %broadcast.1668 = f32[2,8192,8192]{2,1,0} broadcast(%rsqrt.6), dimensions={0,1}
  %multiply.212 = f32[2,8192,8192]{2,1,0} multiply(%convert.238, %broadcast.1668)
  %convert.239 = bf16[2,8192,8192]{2,1,0} convert(%multiply.212)
  %get-tuple-element.268 = f32[80,8192]{1,0} get-tuple-element(%param.43), index=7
  %constant.1532 = s32[] constant(0)
  %dynamic-slice.126 = f32[1,8192]{1,0} dynamic-slice(%get-tuple-element.268, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,8192}
  %convert.240 = bf16[1,8192]{1,0} convert(%dynamic-slice.126)
  %reshape.1571 = bf16[8192]{0} reshape(%convert.240)
  %broadcast.1669 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1571), dimensions={2}
  %multiply.213 = bf16[2,8192,8192]{2,1,0} multiply(%convert.239, %broadcast.1669)
  %copy.44 = bf16[2,8192,8192]{2,1,0} copy(%multiply.213)
  %copy.45 = bf16[2,8192,8192]{2,1,0} copy(%copy.44)
  %constant.1533 = f32[1]{0} constant({1})
  %get-tuple-element.269 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=32
  %dynamic-slice.127 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.269, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %constant.1535 = f32[] constant(-inf)
  %reduce.160 = f32[] reduce(%dynamic-slice.127, %constant.1535), dimensions={0,1}, to_apply=%region_5.709
  %is-finite.35 = pred[] is-finite(%reduce.160)
  %reshape.1573 = pred[1]{0} reshape(%is-finite.35)
  %compare.214 = pred[] compare(%reduce.160, %constant.1529), direction=GT
  %reshape.1575 = pred[1]{0} reshape(%compare.214)
  %constant.1537 = f32[] constant(448)
  %divide.270 = f32[] divide(%constant.1537, %reduce.160)
  %reshape.1577 = f32[1]{0} reshape(%divide.270)
  %constant.1538 = f32[1,1]{1,0} constant({ {1} })
  %get-tuple-element.270 = f32[80,1]{1,0} get-tuple-element(%param.43), index=33
  %dynamic-slice.128 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.270, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.271 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.128)
  %reshape.1579 = f32[1]{0} reshape(%divide.271)
  %select.299 = f32[1]{0} select(%reshape.1575, %reshape.1577, %reshape.1579)
  %select.300 = f32[1]{0} select(%reshape.1573, %select.299, %reshape.1579)
  %divide.272 = f32[1]{0} divide(%constant.1533, %select.300)
  %convert.241 = bf16[1]{0} convert(%divide.272)
  %reshape.1581 = bf16[] reshape(%convert.241)
  %broadcast.1670 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1581), dimensions={}
  %divide.273 = bf16[2,8192,8192]{2,1,0} divide(%copy.45, %broadcast.1670)
  %constant.1540 = bf16[] constant(448)
  %broadcast.1671 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.49 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1663, %divide.273, %broadcast.1671)
  %convert.242 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.49)
  %broadcast.1672 = bf16[1,64,64,128]{3,2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.271 = f32[80,64,64,128]{3,2,1,0} get-tuple-element(%param.43), index=10
  %dynamic-slice.129 = f32[1,64,64,128]{3,2,1,0} dynamic-slice(%get-tuple-element.271, %get-tuple-element.266, %constant.1532, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,64,128}
  %convert.243 = bf16[1,64,64,128]{3,2,1,0} convert(%dynamic-slice.129)
  %get-tuple-element.272 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=34
  %dynamic-slice.130 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.272, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.161 = f32[] reduce(%dynamic-slice.130, %constant.1535), dimensions={0,1}, to_apply=%region_6.750
  %is-finite.36 = pred[] is-finite(%reduce.161)
  %reshape.1583 = pred[1]{0} reshape(%is-finite.36)
  %compare.215 = pred[] compare(%reduce.161, %constant.1529), direction=GT
  %reshape.1585 = pred[1]{0} reshape(%compare.215)
  %divide.274 = f32[] divide(%constant.1537, %reduce.161)
  %reshape.1587 = f32[1]{0} reshape(%divide.274)
  %get-tuple-element.273 = f32[80,1]{1,0} get-tuple-element(%param.43), index=35
  %dynamic-slice.131 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.273, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.275 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.131)
  %reshape.1589 = f32[1]{0} reshape(%divide.275)
  %select.302 = f32[1]{0} select(%reshape.1585, %reshape.1587, %reshape.1589)
  %select.303 = f32[1]{0} select(%reshape.1583, %select.302, %reshape.1589)
  %divide.276 = f32[1]{0} divide(%constant.1533, %select.303)
  %convert.244 = bf16[1]{0} convert(%divide.276)
  %reshape.1591 = bf16[] reshape(%convert.244)
  %broadcast.1673 = bf16[1,64,64,128]{3,2,1,0} broadcast(%reshape.1591), dimensions={}
  %divide.277 = bf16[1,64,64,128]{3,2,1,0} divide(%convert.243, %broadcast.1673)
  %broadcast.1674 = bf16[1,64,64,128]{3,2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.50 = bf16[1,64,64,128]{3,2,1,0} clamp(%broadcast.1672, %divide.277, %broadcast.1674)
  %convert.245 = f8e4m3fn[1,64,64,128]{3,2,1,0} convert(%clamp.50)
  %reshape.1593 = f8e4m3fn[64,64,128]{2,1,0} reshape(%convert.245)
  %all-gather = f8e4m3fn[8192,64,128]{2,1,0} all-gather(%reshape.1593), channel_id=3, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.32 = bf16[2,8192,64,128]{3,2,1,0} dot(%convert.242, %all-gather), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.214 = f32[1]{0} multiply(%divide.272, %divide.276)
  %convert.246 = bf16[1]{0} convert(%multiply.214)
  %reshape.1595 = bf16[] reshape(%convert.246)
  %broadcast.1675 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1595), dimensions={}
  %multiply.215 = bf16[2,8192,64,128]{3,2,1,0} multiply(%dot.32, %broadcast.1675)
  %convert.247 = f32[2,8192,64,128]{3,2,1,0} convert(%multiply.215)
  %get-tuple-element.274 = f32[2,8192,1,128]{3,2,1,0} get-tuple-element(%param.43), index=40
  %reshape.1597 = f32[2,8192,128]{2,1,0} reshape(%get-tuple-element.274)
  %broadcast.1676 = f32[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1597), dimensions={0,1,3}
  %multiply.216 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.247, %broadcast.1676)
  %get-tuple-element.275 = s32[2,8192,64,128]{3,2,1,0} get-tuple-element(%param.43), index=41
  %broadcast.1677 = s32[2,8192,64,128]{3,2,1,0} broadcast(%constant.1524), dimensions={}
  %compare.216 = pred[2,8192,64,128]{3,2,1,0} compare(%get-tuple-element.275, %broadcast.1677), direction=LT
  %slice.399 = bf16[2,8192,64,127]{3,2,1,0} slice(%multiply.215), slice={[0:2], [0:8192], [0:64], [1:128]}
  %slice.400 = bf16[2,8192,64,1]{3,2,1,0} slice(%multiply.215), slice={[0:2], [0:8192], [0:64], [0:1]}
  %concatenate.111 = bf16[2,8192,64,128]{3,2,1,0} concatenate(%slice.399, %slice.400), dimensions={3}
  %slice.401 = bf16[2,8192,64,1]{3,2,1,0} slice(%multiply.215), slice={[0:2], [0:8192], [0:64], [127:128]}
  %slice.402 = bf16[2,8192,64,127]{3,2,1,0} slice(%multiply.215), slice={[0:2], [0:8192], [0:64], [0:127]}
  %concatenate.112 = bf16[2,8192,64,128]{3,2,1,0} concatenate(%slice.401, %slice.402), dimensions={3}
  %select.304 = bf16[2,8192,64,128]{3,2,1,0} select(%compare.216, %concatenate.111, %concatenate.112)
  %convert.248 = f32[2,8192,64,128]{3,2,1,0} convert(%select.304)
  %get-tuple-element.276 = f32[2,8192,1,128]{3,2,1,0} get-tuple-element(%param.43), index=42
  %reshape.1607 = f32[2,8192,128]{2,1,0} reshape(%get-tuple-element.276)
  %broadcast.1678 = f32[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1607), dimensions={0,1,3}
  %multiply.221 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.248, %broadcast.1678)
  %get-tuple-element.277 = f32[1,1,1,128]{3,2,1,0} get-tuple-element(%param.43), index=43
  %reshape.1609 = f32[128]{0} reshape(%get-tuple-element.277)
  %broadcast.1679 = f32[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1609), dimensions={3}
  %multiply.222 = f32[2,8192,64,128]{3,2,1,0} multiply(%multiply.221, %broadcast.1679)
  %add.105 = f32[2,8192,64,128]{3,2,1,0} add(%multiply.216, %multiply.222)
  %convert.249 = bf16[2,8192,64,128]{3,2,1,0} convert(%add.105)
  %copy.46 = bf16[2,8192,64,128]{3,2,1,0} copy(%convert.249)
  %get-tuple-element.278 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=24
  %dynamic-slice.136 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.278, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.162 = f32[] reduce(%dynamic-slice.136, %constant.1535), dimensions={0,1}, to_apply=%region_7.786
  %is-finite.37 = pred[] is-finite(%reduce.162)
  %reshape.1611 = pred[1]{0} reshape(%is-finite.37)
  %compare.217 = pred[] compare(%reduce.162, %constant.1529), direction=GT
  %reshape.1613 = pred[1]{0} reshape(%compare.217)
  %divide.278 = f32[] divide(%constant.1537, %reduce.162)
  %reshape.1615 = f32[1]{0} reshape(%divide.278)
  %get-tuple-element.279 = f32[80,1]{1,0} get-tuple-element(%param.43), index=25
  %dynamic-slice.137 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.279, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.279 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.137)
  %reshape.1617 = f32[1]{0} reshape(%divide.279)
  %select.305 = f32[1]{0} select(%reshape.1613, %reshape.1615, %reshape.1617)
  %select.306 = f32[1]{0} select(%reshape.1611, %select.305, %reshape.1617)
  %divide.280 = f32[1]{0} divide(%constant.1533, %select.306)
  %convert.250 = bf16[1]{0} convert(%divide.280)
  %reshape.1619 = bf16[] reshape(%convert.250)
  %broadcast.1681 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1619), dimensions={}
  %divide.281 = bf16[2,8192,8192]{2,1,0} divide(%copy.45, %broadcast.1681)
  %clamp.51 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1663, %divide.281, %broadcast.1671)
  %convert.251 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.51)
  %broadcast.1683 = bf16[1,64,8,128]{3,2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.280 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.43), index=8
  %dynamic-slice.138 = f32[1,64,8,128]{3,2,1,0} dynamic-slice(%get-tuple-element.280, %get-tuple-element.266, %constant.1532, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,8,128}
  %convert.252 = bf16[1,64,8,128]{3,2,1,0} convert(%dynamic-slice.138)
  %get-tuple-element.281 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=26
  %dynamic-slice.139 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.281, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.163 = f32[] reduce(%dynamic-slice.139, %constant.1535), dimensions={0,1}, to_apply=%region_8.806
  %is-finite.38 = pred[] is-finite(%reduce.163)
  %reshape.1621 = pred[1]{0} reshape(%is-finite.38)
  %compare.218 = pred[] compare(%reduce.163, %constant.1529), direction=GT
  %reshape.1623 = pred[1]{0} reshape(%compare.218)
  %divide.282 = f32[] divide(%constant.1537, %reduce.163)
  %reshape.1625 = f32[1]{0} reshape(%divide.282)
  %get-tuple-element.282 = f32[80,1]{1,0} get-tuple-element(%param.43), index=27
  %dynamic-slice.140 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.282, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.283 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.140)
  %reshape.1627 = f32[1]{0} reshape(%divide.283)
  %select.307 = f32[1]{0} select(%reshape.1623, %reshape.1625, %reshape.1627)
  %select.308 = f32[1]{0} select(%reshape.1621, %select.307, %reshape.1627)
  %divide.284 = f32[1]{0} divide(%constant.1533, %select.308)
  %convert.253 = bf16[1]{0} convert(%divide.284)
  %reshape.1629 = bf16[] reshape(%convert.253)
  %broadcast.1684 = bf16[1,64,8,128]{3,2,1,0} broadcast(%reshape.1629), dimensions={}
  %divide.285 = bf16[1,64,8,128]{3,2,1,0} divide(%convert.252, %broadcast.1684)
  %broadcast.1685 = bf16[1,64,8,128]{3,2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.52 = bf16[1,64,8,128]{3,2,1,0} clamp(%broadcast.1683, %divide.285, %broadcast.1685)
  %convert.254 = f8e4m3fn[1,64,8,128]{3,2,1,0} convert(%clamp.52)
  %reshape.1631 = f8e4m3fn[64,8,128]{2,1,0} reshape(%convert.254)
  %all-gather.1 = f8e4m3fn[8192,8,128]{2,1,0} all-gather(%reshape.1631), channel_id=4, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.33 = bf16[2,8192,8,128]{3,2,1,0} dot(%convert.251, %all-gather.1), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.223 = f32[1]{0} multiply(%divide.280, %divide.284)
  %convert.255 = bf16[1]{0} convert(%multiply.223)
  %reshape.1633 = bf16[] reshape(%convert.255)
  %broadcast.1686 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1633), dimensions={}
  %multiply.224 = bf16[2,8192,8,128]{3,2,1,0} multiply(%dot.33, %broadcast.1686)
  %convert.256 = f32[2,8192,8,128]{3,2,1,0} convert(%multiply.224)
  %get-tuple-element.283 = f32[2,8192,1,128]{3,2,1,0} get-tuple-element(%param.43), index=44
  %reshape.1635 = f32[2,8192,128]{2,1,0} reshape(%get-tuple-element.283)
  %broadcast.1687 = f32[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1635), dimensions={0,1,3}
  %multiply.225 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.256, %broadcast.1687)
  %get-tuple-element.284 = s32[2,8192,8,128]{3,2,1,0} get-tuple-element(%param.43), index=45
  %broadcast.1688 = s32[2,8192,8,128]{3,2,1,0} broadcast(%constant.1524), dimensions={}
  %compare.219 = pred[2,8192,8,128]{3,2,1,0} compare(%get-tuple-element.284, %broadcast.1688), direction=LT
  %slice.403 = bf16[2,8192,8,127]{3,2,1,0} slice(%multiply.224), slice={[0:2], [0:8192], [0:8], [1:128]}
  %slice.404 = bf16[2,8192,8,1]{3,2,1,0} slice(%multiply.224), slice={[0:2], [0:8192], [0:8], [0:1]}
  %concatenate.113 = bf16[2,8192,8,128]{3,2,1,0} concatenate(%slice.403, %slice.404), dimensions={3}
  %slice.405 = bf16[2,8192,8,1]{3,2,1,0} slice(%multiply.224), slice={[0:2], [0:8192], [0:8], [127:128]}
  %slice.406 = bf16[2,8192,8,127]{3,2,1,0} slice(%multiply.224), slice={[0:2], [0:8192], [0:8], [0:127]}
  %concatenate.114 = bf16[2,8192,8,128]{3,2,1,0} concatenate(%slice.405, %slice.406), dimensions={3}
  %select.309 = bf16[2,8192,8,128]{3,2,1,0} select(%compare.219, %concatenate.113, %concatenate.114)
  %convert.257 = f32[2,8192,8,128]{3,2,1,0} convert(%select.309)
  %get-tuple-element.285 = f32[2,8192,1,128]{3,2,1,0} get-tuple-element(%param.43), index=46
  %reshape.1645 = f32[2,8192,128]{2,1,0} reshape(%get-tuple-element.285)
  %broadcast.1689 = f32[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1645), dimensions={0,1,3}
  %multiply.230 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.257, %broadcast.1689)
  %get-tuple-element.286 = f32[1,1,1,128]{3,2,1,0} get-tuple-element(%param.43), index=47
  %reshape.1647 = f32[128]{0} reshape(%get-tuple-element.286)
  %broadcast.1690 = f32[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1647), dimensions={3}
  %multiply.231 = f32[2,8192,8,128]{3,2,1,0} multiply(%multiply.230, %broadcast.1690)
  %add.106 = f32[2,8192,8,128]{3,2,1,0} add(%multiply.225, %multiply.231)
  %convert.258 = bf16[2,8192,8,128]{3,2,1,0} convert(%add.106)
  %copy.48 = bf16[2,8192,8,128]{3,2,1,0} copy(%convert.258)
  %get-tuple-element.287 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=36
  %dynamic-slice.145 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.287, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.164 = f32[] reduce(%dynamic-slice.145, %constant.1535), dimensions={0,1}, to_apply=%region_9.842
  %is-finite.39 = pred[] is-finite(%reduce.164)
  %reshape.1649 = pred[1]{0} reshape(%is-finite.39)
  %compare.220 = pred[] compare(%reduce.164, %constant.1529), direction=GT
  %reshape.1651 = pred[1]{0} reshape(%compare.220)
  %divide.286 = f32[] divide(%constant.1537, %reduce.164)
  %reshape.1653 = f32[1]{0} reshape(%divide.286)
  %get-tuple-element.288 = f32[80,1]{1,0} get-tuple-element(%param.43), index=37
  %dynamic-slice.146 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.288, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.287 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.146)
  %reshape.1655 = f32[1]{0} reshape(%divide.287)
  %select.310 = f32[1]{0} select(%reshape.1651, %reshape.1653, %reshape.1655)
  %select.311 = f32[1]{0} select(%reshape.1649, %select.310, %reshape.1655)
  %divide.288 = f32[1]{0} divide(%constant.1533, %select.311)
  %convert.259 = bf16[1]{0} convert(%divide.288)
  %reshape.1657 = bf16[] reshape(%convert.259)
  %broadcast.1692 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1657), dimensions={}
  %divide.289 = bf16[2,8192,8192]{2,1,0} divide(%copy.45, %broadcast.1692)
  %clamp.53 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1663, %divide.289, %broadcast.1671)
  %convert.260 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.53)
  %get-tuple-element.289 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.43), index=11
  %dynamic-slice.147 = f32[1,64,8,128]{3,2,1,0} dynamic-slice(%get-tuple-element.289, %get-tuple-element.266, %constant.1532, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,8,128}
  %convert.261 = bf16[1,64,8,128]{3,2,1,0} convert(%dynamic-slice.147)
  %get-tuple-element.290 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=38
  %dynamic-slice.148 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.290, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.165 = f32[] reduce(%dynamic-slice.148, %constant.1535), dimensions={0,1}, to_apply=%region_10.862
  %is-finite.40 = pred[] is-finite(%reduce.165)
  %reshape.1659 = pred[1]{0} reshape(%is-finite.40)
  %compare.221 = pred[] compare(%reduce.165, %constant.1529), direction=GT
  %reshape.1661 = pred[1]{0} reshape(%compare.221)
  %divide.290 = f32[] divide(%constant.1537, %reduce.165)
  %reshape.1663 = f32[1]{0} reshape(%divide.290)
  %get-tuple-element.291 = f32[80,1]{1,0} get-tuple-element(%param.43), index=39
  %dynamic-slice.149 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.291, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.291 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.149)
  %reshape.1665 = f32[1]{0} reshape(%divide.291)
  %select.312 = f32[1]{0} select(%reshape.1661, %reshape.1663, %reshape.1665)
  %select.313 = f32[1]{0} select(%reshape.1659, %select.312, %reshape.1665)
  %divide.292 = f32[1]{0} divide(%constant.1533, %select.313)
  %convert.262 = bf16[1]{0} convert(%divide.292)
  %reshape.1666 = bf16[] reshape(%convert.262)
  %broadcast.1695 = bf16[1,64,8,128]{3,2,1,0} broadcast(%reshape.1666), dimensions={}
  %divide.293 = bf16[1,64,8,128]{3,2,1,0} divide(%convert.261, %broadcast.1695)
  %clamp.54 = bf16[1,64,8,128]{3,2,1,0} clamp(%broadcast.1683, %divide.293, %broadcast.1685)
  %convert.263 = f8e4m3fn[1,64,8,128]{3,2,1,0} convert(%clamp.54)
  %reshape.1667 = f8e4m3fn[64,8,128]{2,1,0} reshape(%convert.263)
  %all-gather.2 = f8e4m3fn[8192,8,128]{2,1,0} all-gather(%reshape.1667), channel_id=5, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.34 = bf16[2,8192,8,128]{3,2,1,0} dot(%convert.260, %all-gather.2), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.232 = f32[1]{0} multiply(%divide.288, %divide.292)
  %convert.266 = bf16[1]{0} convert(%multiply.232)
  %reshape.1668 = bf16[] reshape(%convert.266)
  %broadcast.1697 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1668), dimensions={}
  %multiply.233 = bf16[2,8192,8,128]{3,2,1,0} multiply(%dot.34, %broadcast.1697)
  %copy.49 = bf16[2,8192,8,128]{3,2,1,0} copy(%multiply.233)
  %constant.1676 = bf16[0]{0} constant({})
  %broadcast.1699 = s32[3]{0} broadcast(%constant.1532), dimensions={}
  %constant.1680 = s32[] constant(2)
  %reshape.1670 = s32[1]{0} reshape(%constant.1680)
  %reshape.1671 = s32[1]{0} reshape(%constant.1532)
  %constant.1682 = pred[1]{0} constant({0})
  %constant.1683 = s32[1]{0} constant({2})
  %constant.1684 = s32[1]{0} constant({0})
  %select.314 = s32[1]{0} select(%constant.1682, %constant.1683, %constant.1684)
  %maximum.86 = s32[1]{0} maximum(%reshape.1671, %select.314)
  %minimum.86 = s32[1]{0} minimum(%reshape.1670, %maximum.86)
  %sort.0 = (s32[1]{0}, s32[1]{0}) sort(%minimum.86, %constant.1684), dimensions={0}, is_stable=true, to_apply=%region_1.75._custom_call_lowering_rule
  %get-tuple-element.294 = s32[1]{0} get-tuple-element(%sort.0), index=1
  %compare.222 = pred[1]{0} compare(%get-tuple-element.294, %constant.1684), direction=LT
  %constant.1686 = s32[1]{0} constant({1})
  %add.107 = s32[1]{0} add(%get-tuple-element.294, %constant.1686)
  %select.315 = s32[1]{0} select(%compare.222, %add.107, %get-tuple-element.294)
  %reshape.1672 = s32[1,1]{1,0} reshape(%select.315)
  %scatter.89 = s32[1]{0} scatter(%minimum.86, %reshape.1672, %constant.1684), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_2.88._custom_call_lowering_rule
  %compare.223 = pred[1]{0} compare(%scatter.89, %constant.1684), direction=LT
  %constant.1687 = s32[1]{0} constant({3})
  %add.182 = s32[1]{0} add(%scatter.89, %constant.1687)
  %select.316 = s32[1]{0} select(%compare.223, %add.182, %scatter.89)
  %reshape.1673 = s32[1,1]{1,0} reshape(%select.316)
  %scatter.188 = s32[3]{0} scatter(%broadcast.1699, %reshape.1673, %constant.1684), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_6.187._custom_call_lowering_rule
  %broadcast.1700 = s32[2]{0} broadcast(%constant.1532), dimensions={}
  %constant.1689 = pred[] constant(true)
  %broadcast.1702 = pred[3]{0} broadcast(%constant.1689), dimensions={}
  %scatter.97 = pred[3]{0} scatter(%broadcast.1702, %reshape.1673, %constant.1682), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_3.96._custom_call_lowering_rule
  %convert.267 = s32[3]{0} convert(%scatter.97)
  %reduce-window.3 = s32[3]{0} reduce-window(%convert.267, %constant.1532), window={size=3 pad=2_0}, to_apply=%region_4.105._custom_call_lowering_rule
  %maximum.87 = s32[3]{0} maximum(%broadcast.1699, %reduce-window.3)
  %compare.225 = pred[3]{0} compare(%maximum.87, %broadcast.1699), direction=LT
  %broadcast.1703 = s32[3]{0} broadcast(%constant.1680), dimensions={}
  %add.118 = s32[3]{0} add(%maximum.87, %broadcast.1703)
  %select.318 = s32[3]{0} select(%compare.225, %add.118, %maximum.87)
  %reshape.1675 = s32[3,1]{1,0} reshape(%select.318)
  %broadcast.1704 = s32[3]{0} broadcast(%constant.1524), dimensions={}
  %scatter.125 = s32[2]{0} scatter(%broadcast.1700, %reshape.1675, %broadcast.1704), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_5.124._custom_call_lowering_rule
  %reduce-window.4 = s32[2]{0} reduce-window(%scatter.125, %constant.1532), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule
  %sign.0 = s32[2]{0} sign(%reduce-window.4)
  %sign.1 = s32[] sign(%constant.1524)
  %broadcast.1705 = s32[2]{0} broadcast(%sign.1), dimensions={}
  %compare.226 = pred[2]{0} compare(%sign.0, %broadcast.1705), direction=NE
  %broadcast.1706 = s32[2]{0} broadcast(%constant.1524), dimensions={}
  %remainder.8 = s32[2]{0} remainder(%reduce-window.4, %broadcast.1706)
  %compare.227 = pred[2]{0} compare(%remainder.8, %broadcast.1700), direction=NE
  %and.78 = pred[2]{0} and(%compare.226, %compare.227)
  %divide.294 = s32[2]{0} divide(%reduce-window.4, %broadcast.1706)
  %subtract.7 = s32[2]{0} subtract(%divide.294, %broadcast.1706)
  %select.319 = s32[2]{0} select(%and.78, %subtract.7, %divide.294)
  %constant.1697 = s32[] constant(3)
  %compare.228 = pred[] compare(%constant.1697, %constant.1532), direction=EQ
  %select.320 = s32[] select(%compare.228, %constant.1524, %constant.1697)
  %broadcast.1710 = s32[2]{0} broadcast(%select.320), dimensions={}
  %remainder.9 = s32[2]{0} remainder(%select.319, %broadcast.1710)
  %compare.229 = pred[2]{0} compare(%remainder.9, %broadcast.1700), direction=LT
  %compare.230 = pred[] compare(%select.320, %constant.1532), direction=LT
  %broadcast.1712 = pred[2]{0} broadcast(%compare.230), dimensions={}
  %compare.231 = pred[2]{0} compare(%compare.229, %broadcast.1712), direction=NE
  %compare.232 = pred[2]{0} compare(%remainder.9, %broadcast.1700), direction=NE
  %and.79 = pred[2]{0} and(%compare.231, %compare.232)
  %add.109 = s32[2]{0} add(%remainder.9, %broadcast.1710)
  %select.321 = s32[2]{0} select(%and.79, %add.109, %remainder.9)
  %compare.233 = pred[2]{0} compare(%select.321, %broadcast.1700), direction=LT
  %broadcast.1714 = s32[2]{0} broadcast(%constant.1697), dimensions={}
  %add.190 = s32[2]{0} add(%select.321, %broadcast.1714)
  %select.322 = s32[2]{0} select(%compare.233, %add.190, %select.321)
  %reshape.1676 = s32[2,1]{1,0} reshape(%select.322)
  %get-tuple-element.292 = s32[2,1]{1,0} get-tuple-element(%param.43), index=48
  %reshape.1677 = s32[2]{0} reshape(%get-tuple-element.292)
  %compare.234 = pred[2]{0} compare(%reshape.1677, %broadcast.1700), direction=LT
  %constant.1702 = s32[] constant(-1)
  %broadcast.1715 = s32[2]{0} broadcast(%constant.1702), dimensions={}
  %reduce-window.5 = s32[2]{0} reduce-window(%reshape.1677, %constant.1532), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule.clone
  %select.323 = s32[2]{0} select(%compare.234, %broadcast.1715, %reduce-window.5)
  %scatter.196 = s32[3]{0} scatter(%scatter.188, %reshape.1676, %select.323), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_7.195._custom_call_lowering_rule
  %get-tuple-element.293 = s32[2,1]{1,0} get-tuple-element(%param.43), index=49
  %reshape.1685 = s32[2]{0} reshape(%get-tuple-element.293)
  %compare.247 = pred[2]{0} compare(%reshape.1685, %broadcast.1700), direction=LT
  %reduce-window.8 = s32[2]{0} reduce-window(%reshape.1685, %constant.1532), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule.clone.1
  %select.334 = s32[2]{0} select(%compare.247, %broadcast.1715, %reduce-window.8)
  %scatter.250 = s32[3]{0} scatter(%scatter.188, %reshape.1676, %select.334), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_12.249._custom_call_lowering_rule
  %constant.1677 = u32[] constant(0)
  %broadcast.1698 = u32[512]{0} broadcast(%constant.1677), dimensions={}
  %constant.1678 = s32[256]{0} constant({0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 510})
  %partition-id.1 = u32[] partition-id()
  %dynamic-slice.150 = s32[1]{0} dynamic-slice(%constant.1678, %partition-id.1), dynamic_slice_sizes={1}
  %reshape.1669 = s32[] reshape(%dynamic-slice.150)
  %dynamic-slice.151 = u32[2]{0} dynamic-slice(%broadcast.1698, %reshape.1669), dynamic_slice_sizes={2}
  %custom-call.251 = (bf16[2,8192,64,128]{3,2,1,0}, f32[2,64,8192,1]{3,2,1,0}, u32[2,4]{1,0}, u8[48]{0}) custom-call(%copy.46, %copy.48, %copy.49, %constant.1676, %scatter.196, /*index=5*/%scatter.250, %constant.1676, %constant.1676, %dynamic-slice.151), custom_call_target="te_fused_attn_forward_ffi", operand_layout_constraints={bf16[2,8192,64,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[0]{0}, s32[3]{0}, s32[3]{0}, bf16[0]{0}, bf16[0]{0}, u32[2]{0}}, api_version=API_VERSION_TYPED_FFI, backend_config={attn_heads = 64 : i64, bias_batch = 0 : i64, bias_heads = 0 : i64, bias_type = 0 : i64, deterministic = false, dropout_probability = 0.000000e+00 : f64, head_dim = 128 : i64, input_batch = 2 : i64, is_training = true, kv_max_seqlen = 8192 : i64, mask_type = 3 : i64, max_segments_per_seq = 1 : i64, num_gqa_groups = 8 : i64, q_max_seqlen = 8192 : i64, qkv_layout = 9 : i64, scaling_factor = 1.000000e+00 : f64, window_size_left = -1 : i64, window_size_right = -1 : i64}
  %get-tuple-element.299 = bf16[2,8192,64,128]{3,2,1,0} get-tuple-element(%custom-call.251), index=0
  %copy.50 = bf16[2,8192,64,128]{3,2,1,0} copy(%get-tuple-element.299)
  %get-tuple-element.300 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=28
  %dynamic-slice.152 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.300, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.166 = f32[] reduce(%dynamic-slice.152, %constant.1535), dimensions={0,1}, to_apply=%region_11.946
  %is-finite.41 = pred[] is-finite(%reduce.166)
  %reshape.1686 = pred[1]{0} reshape(%is-finite.41)
  %compare.248 = pred[] compare(%reduce.166, %constant.1529), direction=GT
  %reshape.1687 = pred[1]{0} reshape(%compare.248)
  %divide.296 = f32[] divide(%constant.1537, %reduce.166)
  %reshape.1688 = f32[1]{0} reshape(%divide.296)
  %get-tuple-element.301 = f32[80,1]{1,0} get-tuple-element(%param.43), index=29
  %dynamic-slice.153 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.301, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.297 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.153)
  %reshape.1689 = f32[1]{0} reshape(%divide.297)
  %select.336 = f32[1]{0} select(%reshape.1687, %reshape.1688, %reshape.1689)
  %select.337 = f32[1]{0} select(%reshape.1686, %select.336, %reshape.1689)
  %divide.298 = f32[1]{0} divide(%constant.1533, %select.337)
  %convert.269 = bf16[1]{0} convert(%divide.298)
  %reshape.1690 = bf16[] reshape(%convert.269)
  %broadcast.1731 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1690), dimensions={}
  %divide.299 = bf16[2,8192,64,128]{3,2,1,0} divide(%copy.50, %broadcast.1731)
  %broadcast.1733 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.55 = bf16[2,8192,64,128]{3,2,1,0} clamp(%broadcast.1664, %divide.299, %broadcast.1733)
  %convert.270 = f8e4m3fn[2,8192,64,128]{3,2,1,0} convert(%clamp.55)
  %broadcast.1735 = bf16[1,64,128,64]{3,2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.302 = f32[80,64,128,64]{3,2,1,0} get-tuple-element(%param.43), index=9
  %dynamic-slice.154 = f32[1,64,128,64]{3,2,1,0} dynamic-slice(%get-tuple-element.302, %get-tuple-element.266, %constant.1532, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,128,64}
  %convert.271 = bf16[1,64,128,64]{3,2,1,0} convert(%dynamic-slice.154)
  %get-tuple-element.303 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=30
  %dynamic-slice.155 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.303, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.167 = f32[] reduce(%dynamic-slice.155, %constant.1535), dimensions={0,1}, to_apply=%region_12.974
  %is-finite.42 = pred[] is-finite(%reduce.167)
  %reshape.1691 = pred[1]{0} reshape(%is-finite.42)
  %compare.249 = pred[] compare(%reduce.167, %constant.1529), direction=GT
  %reshape.1692 = pred[1]{0} reshape(%compare.249)
  %divide.300 = f32[] divide(%constant.1537, %reduce.167)
  %reshape.1693 = f32[1]{0} reshape(%divide.300)
  %get-tuple-element.304 = f32[80,1]{1,0} get-tuple-element(%param.43), index=31
  %dynamic-slice.156 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.304, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.301 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.156)
  %reshape.1694 = f32[1]{0} reshape(%divide.301)
  %select.338 = f32[1]{0} select(%reshape.1692, %reshape.1693, %reshape.1694)
  %select.339 = f32[1]{0} select(%reshape.1691, %select.338, %reshape.1694)
  %divide.302 = f32[1]{0} divide(%constant.1533, %select.339)
  %convert.272 = bf16[1]{0} convert(%divide.302)
  %reshape.1695 = bf16[] reshape(%convert.272)
  %broadcast.1737 = bf16[1,64,128,64]{3,2,1,0} broadcast(%reshape.1695), dimensions={}
  %divide.303 = bf16[1,64,128,64]{3,2,1,0} divide(%convert.271, %broadcast.1737)
  %broadcast.1739 = bf16[1,64,128,64]{3,2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.56 = bf16[1,64,128,64]{3,2,1,0} clamp(%broadcast.1735, %divide.303, %broadcast.1739)
  %convert.273 = f8e4m3fn[1,64,128,64]{3,2,1,0} convert(%clamp.56)
  %reshape.1696 = f8e4m3fn[64,128,64]{2,1,0} reshape(%convert.273)
  %all-gather.3 = f8e4m3fn[64,128,8192]{2,1,0} all-gather(%reshape.1696), channel_id=6, replica_groups=[2,128]<=[256], dimensions={2}, use_global_device_ids=true
  %dot.35 = bf16[2,8192,8192]{2,1,0} dot(%convert.270, %all-gather.3), lhs_contracting_dims={2,3}, rhs_contracting_dims={0,1}
  %multiply.234 = f32[1]{0} multiply(%divide.298, %divide.302)
  %convert.274 = bf16[1]{0} convert(%multiply.234)
  %reshape.1697 = bf16[] reshape(%convert.274)
  %broadcast.1741 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1697), dimensions={}
  %multiply.235 = bf16[2,8192,8192]{2,1,0} multiply(%dot.35, %broadcast.1741)
  %copy.51 = bf16[2,8192,8192]{2,1,0} copy(%multiply.235)
  %add.111 = bf16[2,8192,8192]{2,1,0} add(%copy.43, %copy.51)
  %convert.275 = f32[2,8192,8192]{2,1,0} convert(%add.111)
  %multiply.236 = f32[2,8192,8192]{2,1,0} multiply(%convert.275, %convert.275)
  %reduce.168 = f32[2,8192]{1,0} reduce(%multiply.236, %constant.1529), dimensions={2}, to_apply=%region_13.1013
  %multiply.237 = f32[2,8192]{1,0} multiply(%reduce.168, %broadcast.1666)
  %add.112 = f32[2,8192]{1,0} add(%multiply.237, %broadcast.1667)
  %rsqrt.7 = f32[2,8192]{1,0} rsqrt(%add.112)
  %broadcast.1747 = f32[2,8192,8192]{2,1,0} broadcast(%rsqrt.7), dimensions={0,1}
  %multiply.238 = f32[2,8192,8192]{2,1,0} multiply(%convert.275, %broadcast.1747)
  %convert.276 = bf16[2,8192,8192]{2,1,0} convert(%multiply.238)
  %get-tuple-element.305 = f32[80,8192]{1,0} get-tuple-element(%param.43), index=6
  %dynamic-slice.157 = f32[1,8192]{1,0} dynamic-slice(%get-tuple-element.305, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,8192}
  %convert.277 = bf16[1,8192]{1,0} convert(%dynamic-slice.157)
  %reshape.1698 = bf16[8192]{0} reshape(%convert.277)
  %broadcast.1749 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1698), dimensions={2}
  %multiply.239 = bf16[2,8192,8192]{2,1,0} multiply(%convert.276, %broadcast.1749)
  %copy.52 = bf16[2,8192,8192]{2,1,0} copy(%multiply.239)
  %get-tuple-element.306 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=12
  %dynamic-slice.158 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.306, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.169 = f32[] reduce(%dynamic-slice.158, %constant.1535), dimensions={0,1}, to_apply=%region_14.1035
  %is-finite.43 = pred[] is-finite(%reduce.169)
  %reshape.1699 = pred[1]{0} reshape(%is-finite.43)
  %compare.250 = pred[] compare(%reduce.169, %constant.1529), direction=GT
  %reshape.1700 = pred[1]{0} reshape(%compare.250)
  %divide.304 = f32[] divide(%constant.1537, %reduce.169)
  %reshape.1701 = f32[1]{0} reshape(%divide.304)
  %get-tuple-element.307 = f32[80,1]{1,0} get-tuple-element(%param.43), index=13
  %dynamic-slice.159 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.307, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.305 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.159)
  %reshape.1702 = f32[1]{0} reshape(%divide.305)
  %select.340 = f32[1]{0} select(%reshape.1700, %reshape.1701, %reshape.1702)
  %select.341 = f32[1]{0} select(%reshape.1699, %select.340, %reshape.1702)
  %divide.306 = f32[1]{0} divide(%constant.1533, %select.341)
  %convert.278 = bf16[1]{0} convert(%divide.306)
  %reshape.1703 = bf16[] reshape(%convert.278)
  %broadcast.1751 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1703), dimensions={}
  %divide.307 = bf16[2,8192,8192]{2,1,0} divide(%copy.52, %broadcast.1751)
  %clamp.57 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1663, %divide.307, %broadcast.1671)
  %convert.279 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.57)
  %broadcast.1755 = bf16[1,64,28672]{2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.308 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.43), index=3
  %dynamic-slice.160 = f32[1,64,28672]{2,1,0} dynamic-slice(%get-tuple-element.308, %get-tuple-element.266, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,28672}
  %convert.280 = bf16[1,64,28672]{2,1,0} convert(%dynamic-slice.160)
  %get-tuple-element.309 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=14
  %dynamic-slice.161 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.309, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.170 = f32[] reduce(%dynamic-slice.161, %constant.1535), dimensions={0,1}, to_apply=%region_15.1055
  %is-finite.44 = pred[] is-finite(%reduce.170)
  %reshape.1704 = pred[1]{0} reshape(%is-finite.44)
  %compare.251 = pred[] compare(%reduce.170, %constant.1529), direction=GT
  %reshape.1705 = pred[1]{0} reshape(%compare.251)
  %divide.308 = f32[] divide(%constant.1537, %reduce.170)
  %reshape.1706 = f32[1]{0} reshape(%divide.308)
  %get-tuple-element.310 = f32[80,1]{1,0} get-tuple-element(%param.43), index=15
  %dynamic-slice.162 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.310, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.309 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.162)
  %reshape.1707 = f32[1]{0} reshape(%divide.309)
  %select.342 = f32[1]{0} select(%reshape.1705, %reshape.1706, %reshape.1707)
  %select.343 = f32[1]{0} select(%reshape.1704, %select.342, %reshape.1707)
  %divide.310 = f32[1]{0} divide(%constant.1533, %select.343)
  %convert.281 = bf16[1]{0} convert(%divide.310)
  %reshape.1708 = bf16[] reshape(%convert.281)
  %broadcast.1757 = bf16[1,64,28672]{2,1,0} broadcast(%reshape.1708), dimensions={}
  %divide.311 = bf16[1,64,28672]{2,1,0} divide(%convert.280, %broadcast.1757)
  %broadcast.1759 = bf16[1,64,28672]{2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.58 = bf16[1,64,28672]{2,1,0} clamp(%broadcast.1755, %divide.311, %broadcast.1759)
  %convert.282 = f8e4m3fn[1,64,28672]{2,1,0} convert(%clamp.58)
  %reshape.1709 = f8e4m3fn[64,28672]{1,0} reshape(%convert.282)
  %all-gather.4 = f8e4m3fn[8192,28672]{1,0} all-gather(%reshape.1709), channel_id=7, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.36 = bf16[2,8192,28672]{2,1,0} dot(%convert.279, %all-gather.4), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.240 = f32[1]{0} multiply(%divide.306, %divide.310)
  %convert.283 = bf16[1]{0} convert(%multiply.240)
  %reshape.1710 = bf16[] reshape(%convert.283)
  %broadcast.1760 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1710), dimensions={}
  %multiply.241 = bf16[2,8192,28672]{2,1,0} multiply(%dot.36, %broadcast.1760)
  %constant.1798 = bf16[] constant(1)
  %broadcast.1761 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1798), dimensions={}
  %negate.26 = bf16[2,8192,28672]{2,1,0} negate(%multiply.241)
  %exponential.4 = bf16[2,8192,28672]{2,1,0} exponential(%negate.26)
  %add.113 = bf16[2,8192,28672]{2,1,0} add(%exponential.4, %broadcast.1761)
  %divide.312 = bf16[2,8192,28672]{2,1,0} divide(%broadcast.1761, %add.113)
  %multiply.242 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.241, %divide.312)
  %get-tuple-element.311 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=16
  %dynamic-slice.163 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.311, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.171 = f32[] reduce(%dynamic-slice.163, %constant.1535), dimensions={0,1}, to_apply=%region_16.1101
  %is-finite.45 = pred[] is-finite(%reduce.171)
  %reshape.1711 = pred[1]{0} reshape(%is-finite.45)
  %compare.252 = pred[] compare(%reduce.171, %constant.1529), direction=GT
  %reshape.1712 = pred[1]{0} reshape(%compare.252)
  %divide.314 = f32[] divide(%constant.1537, %reduce.171)
  %reshape.1713 = f32[1]{0} reshape(%divide.314)
  %get-tuple-element.312 = f32[80,1]{1,0} get-tuple-element(%param.43), index=17
  %dynamic-slice.164 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.312, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.315 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.164)
  %reshape.1714 = f32[1]{0} reshape(%divide.315)
  %select.344 = f32[1]{0} select(%reshape.1712, %reshape.1713, %reshape.1714)
  %select.345 = f32[1]{0} select(%reshape.1711, %select.344, %reshape.1714)
  %divide.316 = f32[1]{0} divide(%constant.1533, %select.345)
  %convert.284 = bf16[1]{0} convert(%divide.316)
  %reshape.1715 = bf16[] reshape(%convert.284)
  %broadcast.1765 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1715), dimensions={}
  %divide.319 = bf16[2,8192,8192]{2,1,0} divide(%copy.52, %broadcast.1765)
  %clamp.59 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1663, %divide.319, %broadcast.1671)
  %convert.285 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.59)
  %get-tuple-element.313 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.43), index=4
  %dynamic-slice.165 = f32[1,64,28672]{2,1,0} dynamic-slice(%get-tuple-element.313, %get-tuple-element.266, %constant.1532, %constant.1532), dynamic_slice_sizes={1,64,28672}
  %convert.286 = bf16[1,64,28672]{2,1,0} convert(%dynamic-slice.165)
  %get-tuple-element.314 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=18
  %dynamic-slice.166 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.314, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.172 = f32[] reduce(%dynamic-slice.166, %constant.1535), dimensions={0,1}, to_apply=%region_17.1121
  %is-finite.46 = pred[] is-finite(%reduce.172)
  %reshape.1716 = pred[1]{0} reshape(%is-finite.46)
  %compare.253 = pred[] compare(%reduce.172, %constant.1529), direction=GT
  %reshape.1717 = pred[1]{0} reshape(%compare.253)
  %divide.320 = f32[] divide(%constant.1537, %reduce.172)
  %reshape.1718 = f32[1]{0} reshape(%divide.320)
  %get-tuple-element.315 = f32[80,1]{1,0} get-tuple-element(%param.43), index=19
  %dynamic-slice.167 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.315, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.321 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.167)
  %reshape.1719 = f32[1]{0} reshape(%divide.321)
  %select.346 = f32[1]{0} select(%reshape.1717, %reshape.1718, %reshape.1719)
  %select.347 = f32[1]{0} select(%reshape.1716, %select.346, %reshape.1719)
  %divide.322 = f32[1]{0} divide(%constant.1533, %select.347)
  %convert.287 = bf16[1]{0} convert(%divide.322)
  %reshape.1720 = bf16[] reshape(%convert.287)
  %broadcast.1770 = bf16[1,64,28672]{2,1,0} broadcast(%reshape.1720), dimensions={}
  %divide.324 = bf16[1,64,28672]{2,1,0} divide(%convert.286, %broadcast.1770)
  %clamp.60 = bf16[1,64,28672]{2,1,0} clamp(%broadcast.1755, %divide.324, %broadcast.1759)
  %convert.288 = f8e4m3fn[1,64,28672]{2,1,0} convert(%clamp.60)
  %reshape.1721 = f8e4m3fn[64,28672]{1,0} reshape(%convert.288)
  %all-gather.5 = f8e4m3fn[8192,28672]{1,0} all-gather(%reshape.1721), channel_id=8, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.37 = bf16[2,8192,28672]{2,1,0} dot(%convert.285, %all-gather.5), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.243 = f32[1]{0} multiply(%divide.316, %divide.322)
  %convert.289 = bf16[1]{0} convert(%multiply.243)
  %reshape.1722 = bf16[] reshape(%convert.289)
  %broadcast.1772 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1722), dimensions={}
  %multiply.244 = bf16[2,8192,28672]{2,1,0} multiply(%dot.37, %broadcast.1772)
  %multiply.245 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.242, %multiply.244)
  %copy.53 = bf16[2,8192,28672]{2,1,0} copy(%multiply.245)
  %get-tuple-element.316 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=20
  %dynamic-slice.168 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.316, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.173 = f32[] reduce(%dynamic-slice.168, %constant.1535), dimensions={0,1}, to_apply=%region_18.1151
  %is-finite.47 = pred[] is-finite(%reduce.173)
  %reshape.1723 = pred[1]{0} reshape(%is-finite.47)
  %compare.254 = pred[] compare(%reduce.173, %constant.1529), direction=GT
  %reshape.1724 = pred[1]{0} reshape(%compare.254)
  %divide.326 = f32[] divide(%constant.1537, %reduce.173)
  %reshape.1725 = f32[1]{0} reshape(%divide.326)
  %get-tuple-element.317 = f32[80,1]{1,0} get-tuple-element(%param.43), index=21
  %dynamic-slice.169 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.317, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.327 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.169)
  %reshape.1726 = f32[1]{0} reshape(%divide.327)
  %select.348 = f32[1]{0} select(%reshape.1724, %reshape.1725, %reshape.1726)
  %select.349 = f32[1]{0} select(%reshape.1723, %select.348, %reshape.1726)
  %divide.329 = f32[1]{0} divide(%constant.1533, %select.349)
  %convert.290 = bf16[1]{0} convert(%divide.329)
  %reshape.1727 = bf16[] reshape(%convert.290)
  %broadcast.1773 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1727), dimensions={}
  %divide.330 = bf16[2,8192,28672]{2,1,0} divide(%copy.53, %broadcast.1773)
  %broadcast.1774 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.61 = bf16[2,8192,28672]{2,1,0} clamp(%broadcast.1662, %divide.330, %broadcast.1774)
  %convert.291 = f8e4m3fn[2,8192,28672]{2,1,0} convert(%clamp.61)
  %broadcast.1775 = bf16[1,28672,64]{2,1,0} broadcast(%constant.1525), dimensions={}
  %get-tuple-element.318 = f32[80,28672,64]{2,1,0} get-tuple-element(%param.43), index=5
  %dynamic-slice.170 = f32[1,28672,64]{2,1,0} dynamic-slice(%get-tuple-element.318, %get-tuple-element.266, %constant.1532, %constant.1532), dynamic_slice_sizes={1,28672,64}
  %convert.292 = bf16[1,28672,64]{2,1,0} convert(%dynamic-slice.170)
  %get-tuple-element.319 = f32[80,1024]{1,0} get-tuple-element(%param.43), index=22
  %dynamic-slice.171 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.319, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1024}
  %reduce.174 = f32[] reduce(%dynamic-slice.171, %constant.1535), dimensions={0,1}, to_apply=%region_19.1179
  %is-finite.48 = pred[] is-finite(%reduce.174)
  %reshape.1728 = pred[1]{0} reshape(%is-finite.48)
  %compare.255 = pred[] compare(%reduce.174, %constant.1529), direction=GT
  %reshape.1729 = pred[1]{0} reshape(%compare.255)
  %divide.332 = f32[] divide(%constant.1537, %reduce.174)
  %reshape.1730 = f32[1]{0} reshape(%divide.332)
  %get-tuple-element.320 = f32[80,1]{1,0} get-tuple-element(%param.43), index=23
  %dynamic-slice.172 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.320, %get-tuple-element.266, %constant.1532), dynamic_slice_sizes={1,1}
  %divide.333 = f32[1,1]{1,0} divide(%constant.1538, %dynamic-slice.172)
  %reshape.1731 = f32[1]{0} reshape(%divide.333)
  %select.350 = f32[1]{0} select(%reshape.1729, %reshape.1730, %reshape.1731)
  %select.351 = f32[1]{0} select(%reshape.1728, %select.350, %reshape.1731)
  %divide.334 = f32[1]{0} divide(%constant.1533, %select.351)
  %convert.293 = bf16[1]{0} convert(%divide.334)
  %reshape.1732 = bf16[] reshape(%convert.293)
  %broadcast.1776 = bf16[1,28672,64]{2,1,0} broadcast(%reshape.1732), dimensions={}
  %divide.335 = bf16[1,28672,64]{2,1,0} divide(%convert.292, %broadcast.1776)
  %broadcast.1777 = bf16[1,28672,64]{2,1,0} broadcast(%constant.1540), dimensions={}
  %clamp.62 = bf16[1,28672,64]{2,1,0} clamp(%broadcast.1775, %divide.335, %broadcast.1777)
  %convert.294 = f8e4m3fn[1,28672,64]{2,1,0} convert(%clamp.62)
  %reshape.1733 = f8e4m3fn[28672,64]{1,0} reshape(%convert.294)
  %all-gather.6 = f8e4m3fn[28672,8192]{1,0} all-gather(%reshape.1733), channel_id=9, replica_groups=[2,128]<=[256], dimensions={1}, use_global_device_ids=true
  %dot.38 = bf16[2,8192,8192]{2,1,0} dot(%convert.291, %all-gather.6), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.246 = f32[1]{0} multiply(%divide.329, %divide.334)
  %convert.295 = bf16[1]{0} convert(%multiply.246)
  %reshape.1734 = bf16[] reshape(%convert.295)
  %broadcast.1778 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1734), dimensions={}
  %multiply.247 = bf16[2,8192,8192]{2,1,0} multiply(%dot.38, %broadcast.1778)
  %copy.54 = bf16[2,8192,8192]{2,1,0} copy(%multiply.247)
  %add.114 = bf16[2,8192,8192]{2,1,0} add(%copy.54, %add.111)
  %copy.55 = bf16[2,8192,8192]{2,1,0} copy(%add.114)
  %get-tuple-element.321 = bf16[80,2,8192,8192]{3,2,1,0} get-tuple-element(%param.43), index=2
  %reshape.1735 = bf16[1,2,8192,8192]{3,2,1,0} reshape(%get-tuple-element.267)
  %dynamic-update-slice.63 = bf16[80,2,8192,8192]{3,2,1,0} dynamic-update-slice(%get-tuple-element.321, %reshape.1735, %get-tuple-element.266, %constant.1532, %constant.1532, /*index=5*/%constant.1532)
  ROOT %tuple.109 = (s32[], bf16[2,8192,8192]{2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, /*index=5*/f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, /*index=10*/f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=15*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=20*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=25*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=30*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=35*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=40*/f32[2,8192,1,128]{3,2,1,0}, s32[2,8192,64,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, /*index=45*/s32[2,8192,8,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, s32[2,1]{1,0}, s32[2,1]{1,0}) tuple(%add.102, %copy.55, %dynamic-update-slice.63, %get-tuple-element.308, %get-tuple-element.313, /*index=5*/%get-tuple-element.318, %get-tuple-element.305, %get-tuple-element.268, %get-tuple-element.280, %get-tuple-element.302, /*index=10*/%get-tuple-element.271, %get-tuple-element.289, %get-tuple-element.306, %get-tuple-element.307, %get-tuple-element.309, /*index=15*/%get-tuple-element.310, %get-tuple-element.311, %get-tuple-element.312, %get-tuple-element.314, %get-tuple-element.315, /*index=20*/%get-tuple-element.316, %get-tuple-element.317, %get-tuple-element.319, %get-tuple-element.320, %get-tuple-element.278, /*index=25*/%get-tuple-element.279, %get-tuple-element.281, %get-tuple-element.282, %get-tuple-element.300, %get-tuple-element.301, /*index=30*/%get-tuple-element.303, %get-tuple-element.304, %get-tuple-element.269, %get-tuple-element.270, %get-tuple-element.272, /*index=35*/%get-tuple-element.273, %get-tuple-element.287, %get-tuple-element.288, %get-tuple-element.290, %get-tuple-element.291, /*index=40*/%get-tuple-element.274, %get-tuple-element.275, %get-tuple-element.276, %get-tuple-element.277, %get-tuple-element.283, /*index=45*/%get-tuple-element.284, %get-tuple-element.285, %get-tuple-element.286, %get-tuple-element.292, %get-tuple-element.293)
}

%region_20.1277_spmd (param.42: (s32[], bf16[2,8192,8192], bf16[80,2,8192,8192], f32[80,64,28672], f32[80,64,28672], /*index=5*/f32[80,28672,64], f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], /*index=10*/f32[80,64,64,128], f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], /*index=15*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=20*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=25*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=30*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=35*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=40*/f32[2,8192,1,128], s32[2,8192,64,128], f32[2,8192,1,128], f32[1,1,1,128], f32[2,8192,1,128], /*index=45*/s32[2,8192,8,128], f32[2,8192,1,128], f32[1,1,1,128], s32[2,1], s32[2,1])) -> pred[] {
  %param.42 = (s32[], bf16[2,8192,8192]{2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, /*index=5*/f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, /*index=10*/f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=15*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=20*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=25*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=30*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=35*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=40*/f32[2,8192,1,128]{3,2,1,0}, s32[2,8192,64,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, /*index=45*/s32[2,8192,8,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, s32[2,1]{1,0}, s32[2,1]{1,0}) parameter(0)
  %get-tuple-element.265 = s32[] get-tuple-element(%param.42), index=0
  %constant.1515 = s32[] constant(80)
  ROOT %compare.212 = pred[] compare(%get-tuple-element.265, %constant.1515), direction=LT
}

%region_21.1289 (Arg_0.1286: f32[], Arg_1.1287: f32[]) -> f32[] {
  %Arg_0.1286 = f32[] parameter(0)
  %Arg_1.1287 = f32[] parameter(1)
  ROOT %add.1288 = f32[] add(%Arg_0.1286, %Arg_1.1287)
}

%region_22.1329 (Arg_0.1326: f32[], Arg_1.1327: f32[]) -> f32[] {
  %Arg_0.1326 = f32[] parameter(0)
  %Arg_1.1327 = f32[] parameter(1)
  ROOT %maximum.1328 = f32[] maximum(%Arg_0.1326, %Arg_1.1327)
}

%region_23.1340 (Arg_0.1337: f32[], Arg_1.1338: f32[]) -> f32[] {
  %Arg_0.1337 = f32[] parameter(0)
  %Arg_1.1338 = f32[] parameter(1)
  ROOT %add.1339 = f32[] add(%Arg_0.1337, %Arg_1.1338)
}

%region_29.1429 (Arg_0.1426: f32[], Arg_1.1427: f32[]) -> f32[] {
  %Arg_0.1426 = f32[] parameter(0)
  %Arg_1.1427 = f32[] parameter(1)
  ROOT %add.1428 = f32[] add(%Arg_0.1426, %Arg_1.1427)
}

%region_32.1791 (Arg_0.1788: f32[], Arg_1.1789: f32[]) -> f32[] {
  %Arg_0.1788 = f32[] parameter(0)
  %Arg_1.1789 = f32[] parameter(1)
  ROOT %add.1790 = f32[] add(%Arg_0.1788, %Arg_1.1789)
}

%region_33.1817 (Arg_0.1814: f32[], Arg_1.1815: f32[]) -> f32[] {
  %Arg_0.1814 = f32[] parameter(0)
  %Arg_1.1815 = f32[] parameter(1)
  ROOT %maximum.1816 = f32[] maximum(%Arg_0.1814, %Arg_1.1815)
}

%region_36.1875 (Arg_0.1872: f32[], Arg_1.1873: f32[]) -> f32[] {
  %Arg_0.1872 = f32[] parameter(0)
  %Arg_1.1873 = f32[] parameter(1)
  ROOT %maximum.1874 = f32[] maximum(%Arg_0.1872, %Arg_1.1873)
}

%region_39.1923 (Arg_0.1920: f32[], Arg_1.1921: f32[]) -> f32[] {
  %Arg_0.1920 = f32[] parameter(0)
  %Arg_1.1921 = f32[] parameter(1)
  ROOT %maximum.1922 = f32[] maximum(%Arg_0.1920, %Arg_1.1921)
}

%region_42.1955 (Arg_0.1952: f32[], Arg_1.1953: f32[]) -> f32[] {
  %Arg_0.1952 = f32[] parameter(0)
  %Arg_1.1953 = f32[] parameter(1)
  ROOT %maximum.1954 = f32[] maximum(%Arg_0.1952, %Arg_1.1953)
}

%region_45.2003 (Arg_0.2000: f32[], Arg_1.2001: f32[]) -> f32[] {
  %Arg_0.2000 = f32[] parameter(0)
  %Arg_1.2001 = f32[] parameter(1)
  ROOT %maximum.2002 = f32[] maximum(%Arg_0.2000, %Arg_1.2001)
}

%region_48.2035 (Arg_0.2032: f32[], Arg_1.2033: f32[]) -> f32[] {
  %Arg_0.2032 = f32[] parameter(0)
  %Arg_1.2033 = f32[] parameter(1)
  ROOT %maximum.2034 = f32[] maximum(%Arg_0.2032, %Arg_1.2033)
}

%region_51.2287 (Arg_0.2284: s32[], Arg_1.2285: s32[]) -> s32[] {
  %Arg_0.2284 = s32[] parameter(0)
  %Arg_1.2285 = s32[] parameter(1)
  ROOT %add.2286 = s32[] add(%Arg_0.2284, %Arg_1.2285)
}

%region_52.2295 (Arg_0.2292: s32[], Arg_1.2293: s32[]) -> s32[] {
  %Arg_0.2292 = s32[] parameter(0)
  %Arg_1.2293 = s32[] parameter(1)
  ROOT %add.2294 = s32[] add(%Arg_0.2292, %Arg_1.2293)
}

%region_53.2300 (Arg_0.2297: s32[], Arg_1.2298: s32[]) -> s32[] {
  %Arg_0.2297 = s32[] parameter(0)
  %Arg_1.2298 = s32[] parameter(1)
  ROOT %maximum.2299 = s32[] maximum(%Arg_0.2297, %Arg_1.2298)
}

%region_1.75._custom_call_lowering_rule.1 (Arg_0.110: s32[], Arg_1.89: s32[], Arg_2.84: s32[], Arg_3.0: s32[]) -> pred[] {
  %Arg_2.84 = s32[] parameter(2)
  %Arg_3.0 = s32[] parameter(3)
  %Arg_0.110 = s32[] parameter(0)
  %Arg_1.89 = s32[] parameter(1)
  ROOT %compare.257 = pred[] compare(%Arg_0.110, %Arg_1.89), direction=LT
}

%region_2.88._custom_call_lowering_rule.1 (Arg_0.111: s32[], Arg_1.90: s32[]) -> s32[] {
  %Arg_0.111 = s32[] parameter(0)
  %Arg_1.90 = s32[] parameter(1)
  ROOT %add.115 = s32[] add(%Arg_0.111, %Arg_1.90)
}

%region_6.187._custom_call_lowering_rule.1 (Arg_0.112: s32[], Arg_1.91: s32[]) -> s32[] {
  %Arg_0.112 = s32[] parameter(0)
  ROOT %Arg_1.91 = s32[] parameter(1)
}

%region_3.96._custom_call_lowering_rule.1 (Arg_0.113: pred[], Arg_1.92: pred[]) -> pred[] {
  %Arg_0.113 = pred[] parameter(0)
  ROOT %Arg_1.92 = pred[] parameter(1)
}

%region_4.105._custom_call_lowering_rule.1 (Arg_0.114: s32[], Arg_1.93: s32[]) -> s32[] {
  %Arg_0.114 = s32[] parameter(0)
  %Arg_1.93 = s32[] parameter(1)
  ROOT %add.116 = s32[] add(%Arg_0.114, %Arg_1.93)
}

%region_5.124._custom_call_lowering_rule.1 (Arg_0.115: s32[], Arg_1.94: s32[]) -> s32[] {
  %Arg_0.115 = s32[] parameter(0)
  %Arg_1.94 = s32[] parameter(1)
  ROOT %add.117 = s32[] add(%Arg_0.115, %Arg_1.94)
}

%region_0.39._custom_call_lowering_rule.1 (Arg_0.116: s32[], Arg_1.96: s32[]) -> s32[] {
  %Arg_0.116 = s32[] parameter(0)
  %Arg_1.96 = s32[] parameter(1)
  ROOT %add.119 = s32[] add(%Arg_0.116, %Arg_1.96)
}

%region_0.39._custom_call_lowering_rule.1.clone (Arg_0.197: s32[], Arg_1.174: s32[]) -> s32[] {
  %Arg_0.197 = s32[] parameter(0)
  %Arg_1.174 = s32[] parameter(1)
  ROOT %add.523 = s32[] add(%Arg_0.197, %Arg_1.174)
}

%region_7.195._custom_call_lowering_rule.1 (Arg_0.117: s32[], Arg_1.97: s32[]) -> s32[] {
  %Arg_0.117 = s32[] parameter(0)
  ROOT %Arg_1.97 = s32[] parameter(1)
}

%region_0.39._custom_call_lowering_rule.1.clone.1 (Arg_0.198: s32[], Arg_1.175: s32[]) -> s32[] {
  %Arg_0.198 = s32[] parameter(0)
  %Arg_1.175 = s32[] parameter(1)
  ROOT %add.524 = s32[] add(%Arg_0.198, %Arg_1.175)
}

%region_12.249._custom_call_lowering_rule.1 (Arg_0.123: s32[], Arg_1.102: s32[]) -> s32[] {
  %Arg_0.123 = s32[] parameter(0)
  ROOT %Arg_1.102 = s32[] parameter(1)
}

%region_54.2311 (Arg_0.2308: f32[], Arg_1.2309: f32[]) -> f32[] {
  %Arg_0.2308 = f32[] parameter(0)
  %Arg_1.2309 = f32[] parameter(1)
  ROOT %maximum.2310 = f32[] maximum(%Arg_0.2308, %Arg_1.2309)
}

%region_57.2351 (Arg_0.2348: f32[], Arg_1.2349: f32[]) -> f32[] {
  %Arg_0.2348 = f32[] parameter(0)
  %Arg_1.2349 = f32[] parameter(1)
  ROOT %maximum.2350 = f32[] maximum(%Arg_0.2348, %Arg_1.2349)
}

%region_60.2403 (Arg_0.2400: f32[], Arg_1.2401: f32[]) -> f32[] {
  %Arg_0.2400 = f32[] parameter(0)
  %Arg_1.2401 = f32[] parameter(1)
  ROOT %add.2402 = f32[] add(%Arg_0.2400, %Arg_1.2401)
}

%region_61.2427 (Arg_0.2424: f32[], Arg_1.2425: f32[]) -> f32[] {
  %Arg_0.2424 = f32[] parameter(0)
  %Arg_1.2425 = f32[] parameter(1)
  ROOT %maximum.2426 = f32[] maximum(%Arg_0.2424, %Arg_1.2425)
}

%region_64.2459 (Arg_0.2456: f32[], Arg_1.2457: f32[]) -> f32[] {
  %Arg_0.2456 = f32[] parameter(0)
  %Arg_1.2457 = f32[] parameter(1)
  ROOT %maximum.2458 = f32[] maximum(%Arg_0.2456, %Arg_1.2457)
}

%region_79.2679 (Arg_0.2676: f32[], Arg_1.2677: f32[]) -> f32[] {
  %Arg_0.2676 = f32[] parameter(0)
  %Arg_1.2677 = f32[] parameter(1)
  ROOT %maximum.2678 = f32[] maximum(%Arg_0.2676, %Arg_1.2677)
}

%region_76.2637 (Arg_0.2634: f32[], Arg_1.2635: f32[]) -> f32[] {
  %Arg_0.2634 = f32[] parameter(0)
  %Arg_1.2635 = f32[] parameter(1)
  ROOT %maximum.2636 = f32[] maximum(%Arg_0.2634, %Arg_1.2635)
}

%region_82.2756 (Arg_0.2753: f32[], Arg_1.2754: f32[]) -> f32[] {
  %Arg_0.2753 = f32[] parameter(0)
  %Arg_1.2754 = f32[] parameter(1)
  ROOT %maximum.2755 = f32[] maximum(%Arg_0.2753, %Arg_1.2754)
}

%region_70.2555 (Arg_0.2552: f32[], Arg_1.2553: f32[]) -> f32[] {
  %Arg_0.2552 = f32[] parameter(0)
  %Arg_1.2553 = f32[] parameter(1)
  ROOT %maximum.2554 = f32[] maximum(%Arg_0.2552, %Arg_1.2553)
}

%region_67.2523 (Arg_0.2520: f32[], Arg_1.2521: f32[]) -> f32[] {
  %Arg_0.2520 = f32[] parameter(0)
  %Arg_1.2521 = f32[] parameter(1)
  ROOT %maximum.2522 = f32[] maximum(%Arg_0.2520, %Arg_1.2521)
}

%region_85.2822 (Arg_0.2819: f32[], Arg_1.2820: f32[]) -> f32[] {
  %Arg_0.2819 = f32[] parameter(0)
  %Arg_1.2820 = f32[] parameter(1)
  ROOT %maximum.2821 = f32[] maximum(%Arg_0.2819, %Arg_1.2820)
}

%region_90.2891 (Arg_0.2888: f32[], Arg_1.2889: f32[]) -> f32[] {
  %Arg_0.2888 = f32[] parameter(0)
  %Arg_1.2889 = f32[] parameter(1)
  ROOT %add.2890 = f32[] add(%Arg_0.2888, %Arg_1.2889)
}

%region_92.2914 (Arg_0.2911: f32[], Arg_1.2912: f32[]) -> f32[] {
  %Arg_0.2911 = f32[] parameter(0)
  %Arg_1.2912 = f32[] parameter(1)
  ROOT %maximum.2913 = f32[] maximum(%Arg_0.2911, %Arg_1.2912)
}

%region_95.3033 (Arg_0.3030: f32[], Arg_1.3031: f32[]) -> f32[] {
  %Arg_0.3030 = f32[] parameter(0)
  %Arg_1.3031 = f32[] parameter(1)
  ROOT %maximum.3032 = f32[] maximum(%Arg_0.3030, %Arg_1.3031)
}

%region_98.3089 (Arg_0.3086: f32[], Arg_1.3087: f32[]) -> f32[] {
  %Arg_0.3086 = f32[] parameter(0)
  %Arg_1.3087 = f32[] parameter(1)
  ROOT %maximum.3088 = f32[] maximum(%Arg_0.3086, %Arg_1.3087)
}

%region_101.3138 (Arg_0.3135: f32[], Arg_1.3136: f32[]) -> f32[] {
  %Arg_0.3135 = f32[] parameter(0)
  %Arg_1.3136 = f32[] parameter(1)
  ROOT %maximum.3137 = f32[] maximum(%Arg_0.3135, %Arg_1.3136)
}

%region_106.3217 (Arg_0.3214: f32[], Arg_1.3215: f32[]) -> f32[] {
  %Arg_0.3214 = f32[] parameter(0)
  %Arg_1.3215 = f32[] parameter(1)
  ROOT %add.3216 = f32[] add(%Arg_0.3214, %Arg_1.3215)
}

%add.clone (x.1: bf16[], y.1: bf16[]) -> bf16[] {
  %x.1 = bf16[] parameter(0)
  %y.1 = bf16[] parameter(1)
  ROOT %add.128 = bf16[] add(%x.1, %y.1)
}

%add.1.clone (x.3: bf16[], y.3: bf16[]) -> bf16[] {
  %x.3 = bf16[] parameter(0)
  %y.3 = bf16[] parameter(1)
  ROOT %add.130 = bf16[] add(%x.3, %y.3)
}

%add.2.clone (x.5: bf16[], y.5: bf16[]) -> bf16[] {
  %x.5 = bf16[] parameter(0)
  %y.5 = bf16[] parameter(1)
  ROOT %add.132 = bf16[] add(%x.5, %y.5)
}

%add.3.clone (x.7: bf16[], y.7: bf16[]) -> bf16[] {
  %x.7 = bf16[] parameter(0)
  %y.7 = bf16[] parameter(1)
  ROOT %add.134 = bf16[] add(%x.7, %y.7)
}

%region_73.2597 (Arg_0.2594: f32[], Arg_1.2595: f32[]) -> f32[] {
  %Arg_0.2594 = f32[] parameter(0)
  %Arg_1.2595 = f32[] parameter(1)
  ROOT %maximum.2596 = f32[] maximum(%Arg_0.2594, %Arg_1.2595)
}

%add.4.clone (x.9: bf16[], y.9: bf16[]) -> bf16[] {
  %x.9 = bf16[] parameter(0)
  %y.9 = bf16[] parameter(1)
  ROOT %add.136 = bf16[] add(%x.9, %y.9)
}

%add.5.clone (x.11: bf16[], y.11: bf16[]) -> bf16[] {
  %x.11 = bf16[] parameter(0)
  %y.11 = bf16[] parameter(1)
  ROOT %add.138 = bf16[] add(%x.11, %y.11)
}

%region_88.2873 (Arg_0.2870: bf16[], Arg_1.2871: bf16[]) -> bf16[] {
  %Arg_0.2870 = bf16[] parameter(0)
  %Arg_1.2871 = bf16[] parameter(1)
  ROOT %add.2872 = bf16[] add(%Arg_0.2870, %Arg_1.2871)
}

%region_88.2873.clone (Arg_0.130: bf16[], Arg_1.109: bf16[]) -> bf16[] {
  %Arg_0.130 = bf16[] parameter(0)
  %Arg_1.109 = bf16[] parameter(1)
  ROOT %add.139 = bf16[] add(%Arg_0.130, %Arg_1.109)
}

%region_104.3199 (Arg_0.3196: bf16[], Arg_1.3197: bf16[]) -> bf16[] {
  %Arg_0.3196 = bf16[] parameter(0)
  %Arg_1.3197 = bf16[] parameter(1)
  ROOT %add.3198 = bf16[] add(%Arg_0.3196, %Arg_1.3197)
}

%region_104.3199.clone (Arg_0.131: bf16[], Arg_1.110: bf16[]) -> bf16[] {
  %Arg_0.131 = bf16[] parameter(0)
  %Arg_1.110 = bf16[] parameter(1)
  ROOT %add.140 = bf16[] add(%Arg_0.131, %Arg_1.110)
}

%add.6.clone (x.13: bf16[], y.13: bf16[]) -> bf16[] {
  %x.13 = bf16[] parameter(0)
  %y.13 = bf16[] parameter(1)
  ROOT %add.142 = bf16[] add(%x.13, %y.13)
}

%add.7.clone (x.15: bf16[], y.15: bf16[]) -> bf16[] {
  %x.15 = bf16[] parameter(0)
  %y.15 = bf16[] parameter(1)
  ROOT %add.144 = bf16[] add(%x.15, %y.15)
}

%add.8.clone (x.17: bf16[], y.17: bf16[]) -> bf16[] {
  %x.17 = bf16[] parameter(0)
  %y.17 = bf16[] parameter(1)
  ROOT %add.146 = bf16[] add(%x.17, %y.17)
}

%add.9.clone (x.19: bf16[], y.19: bf16[]) -> bf16[] {
  %x.19 = bf16[] parameter(0)
  %y.19 = bf16[] parameter(1)
  ROOT %add.148 = bf16[] add(%x.19, %y.19)
}

%add.10.clone (x.21: bf16[], y.21: bf16[]) -> bf16[] {
  %x.21 = bf16[] parameter(0)
  %y.21 = bf16[] parameter(1)
  ROOT %add.150 = bf16[] add(%x.21, %y.21)
}

%add.11.clone (x.23: bf16[], y.23: bf16[]) -> bf16[] {
  %x.23 = bf16[] parameter(0)
  %y.23 = bf16[] parameter(1)
  ROOT %add.152 = bf16[] add(%x.23, %y.23)
}

%add.12.clone (x.25: bf16[], y.25: bf16[]) -> bf16[] {
  %x.25 = bf16[] parameter(0)
  %y.25 = bf16[] parameter(1)
  ROOT %add.154 = bf16[] add(%x.25, %y.25)
}

%add.13.clone (x.27: bf16[], y.27: bf16[]) -> bf16[] {
  %x.27 = bf16[] parameter(0)
  %y.27 = bf16[] parameter(1)
  ROOT %add.156 = bf16[] add(%x.27, %y.27)
}

%region_62.2441 (Arg_0.2438: bf16[], Arg_1.2439: bf16[]) -> bf16[] {
  %Arg_0.2438 = bf16[] parameter(0)
  %Arg_1.2439 = bf16[] parameter(1)
  ROOT %maximum.2440 = bf16[] maximum(%Arg_0.2438, %Arg_1.2439)
}

%region_62.2441.clone (Arg_0.132: bf16[], Arg_1.111: bf16[]) -> bf16[] {
  %Arg_0.132 = bf16[] parameter(0)
  %Arg_1.111 = bf16[] parameter(1)
  ROOT %maximum.90 = bf16[] maximum(%Arg_0.132, %Arg_1.111)
}

%region_65.2473 (Arg_0.2470: bf16[], Arg_1.2471: bf16[]) -> bf16[] {
  %Arg_0.2470 = bf16[] parameter(0)
  %Arg_1.2471 = bf16[] parameter(1)
  ROOT %maximum.2472 = bf16[] maximum(%Arg_0.2470, %Arg_1.2471)
}

%region_65.2473.clone (Arg_0.133: bf16[], Arg_1.112: bf16[]) -> bf16[] {
  %Arg_0.133 = bf16[] parameter(0)
  %Arg_1.112 = bf16[] parameter(1)
  ROOT %maximum.91 = bf16[] maximum(%Arg_0.133, %Arg_1.112)
}

%region_86.2836 (Arg_0.2833: bf16[], Arg_1.2834: bf16[]) -> bf16[] {
  %Arg_0.2833 = bf16[] parameter(0)
  %Arg_1.2834 = bf16[] parameter(1)
  ROOT %maximum.2835 = bf16[] maximum(%Arg_0.2833, %Arg_1.2834)
}

%region_86.2836.clone (Arg_0.134: bf16[], Arg_1.113: bf16[]) -> bf16[] {
  %Arg_0.134 = bf16[] parameter(0)
  %Arg_1.113 = bf16[] parameter(1)
  ROOT %maximum.92 = bf16[] maximum(%Arg_0.134, %Arg_1.113)
}

%region_68.2537.clone (Arg_0.135: bf16[], Arg_1.114: bf16[]) -> bf16[] {
  %Arg_0.135 = bf16[] parameter(0)
  %Arg_1.114 = bf16[] parameter(1)
  ROOT %maximum.93 = bf16[] maximum(%Arg_0.135, %Arg_1.114)
}

%region_71.2569 (Arg_0.2566: bf16[], Arg_1.2567: bf16[]) -> bf16[] {
  %Arg_0.2566 = bf16[] parameter(0)
  %Arg_1.2567 = bf16[] parameter(1)
  ROOT %maximum.2568 = bf16[] maximum(%Arg_0.2566, %Arg_1.2567)
}

%region_71.2569.clone (Arg_0.136: bf16[], Arg_1.115: bf16[]) -> bf16[] {
  %Arg_0.136 = bf16[] parameter(0)
  %Arg_1.115 = bf16[] parameter(1)
  ROOT %maximum.94 = bf16[] maximum(%Arg_0.136, %Arg_1.115)
}

%region_83.2770 (Arg_0.2767: bf16[], Arg_1.2768: bf16[]) -> bf16[] {
  %Arg_0.2767 = bf16[] parameter(0)
  %Arg_1.2768 = bf16[] parameter(1)
  ROOT %maximum.2769 = bf16[] maximum(%Arg_0.2767, %Arg_1.2768)
}

%region_83.2770.clone (Arg_0.137: bf16[], Arg_1.116: bf16[]) -> bf16[] {
  %Arg_0.137 = bf16[] parameter(0)
  %Arg_1.116 = bf16[] parameter(1)
  ROOT %maximum.95 = bf16[] maximum(%Arg_0.137, %Arg_1.116)
}

%region_74.2611 (Arg_0.2608: bf16[], Arg_1.2609: bf16[]) -> bf16[] {
  %Arg_0.2608 = bf16[] parameter(0)
  %Arg_1.2609 = bf16[] parameter(1)
  ROOT %maximum.2610 = bf16[] maximum(%Arg_0.2608, %Arg_1.2609)
}

%region_74.2611.clone (Arg_0.138: bf16[], Arg_1.117: bf16[]) -> bf16[] {
  %Arg_0.138 = bf16[] parameter(0)
  %Arg_1.117 = bf16[] parameter(1)
  ROOT %maximum.96 = bf16[] maximum(%Arg_0.138, %Arg_1.117)
}

%region_77.2651 (Arg_0.2648: bf16[], Arg_1.2649: bf16[]) -> bf16[] {
  %Arg_0.2648 = bf16[] parameter(0)
  %Arg_1.2649 = bf16[] parameter(1)
  ROOT %maximum.2650 = bf16[] maximum(%Arg_0.2648, %Arg_1.2649)
}

%region_77.2651.clone (Arg_0.139: bf16[], Arg_1.118: bf16[]) -> bf16[] {
  %Arg_0.139 = bf16[] parameter(0)
  %Arg_1.118 = bf16[] parameter(1)
  ROOT %maximum.97 = bf16[] maximum(%Arg_0.139, %Arg_1.118)
}

%region_80.2706 (Arg_0.2703: bf16[], Arg_1.2704: bf16[]) -> bf16[] {
  %Arg_0.2703 = bf16[] parameter(0)
  %Arg_1.2704 = bf16[] parameter(1)
  ROOT %maximum.2705 = bf16[] maximum(%Arg_0.2703, %Arg_1.2704)
}

%region_80.2706.clone (Arg_0.140: bf16[], Arg_1.119: bf16[]) -> bf16[] {
  %Arg_0.140 = bf16[] parameter(0)
  %Arg_1.119 = bf16[] parameter(1)
  ROOT %maximum.98 = bf16[] maximum(%Arg_0.140, %Arg_1.119)
}

%region_40.1937 (Arg_0.1934: bf16[], Arg_1.1935: bf16[]) -> bf16[] {
  %Arg_0.1934 = bf16[] parameter(0)
  %Arg_1.1935 = bf16[] parameter(1)
  ROOT %maximum.1936 = bf16[] maximum(%Arg_0.1934, %Arg_1.1935)
}

%region_40.1937.clone (Arg_0.141: bf16[], Arg_1.120: bf16[]) -> bf16[] {
  %Arg_0.141 = bf16[] parameter(0)
  %Arg_1.120 = bf16[] parameter(1)
  ROOT %maximum.99 = bf16[] maximum(%Arg_0.141, %Arg_1.120)
}

%region_43.1969 (Arg_0.1966: bf16[], Arg_1.1967: bf16[]) -> bf16[] {
  %Arg_0.1966 = bf16[] parameter(0)
  %Arg_1.1967 = bf16[] parameter(1)
  ROOT %maximum.1968 = bf16[] maximum(%Arg_0.1966, %Arg_1.1967)
}

%region_43.1969.clone (Arg_0.142: bf16[], Arg_1.121: bf16[]) -> bf16[] {
  %Arg_0.142 = bf16[] parameter(0)
  %Arg_1.121 = bf16[] parameter(1)
  ROOT %maximum.100 = bf16[] maximum(%Arg_0.142, %Arg_1.121)
}

%region_99.3103 (Arg_0.3100: bf16[], Arg_1.3101: bf16[]) -> bf16[] {
  %Arg_0.3100 = bf16[] parameter(0)
  %Arg_1.3101 = bf16[] parameter(1)
  ROOT %maximum.3102 = bf16[] maximum(%Arg_0.3100, %Arg_1.3101)
}

%region_99.3103.clone (Arg_0.143: bf16[], Arg_1.123: bf16[]) -> bf16[] {
  %Arg_0.143 = bf16[] parameter(0)
  %Arg_1.123 = bf16[] parameter(1)
  ROOT %maximum.101 = bf16[] maximum(%Arg_0.143, %Arg_1.123)
}

%region_55.2325 (Arg_0.2322: bf16[], Arg_1.2323: bf16[]) -> bf16[] {
  %Arg_0.2322 = bf16[] parameter(0)
  %Arg_1.2323 = bf16[] parameter(1)
  ROOT %maximum.2324 = bf16[] maximum(%Arg_0.2322, %Arg_1.2323)
}

%region_55.2325.clone (Arg_0.144: bf16[], Arg_1.124: bf16[]) -> bf16[] {
  %Arg_0.144 = bf16[] parameter(0)
  %Arg_1.124 = bf16[] parameter(1)
  ROOT %maximum.102 = bf16[] maximum(%Arg_0.144, %Arg_1.124)
}

%region_58.2365 (Arg_0.2362: bf16[], Arg_1.2363: bf16[]) -> bf16[] {
  %Arg_0.2362 = bf16[] parameter(0)
  %Arg_1.2363 = bf16[] parameter(1)
  ROOT %maximum.2364 = bf16[] maximum(%Arg_0.2362, %Arg_1.2363)
}

%region_58.2365.clone (Arg_0.145: bf16[], Arg_1.126: bf16[]) -> bf16[] {
  %Arg_0.145 = bf16[] parameter(0)
  %Arg_1.126 = bf16[] parameter(1)
  ROOT %maximum.103 = bf16[] maximum(%Arg_0.145, %Arg_1.126)
}

%region_93.2928 (Arg_0.2925: bf16[], Arg_1.2926: bf16[]) -> bf16[] {
  %Arg_0.2925 = bf16[] parameter(0)
  %Arg_1.2926 = bf16[] parameter(1)
  ROOT %maximum.2927 = bf16[] maximum(%Arg_0.2925, %Arg_1.2926)
}

%region_93.2928.clone (Arg_0.146: bf16[], Arg_1.127: bf16[]) -> bf16[] {
  %Arg_0.146 = bf16[] parameter(0)
  %Arg_1.127 = bf16[] parameter(1)
  ROOT %maximum.104 = bf16[] maximum(%Arg_0.146, %Arg_1.127)
}

%region_34.1844.clone (Arg_0.147: bf16[], Arg_1.128: bf16[]) -> bf16[] {
  %Arg_0.147 = bf16[] parameter(0)
  %Arg_1.128 = bf16[] parameter(1)
  ROOT %maximum.105 = bf16[] maximum(%Arg_0.147, %Arg_1.128)
}

%region_37.1889 (Arg_0.1886: bf16[], Arg_1.1887: bf16[]) -> bf16[] {
  %Arg_0.1886 = bf16[] parameter(0)
  %Arg_1.1887 = bf16[] parameter(1)
  ROOT %maximum.1888 = bf16[] maximum(%Arg_0.1886, %Arg_1.1887)
}

%region_37.1889.clone (Arg_0.148: bf16[], Arg_1.129: bf16[]) -> bf16[] {
  %Arg_0.148 = bf16[] parameter(0)
  %Arg_1.129 = bf16[] parameter(1)
  ROOT %maximum.106 = bf16[] maximum(%Arg_0.148, %Arg_1.129)
}

%region_102.3152 (Arg_0.3149: bf16[], Arg_1.3150: bf16[]) -> bf16[] {
  %Arg_0.3149 = bf16[] parameter(0)
  %Arg_1.3150 = bf16[] parameter(1)
  ROOT %maximum.3151 = bf16[] maximum(%Arg_0.3149, %Arg_1.3150)
}

%region_102.3152.clone (Arg_0.149: bf16[], Arg_1.130: bf16[]) -> bf16[] {
  %Arg_0.149 = bf16[] parameter(0)
  %Arg_1.130 = bf16[] parameter(1)
  ROOT %maximum.107 = bf16[] maximum(%Arg_0.149, %Arg_1.130)
}

%region_46.2017.clone (Arg_0.150: bf16[], Arg_1.131: bf16[]) -> bf16[] {
  %Arg_0.150 = bf16[] parameter(0)
  %Arg_1.131 = bf16[] parameter(1)
  ROOT %maximum.108 = bf16[] maximum(%Arg_0.150, %Arg_1.131)
}

%region_49.2049 (Arg_0.2046: bf16[], Arg_1.2047: bf16[]) -> bf16[] {
  %Arg_0.2046 = bf16[] parameter(0)
  %Arg_1.2047 = bf16[] parameter(1)
  ROOT %maximum.2048 = bf16[] maximum(%Arg_0.2046, %Arg_1.2047)
}

%region_49.2049.clone (Arg_0.151: bf16[], Arg_1.132: bf16[]) -> bf16[] {
  %Arg_0.151 = bf16[] parameter(0)
  %Arg_1.132 = bf16[] parameter(1)
  ROOT %maximum.109 = bf16[] maximum(%Arg_0.151, %Arg_1.132)
}

%region_96.3047 (Arg_0.3044: bf16[], Arg_1.3045: bf16[]) -> bf16[] {
  %Arg_0.3044 = bf16[] parameter(0)
  %Arg_1.3045 = bf16[] parameter(1)
  ROOT %maximum.3046 = bf16[] maximum(%Arg_0.3044, %Arg_1.3045)
}

%region_96.3047.clone (Arg_0.152: bf16[], Arg_1.133: bf16[]) -> bf16[] {
  %Arg_0.152 = bf16[] parameter(0)
  %Arg_1.133 = bf16[] parameter(1)
  ROOT %maximum.110 = bf16[] maximum(%Arg_0.152, %Arg_1.133)
}

%region_31.3396_spmd (param.45: (s32[], bf16[2,8192,8192], f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], /*index=5*/f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], /*index=10*/f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=15*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=20*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=25*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=30*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=35*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=40*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=45*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=50*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=55*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=60*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=65*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=70*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=75*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=80*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=85*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=90*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=95*/f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], f32[80,8192], f32[80,8192], /*index=100*/f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], f32[80,64,8,128], bf16[80,2,8192,8192], /*index=105*/s32[2,8192], s32[2,8192])) -> (s32[], bf16[2,8192,8192], f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], /*index=5*/f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], /*index=10*/f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=15*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=20*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=25*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=30*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=35*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=40*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=45*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=50*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=55*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=60*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=65*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=70*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=75*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=80*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=85*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=90*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=95*/f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], f32[80,8192], f32[80,8192], /*index=100*/f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], f32[80,64,8,128], bf16[80,2,8192,8192], /*index=105*/s32[2,8192], s32[2,8192]) {
  %param.45 = (s32[], bf16[2,8192,8192]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, /*index=5*/f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, /*index=10*/f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=45*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=50*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=55*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=60*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=65*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=70*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=75*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=80*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=85*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=90*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=95*/f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, /*index=100*/f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, /*index=105*/s32[2,8192]{1,0}, s32[2,8192]{1,0}) parameter(0)
  %get-tuple-element.323 = s32[] get-tuple-element(%param.45), index=0
  %constant.1863 = s32[] constant(1)
  %add.157 = s32[] add(%get-tuple-element.323, %constant.1863)
  %get-tuple-element.324 = bf16[2,8192,8192]{2,1,0} get-tuple-element(%param.45), index=1
  %copy.56 = bf16[2,8192,8192]{2,1,0} copy(%get-tuple-element.324)
  %constant.1864 = bf16[] constant(-5.734e+04)
  %broadcast.1779 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1864), dimensions={}
  %constant.1865 = bf16[] constant(-448)
  %broadcast.1780 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.325 = bf16[80,2,8192,8192]{3,2,1,0} get-tuple-element(%param.45), index=104
  %constant.1866 = s32[] constant(79)
  %subtract.9 = s32[] subtract(%constant.1866, %get-tuple-element.323)
  %constant.1868 = s32[] constant(0)
  %dynamic-slice.173 = bf16[1,2,8192,8192]{3,2,1,0} dynamic-slice(%get-tuple-element.325, %subtract.9, %constant.1868, %constant.1868, %constant.1868), dynamic_slice_sizes={1,2,8192,8192}
  %reshape.1736 = bf16[2,8192,8192]{2,1,0} reshape(%dynamic-slice.173)
  %copy.57 = bf16[2,8192,8192]{2,1,0} copy(%reshape.1736)
  %broadcast.1781 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.1865), dimensions={}
  %convert.296 = f32[2,8192,8192]{2,1,0} convert(%copy.57)
  %multiply.248 = f32[2,8192,8192]{2,1,0} multiply(%convert.296, %convert.296)
  %constant.1873 = f32[] constant(0)
  %reduce.175 = f32[2,8192]{1,0} reduce(%multiply.248, %constant.1873), dimensions={2}, to_apply=%region_32.1791
  %constant.1874 = f32[] constant(0.000122070312)
  %broadcast.1783 = f32[2,8192]{1,0} broadcast(%constant.1874), dimensions={}
  %multiply.249 = f32[2,8192]{1,0} multiply(%reduce.175, %broadcast.1783)
  %constant.1875 = f32[] constant(1e-05)
  %broadcast.1784 = f32[2,8192]{1,0} broadcast(%constant.1875), dimensions={}
  %add.158 = f32[2,8192]{1,0} add(%multiply.249, %broadcast.1784)
  %reshape.1737 = f32[2,8192,1]{2,1,0} reshape(%add.158)
  %rsqrt.8 = f32[2,8192,1]{2,1,0} rsqrt(%reshape.1737)
  %reshape.1738 = f32[2,8192]{1,0} reshape(%rsqrt.8)
  %broadcast.1785 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.1738), dimensions={0,1}
  %multiply.250 = f32[2,8192,8192]{2,1,0} multiply(%convert.296, %broadcast.1785)
  %convert.297 = bf16[2,8192,8192]{2,1,0} convert(%multiply.250)
  %get-tuple-element.326 = f32[80,8192]{1,0} get-tuple-element(%param.45), index=99
  %dynamic-slice.174 = f32[1,8192]{1,0} dynamic-slice(%get-tuple-element.326, %subtract.9, %constant.1868), dynamic_slice_sizes={1,8192}
  %convert.298 = bf16[1,8192]{1,0} convert(%dynamic-slice.174)
  %reshape.1739 = bf16[8192]{0} reshape(%convert.298)
  %broadcast.1786 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1739), dimensions={2}
  %multiply.251 = bf16[2,8192,8192]{2,1,0} multiply(%convert.297, %broadcast.1786)
  %copy.58 = bf16[2,8192,8192]{2,1,0} copy(%multiply.251)
  %copy.59 = bf16[2,8192,8192]{2,1,0} copy(%copy.58)
  %constant.1877 = f32[1]{0} constant({1})
  %get-tuple-element.327 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=83
  %dynamic-slice.175 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.327, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %constant.1879 = f32[] constant(-inf)
  %reduce.176 = f32[] reduce(%dynamic-slice.175, %constant.1879), dimensions={0,1}, to_apply=%region_33.1817
  %is-finite.49 = pred[] is-finite(%reduce.176)
  %reshape.1740 = pred[1]{0} reshape(%is-finite.49)
  %compare.259 = pred[] compare(%reduce.176, %constant.1873), direction=GT
  %reshape.1741 = pred[1]{0} reshape(%compare.259)
  %constant.1881 = f32[] constant(448)
  %divide.337 = f32[] divide(%constant.1881, %reduce.176)
  %reshape.1742 = f32[1]{0} reshape(%divide.337)
  %constant.1882 = f32[1,1]{1,0} constant({ {1} })
  %get-tuple-element.328 = f32[80,1]{1,0} get-tuple-element(%param.45), index=84
  %dynamic-slice.176 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.328, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.338 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.176)
  %reshape.1743 = f32[1]{0} reshape(%divide.338)
  %select.352 = f32[1]{0} select(%reshape.1741, %reshape.1742, %reshape.1743)
  %select.353 = f32[1]{0} select(%reshape.1740, %select.352, %reshape.1743)
  %divide.339 = f32[1]{0} divide(%constant.1877, %select.353)
  %convert.299 = bf16[1]{0} convert(%divide.339)
  %reshape.1744 = bf16[] reshape(%convert.299)
  %broadcast.1787 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1744), dimensions={}
  %divide.340 = bf16[2,8192,8192]{2,1,0} divide(%copy.59, %broadcast.1787)
  %constant.1884 = bf16[] constant(448)
  %broadcast.1788 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.63 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1780, %divide.340, %broadcast.1788)
  %convert.300 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.63)
  %broadcast.1789 = bf16[1,64,64,128]{3,2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.329 = f32[80,64,64,128]{3,2,1,0} get-tuple-element(%param.45), index=102
  %dynamic-slice.177 = f32[1,64,64,128]{3,2,1,0} dynamic-slice(%get-tuple-element.329, %subtract.9, %constant.1868, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,64,128}
  %convert.301 = bf16[1,64,64,128]{3,2,1,0} convert(%dynamic-slice.177)
  %get-tuple-element.330 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=85
  %dynamic-slice.178 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.330, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.177 = f32[] reduce(%dynamic-slice.178, %constant.1879), dimensions={0,1}, to_apply=%region_36.1875
  %is-finite.50 = pred[] is-finite(%reduce.177)
  %reshape.1745 = pred[1]{0} reshape(%is-finite.50)
  %compare.260 = pred[] compare(%reduce.177, %constant.1873), direction=GT
  %reshape.1746 = pred[1]{0} reshape(%compare.260)
  %divide.341 = f32[] divide(%constant.1881, %reduce.177)
  %reshape.1747 = f32[1]{0} reshape(%divide.341)
  %get-tuple-element.331 = f32[80,1]{1,0} get-tuple-element(%param.45), index=86
  %dynamic-slice.179 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.331, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.342 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.179)
  %reshape.1748 = f32[1]{0} reshape(%divide.342)
  %select.354 = f32[1]{0} select(%reshape.1746, %reshape.1747, %reshape.1748)
  %select.355 = f32[1]{0} select(%reshape.1745, %select.354, %reshape.1748)
  %divide.343 = f32[1]{0} divide(%constant.1877, %select.355)
  %convert.302 = bf16[1]{0} convert(%divide.343)
  %reshape.1749 = bf16[] reshape(%convert.302)
  %broadcast.1790 = bf16[1,64,64,128]{3,2,1,0} broadcast(%reshape.1749), dimensions={}
  %divide.344 = bf16[1,64,64,128]{3,2,1,0} divide(%convert.301, %broadcast.1790)
  %broadcast.1791 = bf16[1,64,64,128]{3,2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.64 = bf16[1,64,64,128]{3,2,1,0} clamp(%broadcast.1789, %divide.344, %broadcast.1791)
  %convert.303 = f8e4m3fn[1,64,64,128]{3,2,1,0} convert(%clamp.64)
  %reshape.1750 = f8e4m3fn[64,64,128]{2,1,0} reshape(%convert.303)
  %all-gather.7 = f8e4m3fn[8192,64,128]{2,1,0} all-gather(%reshape.1750), channel_id=11, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.39 = bf16[2,8192,64,128]{3,2,1,0} dot(%convert.300, %all-gather.7), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.252 = f32[1]{0} multiply(%divide.339, %divide.343)
  %convert.304 = bf16[1]{0} convert(%multiply.252)
  %reshape.1751 = bf16[] reshape(%convert.304)
  %broadcast.1792 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1751), dimensions={}
  %multiply.253 = bf16[2,8192,64,128]{3,2,1,0} multiply(%dot.39, %broadcast.1792)
  %convert.305 = f32[2,8192,64,128]{3,2,1,0} convert(%multiply.253)
  %get-tuple-element.332 = s32[2,8192]{1,0} get-tuple-element(%param.45), index=106
  %convert.306 = f32[2,8192]{1,0} convert(%get-tuple-element.332)
  %broadcast.1793 = f32[2,8192,1,128]{3,2,1,0} broadcast(%convert.306), dimensions={0,1}
  %constant.1898 = f32[] constant(1)
  %broadcast.1794 = f32[128]{0} broadcast(%constant.1898), dimensions={}
  %constant.1899 = f32[] constant(6.28318548)
  %broadcast.1795 = f32[128]{0} broadcast(%constant.1899), dimensions={}
  %constant.1900 = f32[] constant(500000)
  %broadcast.1796 = f32[128]{0} broadcast(%constant.1900), dimensions={}
  %iota.17 = s32[64]{0} iota(), iota_dimension=0
  %constant.1901 = s32[] constant(2)
  %broadcast.1797 = s32[64]{0} broadcast(%constant.1901), dimensions={}
  %multiply.254 = s32[64]{0} multiply(%iota.17, %broadcast.1797)
  %convert.307 = f32[64]{0} convert(%multiply.254)
  %constant.1902 = f32[] constant(0.0078125)
  %broadcast.1798 = f32[64]{0} broadcast(%constant.1902), dimensions={}
  %multiply.255 = f32[64]{0} multiply(%convert.307, %broadcast.1798)
  %broadcast.1800 = f32[64,2]{1,0} broadcast(%multiply.255), dimensions={0}
  %reshape.1752 = f32[128]{0} reshape(%broadcast.1800)
  %power.10 = f32[128]{0} power(%broadcast.1796, %reshape.1752)
  %multiply.256 = f32[128]{0} multiply(%broadcast.1795, %power.10)
  %constant.1903 = f32[] constant(2048)
  %broadcast.1802 = f32[128]{0} broadcast(%constant.1903), dimensions={}
  %compare.261 = pred[128]{0} compare(%multiply.256, %broadcast.1802), direction=LT
  %convert.308 = s32[128]{0} convert(%compare.261)
  %broadcast.1803 = s32[128]{0} broadcast(%constant.1863), dimensions={}
  %compare.262 = pred[128]{0} compare(%convert.308, %broadcast.1803), direction=LT
  %constant.1905 = f32[] constant(8192)
  %broadcast.1804 = f32[128]{0} broadcast(%constant.1905), dimensions={}
  %compare.264 = pred[128]{0} compare(%multiply.256, %broadcast.1804), direction=GT
  %convert.309 = s32[128]{0} convert(%compare.264)
  %compare.265 = pred[128]{0} compare(%convert.309, %broadcast.1803), direction=LT
  %negate.27 = f32[128]{0} negate(%reshape.1752)
  %power.11 = f32[128]{0} power(%broadcast.1796, %negate.27)
  %multiply.257 = f32[128]{0} multiply(%broadcast.1804, %power.11)
  %constant.1906 = f32[] constant(0.159154937)
  %broadcast.1805 = f32[128]{0} broadcast(%constant.1906), dimensions={}
  %multiply.258 = f32[128]{0} multiply(%multiply.257, %broadcast.1805)
  %constant.1907 = f32[] constant(-1)
  %broadcast.1807 = f32[128]{0} broadcast(%constant.1907), dimensions={}
  %add.159 = f32[128]{0} add(%multiply.258, %broadcast.1807)
  %constant.1908 = f32[] constant(0.333333343)
  %broadcast.1809 = f32[128]{0} broadcast(%constant.1908), dimensions={}
  %multiply.259 = f32[128]{0} multiply(%add.159, %broadcast.1809)
  %subtract.10 = f32[128]{0} subtract(%broadcast.1794, %multiply.259)
  %multiply.260 = f32[128]{0} multiply(%subtract.10, %power.11)
  %constant.1909 = f32[] constant(0.125)
  %broadcast.1810 = f32[128]{0} broadcast(%constant.1909), dimensions={}
  %multiply.261 = f32[128]{0} multiply(%multiply.260, %broadcast.1810)
  %multiply.262 = f32[128]{0} multiply(%multiply.259, %power.11)
  %add.160 = f32[128]{0} add(%multiply.261, %multiply.262)
  %multiply.263 = f32[128]{0} multiply(%power.11, %broadcast.1810)
  %select.356 = f32[128]{0} select(%compare.265, %add.160, %multiply.263)
  %select.357 = f32[128]{0} select(%compare.262, %select.356, %power.11)
  %divide.346 = f32[128]{0} divide(%broadcast.1794, %select.357)
  %broadcast.1812 = f32[2,8192,1,128]{3,2,1,0} broadcast(%divide.346), dimensions={3}
  %divide.347 = f32[2,8192,1,128]{3,2,1,0} divide(%broadcast.1793, %broadcast.1812)
  %cosine.2 = f32[2,8192,1,128]{3,2,1,0} cosine(%divide.347)
  %reshape.1753 = f32[2,8192,128]{2,1,0} reshape(%cosine.2)
  %broadcast.1813 = f32[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1753), dimensions={0,1,3}
  %multiply.264 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.305, %broadcast.1813)
  %iota.18 = s32[128]{0} iota(), iota_dimension=0
  %and.82 = s32[128]{0} and(%iota.18, %broadcast.1803)
  %broadcast.1815 = s32[128]{0} broadcast(%constant.1868), dimensions={}
  %compare.266 = pred[128]{0} compare(%and.82, %broadcast.1815), direction=LT
  %compare.267 = pred[128]{0} compare(%and.82, %broadcast.1815), direction=NE
  %and.83 = pred[128]{0} and(%compare.266, %compare.267)
  %broadcast.1816 = s32[128]{0} broadcast(%constant.1901), dimensions={}
  %add.161 = s32[128]{0} add(%and.82, %broadcast.1816)
  %select.358 = s32[128]{0} select(%and.83, %add.161, %and.82)
  %compare.268 = pred[128]{0} compare(%select.358, %broadcast.1803), direction=LT
  %broadcast.1818 = pred[2,8192,64,128]{3,2,1,0} broadcast(%compare.268), dimensions={3}
  %slice.407 = bf16[2,8192,64,127]{3,2,1,0} slice(%multiply.253), slice={[0:2], [0:8192], [0:64], [1:128]}
  %slice.408 = bf16[2,8192,64,1]{3,2,1,0} slice(%multiply.253), slice={[0:2], [0:8192], [0:64], [0:1]}
  %concatenate.115 = bf16[2,8192,64,128]{3,2,1,0} concatenate(%slice.407, %slice.408), dimensions={3}
  %slice.409 = bf16[2,8192,64,1]{3,2,1,0} slice(%multiply.253), slice={[0:2], [0:8192], [0:64], [127:128]}
  %slice.410 = bf16[2,8192,64,127]{3,2,1,0} slice(%multiply.253), slice={[0:2], [0:8192], [0:64], [0:127]}
  %concatenate.116 = bf16[2,8192,64,128]{3,2,1,0} concatenate(%slice.409, %slice.410), dimensions={3}
  %select.359 = bf16[2,8192,64,128]{3,2,1,0} select(%broadcast.1818, %concatenate.115, %concatenate.116)
  %convert.310 = f32[2,8192,64,128]{3,2,1,0} convert(%select.359)
  %sine.2 = f32[2,8192,1,128]{3,2,1,0} sine(%divide.347)
  %reshape.1758 = f32[2,8192,128]{2,1,0} reshape(%sine.2)
  %broadcast.1819 = f32[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1758), dimensions={0,1,3}
  %multiply.269 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.310, %broadcast.1819)
  %constant.1951 = s32[2]{0} constant({-1, 1})
  %broadcast.1820 = s32[64,2]{1,0} broadcast(%constant.1951), dimensions={1}
  %reshape.1759 = s32[128]{0} reshape(%broadcast.1820)
  %convert.311 = f32[128]{0} convert(%reshape.1759)
  %broadcast.1821 = f32[2,8192,64,128]{3,2,1,0} broadcast(%convert.311), dimensions={3}
  %multiply.270 = f32[2,8192,64,128]{3,2,1,0} multiply(%multiply.269, %broadcast.1821)
  %add.162 = f32[2,8192,64,128]{3,2,1,0} add(%multiply.264, %multiply.270)
  %convert.313 = bf16[2,8192,64,128]{3,2,1,0} convert(%add.162)
  %copy.60 = bf16[2,8192,64,128]{3,2,1,0} copy(%convert.313)
  %get-tuple-element.333 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=71
  %dynamic-slice.184 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.333, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.178 = f32[] reduce(%dynamic-slice.184, %constant.1879), dimensions={0,1}, to_apply=%region_39.1923
  %is-finite.51 = pred[] is-finite(%reduce.178)
  %reshape.1760 = pred[1]{0} reshape(%is-finite.51)
  %compare.269 = pred[] compare(%reduce.178, %constant.1873), direction=GT
  %reshape.1761 = pred[1]{0} reshape(%compare.269)
  %divide.348 = f32[] divide(%constant.1881, %reduce.178)
  %reshape.1762 = f32[1]{0} reshape(%divide.348)
  %get-tuple-element.334 = f32[80,1]{1,0} get-tuple-element(%param.45), index=72
  %dynamic-slice.185 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.334, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.349 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.185)
  %reshape.1763 = f32[1]{0} reshape(%divide.349)
  %select.360 = f32[1]{0} select(%reshape.1761, %reshape.1762, %reshape.1763)
  %select.361 = f32[1]{0} select(%reshape.1760, %select.360, %reshape.1763)
  %divide.350 = f32[1]{0} divide(%constant.1877, %select.361)
  %convert.314 = bf16[1]{0} convert(%divide.350)
  %reshape.1764 = bf16[] reshape(%convert.314)
  %broadcast.1823 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1764), dimensions={}
  %divide.351 = bf16[2,8192,8192]{2,1,0} divide(%copy.59, %broadcast.1823)
  %clamp.65 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1780, %divide.351, %broadcast.1788)
  %convert.315 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.65)
  %broadcast.1825 = bf16[1,64,8,128]{3,2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.335 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.45), index=100
  %dynamic-slice.186 = f32[1,64,8,128]{3,2,1,0} dynamic-slice(%get-tuple-element.335, %subtract.9, %constant.1868, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,8,128}
  %convert.316 = bf16[1,64,8,128]{3,2,1,0} convert(%dynamic-slice.186)
  %get-tuple-element.336 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=73
  %dynamic-slice.187 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.336, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.179 = f32[] reduce(%dynamic-slice.187, %constant.1879), dimensions={0,1}, to_apply=%region_42.1955
  %is-finite.52 = pred[] is-finite(%reduce.179)
  %reshape.1765 = pred[1]{0} reshape(%is-finite.52)
  %compare.270 = pred[] compare(%reduce.179, %constant.1873), direction=GT
  %reshape.1766 = pred[1]{0} reshape(%compare.270)
  %divide.352 = f32[] divide(%constant.1881, %reduce.179)
  %reshape.1767 = f32[1]{0} reshape(%divide.352)
  %get-tuple-element.337 = f32[80,1]{1,0} get-tuple-element(%param.45), index=74
  %dynamic-slice.188 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.337, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.353 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.188)
  %reshape.1768 = f32[1]{0} reshape(%divide.353)
  %select.362 = f32[1]{0} select(%reshape.1766, %reshape.1767, %reshape.1768)
  %select.363 = f32[1]{0} select(%reshape.1765, %select.362, %reshape.1768)
  %divide.354 = f32[1]{0} divide(%constant.1877, %select.363)
  %convert.317 = bf16[1]{0} convert(%divide.354)
  %reshape.1769 = bf16[] reshape(%convert.317)
  %broadcast.1826 = bf16[1,64,8,128]{3,2,1,0} broadcast(%reshape.1769), dimensions={}
  %divide.355 = bf16[1,64,8,128]{3,2,1,0} divide(%convert.316, %broadcast.1826)
  %broadcast.1828 = bf16[1,64,8,128]{3,2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.66 = bf16[1,64,8,128]{3,2,1,0} clamp(%broadcast.1825, %divide.355, %broadcast.1828)
  %convert.318 = f8e4m3fn[1,64,8,128]{3,2,1,0} convert(%clamp.66)
  %reshape.1770 = f8e4m3fn[64,8,128]{2,1,0} reshape(%convert.318)
  %all-gather.8 = f8e4m3fn[8192,8,128]{2,1,0} all-gather(%reshape.1770), channel_id=12, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.40 = bf16[2,8192,8,128]{3,2,1,0} dot(%convert.315, %all-gather.8), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.271 = f32[1]{0} multiply(%divide.350, %divide.354)
  %convert.319 = bf16[1]{0} convert(%multiply.271)
  %reshape.1771 = bf16[] reshape(%convert.319)
  %broadcast.1829 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1771), dimensions={}
  %multiply.272 = bf16[2,8192,8,128]{3,2,1,0} multiply(%dot.40, %broadcast.1829)
  %convert.321 = f32[2,8192,8,128]{3,2,1,0} convert(%multiply.272)
  %broadcast.1840 = f32[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1753), dimensions={0,1,3}
  %multiply.283 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.321, %broadcast.1840)
  %broadcast.1845 = pred[2,8192,8,128]{3,2,1,0} broadcast(%compare.268), dimensions={3}
  %slice.411 = bf16[2,8192,8,127]{3,2,1,0} slice(%multiply.272), slice={[0:2], [0:8192], [0:8], [1:128]}
  %slice.412 = bf16[2,8192,8,1]{3,2,1,0} slice(%multiply.272), slice={[0:2], [0:8192], [0:8], [0:1]}
  %concatenate.117 = bf16[2,8192,8,128]{3,2,1,0} concatenate(%slice.411, %slice.412), dimensions={3}
  %slice.413 = bf16[2,8192,8,1]{3,2,1,0} slice(%multiply.272), slice={[0:2], [0:8192], [0:8], [127:128]}
  %slice.414 = bf16[2,8192,8,127]{3,2,1,0} slice(%multiply.272), slice={[0:2], [0:8192], [0:8], [0:127]}
  %concatenate.118 = bf16[2,8192,8,128]{3,2,1,0} concatenate(%slice.413, %slice.414), dimensions={3}
  %select.367 = bf16[2,8192,8,128]{3,2,1,0} select(%broadcast.1845, %concatenate.117, %concatenate.118)
  %convert.327 = f32[2,8192,8,128]{3,2,1,0} convert(%select.367)
  %broadcast.1846 = f32[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1758), dimensions={0,1,3}
  %multiply.288 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.327, %broadcast.1846)
  %broadcast.1848 = f32[2,8192,8,128]{3,2,1,0} broadcast(%convert.311), dimensions={3}
  %multiply.289 = f32[2,8192,8,128]{3,2,1,0} multiply(%multiply.288, %broadcast.1848)
  %add.166 = f32[2,8192,8,128]{3,2,1,0} add(%multiply.283, %multiply.289)
  %convert.329 = bf16[2,8192,8,128]{3,2,1,0} convert(%add.166)
  %copy.62 = bf16[2,8192,8,128]{3,2,1,0} copy(%convert.329)
  %get-tuple-element.338 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=89
  %dynamic-slice.193 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.338, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.180 = f32[] reduce(%dynamic-slice.193, %constant.1879), dimensions={0,1}, to_apply=%region_45.2003
  %is-finite.53 = pred[] is-finite(%reduce.180)
  %reshape.1780 = pred[1]{0} reshape(%is-finite.53)
  %compare.278 = pred[] compare(%reduce.180, %constant.1873), direction=GT
  %reshape.1781 = pred[1]{0} reshape(%compare.278)
  %divide.358 = f32[] divide(%constant.1881, %reduce.180)
  %reshape.1782 = f32[1]{0} reshape(%divide.358)
  %get-tuple-element.339 = f32[80,1]{1,0} get-tuple-element(%param.45), index=90
  %dynamic-slice.194 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.339, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.359 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.194)
  %reshape.1783 = f32[1]{0} reshape(%divide.359)
  %select.368 = f32[1]{0} select(%reshape.1781, %reshape.1782, %reshape.1783)
  %select.369 = f32[1]{0} select(%reshape.1780, %select.368, %reshape.1783)
  %divide.360 = f32[1]{0} divide(%constant.1877, %select.369)
  %convert.330 = bf16[1]{0} convert(%divide.360)
  %reshape.1784 = bf16[] reshape(%convert.330)
  %broadcast.1850 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1784), dimensions={}
  %divide.361 = bf16[2,8192,8192]{2,1,0} divide(%copy.59, %broadcast.1850)
  %clamp.67 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1780, %divide.361, %broadcast.1788)
  %convert.331 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.67)
  %get-tuple-element.340 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.45), index=103
  %dynamic-slice.195 = f32[1,64,8,128]{3,2,1,0} dynamic-slice(%get-tuple-element.340, %subtract.9, %constant.1868, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,8,128}
  %convert.332 = bf16[1,64,8,128]{3,2,1,0} convert(%dynamic-slice.195)
  %get-tuple-element.341 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=91
  %dynamic-slice.196 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.341, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.181 = f32[] reduce(%dynamic-slice.196, %constant.1879), dimensions={0,1}, to_apply=%region_48.2035
  %is-finite.54 = pred[] is-finite(%reduce.181)
  %reshape.1785 = pred[1]{0} reshape(%is-finite.54)
  %compare.279 = pred[] compare(%reduce.181, %constant.1873), direction=GT
  %reshape.1786 = pred[1]{0} reshape(%compare.279)
  %divide.362 = f32[] divide(%constant.1881, %reduce.181)
  %reshape.1787 = f32[1]{0} reshape(%divide.362)
  %get-tuple-element.342 = f32[80,1]{1,0} get-tuple-element(%param.45), index=92
  %dynamic-slice.197 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.342, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.363 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.197)
  %reshape.1788 = f32[1]{0} reshape(%divide.363)
  %select.370 = f32[1]{0} select(%reshape.1786, %reshape.1787, %reshape.1788)
  %select.371 = f32[1]{0} select(%reshape.1785, %select.370, %reshape.1788)
  %divide.364 = f32[1]{0} divide(%constant.1877, %select.371)
  %convert.333 = bf16[1]{0} convert(%divide.364)
  %reshape.1789 = bf16[] reshape(%convert.333)
  %broadcast.1853 = bf16[1,64,8,128]{3,2,1,0} broadcast(%reshape.1789), dimensions={}
  %divide.366 = bf16[1,64,8,128]{3,2,1,0} divide(%convert.332, %broadcast.1853)
  %clamp.68 = bf16[1,64,8,128]{3,2,1,0} clamp(%broadcast.1825, %divide.366, %broadcast.1828)
  %convert.334 = f8e4m3fn[1,64,8,128]{3,2,1,0} convert(%clamp.68)
  %reshape.1790 = f8e4m3fn[64,8,128]{2,1,0} reshape(%convert.334)
  %all-gather.9 = f8e4m3fn[8192,8,128]{2,1,0} all-gather(%reshape.1790), channel_id=13, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.41 = bf16[2,8192,8,128]{3,2,1,0} dot(%convert.331, %all-gather.9), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.290 = f32[1]{0} multiply(%divide.360, %divide.364)
  %convert.335 = bf16[1]{0} convert(%multiply.290)
  %reshape.1791 = bf16[] reshape(%convert.335)
  %broadcast.1855 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1791), dimensions={}
  %multiply.291 = bf16[2,8192,8,128]{3,2,1,0} multiply(%dot.41, %broadcast.1855)
  %copy.63 = bf16[2,8192,8,128]{3,2,1,0} copy(%multiply.291)
  %constant.2043 = bf16[0]{0} constant({})
  %broadcast.1866 = s32[3]{0} broadcast(%constant.1868), dimensions={}
  %reshape.1798 = s32[1]{0} reshape(%constant.1901)
  %reshape.1799 = s32[1]{0} reshape(%constant.1868)
  %constant.2064 = pred[1]{0} constant({0})
  %constant.2065 = s32[1]{0} constant({2})
  %constant.2066 = s32[1]{0} constant({0})
  %select.373 = s32[1]{0} select(%constant.2064, %constant.2065, %constant.2066)
  %maximum.111 = s32[1]{0} maximum(%reshape.1799, %select.373)
  %minimum.88 = s32[1]{0} minimum(%reshape.1798, %maximum.111)
  %sort.2 = (s32[1]{0}, s32[1]{0}) sort(%minimum.88, %constant.2066), dimensions={0}, is_stable=true, to_apply=%region_1.75._custom_call_lowering_rule.1
  %get-tuple-element.344 = s32[1]{0} get-tuple-element(%sort.2), index=1
  %compare.283 = pred[1]{0} compare(%get-tuple-element.344, %constant.2066), direction=LT
  %constant.2068 = s32[1]{0} constant({1})
  %add.167 = s32[1]{0} add(%get-tuple-element.344, %constant.2068)
  %select.374 = s32[1]{0} select(%compare.283, %add.167, %get-tuple-element.344)
  %reshape.1801 = s32[1,1]{1,0} reshape(%select.374)
  %scatter.21 = s32[1]{0} scatter(%minimum.88, %reshape.1801, %constant.2066), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_2.88._custom_call_lowering_rule.1
  %compare.285 = pred[1]{0} compare(%scatter.21, %constant.2066), direction=LT
  %constant.2069 = s32[1]{0} constant({3})
  %add.168 = s32[1]{0} add(%scatter.21, %constant.2069)
  %select.375 = s32[1]{0} select(%compare.285, %add.168, %scatter.21)
  %reshape.1802 = s32[1,1]{1,0} reshape(%select.375)
  %scatter.22 = s32[3]{0} scatter(%broadcast.1866, %reshape.1802, %constant.2066), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_6.187._custom_call_lowering_rule.1
  %broadcast.1868 = s32[2]{0} broadcast(%constant.1868), dimensions={}
  %constant.2071 = pred[] constant(true)
  %broadcast.1870 = pred[3]{0} broadcast(%constant.2071), dimensions={}
  %scatter.23 = pred[3]{0} scatter(%broadcast.1870, %reshape.1802, %constant.2064), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_3.96._custom_call_lowering_rule.1
  %convert.339 = s32[3]{0} convert(%scatter.23)
  %reduce-window.0 = s32[3]{0} reduce-window(%convert.339, %constant.1868), window={size=3 pad=2_0}, to_apply=%region_4.105._custom_call_lowering_rule.1
  %maximum.112 = s32[3]{0} maximum(%broadcast.1866, %reduce-window.0)
  %compare.287 = pred[3]{0} compare(%maximum.112, %broadcast.1866), direction=LT
  %broadcast.1871 = s32[3]{0} broadcast(%constant.1901), dimensions={}
  %add.170 = s32[3]{0} add(%maximum.112, %broadcast.1871)
  %select.377 = s32[3]{0} select(%compare.287, %add.170, %maximum.112)
  %reshape.1804 = s32[3,1]{1,0} reshape(%select.377)
  %broadcast.1872 = s32[3]{0} broadcast(%constant.1863), dimensions={}
  %scatter.24 = s32[2]{0} scatter(%broadcast.1868, %reshape.1804, %broadcast.1872), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_5.124._custom_call_lowering_rule.1
  %reduce-window.1 = s32[2]{0} reduce-window(%scatter.24, %constant.1868), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule.1
  %sign.4 = s32[2]{0} sign(%reduce-window.1)
  %sign.5 = s32[] sign(%constant.1863)
  %broadcast.1873 = s32[2]{0} broadcast(%sign.5), dimensions={}
  %compare.288 = pred[2]{0} compare(%sign.4, %broadcast.1873), direction=NE
  %broadcast.1874 = s32[2]{0} broadcast(%constant.1863), dimensions={}
  %remainder.12 = s32[2]{0} remainder(%reduce-window.1, %broadcast.1874)
  %compare.289 = pred[2]{0} compare(%remainder.12, %broadcast.1868), direction=NE
  %and.87 = pred[2]{0} and(%compare.288, %compare.289)
  %divide.367 = s32[2]{0} divide(%reduce-window.1, %broadcast.1874)
  %subtract.12 = s32[2]{0} subtract(%divide.367, %broadcast.1874)
  %select.378 = s32[2]{0} select(%and.87, %subtract.12, %divide.367)
  %constant.2079 = s32[] constant(3)
  %compare.290 = pred[] compare(%constant.2079, %constant.1868), direction=EQ
  %select.379 = s32[] select(%compare.290, %constant.1863, %constant.2079)
  %broadcast.1878 = s32[2]{0} broadcast(%select.379), dimensions={}
  %remainder.13 = s32[2]{0} remainder(%select.378, %broadcast.1878)
  %compare.291 = pred[2]{0} compare(%remainder.13, %broadcast.1868), direction=LT
  %compare.292 = pred[] compare(%select.379, %constant.1868), direction=LT
  %broadcast.1880 = pred[2]{0} broadcast(%compare.292), dimensions={}
  %compare.296 = pred[2]{0} compare(%compare.291, %broadcast.1880), direction=NE
  %compare.298 = pred[2]{0} compare(%remainder.13, %broadcast.1868), direction=NE
  %and.88 = pred[2]{0} and(%compare.296, %compare.298)
  %add.171 = s32[2]{0} add(%remainder.13, %broadcast.1878)
  %select.380 = s32[2]{0} select(%and.88, %add.171, %remainder.13)
  %compare.299 = pred[2]{0} compare(%select.380, %broadcast.1868), direction=LT
  %broadcast.1882 = s32[2]{0} broadcast(%constant.2079), dimensions={}
  %add.172 = s32[2]{0} add(%select.380, %broadcast.1882)
  %select.381 = s32[2]{0} select(%compare.299, %add.172, %select.380)
  %reshape.1806 = s32[2,1]{1,0} reshape(%select.381)
  %get-tuple-element.343 = s32[2,8192]{1,0} get-tuple-element(%param.45), index=105
  %broadcast.1856 = s32[2,8192,8192]{2,1,0} broadcast(%get-tuple-element.343), dimensions={0,1}
  %broadcast.1857 = s32[2,8192,8192]{2,1,0} broadcast(%get-tuple-element.343), dimensions={0,2}
  %compare.280 = pred[2,8192,8192]{2,1,0} compare(%broadcast.1856, %broadcast.1857), direction=EQ
  %iota.21 = s32[8192,8192]{1,0} iota(), iota_dimension=1
  %iota.22 = s32[8192,8192]{1,0} iota(), iota_dimension=0
  %compare.281 = pred[8192,8192]{1,0} compare(%iota.21, %iota.22), direction=LE
  %broadcast.1859 = pred[2,8192,8192]{2,1,0} broadcast(%compare.281), dimensions={1,2}
  %and.86 = pred[2,8192,8192]{2,1,0} and(%compare.280, %broadcast.1859)
  %broadcast.1861 = f32[2,8192,8192]{2,1,0} broadcast(%constant.1873), dimensions={}
  %constant.2045 = f32[] constant(-2.38197633e+38)
  %broadcast.1862 = f32[2,8192,8192]{2,1,0} broadcast(%constant.2045), dimensions={}
  %select.372 = f32[2,8192,8192]{2,1,0} select(%and.86, %broadcast.1861, %broadcast.1862)
  %compare.282 = pred[2,8192,8192]{2,1,0} compare(%select.372, %broadcast.1861), direction=NE
  %not.3 = pred[2,8192,8192]{2,1,0} not(%compare.282)
  %convert.336 = s32[2,8192,8192]{2,1,0} convert(%not.3)
  %reduce.182 = s32[2,8192]{1,0} reduce(%convert.336, %constant.1868), dimensions={1}, to_apply=%region_51.2287
  %reshape.1792 = s32[2,1,1,8192]{3,2,1,0} reshape(%reduce.182)
  %slice.415 = s32[2,1,1,1]{3,2,1,0} slice(%reshape.1792), slice={[0:2], [0:1], [0:1], [0:1]}
  %reshape.1795 = s32[2,1]{1,0} reshape(%slice.415)
  %reshape.1808 = s32[2]{0} reshape(%reshape.1795)
  %compare.300 = pred[2]{0} compare(%reshape.1808, %broadcast.1868), direction=LT
  %constant.2087 = s32[] constant(-1)
  %broadcast.1883 = s32[2]{0} broadcast(%constant.2087), dimensions={}
  %reduce-window.2 = s32[2]{0} reduce-window(%reshape.1808, %constant.1868), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule.1.clone
  %select.382 = s32[2]{0} select(%compare.300, %broadcast.1883, %reduce-window.2)
  %scatter.25 = s32[3]{0} scatter(%scatter.22, %reshape.1806, %select.382), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_7.195._custom_call_lowering_rule.1
  %reduce.183 = s32[2,8192]{1,0} reduce(%convert.336, %constant.1868), dimensions={2}, to_apply=%region_52.2295
  %reshape.1796 = s32[2,1,1,8192]{3,2,1,0} reshape(%reduce.183)
  %constant.2058 = s32[] constant(-2147483648)
  %reduce.184 = s32[2,1]{1,0} reduce(%reshape.1796, %constant.2058), dimensions={3,2}, to_apply=%region_53.2300
  %reshape.1816 = s32[2]{0} reshape(%reduce.184)
  %compare.313 = pred[2]{0} compare(%reshape.1816, %broadcast.1868), direction=LT
  %reduce-window.11 = s32[2]{0} reduce-window(%reshape.1816, %constant.1868), window={size=2 pad=1_0}, to_apply=%region_0.39._custom_call_lowering_rule.1.clone.1
  %select.394 = s32[2]{0} select(%compare.313, %broadcast.1883, %reduce-window.11)
  %scatter.30 = s32[3]{0} scatter(%scatter.22, %reshape.1806, %select.394), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=1, to_apply=%region_12.249._custom_call_lowering_rule.1
  %constant.2059 = u32[] constant(0)
  %broadcast.1864 = u32[512]{0} broadcast(%constant.2059), dimensions={}
  %constant.2060 = s32[256]{0} constant({0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 510})
  %partition-id.3 = u32[] partition-id()
  %dynamic-slice.199 = s32[1]{0} dynamic-slice(%constant.2060, %partition-id.3), dynamic_slice_sizes={1}
  %reshape.1797 = s32[] reshape(%dynamic-slice.199)
  %dynamic-slice.200 = u32[2]{0} dynamic-slice(%broadcast.1864, %reshape.1797), dynamic_slice_sizes={2}
  %custom-call.40 = (bf16[2,8192,64,128]{3,2,1,0}, f32[2,64,8192,1]{3,2,1,0}, u32[2,4]{1,0}, u8[48]{0}) custom-call(%copy.60, %copy.62, %copy.63, %constant.2043, %scatter.25, /*index=5*/%scatter.30, %constant.2043, %constant.2043, %dynamic-slice.200), custom_call_target="te_fused_attn_forward_ffi", operand_layout_constraints={bf16[2,8192,64,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[0]{0}, s32[3]{0}, s32[3]{0}, bf16[0]{0}, bf16[0]{0}, u32[2]{0}}, api_version=API_VERSION_TYPED_FFI, backend_config={attn_heads = 64 : i64, bias_batch = 0 : i64, bias_heads = 0 : i64, bias_type = 0 : i64, deterministic = false, dropout_probability = 0.000000e+00 : f64, head_dim = 128 : i64, input_batch = 2 : i64, is_training = true, kv_max_seqlen = 8192 : i64, mask_type = 3 : i64, max_segments_per_seq = 1 : i64, num_gqa_groups = 8 : i64, q_max_seqlen = 8192 : i64, qkv_layout = 9 : i64, scaling_factor = 1.000000e+00 : f64, window_size_left = -1 : i64, window_size_right = -1 : i64}
  %get-tuple-element.349 = bf16[2,8192,64,128]{3,2,1,0} get-tuple-element(%custom-call.40), index=0
  %copy.64 = bf16[2,8192,64,128]{3,2,1,0} copy(%get-tuple-element.349)
  %get-tuple-element.350 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=77
  %dynamic-slice.201 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.350, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.185 = f32[] reduce(%dynamic-slice.201, %constant.1879), dimensions={0,1}, to_apply=%region_54.2311
  %is-finite.55 = pred[] is-finite(%reduce.185)
  %reshape.1817 = pred[1]{0} reshape(%is-finite.55)
  %compare.314 = pred[] compare(%reduce.185, %constant.1873), direction=GT
  %reshape.1818 = pred[1]{0} reshape(%compare.314)
  %divide.371 = f32[] divide(%constant.1881, %reduce.185)
  %reshape.1819 = f32[1]{0} reshape(%divide.371)
  %get-tuple-element.351 = f32[80,1]{1,0} get-tuple-element(%param.45), index=78
  %dynamic-slice.202 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.351, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.372 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.202)
  %reshape.1820 = f32[1]{0} reshape(%divide.372)
  %select.395 = f32[1]{0} select(%reshape.1818, %reshape.1819, %reshape.1820)
  %select.396 = f32[1]{0} select(%reshape.1817, %select.395, %reshape.1820)
  %divide.373 = f32[1]{0} divide(%constant.1877, %select.396)
  %convert.341 = bf16[1]{0} convert(%divide.373)
  %reshape.1821 = bf16[] reshape(%convert.341)
  %broadcast.1895 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1821), dimensions={}
  %divide.374 = bf16[2,8192,64,128]{3,2,1,0} divide(%copy.64, %broadcast.1895)
  %broadcast.1896 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.69 = bf16[2,8192,64,128]{3,2,1,0} clamp(%broadcast.1781, %divide.374, %broadcast.1896)
  %convert.342 = f8e4m3fn[2,8192,64,128]{3,2,1,0} convert(%clamp.69)
  %broadcast.1897 = bf16[1,64,128,64]{3,2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.352 = f32[80,64,128,64]{3,2,1,0} get-tuple-element(%param.45), index=101
  %dynamic-slice.203 = f32[1,64,128,64]{3,2,1,0} dynamic-slice(%get-tuple-element.352, %subtract.9, %constant.1868, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,128,64}
  %convert.343 = bf16[1,64,128,64]{3,2,1,0} convert(%dynamic-slice.203)
  %get-tuple-element.353 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=79
  %dynamic-slice.204 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.353, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.186 = f32[] reduce(%dynamic-slice.204, %constant.1879), dimensions={0,1}, to_apply=%region_57.2351
  %is-finite.56 = pred[] is-finite(%reduce.186)
  %reshape.1822 = pred[1]{0} reshape(%is-finite.56)
  %compare.315 = pred[] compare(%reduce.186, %constant.1873), direction=GT
  %reshape.1823 = pred[1]{0} reshape(%compare.315)
  %divide.376 = f32[] divide(%constant.1881, %reduce.186)
  %reshape.1824 = f32[1]{0} reshape(%divide.376)
  %get-tuple-element.354 = f32[80,1]{1,0} get-tuple-element(%param.45), index=80
  %dynamic-slice.205 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.354, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.378 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.205)
  %reshape.1825 = f32[1]{0} reshape(%divide.378)
  %select.397 = f32[1]{0} select(%reshape.1823, %reshape.1824, %reshape.1825)
  %select.398 = f32[1]{0} select(%reshape.1822, %select.397, %reshape.1825)
  %divide.379 = f32[1]{0} divide(%constant.1877, %select.398)
  %convert.344 = bf16[1]{0} convert(%divide.379)
  %reshape.1827 = bf16[] reshape(%convert.344)
  %broadcast.1899 = bf16[1,64,128,64]{3,2,1,0} broadcast(%reshape.1827), dimensions={}
  %divide.381 = bf16[1,64,128,64]{3,2,1,0} divide(%convert.343, %broadcast.1899)
  %broadcast.1901 = bf16[1,64,128,64]{3,2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.70 = bf16[1,64,128,64]{3,2,1,0} clamp(%broadcast.1897, %divide.381, %broadcast.1901)
  %convert.345 = f8e4m3fn[1,64,128,64]{3,2,1,0} convert(%clamp.70)
  %reshape.1828 = f8e4m3fn[64,128,64]{2,1,0} reshape(%convert.345)
  %all-gather.10 = f8e4m3fn[64,128,8192]{2,1,0} all-gather(%reshape.1828), channel_id=14, replica_groups=[2,128]<=[256], dimensions={2}, use_global_device_ids=true
  %dot.42 = bf16[2,8192,8192]{2,1,0} dot(%convert.342, %all-gather.10), lhs_contracting_dims={2,3}, rhs_contracting_dims={0,1}
  %multiply.293 = f32[1]{0} multiply(%divide.373, %divide.379)
  %convert.346 = bf16[1]{0} convert(%multiply.293)
  %reshape.1829 = bf16[] reshape(%convert.346)
  %broadcast.1902 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1829), dimensions={}
  %multiply.294 = bf16[2,8192,8192]{2,1,0} multiply(%dot.42, %broadcast.1902)
  %copy.65 = bf16[2,8192,8192]{2,1,0} copy(%multiply.294)
  %add.179 = bf16[2,8192,8192]{2,1,0} add(%copy.57, %copy.65)
  %convert.347 = f32[2,8192,8192]{2,1,0} convert(%add.179)
  %multiply.295 = f32[2,8192,8192]{2,1,0} multiply(%convert.347, %convert.347)
  %reduce.187 = f32[2,8192]{1,0} reduce(%multiply.295, %constant.1873), dimensions={2}, to_apply=%region_60.2403
  %multiply.296 = f32[2,8192]{1,0} multiply(%reduce.187, %broadcast.1783)
  %add.180 = f32[2,8192]{1,0} add(%multiply.296, %broadcast.1784)
  %reshape.1830 = f32[2,8192,1]{2,1,0} reshape(%add.180)
  %rsqrt.9 = f32[2,8192,1]{2,1,0} rsqrt(%reshape.1830)
  %reshape.1831 = f32[2,8192]{1,0} reshape(%rsqrt.9)
  %broadcast.1906 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.1831), dimensions={0,1}
  %multiply.297 = f32[2,8192,8192]{2,1,0} multiply(%convert.347, %broadcast.1906)
  %convert.348 = bf16[2,8192,8192]{2,1,0} convert(%multiply.297)
  %get-tuple-element.355 = f32[80,8192]{1,0} get-tuple-element(%param.45), index=98
  %dynamic-slice.206 = f32[1,8192]{1,0} dynamic-slice(%get-tuple-element.355, %subtract.9, %constant.1868), dynamic_slice_sizes={1,8192}
  %convert.349 = bf16[1,8192]{1,0} convert(%dynamic-slice.206)
  %reshape.1832 = bf16[8192]{0} reshape(%convert.349)
  %broadcast.1908 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1832), dimensions={2}
  %multiply.298 = bf16[2,8192,8192]{2,1,0} multiply(%convert.348, %broadcast.1908)
  %copy.66 = bf16[2,8192,8192]{2,1,0} copy(%multiply.298)
  %get-tuple-element.356 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=53
  %dynamic-slice.207 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.356, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.188 = f32[] reduce(%dynamic-slice.207, %constant.1879), dimensions={0,1}, to_apply=%region_61.2427
  %is-finite.57 = pred[] is-finite(%reduce.188)
  %reshape.1833 = pred[1]{0} reshape(%is-finite.57)
  %compare.316 = pred[] compare(%reduce.188, %constant.1873), direction=GT
  %reshape.1834 = pred[1]{0} reshape(%compare.316)
  %divide.382 = f32[] divide(%constant.1881, %reduce.188)
  %reshape.1835 = f32[1]{0} reshape(%divide.382)
  %get-tuple-element.357 = f32[80,1]{1,0} get-tuple-element(%param.45), index=54
  %dynamic-slice.208 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.357, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.384 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.208)
  %reshape.1836 = f32[1]{0} reshape(%divide.384)
  %select.399 = f32[1]{0} select(%reshape.1834, %reshape.1835, %reshape.1836)
  %select.400 = f32[1]{0} select(%reshape.1833, %select.399, %reshape.1836)
  %divide.385 = f32[1]{0} divide(%constant.1877, %select.400)
  %convert.350 = bf16[1]{0} convert(%divide.385)
  %reshape.1837 = bf16[] reshape(%convert.350)
  %broadcast.1909 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1837), dimensions={}
  %divide.386 = bf16[2,8192,8192]{2,1,0} divide(%copy.66, %broadcast.1909)
  %clamp.71 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1780, %divide.386, %broadcast.1788)
  %convert.351 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.71)
  %broadcast.1911 = bf16[1,64,28672]{2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.358 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.45), index=95
  %dynamic-slice.209 = f32[1,64,28672]{2,1,0} dynamic-slice(%get-tuple-element.358, %subtract.9, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,28672}
  %convert.353 = bf16[1,64,28672]{2,1,0} convert(%dynamic-slice.209)
  %get-tuple-element.359 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=55
  %dynamic-slice.210 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.359, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.189 = f32[] reduce(%dynamic-slice.210, %constant.1879), dimensions={0,1}, to_apply=%region_64.2459
  %is-finite.58 = pred[] is-finite(%reduce.189)
  %reshape.1838 = pred[1]{0} reshape(%is-finite.58)
  %compare.317 = pred[] compare(%reduce.189, %constant.1873), direction=GT
  %reshape.1839 = pred[1]{0} reshape(%compare.317)
  %divide.387 = f32[] divide(%constant.1881, %reduce.189)
  %reshape.1840 = f32[1]{0} reshape(%divide.387)
  %get-tuple-element.360 = f32[80,1]{1,0} get-tuple-element(%param.45), index=56
  %dynamic-slice.211 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.360, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.389 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.211)
  %reshape.1841 = f32[1]{0} reshape(%divide.389)
  %select.401 = f32[1]{0} select(%reshape.1839, %reshape.1840, %reshape.1841)
  %select.402 = f32[1]{0} select(%reshape.1838, %select.401, %reshape.1841)
  %divide.390 = f32[1]{0} divide(%constant.1877, %select.402)
  %convert.354 = bf16[1]{0} convert(%divide.390)
  %reshape.1842 = bf16[] reshape(%convert.354)
  %broadcast.1912 = bf16[1,64,28672]{2,1,0} broadcast(%reshape.1842), dimensions={}
  %divide.391 = bf16[1,64,28672]{2,1,0} divide(%convert.353, %broadcast.1912)
  %broadcast.1913 = bf16[1,64,28672]{2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.72 = bf16[1,64,28672]{2,1,0} clamp(%broadcast.1911, %divide.391, %broadcast.1913)
  %convert.355 = f8e4m3fn[1,64,28672]{2,1,0} convert(%clamp.72)
  %reshape.1843 = f8e4m3fn[64,28672]{1,0} reshape(%convert.355)
  %all-gather.11 = f8e4m3fn[8192,28672]{1,0} all-gather(%reshape.1843), channel_id=15, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.43 = bf16[2,8192,28672]{2,1,0} dot(%convert.351, %all-gather.11), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.299 = f32[1]{0} multiply(%divide.385, %divide.390)
  %convert.356 = bf16[1]{0} convert(%multiply.299)
  %reshape.1844 = bf16[] reshape(%convert.356)
  %broadcast.1914 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1844), dimensions={}
  %multiply.300 = bf16[2,8192,28672]{2,1,0} multiply(%dot.43, %broadcast.1914)
  %constant.2143 = bf16[] constant(1)
  %broadcast.1916 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.2143), dimensions={}
  %negate.29 = bf16[2,8192,28672]{2,1,0} negate(%multiply.300)
  %exponential.5 = bf16[2,8192,28672]{2,1,0} exponential(%negate.29)
  %add.181 = bf16[2,8192,28672]{2,1,0} add(%exponential.5, %broadcast.1916)
  %divide.392 = bf16[2,8192,28672]{2,1,0} divide(%broadcast.1916, %add.181)
  %multiply.301 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.300, %divide.392)
  %broadcast.1918 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.1864), dimensions={}
  %copy.67 = bf16[2,8192,8192]{2,1,0} copy(%copy.56)
  %get-tuple-element.361 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=69
  %dynamic-slice.212 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.361, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.190 = f32[] reduce(%dynamic-slice.212, %constant.1879), dimensions={0,1}, to_apply=%region_79.2679
  %is-finite.59 = pred[] is-finite(%reduce.190)
  %reshape.1845 = pred[1]{0} reshape(%is-finite.59)
  %compare.318 = pred[] compare(%reduce.190, %constant.1873), direction=GT
  %reshape.1846 = pred[1]{0} reshape(%compare.318)
  %constant.2149 = f32[] constant(57344)
  %divide.393 = f32[] divide(%constant.2149, %reduce.190)
  %reshape.1847 = f32[1]{0} reshape(%divide.393)
  %get-tuple-element.362 = f32[80,1]{1,0} get-tuple-element(%param.45), index=70
  %dynamic-slice.213 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.362, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.394 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.213)
  %reshape.1848 = f32[1]{0} reshape(%divide.394)
  %select.403 = f32[1]{0} select(%reshape.1846, %reshape.1847, %reshape.1848)
  %select.404 = f32[1]{0} select(%reshape.1845, %select.403, %reshape.1848)
  %divide.395 = f32[1]{0} divide(%constant.1877, %select.404)
  %convert.357 = bf16[1]{0} convert(%divide.395)
  %reshape.1849 = bf16[] reshape(%convert.357)
  %broadcast.1919 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1849), dimensions={}
  %divide.396 = bf16[2,8192,8192]{2,1,0} divide(%copy.67, %broadcast.1919)
  %constant.2152 = bf16[] constant(5.734e+04)
  %broadcast.1920 = bf16[2,8192,8192]{2,1,0} broadcast(%constant.2152), dimensions={}
  %clamp.73 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1918, %divide.396, %broadcast.1920)
  %convert.358 = f8e5m2[2,8192,8192]{2,1,0} convert(%clamp.73)
  %broadcast.1921 = bf16[1,28672,64]{2,1,0} broadcast(%constant.1865), dimensions={}
  %get-tuple-element.363 = f32[80,28672,64]{2,1,0} get-tuple-element(%param.45), index=97
  %dynamic-slice.214 = f32[1,28672,64]{2,1,0} dynamic-slice(%get-tuple-element.363, %subtract.9, %constant.1868, %constant.1868), dynamic_slice_sizes={1,28672,64}
  %convert.359 = bf16[1,28672,64]{2,1,0} convert(%dynamic-slice.214)
  %get-tuple-element.364 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=67
  %dynamic-slice.215 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.364, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.191 = f32[] reduce(%dynamic-slice.215, %constant.1879), dimensions={0,1}, to_apply=%region_76.2637
  %is-finite.60 = pred[] is-finite(%reduce.191)
  %reshape.1850 = pred[1]{0} reshape(%is-finite.60)
  %compare.320 = pred[] compare(%reduce.191, %constant.1873), direction=GT
  %reshape.1851 = pred[1]{0} reshape(%compare.320)
  %divide.398 = f32[] divide(%constant.1881, %reduce.191)
  %reshape.1852 = f32[1]{0} reshape(%divide.398)
  %get-tuple-element.365 = f32[80,1]{1,0} get-tuple-element(%param.45), index=68
  %dynamic-slice.216 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.365, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.399 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.216)
  %reshape.1853 = f32[1]{0} reshape(%divide.399)
  %select.405 = f32[1]{0} select(%reshape.1851, %reshape.1852, %reshape.1853)
  %select.406 = f32[1]{0} select(%reshape.1850, %select.405, %reshape.1853)
  %divide.400 = f32[1]{0} divide(%constant.1877, %select.406)
  %convert.360 = bf16[1]{0} convert(%divide.400)
  %reshape.1854 = bf16[] reshape(%convert.360)
  %broadcast.1922 = bf16[1,28672,64]{2,1,0} broadcast(%reshape.1854), dimensions={}
  %divide.401 = bf16[1,28672,64]{2,1,0} divide(%convert.359, %broadcast.1922)
  %broadcast.1923 = bf16[1,28672,64]{2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.74 = bf16[1,28672,64]{2,1,0} clamp(%broadcast.1921, %divide.401, %broadcast.1923)
  %convert.361 = f8e4m3fn[1,28672,64]{2,1,0} convert(%clamp.74)
  %reshape.1855 = f8e4m3fn[28672,64]{1,0} reshape(%convert.361)
  %all-gather.12 = f8e4m3fn[28672,8192]{1,0} all-gather(%reshape.1855), channel_id=16, replica_groups=[2,128]<=[256], dimensions={1}, use_global_device_ids=true
  %dot.44 = bf16[2,8192,28672]{2,1,0} dot(%convert.358, %all-gather.12), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}
  %multiply.302 = f32[1]{0} multiply(%divide.400, %divide.395)
  %convert.362 = bf16[1]{0} convert(%multiply.302)
  %reshape.1856 = bf16[] reshape(%convert.362)
  %broadcast.1924 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1856), dimensions={}
  %multiply.303 = bf16[2,8192,28672]{2,1,0} multiply(%dot.44, %broadcast.1924)
  %copy.68 = bf16[2,8192,28672]{2,1,0} copy(%multiply.303)
  %multiply.304 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.301, %copy.68)
  %get-tuple-element.366 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=63
  %dynamic-slice.217 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.366, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.192 = f32[] reduce(%dynamic-slice.217, %constant.1879), dimensions={0,1}, to_apply=%region_82.2756
  %is-finite.61 = pred[] is-finite(%reduce.192)
  %reshape.1857 = pred[1]{0} reshape(%is-finite.61)
  %compare.322 = pred[] compare(%reduce.192, %constant.1873), direction=GT
  %reshape.1858 = pred[1]{0} reshape(%compare.322)
  %divide.402 = f32[] divide(%constant.2149, %reduce.192)
  %reshape.1860 = f32[1]{0} reshape(%divide.402)
  %get-tuple-element.367 = f32[80,1]{1,0} get-tuple-element(%param.45), index=64
  %dynamic-slice.218 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.367, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.403 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.218)
  %reshape.1861 = f32[1]{0} reshape(%divide.403)
  %select.407 = f32[1]{0} select(%reshape.1858, %reshape.1860, %reshape.1861)
  %select.408 = f32[1]{0} select(%reshape.1857, %select.407, %reshape.1861)
  %divide.404 = f32[1]{0} divide(%constant.1877, %select.408)
  %convert.363 = bf16[1]{0} convert(%divide.404)
  %reshape.1862 = bf16[] reshape(%convert.363)
  %broadcast.1925 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1862), dimensions={}
  %divide.405 = bf16[2,8192,28672]{2,1,0} divide(%multiply.304, %broadcast.1925)
  %broadcast.1926 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.2152), dimensions={}
  %clamp.75 = bf16[2,8192,28672]{2,1,0} clamp(%broadcast.1779, %divide.405, %broadcast.1926)
  %convert.365 = f8e5m2[2,8192,28672]{2,1,0} convert(%clamp.75)
  %get-tuple-element.368 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.45), index=96
  %dynamic-slice.219 = f32[1,64,28672]{2,1,0} dynamic-slice(%get-tuple-element.368, %subtract.9, %constant.1868, %constant.1868), dynamic_slice_sizes={1,64,28672}
  %convert.366 = bf16[1,64,28672]{2,1,0} convert(%dynamic-slice.219)
  %get-tuple-element.369 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=61
  %dynamic-slice.220 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.369, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.193 = f32[] reduce(%dynamic-slice.220, %constant.1879), dimensions={0,1}, to_apply=%region_70.2555
  %is-finite.62 = pred[] is-finite(%reduce.193)
  %reshape.1863 = pred[1]{0} reshape(%is-finite.62)
  %compare.323 = pred[] compare(%reduce.193, %constant.1873), direction=GT
  %reshape.1864 = pred[1]{0} reshape(%compare.323)
  %divide.406 = f32[] divide(%constant.1881, %reduce.193)
  %reshape.1865 = f32[1]{0} reshape(%divide.406)
  %get-tuple-element.370 = f32[80,1]{1,0} get-tuple-element(%param.45), index=62
  %dynamic-slice.221 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.370, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.407 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.221)
  %reshape.1866 = f32[1]{0} reshape(%divide.407)
  %select.409 = f32[1]{0} select(%reshape.1864, %reshape.1865, %reshape.1866)
  %select.410 = f32[1]{0} select(%reshape.1863, %select.409, %reshape.1866)
  %divide.408 = f32[1]{0} divide(%constant.1877, %select.410)
  %convert.367 = bf16[1]{0} convert(%divide.408)
  %reshape.1867 = bf16[] reshape(%convert.367)
  %broadcast.1928 = bf16[1,64,28672]{2,1,0} broadcast(%reshape.1867), dimensions={}
  %divide.409 = bf16[1,64,28672]{2,1,0} divide(%convert.366, %broadcast.1928)
  %clamp.76 = bf16[1,64,28672]{2,1,0} clamp(%broadcast.1911, %divide.409, %broadcast.1913)
  %convert.368 = f8e4m3fn[1,64,28672]{2,1,0} convert(%clamp.76)
  %reshape.1868 = f8e4m3fn[64,28672]{1,0} reshape(%convert.368)
  %all-gather.13 = f8e4m3fn[8192,28672]{1,0} all-gather(%reshape.1868), channel_id=17, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.45 = bf16[2,8192,8192]{2,1,0} dot(%convert.365, %all-gather.13), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}
  %multiply.305 = f32[1]{0} multiply(%divide.408, %divide.404)
  %convert.369 = bf16[1]{0} convert(%multiply.305)
  %reshape.1869 = bf16[] reshape(%convert.369)
  %broadcast.1930 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1869), dimensions={}
  %multiply.306 = bf16[2,8192,8192]{2,1,0} multiply(%dot.45, %broadcast.1930)
  %get-tuple-element.371 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=59
  %dynamic-slice.222 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.371, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.194 = f32[] reduce(%dynamic-slice.222, %constant.1879), dimensions={0,1}, to_apply=%region_67.2523
  %is-finite.63 = pred[] is-finite(%reduce.194)
  %reshape.1870 = pred[1]{0} reshape(%is-finite.63)
  %compare.324 = pred[] compare(%reduce.194, %constant.1873), direction=GT
  %reshape.1871 = pred[1]{0} reshape(%compare.324)
  %divide.410 = f32[] divide(%constant.1881, %reduce.194)
  %reshape.1872 = f32[1]{0} reshape(%divide.410)
  %get-tuple-element.372 = f32[80,1]{1,0} get-tuple-element(%param.45), index=60
  %dynamic-slice.223 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.372, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.411 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.223)
  %reshape.1873 = f32[1]{0} reshape(%divide.411)
  %select.411 = f32[1]{0} select(%reshape.1871, %reshape.1872, %reshape.1873)
  %select.412 = f32[1]{0} select(%reshape.1870, %select.411, %reshape.1873)
  %divide.412 = f32[1]{0} divide(%constant.1877, %select.412)
  %convert.370 = bf16[1]{0} convert(%divide.412)
  %reshape.1874 = bf16[] reshape(%convert.370)
  %broadcast.1933 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1874), dimensions={}
  %divide.413 = bf16[2,8192,8192]{2,1,0} divide(%copy.66, %broadcast.1933)
  %clamp.77 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1780, %divide.413, %broadcast.1788)
  %convert.371 = f8e4m3fn[2,8192,8192]{2,1,0} convert(%clamp.77)
  %dot.46 = bf16[2,8192,28672]{2,1,0} dot(%convert.371, %all-gather.13), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %multiply.307 = f32[1]{0} multiply(%divide.412, %divide.408)
  %convert.373 = bf16[1]{0} convert(%multiply.307)
  %reshape.1875 = bf16[] reshape(%convert.373)
  %broadcast.1935 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1875), dimensions={}
  %multiply.308 = bf16[2,8192,28672]{2,1,0} multiply(%dot.46, %broadcast.1935)
  %multiply.309 = bf16[2,8192,28672]{2,1,0} multiply(%copy.68, %multiply.308)
  %multiply.310 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.309, %divide.392)
  %multiply.312 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.300, %multiply.309)
  %subtract.14 = bf16[2,8192,28672]{2,1,0} subtract(%broadcast.1916, %divide.392)
  %multiply.313 = bf16[2,8192,28672]{2,1,0} multiply(%divide.392, %subtract.14)
  %multiply.314 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.312, %multiply.313)
  %add.183 = bf16[2,8192,28672]{2,1,0} add(%multiply.310, %multiply.314)
  %get-tuple-element.373 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=57
  %dynamic-slice.224 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.373, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.195 = f32[] reduce(%dynamic-slice.224, %constant.1879), dimensions={0,1}, to_apply=%region_85.2822
  %is-finite.64 = pred[] is-finite(%reduce.195)
  %reshape.1876 = pred[1]{0} reshape(%is-finite.64)
  %compare.325 = pred[] compare(%reduce.195, %constant.1873), direction=GT
  %reshape.1877 = pred[1]{0} reshape(%compare.325)
  %divide.414 = f32[] divide(%constant.2149, %reduce.195)
  %reshape.1878 = f32[1]{0} reshape(%divide.414)
  %get-tuple-element.374 = f32[80,1]{1,0} get-tuple-element(%param.45), index=58
  %dynamic-slice.225 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.374, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.415 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.225)
  %reshape.1879 = f32[1]{0} reshape(%divide.415)
  %select.413 = f32[1]{0} select(%reshape.1877, %reshape.1878, %reshape.1879)
  %select.414 = f32[1]{0} select(%reshape.1876, %select.413, %reshape.1879)
  %divide.416 = f32[1]{0} divide(%constant.1877, %select.414)
  %convert.375 = bf16[1]{0} convert(%divide.416)
  %reshape.1880 = bf16[] reshape(%convert.375)
  %broadcast.1936 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1880), dimensions={}
  %divide.417 = bf16[2,8192,28672]{2,1,0} divide(%add.183, %broadcast.1936)
  %clamp.78 = bf16[2,8192,28672]{2,1,0} clamp(%broadcast.1779, %divide.417, %broadcast.1926)
  %convert.376 = f8e5m2[2,8192,28672]{2,1,0} convert(%clamp.78)
  %dot.47 = bf16[2,8192,8192]{2,1,0} dot(%convert.376, %all-gather.11), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}
  %multiply.315 = f32[1]{0} multiply(%divide.390, %divide.416)
  %convert.377 = bf16[1]{0} convert(%multiply.315)
  %reshape.1881 = bf16[] reshape(%convert.377)
  %broadcast.1938 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1881), dimensions={}
  %multiply.316 = bf16[2,8192,8192]{2,1,0} multiply(%dot.47, %broadcast.1938)
  %add.184 = bf16[2,8192,8192]{2,1,0} add(%multiply.306, %multiply.316)
  %copy.69 = bf16[2,8192,8192]{2,1,0} copy(%add.184)
  %multiply.317 = bf16[2,8192,8192]{2,1,0} multiply(%copy.69, %broadcast.1908)
  %convert.378 = f32[2,8192,8192]{2,1,0} convert(%multiply.317)
  %multiply.318 = f32[2,8192,8192]{2,1,0} multiply(%convert.378, %broadcast.1906)
  %multiply.319 = f32[2,8192,8192]{2,1,0} multiply(%convert.347, %convert.378)
  %reduce.196 = f32[2,8192]{1,0} reduce(%multiply.319, %constant.1873), dimensions={2}, to_apply=%region_90.2891
  %reshape.1884 = f32[2,8192,1]{2,1,0} reshape(%reduce.196)
  %divide.418 = f32[2,8192,1]{2,1,0} divide(%rsqrt.9, %reshape.1830)
  %constant.2204 = f32[] constant(-0.5)
  %broadcast.1941 = f32[2,8192,1]{2,1,0} broadcast(%constant.2204), dimensions={}
  %multiply.320 = f32[2,8192,1]{2,1,0} multiply(%divide.418, %broadcast.1941)
  %multiply.321 = f32[2,8192,1]{2,1,0} multiply(%reshape.1884, %multiply.320)
  %constant.2205 = f32[] constant(0.000244140625)
  %broadcast.1942 = f32[2,8192,1]{2,1,0} broadcast(%constant.2205), dimensions={}
  %multiply.322 = f32[2,8192,1]{2,1,0} multiply(%multiply.321, %broadcast.1942)
  %reshape.1885 = f32[2,8192]{1,0} reshape(%multiply.322)
  %broadcast.1943 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.1885), dimensions={0,1}
  %multiply.323 = f32[2,8192,8192]{2,1,0} multiply(%convert.347, %broadcast.1943)
  %add.185 = f32[2,8192,8192]{2,1,0} add(%multiply.318, %multiply.323)
  %convert.379 = bf16[2,8192,8192]{2,1,0} convert(%add.185)
  %add.186 = bf16[2,8192,8192]{2,1,0} add(%copy.56, %convert.379)
  %broadcast.1944 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%constant.1864), dimensions={}
  %get-tuple-element.375 = f32[2,64,8192,1]{3,2,1,0} get-tuple-element(%custom-call.40), index=1
  %get-tuple-element.376 = u32[2,4]{1,0} get-tuple-element(%custom-call.40), index=2
  %copy.70 = bf16[2,8192,8192]{2,1,0} copy(%add.186)
  %get-tuple-element.377 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=81
  %dynamic-slice.226 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.377, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.197 = f32[] reduce(%dynamic-slice.226, %constant.1879), dimensions={0,1}, to_apply=%region_92.2914
  %is-finite.65 = pred[] is-finite(%reduce.197)
  %reshape.1886 = pred[1]{0} reshape(%is-finite.65)
  %compare.326 = pred[] compare(%reduce.197, %constant.1873), direction=GT
  %reshape.1887 = pred[1]{0} reshape(%compare.326)
  %divide.419 = f32[] divide(%constant.2149, %reduce.197)
  %reshape.1888 = f32[1]{0} reshape(%divide.419)
  %get-tuple-element.378 = f32[80,1]{1,0} get-tuple-element(%param.45), index=82
  %dynamic-slice.227 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.378, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.420 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.227)
  %reshape.1889 = f32[1]{0} reshape(%divide.420)
  %select.415 = f32[1]{0} select(%reshape.1887, %reshape.1888, %reshape.1889)
  %select.416 = f32[1]{0} select(%reshape.1886, %select.415, %reshape.1889)
  %divide.421 = f32[1]{0} divide(%constant.1877, %select.416)
  %convert.380 = bf16[1]{0} convert(%divide.421)
  %reshape.1890 = bf16[] reshape(%convert.380)
  %broadcast.1947 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1890), dimensions={}
  %divide.422 = bf16[2,8192,8192]{2,1,0} divide(%copy.70, %broadcast.1947)
  %clamp.79 = bf16[2,8192,8192]{2,1,0} clamp(%broadcast.1918, %divide.422, %broadcast.1920)
  %convert.381 = f8e5m2[2,8192,8192]{2,1,0} convert(%clamp.79)
  %dot.48 = bf16[2,8192,64,128]{3,2,1,0} dot(%convert.381, %all-gather.10), lhs_contracting_dims={2}, rhs_contracting_dims={2}, operand_precision={highest,highest}
  %multiply.324 = f32[1]{0} multiply(%divide.379, %divide.421)
  %convert.382 = bf16[1]{0} convert(%multiply.324)
  %reshape.1891 = bf16[] reshape(%convert.382)
  %broadcast.1950 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1891), dimensions={}
  %multiply.325 = bf16[2,8192,64,128]{3,2,1,0} multiply(%dot.48, %broadcast.1950)
  %copy.71 = bf16[2,8192,64,128]{3,2,1,0} copy(%multiply.325)
  %custom-call.254 = (bf16[2,8192,64,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[0]{0}, u8[1077936176]{0}) custom-call(%copy.60, %copy.62, %copy.63, %constant.2043, %get-tuple-element.375, /*index=5*/%get-tuple-element.376, %get-tuple-element.349, %copy.71, %scatter.25, %scatter.30, /*index=10*/%constant.2043, %constant.2043), custom_call_target="te_fused_attn_backward_ffi", operand_layout_constraints={bf16[2,8192,64,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[2,8192,8,128]{3,2,1,0}, bf16[0]{0}, f32[2,64,8192,1]{3,2,1,0}, u32[2,4]{1,0}, bf16[2,8192,64,128]{3,2,1,0}, bf16[2,8192,64,128]{3,2,1,0}, s32[3]{0}, s32[3]{0}, bf16[0]{0}, bf16[0]{0}}, api_version=API_VERSION_TYPED_FFI, backend_config={attn_heads = 64 : i64, bias_batch = 0 : i64, bias_heads = 0 : i64, bias_type = 0 : i64, deterministic = false, dropout_probability = 0.000000e+00 : f64, head_dim = 128 : i64, input_batch = 2 : i64, is_training = true, kv_max_seqlen = 8192 : i64, mask_type = 3 : i64, max_segments_per_seq = 1 : i64, num_gqa_groups = 8 : i64, q_max_seqlen = 8192 : i64, qkv_layout = 9 : i64, scaling_factor = 1.000000e+00 : f64, window_size_left = -1 : i64, window_size_right = -1 : i64}
  %get-tuple-element.385 = bf16[2,8192,8,128]{3,2,1,0} get-tuple-element(%custom-call.254), index=2
  %copy.72 = bf16[2,8192,8,128]{3,2,1,0} copy(%get-tuple-element.385)
  %get-tuple-element.386 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=93
  %dynamic-slice.228 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.386, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.198 = f32[] reduce(%dynamic-slice.228, %constant.1879), dimensions={0,1}, to_apply=%region_95.3033
  %is-finite.66 = pred[] is-finite(%reduce.198)
  %reshape.1909 = pred[1]{0} reshape(%is-finite.66)
  %compare.355 = pred[] compare(%reduce.198, %constant.1873), direction=GT
  %reshape.1910 = pred[1]{0} reshape(%compare.355)
  %divide.425 = f32[] divide(%constant.2149, %reduce.198)
  %reshape.1911 = f32[1]{0} reshape(%divide.425)
  %get-tuple-element.387 = f32[80,1]{1,0} get-tuple-element(%param.45), index=94
  %dynamic-slice.229 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.387, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.426 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.229)
  %reshape.1912 = f32[1]{0} reshape(%divide.426)
  %select.438 = f32[1]{0} select(%reshape.1910, %reshape.1911, %reshape.1912)
  %select.439 = f32[1]{0} select(%reshape.1909, %select.438, %reshape.1912)
  %divide.427 = f32[1]{0} divide(%constant.1877, %select.439)
  %convert.385 = bf16[1]{0} convert(%divide.427)
  %reshape.1913 = bf16[] reshape(%convert.385)
  %broadcast.1981 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1913), dimensions={}
  %divide.428 = bf16[2,8192,8,128]{3,2,1,0} divide(%copy.72, %broadcast.1981)
  %broadcast.1982 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%constant.2152), dimensions={}
  %clamp.80 = bf16[2,8192,8,128]{3,2,1,0} clamp(%broadcast.1944, %divide.428, %broadcast.1982)
  %convert.386 = f8e5m2[2,8192,8,128]{3,2,1,0} convert(%clamp.80)
  %dot.49 = bf16[2,8192,8192]{2,1,0} dot(%convert.386, %all-gather.9), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}
  %multiply.326 = f32[1]{0} multiply(%divide.364, %divide.427)
  %convert.387 = bf16[1]{0} convert(%multiply.326)
  %reshape.1914 = bf16[] reshape(%convert.387)
  %broadcast.1983 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1914), dimensions={}
  %multiply.328 = bf16[2,8192,8192]{2,1,0} multiply(%dot.49, %broadcast.1983)
  %get-tuple-element.388 = bf16[2,8192,8,128]{3,2,1,0} get-tuple-element(%custom-call.254), index=1
  %copy.73 = bf16[2,8192,8,128]{3,2,1,0} copy(%get-tuple-element.388)
  %convert.388 = f32[2,8192,8,128]{3,2,1,0} convert(%copy.73)
  %multiply.330 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.388, %broadcast.1840)
  %convert.389 = bf16[2,8192,8,128]{3,2,1,0} convert(%multiply.330)
  %compare.356 = pred[128]{0} compare(%select.358, %broadcast.1803), direction=EQ
  %broadcast.1989 = pred[2,8192,8,128]{3,2,1,0} broadcast(%compare.356), dimensions={3}
  %multiply.331 = f32[2,8192,8,128]{3,2,1,0} multiply(%convert.388, %broadcast.1848)
  %multiply.332 = f32[2,8192,8,128]{3,2,1,0} multiply(%multiply.331, %broadcast.1846)
  %convert.391 = bf16[2,8192,8,128]{3,2,1,0} convert(%multiply.332)
  %constant.2261 = bf16[] constant(0)
  %broadcast.1992 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%constant.2261), dimensions={}
  %select.440 = bf16[2,8192,8,128]{3,2,1,0} select(%broadcast.1989, %convert.391, %broadcast.1992)
  %slice.416 = bf16[2,8192,8,127]{3,2,1,0} slice(%select.440), slice={[0:2], [0:8192], [0:8], [1:128]}
  %pad.50 = bf16[2,8192,8,128]{3,2,1,0} pad(%slice.416, %constant.2261), padding=0_0x0_0x0_0x0_1
  %add.195 = bf16[2,8192,8,128]{3,2,1,0} add(%convert.389, %pad.50)
  %slice.417 = bf16[2,8192,8,1]{3,2,1,0} slice(%select.440), slice={[0:2], [0:8192], [0:8], [0:1]}
  %pad.51 = bf16[2,8192,8,128]{3,2,1,0} pad(%slice.417, %constant.2261), padding=0_0x0_0x0_0x127_0
  %add.196 = bf16[2,8192,8,128]{3,2,1,0} add(%add.195, %pad.51)
  %compare.357 = pred[128]{0} compare(%select.358, %broadcast.1815), direction=EQ
  %broadcast.1994 = pred[2,8192,8,128]{3,2,1,0} broadcast(%compare.357), dimensions={3}
  %select.441 = bf16[2,8192,8,128]{3,2,1,0} select(%broadcast.1994, %convert.391, %broadcast.1992)
  %slice.418 = bf16[2,8192,8,1]{3,2,1,0} slice(%select.441), slice={[0:2], [0:8192], [0:8], [127:128]}
  %pad.52 = bf16[2,8192,8,128]{3,2,1,0} pad(%slice.418, %constant.2261), padding=0_0x0_0x0_0x0_127
  %add.197 = bf16[2,8192,8,128]{3,2,1,0} add(%add.196, %pad.52)
  %slice.419 = bf16[2,8192,8,127]{3,2,1,0} slice(%select.441), slice={[0:2], [0:8192], [0:8], [0:127]}
  %pad.53 = bf16[2,8192,8,128]{3,2,1,0} pad(%slice.419, %constant.2261), padding=0_0x0_0x0_0x1_0
  %add.198 = bf16[2,8192,8,128]{3,2,1,0} add(%add.197, %pad.53)
  %get-tuple-element.389 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=75
  %dynamic-slice.238 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.389, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.199 = f32[] reduce(%dynamic-slice.238, %constant.1879), dimensions={0,1}, to_apply=%region_98.3089
  %is-finite.67 = pred[] is-finite(%reduce.199)
  %reshape.1926 = pred[1]{0} reshape(%is-finite.67)
  %compare.358 = pred[] compare(%reduce.199, %constant.1873), direction=GT
  %reshape.1927 = pred[1]{0} reshape(%compare.358)
  %divide.429 = f32[] divide(%constant.2149, %reduce.199)
  %reshape.1928 = f32[1]{0} reshape(%divide.429)
  %get-tuple-element.390 = f32[80,1]{1,0} get-tuple-element(%param.45), index=76
  %dynamic-slice.239 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.390, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.430 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.239)
  %reshape.1929 = f32[1]{0} reshape(%divide.430)
  %select.442 = f32[1]{0} select(%reshape.1927, %reshape.1928, %reshape.1929)
  %select.443 = f32[1]{0} select(%reshape.1926, %select.442, %reshape.1929)
  %divide.431 = f32[1]{0} divide(%constant.1877, %select.443)
  %convert.392 = bf16[1]{0} convert(%divide.431)
  %reshape.1930 = bf16[] reshape(%convert.392)
  %broadcast.1996 = bf16[2,8192,8,128]{3,2,1,0} broadcast(%reshape.1930), dimensions={}
  %divide.432 = bf16[2,8192,8,128]{3,2,1,0} divide(%add.198, %broadcast.1996)
  %clamp.81 = bf16[2,8192,8,128]{3,2,1,0} clamp(%broadcast.1944, %divide.432, %broadcast.1982)
  %convert.393 = f8e5m2[2,8192,8,128]{3,2,1,0} convert(%clamp.81)
  %dot.50 = bf16[2,8192,8192]{2,1,0} dot(%convert.393, %all-gather.8), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}
  %multiply.341 = f32[1]{0} multiply(%divide.354, %divide.431)
  %convert.394 = bf16[1]{0} convert(%multiply.341)
  %reshape.1931 = bf16[] reshape(%convert.394)
  %broadcast.1999 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1931), dimensions={}
  %multiply.342 = bf16[2,8192,8192]{2,1,0} multiply(%dot.50, %broadcast.1999)
  %add.199 = bf16[2,8192,8192]{2,1,0} add(%multiply.328, %multiply.342)
  %copy.74 = bf16[2,8192,8192]{2,1,0} copy(%add.199)
  %broadcast.2000 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.1864), dimensions={}
  %get-tuple-element.391 = bf16[2,8192,64,128]{3,2,1,0} get-tuple-element(%custom-call.254), index=0
  %copy.75 = bf16[2,8192,64,128]{3,2,1,0} copy(%get-tuple-element.391)
  %convert.395 = f32[2,8192,64,128]{3,2,1,0} convert(%copy.75)
  %multiply.343 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.395, %broadcast.1813)
  %convert.396 = bf16[2,8192,64,128]{3,2,1,0} convert(%multiply.343)
  %broadcast.2003 = pred[2,8192,64,128]{3,2,1,0} broadcast(%compare.356), dimensions={3}
  %multiply.344 = f32[2,8192,64,128]{3,2,1,0} multiply(%convert.395, %broadcast.1821)
  %multiply.345 = f32[2,8192,64,128]{3,2,1,0} multiply(%multiply.344, %broadcast.1819)
  %convert.397 = bf16[2,8192,64,128]{3,2,1,0} convert(%multiply.345)
  %broadcast.2006 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.2261), dimensions={}
  %select.444 = bf16[2,8192,64,128]{3,2,1,0} select(%broadcast.2003, %convert.397, %broadcast.2006)
  %slice.420 = bf16[2,8192,64,127]{3,2,1,0} slice(%select.444), slice={[0:2], [0:8192], [0:64], [1:128]}
  %pad.54 = bf16[2,8192,64,128]{3,2,1,0} pad(%slice.420, %constant.2261), padding=0_0x0_0x0_0x0_1
  %add.200 = bf16[2,8192,64,128]{3,2,1,0} add(%convert.396, %pad.54)
  %slice.421 = bf16[2,8192,64,1]{3,2,1,0} slice(%select.444), slice={[0:2], [0:8192], [0:64], [0:1]}
  %pad.55 = bf16[2,8192,64,128]{3,2,1,0} pad(%slice.421, %constant.2261), padding=0_0x0_0x0_0x127_0
  %add.201 = bf16[2,8192,64,128]{3,2,1,0} add(%add.200, %pad.55)
  %broadcast.2008 = pred[2,8192,64,128]{3,2,1,0} broadcast(%compare.357), dimensions={3}
  %select.445 = bf16[2,8192,64,128]{3,2,1,0} select(%broadcast.2008, %convert.397, %broadcast.2006)
  %slice.422 = bf16[2,8192,64,1]{3,2,1,0} slice(%select.445), slice={[0:2], [0:8192], [0:64], [127:128]}
  %pad.56 = bf16[2,8192,64,128]{3,2,1,0} pad(%slice.422, %constant.2261), padding=0_0x0_0x0_0x0_127
  %add.202 = bf16[2,8192,64,128]{3,2,1,0} add(%add.201, %pad.56)
  %slice.423 = bf16[2,8192,64,127]{3,2,1,0} slice(%select.445), slice={[0:2], [0:8192], [0:64], [0:127]}
  %pad.57 = bf16[2,8192,64,128]{3,2,1,0} pad(%slice.423, %constant.2261), padding=0_0x0_0x0_0x1_0
  %add.203 = bf16[2,8192,64,128]{3,2,1,0} add(%add.202, %pad.57)
  %get-tuple-element.392 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=87
  %dynamic-slice.248 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.392, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.200 = f32[] reduce(%dynamic-slice.248, %constant.1879), dimensions={0,1}, to_apply=%region_101.3138
  %is-finite.68 = pred[] is-finite(%reduce.200)
  %reshape.1942 = pred[1]{0} reshape(%is-finite.68)
  %compare.361 = pred[] compare(%reduce.200, %constant.1873), direction=GT
  %reshape.1943 = pred[1]{0} reshape(%compare.361)
  %divide.433 = f32[] divide(%constant.2149, %reduce.200)
  %reshape.1944 = f32[1]{0} reshape(%divide.433)
  %get-tuple-element.393 = f32[80,1]{1,0} get-tuple-element(%param.45), index=88
  %dynamic-slice.249 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.393, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.434 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.249)
  %reshape.1945 = f32[1]{0} reshape(%divide.434)
  %select.446 = f32[1]{0} select(%reshape.1943, %reshape.1944, %reshape.1945)
  %select.447 = f32[1]{0} select(%reshape.1942, %select.446, %reshape.1945)
  %divide.435 = f32[1]{0} divide(%constant.1877, %select.447)
  %convert.398 = bf16[1]{0} convert(%divide.435)
  %reshape.1946 = bf16[] reshape(%convert.398)
  %broadcast.2009 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%reshape.1946), dimensions={}
  %divide.436 = bf16[2,8192,64,128]{3,2,1,0} divide(%add.203, %broadcast.2009)
  %broadcast.2010 = bf16[2,8192,64,128]{3,2,1,0} broadcast(%constant.2152), dimensions={}
  %clamp.82 = bf16[2,8192,64,128]{3,2,1,0} clamp(%broadcast.2000, %divide.436, %broadcast.2010)
  %convert.399 = f8e5m2[2,8192,64,128]{3,2,1,0} convert(%clamp.82)
  %dot.51 = bf16[2,8192,8192]{2,1,0} dot(%convert.399, %all-gather.7), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}
  %multiply.354 = f32[1]{0} multiply(%divide.343, %divide.435)
  %convert.400 = bf16[1]{0} convert(%multiply.354)
  %reshape.1948 = bf16[] reshape(%convert.400)
  %broadcast.2011 = bf16[2,8192,8192]{2,1,0} broadcast(%reshape.1948), dimensions={}
  %multiply.355 = bf16[2,8192,8192]{2,1,0} multiply(%dot.51, %broadcast.2011)
  %copy.76 = bf16[2,8192,8192]{2,1,0} copy(%multiply.355)
  %add.204 = bf16[2,8192,8192]{2,1,0} add(%copy.74, %copy.76)
  %copy.77 = bf16[2,8192,8192]{2,1,0} copy(%add.204)
  %multiply.356 = bf16[2,8192,8192]{2,1,0} multiply(%copy.77, %broadcast.1786)
  %convert.401 = f32[2,8192,8192]{2,1,0} convert(%multiply.356)
  %multiply.357 = f32[2,8192,8192]{2,1,0} multiply(%convert.401, %broadcast.1785)
  %multiply.358 = f32[2,8192,8192]{2,1,0} multiply(%convert.296, %convert.401)
  %reduce.201 = f32[2,8192]{1,0} reduce(%multiply.358, %constant.1873), dimensions={2}, to_apply=%region_106.3217
  %reshape.1951 = f32[2,8192,1]{2,1,0} reshape(%reduce.201)
  %divide.437 = f32[2,8192,1]{2,1,0} divide(%rsqrt.8, %reshape.1737)
  %multiply.359 = f32[2,8192,1]{2,1,0} multiply(%divide.437, %broadcast.1941)
  %multiply.360 = f32[2,8192,1]{2,1,0} multiply(%reshape.1951, %multiply.359)
  %multiply.361 = f32[2,8192,1]{2,1,0} multiply(%multiply.360, %broadcast.1942)
  %reshape.1952 = f32[2,8192]{1,0} reshape(%multiply.361)
  %broadcast.2015 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.1952), dimensions={0,1}
  %multiply.362 = f32[2,8192,8192]{2,1,0} multiply(%convert.296, %broadcast.2015)
  %add.206 = f32[2,8192,8192]{2,1,0} add(%multiply.357, %multiply.362)
  %convert.402 = bf16[2,8192,8192]{2,1,0} convert(%add.206)
  %add.207 = bf16[2,8192,8192]{2,1,0} add(%add.186, %convert.402)
  %copy.78 = bf16[2,8192,8192]{2,1,0} copy(%add.207)
  %get-tuple-element.394 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.45), index=2
  %dot.52 = bf16[8192,28672]{1,0} dot(%convert.351, %convert.376), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce = bf16[8192,28672]{1,0} all-reduce(%dot.52), channel_id=18, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.clone
  %constant.2433 = s32[128]{0} constant({0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120, 5184, 5248, 5312, 5376, 5440, 5504, 5568, 5632, 5696, 5760, 5824, 5888, 5952, 6016, 6080, 6144, 6208, 6272, 6336, 6400, 6464, 6528, 6592, 6656, 6720, 6784, 6848, 6912, 6976, 7040, 7104, 7168, 7232, 7296, 7360, 7424, 7488, 7552, 7616, 7680, 7744, 7808, 7872, 7936, 8000, 8064, 8128})
  %constant.2432 = u32[256]{0} constant({0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127})
  %dynamic-slice.251 = u32[1]{0} dynamic-slice(%constant.2432, %partition-id.3), dynamic_slice_sizes={1}
  %reshape.1954 = u32[] reshape(%dynamic-slice.251)
  %dynamic-slice.252 = s32[1]{0} dynamic-slice(%constant.2433, %reshape.1954), dynamic_slice_sizes={1}
  %reshape.1955 = s32[] reshape(%dynamic-slice.252)
  %dynamic-slice.253 = bf16[64,28672]{1,0} dynamic-slice(%all-reduce, %reshape.1955, %constant.1868), dynamic_slice_sizes={64,28672}
  %all-reduce.1 = bf16[64,28672]{1,0} all-reduce(%dynamic-slice.253), channel_id=19, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.1.clone
  %multiply.364 = f32[1]{0} multiply(%divide.385, %divide.416)
  %convert.403 = bf16[1]{0} convert(%multiply.364)
  %reshape.1956 = bf16[] reshape(%convert.403)
  %broadcast.2016 = bf16[64,28672]{1,0} broadcast(%reshape.1956), dimensions={}
  %multiply.365 = bf16[64,28672]{0,1} multiply(%all-reduce.1, %broadcast.2016)
  %convert.405 = f32[64,28672]{0,1} convert(%multiply.365)
  %reshape.1957 = f32[1,64,28672]{2,1,0} reshape(%convert.405)
  %dynamic-update-slice.64 = f32[80,64,28672]{2,1,0} dynamic-update-slice(%get-tuple-element.394, %reshape.1957, %subtract.9, %constant.1868, %constant.1868)
  %get-tuple-element.395 = f32[80,64,28672]{2,1,0} get-tuple-element(%param.45), index=3
  %dot.53 = bf16[8192,28672]{1,0} dot(%convert.371, %convert.365), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.2 = bf16[8192,28672]{1,0} all-reduce(%dot.53), channel_id=20, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.2.clone
  %dynamic-slice.257 = bf16[64,28672]{1,0} dynamic-slice(%all-reduce.2, %reshape.1955, %constant.1868), dynamic_slice_sizes={64,28672}
  %all-reduce.3 = bf16[64,28672]{1,0} all-reduce(%dynamic-slice.257), channel_id=21, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.3.clone
  %multiply.366 = f32[1]{0} multiply(%divide.412, %divide.404)
  %convert.406 = bf16[1]{0} convert(%multiply.366)
  %reshape.1961 = bf16[] reshape(%convert.406)
  %broadcast.2017 = bf16[64,28672]{1,0} broadcast(%reshape.1961), dimensions={}
  %multiply.367 = bf16[64,28672]{0,1} multiply(%all-reduce.3, %broadcast.2017)
  %convert.407 = f32[64,28672]{0,1} convert(%multiply.367)
  %reshape.1962 = f32[1,64,28672]{2,1,0} reshape(%convert.407)
  %dynamic-update-slice.65 = f32[80,64,28672]{2,1,0} dynamic-update-slice(%get-tuple-element.395, %reshape.1962, %subtract.9, %constant.1868, %constant.1868)
  %get-tuple-element.396 = f32[80,28672,64]{2,1,0} get-tuple-element(%param.45), index=4
  %broadcast.2018 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1865), dimensions={}
  %multiply.368 = bf16[2,8192,28672]{2,1,0} multiply(%multiply.301, %multiply.308)
  %copy.79 = bf16[2,8192,28672]{2,1,0} copy(%multiply.368)
  %get-tuple-element.397 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=65
  %dynamic-slice.258 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.397, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1024}
  %reduce.202 = f32[] reduce(%dynamic-slice.258, %constant.1879), dimensions={0,1}, to_apply=%region_73.2597
  %is-finite.69 = pred[] is-finite(%reduce.202)
  %reshape.1963 = pred[1]{0} reshape(%is-finite.69)
  %compare.362 = pred[] compare(%reduce.202, %constant.1873), direction=GT
  %reshape.1964 = pred[1]{0} reshape(%compare.362)
  %divide.438 = f32[] divide(%constant.1881, %reduce.202)
  %reshape.1965 = f32[1]{0} reshape(%divide.438)
  %get-tuple-element.398 = f32[80,1]{1,0} get-tuple-element(%param.45), index=66
  %dynamic-slice.259 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.398, %subtract.9, %constant.1868), dynamic_slice_sizes={1,1}
  %divide.439 = f32[1,1]{1,0} divide(%constant.1882, %dynamic-slice.259)
  %reshape.1966 = f32[1]{0} reshape(%divide.439)
  %select.448 = f32[1]{0} select(%reshape.1964, %reshape.1965, %reshape.1966)
  %select.449 = f32[1]{0} select(%reshape.1963, %select.448, %reshape.1966)
  %divide.440 = f32[1]{0} divide(%constant.1877, %select.449)
  %convert.408 = bf16[1]{0} convert(%divide.440)
  %reshape.1967 = bf16[] reshape(%convert.408)
  %broadcast.2019 = bf16[2,8192,28672]{2,1,0} broadcast(%reshape.1967), dimensions={}
  %divide.441 = bf16[2,8192,28672]{2,1,0} divide(%copy.79, %broadcast.2019)
  %broadcast.2020 = bf16[2,8192,28672]{2,1,0} broadcast(%constant.1884), dimensions={}
  %clamp.83 = bf16[2,8192,28672]{2,1,0} clamp(%broadcast.2018, %divide.441, %broadcast.2020)
  %convert.409 = f8e4m3fn[2,8192,28672]{2,1,0} convert(%clamp.83)
  %dot.54 = bf16[28672,8192]{1,0} dot(%convert.409, %convert.358), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.4 = bf16[28672,8192]{1,0} all-reduce(%dot.54), channel_id=22, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.4.clone
  %dynamic-slice.263 = bf16[28672,64]{1,0} dynamic-slice(%all-reduce.4, %constant.1868, %reshape.1955), dynamic_slice_sizes={28672,64}
  %all-reduce.5 = bf16[28672,64]{1,0} all-reduce(%dynamic-slice.263), channel_id=23, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.5.clone
  %multiply.369 = f32[1]{0} multiply(%divide.440, %divide.395)
  %convert.410 = bf16[1]{0} convert(%multiply.369)
  %reshape.1971 = bf16[] reshape(%convert.410)
  %broadcast.2021 = bf16[28672,64]{1,0} broadcast(%reshape.1971), dimensions={}
  %multiply.370 = bf16[28672,64]{0,1} multiply(%all-reduce.5, %broadcast.2021)
  %convert.411 = f32[28672,64]{0,1} convert(%multiply.370)
  %reshape.1972 = f32[1,28672,64]{2,1,0} reshape(%convert.411)
  %dynamic-update-slice.66 = f32[80,28672,64]{2,1,0} dynamic-update-slice(%get-tuple-element.396, %reshape.1972, %subtract.9, %constant.1868, %constant.1868)
  %get-tuple-element.399 = f32[80,8192]{1,0} get-tuple-element(%param.45), index=5
  %multiply.371 = bf16[2,8192,8192]{2,1,0} multiply(%convert.348, %copy.69)
  %reduce.203 = bf16[8192]{0} reduce(%multiply.371, %constant.2261), dimensions={0,1}, to_apply=%region_88.2873
  %all-reduce.6 = bf16[8192]{0} all-reduce(%reduce.203), channel_id=24, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_88.2873.clone
  %convert.412 = f32[8192]{0} convert(%all-reduce.6)
  %reshape.1973 = f32[1,8192]{1,0} reshape(%convert.412)
  %dynamic-update-slice.67 = f32[80,8192]{1,0} dynamic-update-slice(%get-tuple-element.399, %reshape.1973, %subtract.9, %constant.1868)
  %get-tuple-element.400 = f32[80,8192]{1,0} get-tuple-element(%param.45), index=6
  %multiply.372 = bf16[2,8192,8192]{2,1,0} multiply(%convert.297, %copy.77)
  %reduce.204 = bf16[8192]{0} reduce(%multiply.372, %constant.2261), dimensions={0,1}, to_apply=%region_104.3199
  %all-reduce.7 = bf16[8192]{0} all-reduce(%reduce.204), channel_id=25, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_104.3199.clone
  %convert.413 = f32[8192]{0} convert(%all-reduce.7)
  %reshape.1974 = f32[1,8192]{1,0} reshape(%convert.413)
  %dynamic-update-slice.68 = f32[80,8192]{1,0} dynamic-update-slice(%get-tuple-element.400, %reshape.1974, %subtract.9, %constant.1868)
  %get-tuple-element.401 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.45), index=7
  %dot.55 = bf16[8,128,8192]{2,1,0} dot(%convert.393, %convert.315), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.8 = bf16[8,128,8192]{2,1,0} all-reduce(%dot.55), channel_id=26, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.6.clone
  %dynamic-slice.267 = bf16[8,128,64]{2,1,0} dynamic-slice(%all-reduce.8, %constant.1868, %constant.1868, %reshape.1955), dynamic_slice_sizes={8,128,64}
  %all-reduce.9 = bf16[8,128,64]{2,1,0} all-reduce(%dynamic-slice.267), channel_id=27, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.7.clone
  %multiply.373 = f32[1]{0} multiply(%divide.350, %divide.431)
  %convert.414 = bf16[1]{0} convert(%multiply.373)
  %reshape.1978 = bf16[] reshape(%convert.414)
  %broadcast.2022 = bf16[8,128,64]{1,0,2} broadcast(%reshape.1978), dimensions={}
  %multiply.374 = bf16[8,128,64]{2,1,0} multiply(%all-reduce.9, %broadcast.2022)
  %convert.415 = f32[8,128,64]{2,1,0} convert(%multiply.374)
  %transpose.56 = f32[64,8,128]{0,2,1} transpose(%convert.415), dimensions={2,0,1}
  %reshape.1980 = f32[1,64,8,128]{3,2,1,0} reshape(%transpose.56)
  %dynamic-update-slice.69 = f32[80,64,8,128]{3,2,1,0} dynamic-update-slice(%get-tuple-element.401, %reshape.1980, %subtract.9, %constant.1868, %constant.1868, /*index=5*/%constant.1868)
  %get-tuple-element.402 = f32[80,64,128,64]{3,2,1,0} get-tuple-element(%param.45), index=8
  %dot.56 = bf16[8192,64,128]{2,1,0} dot(%convert.381, %convert.342), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.10 = bf16[8192,64,128]{2,1,0} all-reduce(%dot.56), channel_id=28, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.8.clone
  %dynamic-slice.271 = bf16[64,64,128]{2,1,0} dynamic-slice(%all-reduce.10, %reshape.1955, %constant.1868, %constant.1868), dynamic_slice_sizes={64,64,128}
  %all-reduce.11 = bf16[64,64,128]{2,1,0} all-reduce(%dynamic-slice.271), channel_id=29, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.9.clone
  %multiply.375 = f32[1]{0} multiply(%divide.373, %divide.421)
  %convert.416 = bf16[1]{0} convert(%multiply.375)
  %reshape.1984 = bf16[] reshape(%convert.416)
  %broadcast.2023 = bf16[64,64,128]{0,2,1} broadcast(%reshape.1984), dimensions={}
  %multiply.376 = bf16[64,64,128]{2,1,0} multiply(%all-reduce.11, %broadcast.2023)
  %convert.417 = f32[64,64,128]{2,1,0} convert(%multiply.376)
  %transpose.57 = f32[64,128,64]{1,0,2} transpose(%convert.417), dimensions={1,2,0}
  %reshape.1985 = f32[1,64,128,64]{3,2,1,0} reshape(%transpose.57)
  %dynamic-update-slice.70 = f32[80,64,128,64]{3,2,1,0} dynamic-update-slice(%get-tuple-element.402, %reshape.1985, %subtract.9, %constant.1868, %constant.1868, /*index=5*/%constant.1868)
  %get-tuple-element.403 = f32[80,64,64,128]{3,2,1,0} get-tuple-element(%param.45), index=9
  %dot.57 = bf16[64,128,8192]{2,1,0} dot(%convert.399, %convert.300), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.12 = bf16[64,128,8192]{2,1,0} all-reduce(%dot.57), channel_id=30, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.10.clone
  %dynamic-slice.275 = bf16[64,128,64]{2,1,0} dynamic-slice(%all-reduce.12, %constant.1868, %constant.1868, %reshape.1955), dynamic_slice_sizes={64,128,64}
  %all-reduce.13 = bf16[64,128,64]{2,1,0} all-reduce(%dynamic-slice.275), channel_id=31, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.11.clone
  %multiply.377 = f32[1]{0} multiply(%divide.339, %divide.435)
  %convert.418 = bf16[1]{0} convert(%multiply.377)
  %reshape.1989 = bf16[] reshape(%convert.418)
  %broadcast.2024 = bf16[64,128,64]{1,0,2} broadcast(%reshape.1989), dimensions={}
  %multiply.378 = bf16[64,128,64]{2,1,0} multiply(%all-reduce.13, %broadcast.2024)
  %convert.419 = f32[64,128,64]{2,1,0} convert(%multiply.378)
  %transpose.58 = f32[64,64,128]{0,2,1} transpose(%convert.419), dimensions={2,0,1}
  %reshape.1990 = f32[1,64,64,128]{3,2,1,0} reshape(%transpose.58)
  %dynamic-update-slice.71 = f32[80,64,64,128]{3,2,1,0} dynamic-update-slice(%get-tuple-element.403, %reshape.1990, %subtract.9, %constant.1868, %constant.1868, /*index=5*/%constant.1868)
  %get-tuple-element.404 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%param.45), index=10
  %dot.58 = bf16[8,128,8192]{2,1,0} dot(%convert.386, %convert.331), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}
  %all-reduce.14 = bf16[8,128,8192]{2,1,0} all-reduce(%dot.58), channel_id=32, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.12.clone
  %dynamic-slice.279 = bf16[8,128,64]{2,1,0} dynamic-slice(%all-reduce.14, %constant.1868, %constant.1868, %reshape.1955), dynamic_slice_sizes={8,128,64}
  %all-reduce.15 = bf16[8,128,64]{2,1,0} all-reduce(%dynamic-slice.279), channel_id=33, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.13.clone
  %multiply.380 = f32[1]{0} multiply(%divide.360, %divide.427)
  %convert.420 = bf16[1]{0} convert(%multiply.380)
  %reshape.1994 = bf16[] reshape(%convert.420)
  %broadcast.2025 = bf16[8,128,64]{1,0,2} broadcast(%reshape.1994), dimensions={}
  %multiply.382 = bf16[8,128,64]{2,1,0} multiply(%all-reduce.15, %broadcast.2025)
  %convert.421 = f32[8,128,64]{2,1,0} convert(%multiply.382)
  %transpose.59 = f32[64,8,128]{0,2,1} transpose(%convert.421), dimensions={2,0,1}
  %reshape.1995 = f32[1,64,8,128]{3,2,1,0} reshape(%transpose.59)
  %dynamic-update-slice.72 = f32[80,64,8,128]{3,2,1,0} dynamic-update-slice(%get-tuple-element.404, %reshape.1995, %subtract.9, %constant.1868, %constant.1868, /*index=5*/%constant.1868)
  %get-tuple-element.405 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=11
  %reshape.1997 = f32[1024]{0} reshape(%dynamic-slice.207)
  %slice.424 = f32[1023]{0} slice(%reshape.1997), slice={[1:1024]}
  %slice.425 = f32[1,1]{1,0} slice(%dynamic-slice.207), slice={[0:1], [0:1]}
  %reshape.1998 = f32[1]{0} reshape(%slice.425)
  %concatenate.119 = f32[1024]{0} concatenate(%slice.424, %reshape.1998), dimensions={0}
  %reshape.1999 = f32[1,1024]{1,0} reshape(%concatenate.119)
  %abs.28 = bf16[2,8192,8192]{2,1,0} abs(%copy.66)
  %constant.2514 = bf16[] constant(-inf)
  %reduce.205 = bf16[] reduce(%abs.28, %constant.2514), dimensions={0,1,2}, to_apply=%region_62.2441
  %all-reduce.16 = bf16[] all-reduce(%reduce.205), channel_id=34, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_62.2441.clone
  %convert.422 = f32[] convert(%all-reduce.16)
  %reshape.2000 = f32[1,1]{1,0} reshape(%convert.422)
  %dynamic-update-slice.73 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.1999, %reshape.2000, %constant.1868, %constant.1868)
  %dynamic-update-slice.74 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.405, %dynamic-update-slice.73, %subtract.9, %constant.1868)
  %get-tuple-element.406 = f32[80,1]{1,0} get-tuple-element(%param.45), index=12
  %reshape.2001 = f32[1,1]{1,0} reshape(%divide.385)
  %dynamic-update-slice.75 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.406, %reshape.2001, %subtract.9, %constant.1868)
  %get-tuple-element.407 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=13
  %reshape.2002 = f32[1024]{0} reshape(%dynamic-slice.210)
  %slice.426 = f32[1023]{0} slice(%reshape.2002), slice={[1:1024]}
  %slice.427 = f32[1,1]{1,0} slice(%dynamic-slice.210), slice={[0:1], [0:1]}
  %reshape.2003 = f32[1]{0} reshape(%slice.427)
  %concatenate.120 = f32[1024]{0} concatenate(%slice.426, %reshape.2003), dimensions={0}
  %reshape.2004 = f32[1,1024]{1,0} reshape(%concatenate.120)
  %abs.29 = bf16[1,64,28672]{2,1,0} abs(%convert.353)
  %reduce.206 = bf16[] reduce(%abs.29, %constant.2514), dimensions={0,1,2}, to_apply=%region_65.2473
  %all-reduce.17 = bf16[] all-reduce(%reduce.206), channel_id=35, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_65.2473.clone
  %convert.423 = f32[] convert(%all-reduce.17)
  %reshape.2005 = f32[1,1]{1,0} reshape(%convert.423)
  %dynamic-update-slice.76 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2004, %reshape.2005, %constant.1868, %constant.1868)
  %dynamic-update-slice.77 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.407, %dynamic-update-slice.76, %subtract.9, %constant.1868)
  %get-tuple-element.408 = f32[80,1]{1,0} get-tuple-element(%param.45), index=14
  %reshape.2006 = f32[1,1]{1,0} reshape(%divide.390)
  %dynamic-update-slice.78 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.408, %reshape.2006, %subtract.9, %constant.1868)
  %get-tuple-element.409 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=15
  %reshape.2007 = f32[1024]{0} reshape(%dynamic-slice.224)
  %slice.428 = f32[1023]{0} slice(%reshape.2007), slice={[1:1024]}
  %slice.429 = f32[1,1]{1,0} slice(%dynamic-slice.224), slice={[0:1], [0:1]}
  %reshape.2008 = f32[1]{0} reshape(%slice.429)
  %concatenate.121 = f32[1024]{0} concatenate(%slice.428, %reshape.2008), dimensions={0}
  %reshape.2009 = f32[1,1024]{1,0} reshape(%concatenate.121)
  %abs.30 = bf16[2,8192,28672]{2,1,0} abs(%add.183)
  %reduce.207 = bf16[] reduce(%abs.30, %constant.2514), dimensions={0,1,2}, to_apply=%region_86.2836
  %all-reduce.18 = bf16[] all-reduce(%reduce.207), channel_id=36, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_86.2836.clone
  %convert.424 = f32[] convert(%all-reduce.18)
  %reshape.2010 = f32[1,1]{1,0} reshape(%convert.424)
  %dynamic-update-slice.79 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2009, %reshape.2010, %constant.1868, %constant.1868)
  %dynamic-update-slice.80 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.409, %dynamic-update-slice.79, %subtract.9, %constant.1868)
  %get-tuple-element.410 = f32[80,1]{1,0} get-tuple-element(%param.45), index=16
  %reshape.2011 = f32[1,1]{1,0} reshape(%divide.416)
  %dynamic-update-slice.81 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.410, %reshape.2011, %subtract.9, %constant.1868)
  %get-tuple-element.411 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=17
  %reshape.2012 = f32[1024]{0} reshape(%dynamic-slice.222)
  %slice.430 = f32[1023]{0} slice(%reshape.2012), slice={[1:1024]}
  %slice.431 = f32[1,1]{1,0} slice(%dynamic-slice.222), slice={[0:1], [0:1]}
  %reshape.2013 = f32[1]{0} reshape(%slice.431)
  %concatenate.122 = f32[1024]{0} concatenate(%slice.430, %reshape.2013), dimensions={0}
  %reshape.2014 = f32[1,1024]{1,0} reshape(%concatenate.122)
  %all-reduce.19 = bf16[] all-reduce(%reduce.205), channel_id=37, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_68.2537.clone
  %convert.425 = f32[] convert(%all-reduce.19)
  %reshape.2015 = f32[1,1]{1,0} reshape(%convert.425)
  %dynamic-update-slice.82 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2014, %reshape.2015, %constant.1868, %constant.1868)
  %dynamic-update-slice.83 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.411, %dynamic-update-slice.82, %subtract.9, %constant.1868)
  %get-tuple-element.412 = f32[80,1]{1,0} get-tuple-element(%param.45), index=18
  %reshape.2016 = f32[1,1]{1,0} reshape(%divide.412)
  %dynamic-update-slice.84 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.412, %reshape.2016, %subtract.9, %constant.1868)
  %get-tuple-element.413 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=19
  %reshape.2017 = f32[1024]{0} reshape(%dynamic-slice.220)
  %slice.432 = f32[1023]{0} slice(%reshape.2017), slice={[1:1024]}
  %slice.433 = f32[1,1]{1,0} slice(%dynamic-slice.220), slice={[0:1], [0:1]}
  %reshape.2018 = f32[1]{0} reshape(%slice.433)
  %concatenate.123 = f32[1024]{0} concatenate(%slice.432, %reshape.2018), dimensions={0}
  %reshape.2019 = f32[1,1024]{1,0} reshape(%concatenate.123)
  %abs.32 = bf16[1,64,28672]{2,1,0} abs(%convert.366)
  %reduce.209 = bf16[] reduce(%abs.32, %constant.2514), dimensions={0,1,2}, to_apply=%region_71.2569
  %all-reduce.20 = bf16[] all-reduce(%reduce.209), channel_id=38, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_71.2569.clone
  %convert.426 = f32[] convert(%all-reduce.20)
  %reshape.2020 = f32[1,1]{1,0} reshape(%convert.426)
  %dynamic-update-slice.85 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2019, %reshape.2020, %constant.1868, %constant.1868)
  %dynamic-update-slice.86 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.413, %dynamic-update-slice.85, %subtract.9, %constant.1868)
  %get-tuple-element.414 = f32[80,1]{1,0} get-tuple-element(%param.45), index=20
  %reshape.2021 = f32[1,1]{1,0} reshape(%divide.408)
  %dynamic-update-slice.87 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.414, %reshape.2021, %subtract.9, %constant.1868)
  %get-tuple-element.415 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=21
  %reshape.2022 = f32[1024]{0} reshape(%dynamic-slice.217)
  %slice.434 = f32[1023]{0} slice(%reshape.2022), slice={[1:1024]}
  %slice.435 = f32[1,1]{1,0} slice(%dynamic-slice.217), slice={[0:1], [0:1]}
  %reshape.2023 = f32[1]{0} reshape(%slice.435)
  %concatenate.124 = f32[1024]{0} concatenate(%slice.434, %reshape.2023), dimensions={0}
  %reshape.2024 = f32[1,1024]{1,0} reshape(%concatenate.124)
  %abs.33 = bf16[2,8192,28672]{2,1,0} abs(%multiply.304)
  %reduce.210 = bf16[] reduce(%abs.33, %constant.2514), dimensions={0,1,2}, to_apply=%region_83.2770
  %all-reduce.21 = bf16[] all-reduce(%reduce.210), channel_id=39, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_83.2770.clone
  %convert.427 = f32[] convert(%all-reduce.21)
  %reshape.2025 = f32[1,1]{1,0} reshape(%convert.427)
  %dynamic-update-slice.88 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2024, %reshape.2025, %constant.1868, %constant.1868)
  %dynamic-update-slice.89 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.415, %dynamic-update-slice.88, %subtract.9, %constant.1868)
  %get-tuple-element.416 = f32[80,1]{1,0} get-tuple-element(%param.45), index=22
  %reshape.2026 = f32[1,1]{1,0} reshape(%divide.404)
  %dynamic-update-slice.90 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.416, %reshape.2026, %subtract.9, %constant.1868)
  %get-tuple-element.417 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=23
  %reshape.2028 = f32[1024]{0} reshape(%dynamic-slice.258)
  %slice.436 = f32[1023]{0} slice(%reshape.2028), slice={[1:1024]}
  %slice.437 = f32[1,1]{1,0} slice(%dynamic-slice.258), slice={[0:1], [0:1]}
  %reshape.2029 = f32[1]{0} reshape(%slice.437)
  %concatenate.125 = f32[1024]{0} concatenate(%slice.436, %reshape.2029), dimensions={0}
  %reshape.2030 = f32[1,1024]{1,0} reshape(%concatenate.125)
  %abs.34 = bf16[2,8192,28672]{2,1,0} abs(%copy.79)
  %reduce.211 = bf16[] reduce(%abs.34, %constant.2514), dimensions={0,1,2}, to_apply=%region_74.2611
  %all-reduce.22 = bf16[] all-reduce(%reduce.211), channel_id=40, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_74.2611.clone
  %convert.428 = f32[] convert(%all-reduce.22)
  %reshape.2031 = f32[1,1]{1,0} reshape(%convert.428)
  %dynamic-update-slice.91 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2030, %reshape.2031, %constant.1868, %constant.1868)
  %dynamic-update-slice.92 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.417, %dynamic-update-slice.91, %subtract.9, %constant.1868)
  %get-tuple-element.418 = f32[80,1]{1,0} get-tuple-element(%param.45), index=24
  %reshape.2032 = f32[1,1]{1,0} reshape(%divide.440)
  %dynamic-update-slice.93 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.418, %reshape.2032, %subtract.9, %constant.1868)
  %get-tuple-element.419 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=25
  %reshape.2033 = f32[1024]{0} reshape(%dynamic-slice.215)
  %slice.438 = f32[1023]{0} slice(%reshape.2033), slice={[1:1024]}
  %slice.439 = f32[1,1]{1,0} slice(%dynamic-slice.215), slice={[0:1], [0:1]}
  %reshape.2034 = f32[1]{0} reshape(%slice.439)
  %concatenate.126 = f32[1024]{0} concatenate(%slice.438, %reshape.2034), dimensions={0}
  %reshape.2035 = f32[1,1024]{1,0} reshape(%concatenate.126)
  %abs.35 = bf16[1,28672,64]{2,1,0} abs(%convert.359)
  %reduce.212 = bf16[] reduce(%abs.35, %constant.2514), dimensions={0,1,2}, to_apply=%region_77.2651
  %all-reduce.23 = bf16[] all-reduce(%reduce.212), channel_id=41, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_77.2651.clone
  %convert.429 = f32[] convert(%all-reduce.23)
  %reshape.2036 = f32[1,1]{1,0} reshape(%convert.429)
  %dynamic-update-slice.94 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2035, %reshape.2036, %constant.1868, %constant.1868)
  %dynamic-update-slice.95 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.419, %dynamic-update-slice.94, %subtract.9, %constant.1868)
  %get-tuple-element.420 = f32[80,1]{1,0} get-tuple-element(%param.45), index=26
  %reshape.2037 = f32[1,1]{1,0} reshape(%divide.400)
  %dynamic-update-slice.96 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.420, %reshape.2037, %subtract.9, %constant.1868)
  %get-tuple-element.421 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=27
  %reshape.2038 = f32[1024]{0} reshape(%dynamic-slice.212)
  %slice.440 = f32[1023]{0} slice(%reshape.2038), slice={[1:1024]}
  %slice.441 = f32[1,1]{1,0} slice(%dynamic-slice.212), slice={[0:1], [0:1]}
  %reshape.2039 = f32[1]{0} reshape(%slice.441)
  %concatenate.127 = f32[1024]{0} concatenate(%slice.440, %reshape.2039), dimensions={0}
  %reshape.2040 = f32[1,1024]{1,0} reshape(%concatenate.127)
  %abs.36 = bf16[2,8192,8192]{2,1,0} abs(%copy.67)
  %reduce.213 = bf16[] reduce(%abs.36, %constant.2514), dimensions={0,1,2}, to_apply=%region_80.2706
  %all-reduce.24 = bf16[] all-reduce(%reduce.213), channel_id=42, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_80.2706.clone
  %convert.430 = f32[] convert(%all-reduce.24)
  %reshape.2041 = f32[1,1]{1,0} reshape(%convert.430)
  %dynamic-update-slice.97 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2040, %reshape.2041, %constant.1868, %constant.1868)
  %dynamic-update-slice.98 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.421, %dynamic-update-slice.97, %subtract.9, %constant.1868)
  %get-tuple-element.422 = f32[80,1]{1,0} get-tuple-element(%param.45), index=28
  %reshape.2042 = f32[1,1]{1,0} reshape(%divide.395)
  %dynamic-update-slice.99 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.422, %reshape.2042, %subtract.9, %constant.1868)
  %get-tuple-element.423 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=29
  %reshape.2043 = f32[1024]{0} reshape(%dynamic-slice.184)
  %slice.443 = f32[1023]{0} slice(%reshape.2043), slice={[1:1024]}
  %slice.444 = f32[1,1]{1,0} slice(%dynamic-slice.184), slice={[0:1], [0:1]}
  %reshape.2044 = f32[1]{0} reshape(%slice.444)
  %concatenate.128 = f32[1024]{0} concatenate(%slice.443, %reshape.2044), dimensions={0}
  %reshape.2045 = f32[1,1024]{1,0} reshape(%concatenate.128)
  %abs.37 = bf16[2,8192,8192]{2,1,0} abs(%copy.59)
  %reduce.214 = bf16[] reduce(%abs.37, %constant.2514), dimensions={0,1,2}, to_apply=%region_40.1937
  %all-reduce.25 = bf16[] all-reduce(%reduce.214), channel_id=43, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_40.1937.clone
  %convert.431 = f32[] convert(%all-reduce.25)
  %reshape.2046 = f32[1,1]{1,0} reshape(%convert.431)
  %dynamic-update-slice.100 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2045, %reshape.2046, %constant.1868, %constant.1868)
  %dynamic-update-slice.101 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.423, %dynamic-update-slice.100, %subtract.9, %constant.1868)
  %get-tuple-element.424 = f32[80,1]{1,0} get-tuple-element(%param.45), index=30
  %reshape.2047 = f32[1,1]{1,0} reshape(%divide.350)
  %dynamic-update-slice.102 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.424, %reshape.2047, %subtract.9, %constant.1868)
  %get-tuple-element.425 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=31
  %reshape.2048 = f32[1024]{0} reshape(%dynamic-slice.187)
  %slice.445 = f32[1023]{0} slice(%reshape.2048), slice={[1:1024]}
  %slice.446 = f32[1,1]{1,0} slice(%dynamic-slice.187), slice={[0:1], [0:1]}
  %reshape.2049 = f32[1]{0} reshape(%slice.446)
  %concatenate.129 = f32[1024]{0} concatenate(%slice.445, %reshape.2049), dimensions={0}
  %reshape.2050 = f32[1,1024]{1,0} reshape(%concatenate.129)
  %abs.38 = bf16[1,64,8,128]{3,2,1,0} abs(%convert.316)
  %reduce.215 = bf16[] reduce(%abs.38, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_43.1969
  %all-reduce.26 = bf16[] all-reduce(%reduce.215), channel_id=44, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_43.1969.clone
  %convert.432 = f32[] convert(%all-reduce.26)
  %reshape.2051 = f32[1,1]{1,0} reshape(%convert.432)
  %dynamic-update-slice.103 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2050, %reshape.2051, %constant.1868, %constant.1868)
  %dynamic-update-slice.104 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.425, %dynamic-update-slice.103, %subtract.9, %constant.1868)
  %get-tuple-element.426 = f32[80,1]{1,0} get-tuple-element(%param.45), index=32
  %reshape.2052 = f32[1,1]{1,0} reshape(%divide.354)
  %dynamic-update-slice.105 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.426, %reshape.2052, %subtract.9, %constant.1868)
  %get-tuple-element.427 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=33
  %reshape.2053 = f32[1024]{0} reshape(%dynamic-slice.238)
  %slice.447 = f32[1023]{0} slice(%reshape.2053), slice={[1:1024]}
  %slice.448 = f32[1,1]{1,0} slice(%dynamic-slice.238), slice={[0:1], [0:1]}
  %reshape.2054 = f32[1]{0} reshape(%slice.448)
  %concatenate.130 = f32[1024]{0} concatenate(%slice.447, %reshape.2054), dimensions={0}
  %reshape.2055 = f32[1,1024]{1,0} reshape(%concatenate.130)
  %abs.39 = bf16[2,8192,8,128]{3,2,1,0} abs(%add.198)
  %reduce.216 = bf16[] reduce(%abs.39, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_99.3103
  %all-reduce.27 = bf16[] all-reduce(%reduce.216), channel_id=45, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_99.3103.clone
  %convert.433 = f32[] convert(%all-reduce.27)
  %reshape.2056 = f32[1,1]{1,0} reshape(%convert.433)
  %dynamic-update-slice.106 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2055, %reshape.2056, %constant.1868, %constant.1868)
  %dynamic-update-slice.107 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.427, %dynamic-update-slice.106, %subtract.9, %constant.1868)
  %get-tuple-element.428 = f32[80,1]{1,0} get-tuple-element(%param.45), index=34
  %reshape.2057 = f32[1,1]{1,0} reshape(%divide.431)
  %dynamic-update-slice.108 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.428, %reshape.2057, %subtract.9, %constant.1868)
  %get-tuple-element.429 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=35
  %reshape.2058 = f32[1024]{0} reshape(%dynamic-slice.201)
  %slice.449 = f32[1023]{0} slice(%reshape.2058), slice={[1:1024]}
  %slice.450 = f32[1,1]{1,0} slice(%dynamic-slice.201), slice={[0:1], [0:1]}
  %reshape.2060 = f32[1]{0} reshape(%slice.450)
  %concatenate.131 = f32[1024]{0} concatenate(%slice.449, %reshape.2060), dimensions={0}
  %reshape.2061 = f32[1,1024]{1,0} reshape(%concatenate.131)
  %abs.40 = bf16[2,8192,64,128]{3,2,1,0} abs(%copy.64)
  %reduce.217 = bf16[] reduce(%abs.40, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_55.2325
  %all-reduce.28 = bf16[] all-reduce(%reduce.217), channel_id=46, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_55.2325.clone
  %convert.434 = f32[] convert(%all-reduce.28)
  %reshape.2062 = f32[1,1]{1,0} reshape(%convert.434)
  %dynamic-update-slice.109 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2061, %reshape.2062, %constant.1868, %constant.1868)
  %dynamic-update-slice.110 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.429, %dynamic-update-slice.109, %subtract.9, %constant.1868)
  %get-tuple-element.430 = f32[80,1]{1,0} get-tuple-element(%param.45), index=36
  %reshape.2063 = f32[1,1]{1,0} reshape(%divide.373)
  %dynamic-update-slice.111 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.430, %reshape.2063, %subtract.9, %constant.1868)
  %get-tuple-element.431 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=37
  %reshape.2064 = f32[1024]{0} reshape(%dynamic-slice.204)
  %slice.451 = f32[1023]{0} slice(%reshape.2064), slice={[1:1024]}
  %slice.452 = f32[1,1]{1,0} slice(%dynamic-slice.204), slice={[0:1], [0:1]}
  %reshape.2065 = f32[1]{0} reshape(%slice.452)
  %concatenate.132 = f32[1024]{0} concatenate(%slice.451, %reshape.2065), dimensions={0}
  %reshape.2066 = f32[1,1024]{1,0} reshape(%concatenate.132)
  %abs.41 = bf16[1,64,128,64]{3,2,1,0} abs(%convert.343)
  %reduce.218 = bf16[] reduce(%abs.41, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_58.2365
  %all-reduce.29 = bf16[] all-reduce(%reduce.218), channel_id=47, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_58.2365.clone
  %convert.435 = f32[] convert(%all-reduce.29)
  %reshape.2067 = f32[1,1]{1,0} reshape(%convert.435)
  %dynamic-update-slice.112 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2066, %reshape.2067, %constant.1868, %constant.1868)
  %dynamic-update-slice.113 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.431, %dynamic-update-slice.112, %subtract.9, %constant.1868)
  %get-tuple-element.432 = f32[80,1]{1,0} get-tuple-element(%param.45), index=38
  %reshape.2069 = f32[1,1]{1,0} reshape(%divide.379)
  %dynamic-update-slice.114 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.432, %reshape.2069, %subtract.9, %constant.1868)
  %get-tuple-element.433 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=39
  %reshape.2070 = f32[1024]{0} reshape(%dynamic-slice.226)
  %slice.453 = f32[1023]{0} slice(%reshape.2070), slice={[1:1024]}
  %slice.454 = f32[1,1]{1,0} slice(%dynamic-slice.226), slice={[0:1], [0:1]}
  %reshape.2071 = f32[1]{0} reshape(%slice.454)
  %concatenate.133 = f32[1024]{0} concatenate(%slice.453, %reshape.2071), dimensions={0}
  %reshape.2072 = f32[1,1024]{1,0} reshape(%concatenate.133)
  %abs.42 = bf16[2,8192,8192]{2,1,0} abs(%copy.70)
  %reduce.219 = bf16[] reduce(%abs.42, %constant.2514), dimensions={0,1,2}, to_apply=%region_93.2928
  %all-reduce.30 = bf16[] all-reduce(%reduce.219), channel_id=48, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_93.2928.clone
  %convert.437 = f32[] convert(%all-reduce.30)
  %reshape.2073 = f32[1,1]{1,0} reshape(%convert.437)
  %dynamic-update-slice.115 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2072, %reshape.2073, %constant.1868, %constant.1868)
  %dynamic-update-slice.116 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.433, %dynamic-update-slice.115, %subtract.9, %constant.1868)
  %get-tuple-element.434 = f32[80,1]{1,0} get-tuple-element(%param.45), index=40
  %reshape.2074 = f32[1,1]{1,0} reshape(%divide.421)
  %dynamic-update-slice.117 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.434, %reshape.2074, %subtract.9, %constant.1868)
  %get-tuple-element.435 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=41
  %reshape.2075 = f32[1024]{0} reshape(%dynamic-slice.175)
  %slice.455 = f32[1023]{0} slice(%reshape.2075), slice={[1:1024]}
  %slice.456 = f32[1,1]{1,0} slice(%dynamic-slice.175), slice={[0:1], [0:1]}
  %reshape.2076 = f32[1]{0} reshape(%slice.456)
  %concatenate.134 = f32[1024]{0} concatenate(%slice.455, %reshape.2076), dimensions={0}
  %reshape.2077 = f32[1,1024]{1,0} reshape(%concatenate.134)
  %all-reduce.31 = bf16[] all-reduce(%reduce.214), channel_id=49, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_34.1844.clone
  %convert.438 = f32[] convert(%all-reduce.31)
  %reshape.2078 = f32[1,1]{1,0} reshape(%convert.438)
  %dynamic-update-slice.118 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2077, %reshape.2078, %constant.1868, %constant.1868)
  %dynamic-update-slice.119 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.435, %dynamic-update-slice.118, %subtract.9, %constant.1868)
  %get-tuple-element.436 = f32[80,1]{1,0} get-tuple-element(%param.45), index=42
  %reshape.2079 = f32[1,1]{1,0} reshape(%divide.339)
  %dynamic-update-slice.120 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.436, %reshape.2079, %subtract.9, %constant.1868)
  %get-tuple-element.437 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=43
  %reshape.2080 = f32[1024]{0} reshape(%dynamic-slice.178)
  %slice.457 = f32[1023]{0} slice(%reshape.2080), slice={[1:1024]}
  %slice.458 = f32[1,1]{1,0} slice(%dynamic-slice.178), slice={[0:1], [0:1]}
  %reshape.2081 = f32[1]{0} reshape(%slice.458)
  %concatenate.135 = f32[1024]{0} concatenate(%slice.457, %reshape.2081), dimensions={0}
  %reshape.2082 = f32[1,1024]{1,0} reshape(%concatenate.135)
  %abs.44 = bf16[1,64,64,128]{3,2,1,0} abs(%convert.301)
  %reduce.221 = bf16[] reduce(%abs.44, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_37.1889
  %all-reduce.32 = bf16[] all-reduce(%reduce.221), channel_id=50, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_37.1889.clone
  %convert.439 = f32[] convert(%all-reduce.32)
  %reshape.2083 = f32[1,1]{1,0} reshape(%convert.439)
  %dynamic-update-slice.121 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2082, %reshape.2083, %constant.1868, %constant.1868)
  %dynamic-update-slice.122 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.437, %dynamic-update-slice.121, %subtract.9, %constant.1868)
  %get-tuple-element.438 = f32[80,1]{1,0} get-tuple-element(%param.45), index=44
  %reshape.2084 = f32[1,1]{1,0} reshape(%divide.343)
  %dynamic-update-slice.123 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.438, %reshape.2084, %subtract.9, %constant.1868)
  %get-tuple-element.439 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=45
  %reshape.2085 = f32[1024]{0} reshape(%dynamic-slice.248)
  %slice.459 = f32[1023]{0} slice(%reshape.2085), slice={[1:1024]}
  %slice.460 = f32[1,1]{1,0} slice(%dynamic-slice.248), slice={[0:1], [0:1]}
  %reshape.2086 = f32[1]{0} reshape(%slice.460)
  %concatenate.136 = f32[1024]{0} concatenate(%slice.459, %reshape.2086), dimensions={0}
  %reshape.2087 = f32[1,1024]{1,0} reshape(%concatenate.136)
  %abs.45 = bf16[2,8192,64,128]{3,2,1,0} abs(%add.203)
  %reduce.222 = bf16[] reduce(%abs.45, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_102.3152
  %all-reduce.33 = bf16[] all-reduce(%reduce.222), channel_id=51, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_102.3152.clone
  %convert.440 = f32[] convert(%all-reduce.33)
  %reshape.2088 = f32[1,1]{1,0} reshape(%convert.440)
  %dynamic-update-slice.124 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2087, %reshape.2088, %constant.1868, %constant.1868)
  %dynamic-update-slice.125 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.439, %dynamic-update-slice.124, %subtract.9, %constant.1868)
  %get-tuple-element.440 = f32[80,1]{1,0} get-tuple-element(%param.45), index=46
  %reshape.2089 = f32[1,1]{1,0} reshape(%divide.435)
  %dynamic-update-slice.126 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.440, %reshape.2089, %subtract.9, %constant.1868)
  %get-tuple-element.441 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=47
  %reshape.2090 = f32[1024]{0} reshape(%dynamic-slice.193)
  %slice.461 = f32[1023]{0} slice(%reshape.2090), slice={[1:1024]}
  %slice.462 = f32[1,1]{1,0} slice(%dynamic-slice.193), slice={[0:1], [0:1]}
  %reshape.2091 = f32[1]{0} reshape(%slice.462)
  %concatenate.137 = f32[1024]{0} concatenate(%slice.461, %reshape.2091), dimensions={0}
  %reshape.2092 = f32[1,1024]{1,0} reshape(%concatenate.137)
  %all-reduce.34 = bf16[] all-reduce(%reduce.214), channel_id=52, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_46.2017.clone
  %convert.441 = f32[] convert(%all-reduce.34)
  %reshape.2093 = f32[1,1]{1,0} reshape(%convert.441)
  %dynamic-update-slice.127 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2092, %reshape.2093, %constant.1868, %constant.1868)
  %dynamic-update-slice.128 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.441, %dynamic-update-slice.127, %subtract.9, %constant.1868)
  %get-tuple-element.442 = f32[80,1]{1,0} get-tuple-element(%param.45), index=48
  %reshape.2094 = f32[1,1]{1,0} reshape(%divide.360)
  %dynamic-update-slice.129 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.442, %reshape.2094, %subtract.9, %constant.1868)
  %get-tuple-element.443 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=49
  %reshape.2095 = f32[1024]{0} reshape(%dynamic-slice.196)
  %slice.463 = f32[1023]{0} slice(%reshape.2095), slice={[1:1024]}
  %slice.464 = f32[1,1]{1,0} slice(%dynamic-slice.196), slice={[0:1], [0:1]}
  %reshape.2096 = f32[1]{0} reshape(%slice.464)
  %concatenate.138 = f32[1024]{0} concatenate(%slice.463, %reshape.2096), dimensions={0}
  %reshape.2097 = f32[1,1024]{1,0} reshape(%concatenate.138)
  %abs.47 = bf16[1,64,8,128]{3,2,1,0} abs(%convert.332)
  %reduce.224 = bf16[] reduce(%abs.47, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_49.2049
  %all-reduce.35 = bf16[] all-reduce(%reduce.224), channel_id=53, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_49.2049.clone
  %convert.442 = f32[] convert(%all-reduce.35)
  %reshape.2098 = f32[1,1]{1,0} reshape(%convert.442)
  %dynamic-update-slice.130 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2097, %reshape.2098, %constant.1868, %constant.1868)
  %dynamic-update-slice.131 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.443, %dynamic-update-slice.130, %subtract.9, %constant.1868)
  %get-tuple-element.444 = f32[80,1]{1,0} get-tuple-element(%param.45), index=50
  %reshape.2099 = f32[1,1]{1,0} reshape(%divide.364)
  %dynamic-update-slice.132 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.444, %reshape.2099, %subtract.9, %constant.1868)
  %get-tuple-element.445 = f32[80,1024]{1,0} get-tuple-element(%param.45), index=51
  %reshape.2100 = f32[1024]{0} reshape(%dynamic-slice.228)
  %slice.465 = f32[1023]{0} slice(%reshape.2100), slice={[1:1024]}
  %slice.466 = f32[1,1]{1,0} slice(%dynamic-slice.228), slice={[0:1], [0:1]}
  %reshape.2101 = f32[1]{0} reshape(%slice.466)
  %concatenate.139 = f32[1024]{0} concatenate(%slice.465, %reshape.2101), dimensions={0}
  %reshape.2102 = f32[1,1024]{1,0} reshape(%concatenate.139)
  %abs.48 = bf16[2,8192,8,128]{3,2,1,0} abs(%copy.72)
  %reduce.225 = bf16[] reduce(%abs.48, %constant.2514), dimensions={0,1,2,3}, to_apply=%region_96.3047
  %all-reduce.36 = bf16[] all-reduce(%reduce.225), channel_id=54, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_96.3047.clone
  %convert.443 = f32[] convert(%all-reduce.36)
  %reshape.2103 = f32[1,1]{1,0} reshape(%convert.443)
  %dynamic-update-slice.133 = f32[1,1024]{1,0} dynamic-update-slice(%reshape.2102, %reshape.2103, %constant.1868, %constant.1868)
  %dynamic-update-slice.134 = f32[80,1024]{1,0} dynamic-update-slice(%get-tuple-element.445, %dynamic-update-slice.133, %subtract.9, %constant.1868)
  %get-tuple-element.446 = f32[80,1]{1,0} get-tuple-element(%param.45), index=52
  %reshape.2105 = f32[1,1]{1,0} reshape(%divide.427)
  %dynamic-update-slice.135 = f32[80,1]{1,0} dynamic-update-slice(%get-tuple-element.446, %reshape.2105, %subtract.9, %constant.1868)
  ROOT %tuple.111 = (s32[], bf16[2,8192,8192]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, /*index=5*/f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, /*index=10*/f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=45*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=50*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=55*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=60*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=65*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=70*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=75*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=80*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=85*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=90*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=95*/f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, /*index=100*/f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, /*index=105*/s32[2,8192]{1,0}, s32[2,8192]{1,0}) tuple(%add.157, %copy.78, %dynamic-update-slice.64, %dynamic-update-slice.65, %dynamic-update-slice.66, /*index=5*/%dynamic-update-slice.67, %dynamic-update-slice.68, %dynamic-update-slice.69, %dynamic-update-slice.70, %dynamic-update-slice.71, /*index=10*/%dynamic-update-slice.72, %dynamic-update-slice.74, %dynamic-update-slice.75, %dynamic-update-slice.77, %dynamic-update-slice.78, /*index=15*/%dynamic-update-slice.80, %dynamic-update-slice.81, %dynamic-update-slice.83, %dynamic-update-slice.84, %dynamic-update-slice.86, /*index=20*/%dynamic-update-slice.87, %dynamic-update-slice.89, %dynamic-update-slice.90, %dynamic-update-slice.92, %dynamic-update-slice.93, /*index=25*/%dynamic-update-slice.95, %dynamic-update-slice.96, %dynamic-update-slice.98, %dynamic-update-slice.99, %dynamic-update-slice.101, /*index=30*/%dynamic-update-slice.102, %dynamic-update-slice.104, %dynamic-update-slice.105, %dynamic-update-slice.107, %dynamic-update-slice.108, /*index=35*/%dynamic-update-slice.110, %dynamic-update-slice.111, %dynamic-update-slice.113, %dynamic-update-slice.114, %dynamic-update-slice.116, /*index=40*/%dynamic-update-slice.117, %dynamic-update-slice.119, %dynamic-update-slice.120, %dynamic-update-slice.122, %dynamic-update-slice.123, /*index=45*/%dynamic-update-slice.125, %dynamic-update-slice.126, %dynamic-update-slice.128, %dynamic-update-slice.129, %dynamic-update-slice.131, /*index=50*/%dynamic-update-slice.132, %dynamic-update-slice.134, %dynamic-update-slice.135, %get-tuple-element.356, %get-tuple-element.357, /*index=55*/%get-tuple-element.359, %get-tuple-element.360, %get-tuple-element.373, %get-tuple-element.374, %get-tuple-element.371, /*index=60*/%get-tuple-element.372, %get-tuple-element.369, %get-tuple-element.370, %get-tuple-element.366, %get-tuple-element.367, /*index=65*/%get-tuple-element.397, %get-tuple-element.398, %get-tuple-element.364, %get-tuple-element.365, %get-tuple-element.361, /*index=70*/%get-tuple-element.362, %get-tuple-element.333, %get-tuple-element.334, %get-tuple-element.336, %get-tuple-element.337, /*index=75*/%get-tuple-element.389, %get-tuple-element.390, %get-tuple-element.350, %get-tuple-element.351, %get-tuple-element.353, /*index=80*/%get-tuple-element.354, %get-tuple-element.377, %get-tuple-element.378, %get-tuple-element.327, %get-tuple-element.328, /*index=85*/%get-tuple-element.330, %get-tuple-element.331, %get-tuple-element.392, %get-tuple-element.393, %get-tuple-element.338, /*index=90*/%get-tuple-element.339, %get-tuple-element.341, %get-tuple-element.342, %get-tuple-element.386, %get-tuple-element.387, /*index=95*/%get-tuple-element.358, %get-tuple-element.368, %get-tuple-element.363, %get-tuple-element.355, %get-tuple-element.326, /*index=100*/%get-tuple-element.335, %get-tuple-element.352, %get-tuple-element.329, %get-tuple-element.340, %get-tuple-element.325, /*index=105*/%get-tuple-element.343, %get-tuple-element.332)
}

%region_108.3507_spmd (param.44: (s32[], bf16[2,8192,8192], f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], /*index=5*/f32[80,8192], f32[80,8192], f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], /*index=10*/f32[80,64,8,128], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=15*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=20*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=25*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=30*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=35*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=40*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=45*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=50*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=55*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=60*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=65*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=70*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=75*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=80*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=85*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=90*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=95*/f32[80,64,28672], f32[80,64,28672], f32[80,28672,64], f32[80,8192], f32[80,8192], /*index=100*/f32[80,64,8,128], f32[80,64,128,64], f32[80,64,64,128], f32[80,64,8,128], bf16[80,2,8192,8192], /*index=105*/s32[2,8192], s32[2,8192])) -> pred[] {
  %param.44 = (s32[], bf16[2,8192,8192]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, /*index=5*/f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, /*index=10*/f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=45*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=50*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=55*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=60*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=65*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=70*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=75*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=80*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=85*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=90*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=95*/f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, f32[80,8192]{1,0}, f32[80,8192]{1,0}, /*index=100*/f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, f32[80,64,8,128]{3,2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, /*index=105*/s32[2,8192]{1,0}, s32[2,8192]{1,0}) parameter(0)
  %get-tuple-element.322 = s32[] get-tuple-element(%param.44), index=0
  %constant.1844 = s32[] constant(80)
  ROOT %compare.256 = pred[] compare(%get-tuple-element.322, %constant.1844), direction=LT
}

%region_27.1411 (Arg_0.1408: bf16[], Arg_1.1409: bf16[]) -> bf16[] {
  %Arg_0.1408 = bf16[] parameter(0)
  %Arg_1.1409 = bf16[] parameter(1)
  ROOT %add.1410 = bf16[] add(%Arg_0.1408, %Arg_1.1409)
}

%region_27.1411.clone (Arg_0.153: bf16[], Arg_1.134: bf16[]) -> bf16[] {
  %Arg_0.153 = bf16[] parameter(0)
  %Arg_1.134 = bf16[] parameter(1)
  ROOT %add.209 = bf16[] add(%Arg_0.153, %Arg_1.134)
}

%region_109.3580 (Arg_0.3577: f32[], Arg_1.3578: f32[]) -> f32[] {
  %Arg_0.3577 = f32[] parameter(0)
  %Arg_1.3578 = f32[] parameter(1)
  ROOT %add.3579 = f32[] add(%Arg_0.3577, %Arg_1.3578)
}

%region_110.3586 (Arg_0.3583: f32[], Arg_1.3584: f32[]) -> f32[] {
  %Arg_0.3583 = f32[] parameter(0)
  %Arg_1.3584 = f32[] parameter(1)
  ROOT %add.3585 = f32[] add(%Arg_0.3583, %Arg_1.3584)
}

%region_110.3586.clone (Arg_0.154: f32[], Arg_1.135: f32[]) -> f32[] {
  %Arg_0.154 = f32[] parameter(0)
  %Arg_1.135 = f32[] parameter(1)
  ROOT %add.211 = f32[] add(%Arg_0.154, %Arg_1.135)
}

%region_111.3593 (Arg_0.3590: f32[], Arg_1.3591: f32[]) -> f32[] {
  %Arg_0.3590 = f32[] parameter(0)
  %Arg_1.3591 = f32[] parameter(1)
  ROOT %add.3592 = f32[] add(%Arg_0.3590, %Arg_1.3591)
}

%region_111.3593.clone (Arg_0.155: f32[], Arg_1.136: f32[]) -> f32[] {
  %Arg_0.155 = f32[] parameter(0)
  %Arg_1.136 = f32[] parameter(1)
  ROOT %add.212 = f32[] add(%Arg_0.155, %Arg_1.136)
}

%region_112.3600 (Arg_0.3597: f32[], Arg_1.3598: f32[]) -> f32[] {
  %Arg_0.3597 = f32[] parameter(0)
  %Arg_1.3598 = f32[] parameter(1)
  ROOT %add.3599 = f32[] add(%Arg_0.3597, %Arg_1.3598)
}

%region_112.3600.clone (Arg_0.156: f32[], Arg_1.137: f32[]) -> f32[] {
  %Arg_0.156 = f32[] parameter(0)
  %Arg_1.137 = f32[] parameter(1)
  ROOT %add.215 = f32[] add(%Arg_0.156, %Arg_1.137)
}

%region_113.3607 (Arg_0.3604: f32[], Arg_1.3605: f32[]) -> f32[] {
  %Arg_0.3604 = f32[] parameter(0)
  %Arg_1.3605 = f32[] parameter(1)
  ROOT %add.3606 = f32[] add(%Arg_0.3604, %Arg_1.3605)
}

%region_114.3614 (Arg_0.3611: f32[], Arg_1.3612: f32[]) -> f32[] {
  %Arg_0.3611 = f32[] parameter(0)
  %Arg_1.3612 = f32[] parameter(1)
  ROOT %add.3613 = f32[] add(%Arg_0.3611, %Arg_1.3612)
}

%region_115.3621 (Arg_0.3618: f32[], Arg_1.3619: f32[]) -> f32[] {
  %Arg_0.3618 = f32[] parameter(0)
  %Arg_1.3619 = f32[] parameter(1)
  ROOT %add.3620 = f32[] add(%Arg_0.3618, %Arg_1.3619)
}

%region_115.3621.clone (Arg_0.157: f32[], Arg_1.138: f32[]) -> f32[] {
  %Arg_0.157 = f32[] parameter(0)
  %Arg_1.138 = f32[] parameter(1)
  ROOT %add.216 = f32[] add(%Arg_0.157, %Arg_1.138)
}

%region_116.3628 (Arg_0.3625: f32[], Arg_1.3626: f32[]) -> f32[] {
  %Arg_0.3625 = f32[] parameter(0)
  %Arg_1.3626 = f32[] parameter(1)
  ROOT %add.3627 = f32[] add(%Arg_0.3625, %Arg_1.3626)
}

%region_116.3628.clone (Arg_0.158: f32[], Arg_1.139: f32[]) -> f32[] {
  %Arg_0.158 = f32[] parameter(0)
  %Arg_1.139 = f32[] parameter(1)
  ROOT %add.218 = f32[] add(%Arg_0.158, %Arg_1.139)
}

%region_117.3635 (Arg_0.3632: f32[], Arg_1.3633: f32[]) -> f32[] {
  %Arg_0.3632 = f32[] parameter(0)
  %Arg_1.3633 = f32[] parameter(1)
  ROOT %add.3634 = f32[] add(%Arg_0.3632, %Arg_1.3633)
}

%region_117.3635.clone (Arg_0.159: f32[], Arg_1.140: f32[]) -> f32[] {
  %Arg_0.159 = f32[] parameter(0)
  %Arg_1.140 = f32[] parameter(1)
  ROOT %add.219 = f32[] add(%Arg_0.159, %Arg_1.140)
}

%region_118.3642 (Arg_0.3639: f32[], Arg_1.3640: f32[]) -> f32[] {
  %Arg_0.3639 = f32[] parameter(0)
  %Arg_1.3640 = f32[] parameter(1)
  ROOT %add.3641 = f32[] add(%Arg_0.3639, %Arg_1.3640)
}

%region_118.3642.clone (Arg_0.160: f32[], Arg_1.141: f32[]) -> f32[] {
  %Arg_0.160 = f32[] parameter(0)
  %Arg_1.141 = f32[] parameter(1)
  ROOT %add.220 = f32[] add(%Arg_0.160, %Arg_1.141)
}

%add.14.clone (x.29: bf16[], y.29: bf16[]) -> bf16[] {
  %x.29 = bf16[] parameter(0)
  %y.29 = bf16[] parameter(1)
  ROOT %add.222 = bf16[] add(%x.29, %y.29)
}

%add.15.clone (x.31: bf16[], y.31: bf16[]) -> bf16[] {
  %x.31 = bf16[] parameter(0)
  %y.31 = bf16[] parameter(1)
  ROOT %add.225 = bf16[] add(%x.31, %y.31)
}

%region_119.3649 (Arg_0.3646: f32[], Arg_1.3647: f32[]) -> f32[] {
  %Arg_0.3646 = f32[] parameter(0)
  %Arg_1.3647 = f32[] parameter(1)
  ROOT %add.3648 = f32[] add(%Arg_0.3646, %Arg_1.3647)
}

%region_119.3649.clone (Arg_0.161: f32[], Arg_1.142: f32[]) -> f32[] {
  %Arg_0.161 = f32[] parameter(0)
  %Arg_1.142 = f32[] parameter(1)
  ROOT %add.226 = f32[] add(%Arg_0.161, %Arg_1.142)
}

%add.16.clone (x.33: bf16[], y.33: bf16[]) -> bf16[] {
  %x.33 = bf16[] parameter(0)
  %y.33 = bf16[] parameter(1)
  ROOT %add.230 = bf16[] add(%x.33, %y.33)
}

%add.17.clone (x.35: bf16[], y.35: bf16[]) -> bf16[] {
  %x.35 = bf16[] parameter(0)
  %y.35 = bf16[] parameter(1)
  ROOT %add.233 = bf16[] add(%x.35, %y.35)
}

%region_120.3656 (Arg_0.3653: f32[], Arg_1.3654: f32[]) -> f32[] {
  %Arg_0.3653 = f32[] parameter(0)
  %Arg_1.3654 = f32[] parameter(1)
  ROOT %add.3655 = f32[] add(%Arg_0.3653, %Arg_1.3654)
}

%region_120.3656.clone (Arg_0.162: f32[], Arg_1.143: f32[]) -> f32[] {
  %Arg_0.162 = f32[] parameter(0)
  %Arg_1.143 = f32[] parameter(1)
  ROOT %add.234 = f32[] add(%Arg_0.162, %Arg_1.143)
}

%region_121.3991 (Arg_0.3988: f32[], Arg_1.3989: f32[]) -> f32[] {
  %Arg_0.3988 = f32[] parameter(0)
  %Arg_1.3989 = f32[] parameter(1)
  ROOT %add.3990 = f32[] add(%Arg_0.3988, %Arg_1.3989)
}

%region_122.3997 (Arg_0.3994: f32[], Arg_1.3995: f32[]) -> f32[] {
  %Arg_0.3994 = f32[] parameter(0)
  %Arg_1.3995 = f32[] parameter(1)
  ROOT %add.3996 = f32[] add(%Arg_0.3994, %Arg_1.3995)
}

%region_123.4004 (Arg_0.4001: f32[], Arg_1.4002: f32[]) -> f32[] {
  %Arg_0.4001 = f32[] parameter(0)
  %Arg_1.4002 = f32[] parameter(1)
  ROOT %add.4003 = f32[] add(%Arg_0.4001, %Arg_1.4002)
}

%region_124.4011 (Arg_0.4008: f32[], Arg_1.4009: f32[]) -> f32[] {
  %Arg_0.4008 = f32[] parameter(0)
  %Arg_1.4009 = f32[] parameter(1)
  ROOT %add.4010 = f32[] add(%Arg_0.4008, %Arg_1.4009)
}

%region_125.4018 (Arg_0.4015: f32[], Arg_1.4016: f32[]) -> f32[] {
  %Arg_0.4015 = f32[] parameter(0)
  %Arg_1.4016 = f32[] parameter(1)
  ROOT %add.4017 = f32[] add(%Arg_0.4015, %Arg_1.4016)
}

%region_126.4025 (Arg_0.4022: f32[], Arg_1.4023: f32[]) -> f32[] {
  %Arg_0.4022 = f32[] parameter(0)
  %Arg_1.4023 = f32[] parameter(1)
  ROOT %add.4024 = f32[] add(%Arg_0.4022, %Arg_1.4023)
}

%region_127.4032 (Arg_0.4029: f32[], Arg_1.4030: f32[]) -> f32[] {
  %Arg_0.4029 = f32[] parameter(0)
  %Arg_1.4030 = f32[] parameter(1)
  ROOT %add.4031 = f32[] add(%Arg_0.4029, %Arg_1.4030)
}

%region_128.4039 (Arg_0.4036: f32[], Arg_1.4037: f32[]) -> f32[] {
  %Arg_0.4036 = f32[] parameter(0)
  %Arg_1.4037 = f32[] parameter(1)
  ROOT %add.4038 = f32[] add(%Arg_0.4036, %Arg_1.4037)
}

%region_129.4046 (Arg_0.4043: f32[], Arg_1.4044: f32[]) -> f32[] {
  %Arg_0.4043 = f32[] parameter(0)
  %Arg_1.4044 = f32[] parameter(1)
  ROOT %add.4045 = f32[] add(%Arg_0.4043, %Arg_1.4044)
}

%region_130.4053 (Arg_0.4050: f32[], Arg_1.4051: f32[]) -> f32[] {
  %Arg_0.4050 = f32[] parameter(0)
  %Arg_1.4051 = f32[] parameter(1)
  ROOT %add.4052 = f32[] add(%Arg_0.4050, %Arg_1.4051)
}

%region_131.4060 (Arg_0.4057: f32[], Arg_1.4058: f32[]) -> f32[] {
  %Arg_0.4057 = f32[] parameter(0)
  %Arg_1.4058 = f32[] parameter(1)
  ROOT %add.4059 = f32[] add(%Arg_0.4057, %Arg_1.4058)
}

%region_132.4067 (Arg_0.4064: f32[], Arg_1.4065: f32[]) -> f32[] {
  %Arg_0.4064 = f32[] parameter(0)
  %Arg_1.4065 = f32[] parameter(1)
  ROOT %add.4066 = f32[] add(%Arg_0.4064, %Arg_1.4065)
}

%region_133.4074 (Arg_0.4071: f32[], Arg_1.4072: f32[]) -> f32[] {
  %Arg_0.4071 = f32[] parameter(0)
  %Arg_1.4072 = f32[] parameter(1)
  ROOT %add.4073 = f32[] add(%Arg_0.4071, %Arg_1.4072)
}

%region_134.4081 (Arg_0.4078: f32[], Arg_1.4079: f32[]) -> f32[] {
  %Arg_0.4078 = f32[] parameter(0)
  %Arg_1.4079 = f32[] parameter(1)
  ROOT %add.4080 = f32[] add(%Arg_0.4078, %Arg_1.4079)
}

%region_135.4088 (Arg_0.4085: f32[], Arg_1.4086: f32[]) -> f32[] {
  %Arg_0.4085 = f32[] parameter(0)
  %Arg_1.4086 = f32[] parameter(1)
  ROOT %add.4087 = f32[] add(%Arg_0.4085, %Arg_1.4086)
}

%region_136.4095 (Arg_0.4092: f32[], Arg_1.4093: f32[]) -> f32[] {
  %Arg_0.4092 = f32[] parameter(0)
  %Arg_1.4093 = f32[] parameter(1)
  ROOT %add.4094 = f32[] add(%Arg_0.4092, %Arg_1.4093)
}

%region_137.4102 (Arg_0.4099: f32[], Arg_1.4100: f32[]) -> f32[] {
  %Arg_0.4099 = f32[] parameter(0)
  %Arg_1.4100 = f32[] parameter(1)
  ROOT %add.4101 = f32[] add(%Arg_0.4099, %Arg_1.4100)
}

%region_138.4109 (Arg_0.4106: f32[], Arg_1.4107: f32[]) -> f32[] {
  %Arg_0.4106 = f32[] parameter(0)
  %Arg_1.4107 = f32[] parameter(1)
  ROOT %add.4108 = f32[] add(%Arg_0.4106, %Arg_1.4107)
}

%region_139.4116 (Arg_0.4113: f32[], Arg_1.4114: f32[]) -> f32[] {
  %Arg_0.4113 = f32[] parameter(0)
  %Arg_1.4114 = f32[] parameter(1)
  ROOT %add.4115 = f32[] add(%Arg_0.4113, %Arg_1.4114)
}

%region_140.4123 (Arg_0.4120: f32[], Arg_1.4121: f32[]) -> f32[] {
  %Arg_0.4120 = f32[] parameter(0)
  %Arg_1.4121 = f32[] parameter(1)
  ROOT %add.4122 = f32[] add(%Arg_0.4120, %Arg_1.4121)
}

%region_141.4130 (Arg_0.4127: f32[], Arg_1.4128: f32[]) -> f32[] {
  %Arg_0.4127 = f32[] parameter(0)
  %Arg_1.4128 = f32[] parameter(1)
  ROOT %add.4129 = f32[] add(%Arg_0.4127, %Arg_1.4128)
}

%region_142.4137 (Arg_0.4134: f32[], Arg_1.4135: f32[]) -> f32[] {
  %Arg_0.4134 = f32[] parameter(0)
  %Arg_1.4135 = f32[] parameter(1)
  ROOT %add.4136 = f32[] add(%Arg_0.4134, %Arg_1.4135)
}

%region_143.4144 (Arg_0.4141: f32[], Arg_1.4142: f32[]) -> f32[] {
  %Arg_0.4141 = f32[] parameter(0)
  %Arg_1.4142 = f32[] parameter(1)
  ROOT %add.4143 = f32[] add(%Arg_0.4141, %Arg_1.4142)
}

%region_144.4151 (Arg_0.4148: f32[], Arg_1.4149: f32[]) -> f32[] {
  %Arg_0.4148 = f32[] parameter(0)
  %Arg_1.4149 = f32[] parameter(1)
  ROOT %add.4150 = f32[] add(%Arg_0.4148, %Arg_1.4149)
}

%region_145.4158 (Arg_0.4155: f32[], Arg_1.4156: f32[]) -> f32[] {
  %Arg_0.4155 = f32[] parameter(0)
  %Arg_1.4156 = f32[] parameter(1)
  ROOT %add.4157 = f32[] add(%Arg_0.4155, %Arg_1.4156)
}

%region_146.4165 (Arg_0.4162: f32[], Arg_1.4163: f32[]) -> f32[] {
  %Arg_0.4162 = f32[] parameter(0)
  %Arg_1.4163 = f32[] parameter(1)
  ROOT %add.4164 = f32[] add(%Arg_0.4162, %Arg_1.4163)
}

%region_147.4172 (Arg_0.4169: f32[], Arg_1.4170: f32[]) -> f32[] {
  %Arg_0.4169 = f32[] parameter(0)
  %Arg_1.4170 = f32[] parameter(1)
  ROOT %add.4171 = f32[] add(%Arg_0.4169, %Arg_1.4170)
}

%region_148.4179 (Arg_0.4176: f32[], Arg_1.4177: f32[]) -> f32[] {
  %Arg_0.4176 = f32[] parameter(0)
  %Arg_1.4177 = f32[] parameter(1)
  ROOT %add.4178 = f32[] add(%Arg_0.4176, %Arg_1.4177)
}

%region_149.4186 (Arg_0.4183: f32[], Arg_1.4184: f32[]) -> f32[] {
  %Arg_0.4183 = f32[] parameter(0)
  %Arg_1.4184 = f32[] parameter(1)
  ROOT %add.4185 = f32[] add(%Arg_0.4183, %Arg_1.4184)
}

%region_150.4193 (Arg_0.4190: f32[], Arg_1.4191: f32[]) -> f32[] {
  %Arg_0.4190 = f32[] parameter(0)
  %Arg_1.4191 = f32[] parameter(1)
  ROOT %add.4192 = f32[] add(%Arg_0.4190, %Arg_1.4191)
}

%region_151.4200 (Arg_0.4197: f32[], Arg_1.4198: f32[]) -> f32[] {
  %Arg_0.4197 = f32[] parameter(0)
  %Arg_1.4198 = f32[] parameter(1)
  ROOT %add.4199 = f32[] add(%Arg_0.4197, %Arg_1.4198)
}

%region_152.4207 (Arg_0.4204: f32[], Arg_1.4205: f32[]) -> f32[] {
  %Arg_0.4204 = f32[] parameter(0)
  %Arg_1.4205 = f32[] parameter(1)
  ROOT %add.4206 = f32[] add(%Arg_0.4204, %Arg_1.4205)
}

%region_153.4214 (Arg_0.4211: f32[], Arg_1.4212: f32[]) -> f32[] {
  %Arg_0.4211 = f32[] parameter(0)
  %Arg_1.4212 = f32[] parameter(1)
  ROOT %add.4213 = f32[] add(%Arg_0.4211, %Arg_1.4212)
}

%region_154.4221 (Arg_0.4218: f32[], Arg_1.4219: f32[]) -> f32[] {
  %Arg_0.4218 = f32[] parameter(0)
  %Arg_1.4219 = f32[] parameter(1)
  ROOT %add.4220 = f32[] add(%Arg_0.4218, %Arg_1.4219)
}

%region_155.4228 (Arg_0.4225: f32[], Arg_1.4226: f32[]) -> f32[] {
  %Arg_0.4225 = f32[] parameter(0)
  %Arg_1.4226 = f32[] parameter(1)
  ROOT %add.4227 = f32[] add(%Arg_0.4225, %Arg_1.4226)
}

%region_156.4235 (Arg_0.4232: f32[], Arg_1.4233: f32[]) -> f32[] {
  %Arg_0.4232 = f32[] parameter(0)
  %Arg_1.4233 = f32[] parameter(1)
  ROOT %add.4234 = f32[] add(%Arg_0.4232, %Arg_1.4233)
}

%region_157.4242 (Arg_0.4239: f32[], Arg_1.4240: f32[]) -> f32[] {
  %Arg_0.4239 = f32[] parameter(0)
  %Arg_1.4240 = f32[] parameter(1)
  ROOT %add.4241 = f32[] add(%Arg_0.4239, %Arg_1.4240)
}

%region_158.4249 (Arg_0.4246: f32[], Arg_1.4247: f32[]) -> f32[] {
  %Arg_0.4246 = f32[] parameter(0)
  %Arg_1.4247 = f32[] parameter(1)
  ROOT %add.4248 = f32[] add(%Arg_0.4246, %Arg_1.4247)
}

%region_159.4256 (Arg_0.4253: f32[], Arg_1.4254: f32[]) -> f32[] {
  %Arg_0.4253 = f32[] parameter(0)
  %Arg_1.4254 = f32[] parameter(1)
  ROOT %add.4255 = f32[] add(%Arg_0.4253, %Arg_1.4254)
}

%region_160.4263 (Arg_0.4260: f32[], Arg_1.4261: f32[]) -> f32[] {
  %Arg_0.4260 = f32[] parameter(0)
  %Arg_1.4261 = f32[] parameter(1)
  ROOT %add.4262 = f32[] add(%Arg_0.4260, %Arg_1.4261)
}

%region_161.4270 (Arg_0.4267: f32[], Arg_1.4268: f32[]) -> f32[] {
  %Arg_0.4267 = f32[] parameter(0)
  %Arg_1.4268 = f32[] parameter(1)
  ROOT %add.4269 = f32[] add(%Arg_0.4267, %Arg_1.4268)
}

%region_162.4277 (Arg_0.4274: f32[], Arg_1.4275: f32[]) -> f32[] {
  %Arg_0.4274 = f32[] parameter(0)
  %Arg_1.4275 = f32[] parameter(1)
  ROOT %add.4276 = f32[] add(%Arg_0.4274, %Arg_1.4275)
}

%region_163.4284 (Arg_0.4281: f32[], Arg_1.4282: f32[]) -> f32[] {
  %Arg_0.4281 = f32[] parameter(0)
  %Arg_1.4282 = f32[] parameter(1)
  ROOT %add.4283 = f32[] add(%Arg_0.4281, %Arg_1.4282)
}

%region_164.4291 (Arg_0.4288: f32[], Arg_1.4289: f32[]) -> f32[] {
  %Arg_0.4288 = f32[] parameter(0)
  %Arg_1.4289 = f32[] parameter(1)
  ROOT %add.4290 = f32[] add(%Arg_0.4288, %Arg_1.4289)
}

%region_164.4291.clone (Arg_0.163: f32[], Arg_1.144: f32[]) -> f32[] {
  %Arg_0.163 = f32[] parameter(0)
  %Arg_1.144 = f32[] parameter(1)
  ROOT %add.235 = f32[] add(%Arg_0.163, %Arg_1.144)
}

%region_165.4298 (Arg_0.4295: f32[], Arg_1.4296: f32[]) -> f32[] {
  %Arg_0.4295 = f32[] parameter(0)
  %Arg_1.4296 = f32[] parameter(1)
  ROOT %add.4297 = f32[] add(%Arg_0.4295, %Arg_1.4296)
}

%region_165.4298.clone (Arg_0.164: f32[], Arg_1.145: f32[]) -> f32[] {
  %Arg_0.164 = f32[] parameter(0)
  %Arg_1.145 = f32[] parameter(1)
  ROOT %add.237 = f32[] add(%Arg_0.164, %Arg_1.145)
}

%region_166.4305 (Arg_0.4302: f32[], Arg_1.4303: f32[]) -> f32[] {
  %Arg_0.4302 = f32[] parameter(0)
  %Arg_1.4303 = f32[] parameter(1)
  ROOT %add.4304 = f32[] add(%Arg_0.4302, %Arg_1.4303)
}

%region_166.4305.clone (Arg_0.165: f32[], Arg_1.146: f32[]) -> f32[] {
  %Arg_0.165 = f32[] parameter(0)
  %Arg_1.146 = f32[] parameter(1)
  ROOT %add.238 = f32[] add(%Arg_0.165, %Arg_1.146)
}

%region_167.4312 (Arg_0.4309: f32[], Arg_1.4310: f32[]) -> f32[] {
  %Arg_0.4309 = f32[] parameter(0)
  %Arg_1.4310 = f32[] parameter(1)
  ROOT %add.4311 = f32[] add(%Arg_0.4309, %Arg_1.4310)
}

%region_168.4319 (Arg_0.4316: f32[], Arg_1.4317: f32[]) -> f32[] {
  %Arg_0.4316 = f32[] parameter(0)
  %Arg_1.4317 = f32[] parameter(1)
  ROOT %add.4318 = f32[] add(%Arg_0.4316, %Arg_1.4317)
}

%region_169.4326 (Arg_0.4323: f32[], Arg_1.4324: f32[]) -> f32[] {
  %Arg_0.4323 = f32[] parameter(0)
  %Arg_1.4324 = f32[] parameter(1)
  ROOT %add.4325 = f32[] add(%Arg_0.4323, %Arg_1.4324)
}

%region_169.4326.clone (Arg_0.166: f32[], Arg_1.147: f32[]) -> f32[] {
  %Arg_0.166 = f32[] parameter(0)
  %Arg_1.147 = f32[] parameter(1)
  ROOT %add.240 = f32[] add(%Arg_0.166, %Arg_1.147)
}

%region_170.4333 (Arg_0.4330: f32[], Arg_1.4331: f32[]) -> f32[] {
  %Arg_0.4330 = f32[] parameter(0)
  %Arg_1.4331 = f32[] parameter(1)
  ROOT %add.4332 = f32[] add(%Arg_0.4330, %Arg_1.4331)
}

%region_170.4333.clone (Arg_0.167: f32[], Arg_1.148: f32[]) -> f32[] {
  %Arg_0.167 = f32[] parameter(0)
  %Arg_1.148 = f32[] parameter(1)
  ROOT %add.241 = f32[] add(%Arg_0.167, %Arg_1.148)
}

%region_171.4340 (Arg_0.4337: f32[], Arg_1.4338: f32[]) -> f32[] {
  %Arg_0.4337 = f32[] parameter(0)
  %Arg_1.4338 = f32[] parameter(1)
  ROOT %add.4339 = f32[] add(%Arg_0.4337, %Arg_1.4338)
}

%region_171.4340.clone (Arg_0.168: f32[], Arg_1.149: f32[]) -> f32[] {
  %Arg_0.168 = f32[] parameter(0)
  %Arg_1.149 = f32[] parameter(1)
  ROOT %add.242 = f32[] add(%Arg_0.168, %Arg_1.149)
}

%region_172.4347 (Arg_0.4344: f32[], Arg_1.4345: f32[]) -> f32[] {
  %Arg_0.4344 = f32[] parameter(0)
  %Arg_1.4345 = f32[] parameter(1)
  ROOT %add.4346 = f32[] add(%Arg_0.4344, %Arg_1.4345)
}

%region_172.4347.clone (Arg_0.169: f32[], Arg_1.150: f32[]) -> f32[] {
  %Arg_0.169 = f32[] parameter(0)
  %Arg_1.150 = f32[] parameter(1)
  ROOT %add.243 = f32[] add(%Arg_0.169, %Arg_1.150)
}

%region_173.4354 (Arg_0.4351: f32[], Arg_1.4352: f32[]) -> f32[] {
  %Arg_0.4351 = f32[] parameter(0)
  %Arg_1.4352 = f32[] parameter(1)
  ROOT %add.4353 = f32[] add(%Arg_0.4351, %Arg_1.4352)
}

%region_173.4354.clone (Arg_0.170: f32[], Arg_1.151: f32[]) -> f32[] {
  %Arg_0.170 = f32[] parameter(0)
  %Arg_1.151 = f32[] parameter(1)
  ROOT %add.245 = f32[] add(%Arg_0.170, %Arg_1.151)
}

%region_174.4361 (Arg_0.4358: f32[], Arg_1.4359: f32[]) -> f32[] {
  %Arg_0.4358 = f32[] parameter(0)
  %Arg_1.4359 = f32[] parameter(1)
  ROOT %add.4360 = f32[] add(%Arg_0.4358, %Arg_1.4359)
}

%region_174.4361.clone (Arg_0.171: f32[], Arg_1.152: f32[]) -> f32[] {
  %Arg_0.171 = f32[] parameter(0)
  %Arg_1.152 = f32[] parameter(1)
  ROOT %add.246 = f32[] add(%Arg_0.171, %Arg_1.152)
}

%region_24.1352 (Arg_0.1349: f32[], Arg_1.1350: f32[]) -> f32[] {
  %Arg_0.1349 = f32[] parameter(0)
  %Arg_1.1350 = f32[] parameter(1)
  ROOT %add.1351 = f32[] add(%Arg_0.1349, %Arg_1.1350)
}

%region_25.1368 (Arg_0.1365: f32[], Arg_1.1366: f32[]) -> f32[] {
  %Arg_0.1365 = f32[] parameter(0)
  %Arg_1.1366 = f32[] parameter(1)
  ROOT %add.1367 = f32[] add(%Arg_0.1365, %Arg_1.1366)
}

%region_25.1368.clone (Arg_0.172: f32[], Arg_1.153: f32[]) -> f32[] {
  %Arg_0.172 = f32[] parameter(0)
  %Arg_1.153 = f32[] parameter(1)
  ROOT %add.248 = f32[] add(%Arg_0.172, %Arg_1.153)
}

%region_271.5040 (Arg_0.5037: f32[], Arg_1.5038: f32[]) -> f32[] {
  %Arg_0.5037 = f32[] parameter(0)
  %Arg_1.5038 = f32[] parameter(1)
  ROOT %add.5039 = f32[] add(%Arg_0.5037, %Arg_1.5038)
}

%region_272.5047 (Arg_0.5044: f32[], Arg_1.5045: f32[]) -> f32[] {
  %Arg_0.5044 = f32[] parameter(0)
  %Arg_1.5045 = f32[] parameter(1)
  ROOT %add.5046 = f32[] add(%Arg_0.5044, %Arg_1.5045)
}

%region_272.5047.clone (Arg_0.173: f32[], Arg_1.154: f32[]) -> f32[] {
  %Arg_0.173 = f32[] parameter(0)
  %Arg_1.154 = f32[] parameter(1)
  ROOT %add.249 = f32[] add(%Arg_0.173, %Arg_1.154)
}

%region_273.5054 (Arg_0.5051: f32[], Arg_1.5052: f32[]) -> f32[] {
  %Arg_0.5051 = f32[] parameter(0)
  %Arg_1.5052 = f32[] parameter(1)
  ROOT %add.5053 = f32[] add(%Arg_0.5051, %Arg_1.5052)
}

%region_273.5054.clone (Arg_0.174: f32[], Arg_1.155: f32[]) -> f32[] {
  %Arg_0.174 = f32[] parameter(0)
  %Arg_1.155 = f32[] parameter(1)
  ROOT %add.250 = f32[] add(%Arg_0.174, %Arg_1.155)
}

%region_274.5061 (Arg_0.5058: f32[], Arg_1.5059: f32[]) -> f32[] {
  %Arg_0.5058 = f32[] parameter(0)
  %Arg_1.5059 = f32[] parameter(1)
  ROOT %add.5060 = f32[] add(%Arg_0.5058, %Arg_1.5059)
}

%region_274.5061.clone (Arg_0.175: f32[], Arg_1.156: f32[]) -> f32[] {
  %Arg_0.175 = f32[] parameter(0)
  %Arg_1.156 = f32[] parameter(1)
  ROOT %add.251 = f32[] add(%Arg_0.175, %Arg_1.156)
}

%region_275.5068 (Arg_0.5065: f32[], Arg_1.5066: f32[]) -> f32[] {
  %Arg_0.5065 = f32[] parameter(0)
  %Arg_1.5066 = f32[] parameter(1)
  ROOT %add.5067 = f32[] add(%Arg_0.5065, %Arg_1.5066)
}

%region_276.5075 (Arg_0.5072: f32[], Arg_1.5073: f32[]) -> f32[] {
  %Arg_0.5072 = f32[] parameter(0)
  %Arg_1.5073 = f32[] parameter(1)
  ROOT %add.5074 = f32[] add(%Arg_0.5072, %Arg_1.5073)
}

%region_277.5082 (Arg_0.5079: f32[], Arg_1.5080: f32[]) -> f32[] {
  %Arg_0.5079 = f32[] parameter(0)
  %Arg_1.5080 = f32[] parameter(1)
  ROOT %add.5081 = f32[] add(%Arg_0.5079, %Arg_1.5080)
}

%region_277.5082.clone (Arg_0.176: f32[], Arg_1.157: f32[]) -> f32[] {
  %Arg_0.176 = f32[] parameter(0)
  %Arg_1.157 = f32[] parameter(1)
  ROOT %add.252 = f32[] add(%Arg_0.176, %Arg_1.157)
}

%region_278.5089 (Arg_0.5086: f32[], Arg_1.5087: f32[]) -> f32[] {
  %Arg_0.5086 = f32[] parameter(0)
  %Arg_1.5087 = f32[] parameter(1)
  ROOT %add.5088 = f32[] add(%Arg_0.5086, %Arg_1.5087)
}

%region_278.5089.clone (Arg_0.177: f32[], Arg_1.158: f32[]) -> f32[] {
  %Arg_0.177 = f32[] parameter(0)
  %Arg_1.158 = f32[] parameter(1)
  ROOT %add.253 = f32[] add(%Arg_0.177, %Arg_1.158)
}

%region_279.5096 (Arg_0.5093: f32[], Arg_1.5094: f32[]) -> f32[] {
  %Arg_0.5093 = f32[] parameter(0)
  %Arg_1.5094 = f32[] parameter(1)
  ROOT %add.5095 = f32[] add(%Arg_0.5093, %Arg_1.5094)
}

%region_279.5096.clone (Arg_0.178: f32[], Arg_1.159: f32[]) -> f32[] {
  %Arg_0.178 = f32[] parameter(0)
  %Arg_1.159 = f32[] parameter(1)
  ROOT %add.254 = f32[] add(%Arg_0.178, %Arg_1.159)
}

%region_280.5103 (Arg_0.5100: f32[], Arg_1.5101: f32[]) -> f32[] {
  %Arg_0.5100 = f32[] parameter(0)
  %Arg_1.5101 = f32[] parameter(1)
  ROOT %add.5102 = f32[] add(%Arg_0.5100, %Arg_1.5101)
}

%region_280.5103.clone (Arg_0.179: f32[], Arg_1.160: f32[]) -> f32[] {
  %Arg_0.179 = f32[] parameter(0)
  %Arg_1.160 = f32[] parameter(1)
  ROOT %add.255 = f32[] add(%Arg_0.179, %Arg_1.160)
}

%region_281.5110 (Arg_0.5107: f32[], Arg_1.5108: f32[]) -> f32[] {
  %Arg_0.5107 = f32[] parameter(0)
  %Arg_1.5108 = f32[] parameter(1)
  ROOT %add.5109 = f32[] add(%Arg_0.5107, %Arg_1.5108)
}

%region_281.5110.clone (Arg_0.180: f32[], Arg_1.161: f32[]) -> f32[] {
  %Arg_0.180 = f32[] parameter(0)
  %Arg_1.161 = f32[] parameter(1)
  ROOT %add.256 = f32[] add(%Arg_0.180, %Arg_1.161)
}

%region_282.5117 (Arg_0.5114: f32[], Arg_1.5115: f32[]) -> f32[] {
  %Arg_0.5114 = f32[] parameter(0)
  %Arg_1.5115 = f32[] parameter(1)
  ROOT %add.5116 = f32[] add(%Arg_0.5114, %Arg_1.5115)
}

%region_282.5117.clone (Arg_0.181: f32[], Arg_1.162: f32[]) -> f32[] {
  %Arg_0.181 = f32[] parameter(0)
  %Arg_1.162 = f32[] parameter(1)
  ROOT %add.257 = f32[] add(%Arg_0.181, %Arg_1.162)
}

%region_218.4669.clone (Arg_0.182: f32[], Arg_1.163: f32[]) -> f32[] {
  %Arg_0.182 = f32[] parameter(0)
  %Arg_1.163 = f32[] parameter(1)
  ROOT %add.258 = f32[] add(%Arg_0.182, %Arg_1.163)
}

%region_219.4676.clone (Arg_0.183: f32[], Arg_1.164: f32[]) -> f32[] {
  %Arg_0.183 = f32[] parameter(0)
  %Arg_1.164 = f32[] parameter(1)
  ROOT %add.259 = f32[] add(%Arg_0.183, %Arg_1.164)
}

%region_220.4683.clone (Arg_0.184: f32[], Arg_1.165: f32[]) -> f32[] {
  %Arg_0.184 = f32[] parameter(0)
  %Arg_1.165 = f32[] parameter(1)
  ROOT %add.260 = f32[] add(%Arg_0.184, %Arg_1.165)
}

%region_223.4704.clone (Arg_0.186: f32[], Arg_1.166: f32[]) -> f32[] {
  %Arg_0.186 = f32[] parameter(0)
  %Arg_1.166 = f32[] parameter(1)
  ROOT %add.261 = f32[] add(%Arg_0.186, %Arg_1.166)
}

%region_224.4711.clone (Arg_0.187: f32[], Arg_1.167: f32[]) -> f32[] {
  %Arg_0.187 = f32[] parameter(0)
  %Arg_1.167 = f32[] parameter(1)
  ROOT %add.262 = f32[] add(%Arg_0.187, %Arg_1.167)
}

%region_225.4718.clone (Arg_0.189: f32[], Arg_1.168: f32[]) -> f32[] {
  %Arg_0.189 = f32[] parameter(0)
  %Arg_1.168 = f32[] parameter(1)
  ROOT %add.263 = f32[] add(%Arg_0.189, %Arg_1.168)
}

%region_226.4725.clone (Arg_0.190: f32[], Arg_1.169: f32[]) -> f32[] {
  %Arg_0.190 = f32[] parameter(0)
  %Arg_1.169 = f32[] parameter(1)
  ROOT %add.264 = f32[] add(%Arg_0.190, %Arg_1.169)
}

%region_227.4732.clone (Arg_0.191: f32[], Arg_1.170: f32[]) -> f32[] {
  %Arg_0.191 = f32[] parameter(0)
  %Arg_1.170 = f32[] parameter(1)
  ROOT %add.265 = f32[] add(%Arg_0.191, %Arg_1.170)
}

%region_228.4739.clone (Arg_0.192: f32[], Arg_1.171: f32[]) -> f32[] {
  %Arg_0.192 = f32[] parameter(0)
  %Arg_1.171 = f32[] parameter(1)
  ROOT %add.266 = f32[] add(%Arg_0.192, %Arg_1.171)
}

ENTRY %main.5209_spmd (param.46: s32[], param.59: f32[80,1024], param.60: f32[80,1], param.61: f32[80,1024], param.62: f32[80,1], param.92: f32[80,1024], param.93: f32[80,1], param.63: f32[80,1024], param.64: f32[80,1], param.65: f32[80,1024], param.66: f32[80,1], param.94: f32[80,1024], param.95: f32[80,1], param.67: f32[80,1024], param.68: f32[80,1], param.69: f32[80,1024], param.70: f32[80,1], param.96: f32[80,1024], param.97: f32[80,1], param.71: f32[80,1024], param.72: f32[80,1], param.73: f32[80,1024], param.74: f32[80,1], param.98: f32[80,1024], param.99: f32[80,1], param.75: f32[80,1024], param.76: f32[80,1], param.77: f32[80,1024], param.78: f32[80,1], param.100: f32[80,1024], param.101: f32[80,1], param.79: f32[80,1024], param.80: f32[80,1], param.81: f32[80,1024], param.82: f32[80,1], param.102: f32[80,1024], param.103: f32[80,1], param.83: f32[80,1024], param.84: f32[80,1], param.85: f32[80,1024], param.86: f32[80,1], param.104: f32[80,1024], param.105: f32[80,1], param.89: f32[8192], param.50: f32[64,80,28672], param.51: f32[64,80,28672], param.52: f32[28672,80,64], param.53: f32[8192,80], param.54: f32[8192,80], param.55: f32[64,80,8,128], param.56: f32[64,80,128,64], param.57: f32[64,80,64,128], param.58: f32[64,80,8,128], param.90: f32[64,128256], param.49: f32[128256,64], param.108: s32[], param.107: f32[8192], param.110: f32[64,80,28672], param.112: f32[64,80,28672], param.114: f32[28672,80,64], param.116: f32[8192,80], param.118: f32[8192,80], param.120: f32[64,80,8,128], param.122: f32[64,80,128,64], param.124: f32[64,80,64,128], param.126: f32[64,80,8,128], param.128: f32[64,128256], param.130: f32[128256,64], param.109: f32[8192], param.111: f32[64,80,28672], param.113: f32[64,80,28672], param.115: f32[28672,80,64], param.117: f32[8192,80], param.119: f32[8192,80], param.121: f32[64,80,8,128], param.123: f32[64,80,128,64], param.125: f32[64,80,64,128], param.127: f32[64,80,8,128], param.129: f32[64,128256], param.131: f32[128256,64], param.106: s32[], param.48: s32[2,8192], param.87: s32[2,8192], param.88: s32[2,8192], param.91: s32[2,8192], param.47: s32[2,8192]) -> (s32[], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=5*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=10*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=15*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=20*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=25*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=30*/f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], /*index=35*/f32[80,1024], f32[80,1], f32[80,1024], f32[80,1], f32[80,1024], /*index=40*/f32[80,1], f32[80,1024], f32[80,1], f32[8192], f32[64,80,28672], /*index=45*/f32[64,80,28672], f32[28672,80,64], f32[8192,80], f32[8192,80], f32[64,80,8,128], /*index=50*/f32[64,80,128,64], f32[64,80,64,128], f32[64,80,8,128], f32[64,128256], f32[128256,64], /*index=55*/s32[], f32[8192], f32[64,80,28672], f32[64,80,28672], f32[28672,80,64], /*index=60*/f32[8192,80], f32[8192,80], f32[64,80,8,128], f32[64,80,128,64], f32[64,80,64,128], /*index=65*/f32[64,80,8,128], f32[64,128256], f32[128256,64], f32[8192], f32[64,80,28672], /*index=70*/f32[64,80,28672], f32[28672,80,64], f32[8192,80], f32[8192,80], f32[64,80,8,128], /*index=75*/f32[64,80,128,64], f32[64,80,64,128], f32[64,80,8,128], f32[64,128256], f32[128256,64], /*index=80*/s32[], f32[], f32[], f32[], f32[], /*index=85*/f32[], s32[]) {
  %param.46 = s32[] parameter(0), sharding={replicated}
  %constant.2626 = s32[] constant(1)
  %add.267 = s32[] add(%param.46, %constant.2626)
  %constant.2627 = s32[] constant(0)
  %param.47 = s32[2,8192]{1,0} parameter(85), sharding={devices=[256,1]<=[256]}
  %broadcast.2027 = s32[2,8192]{1,0} broadcast(%constant.2627), dimensions={}
  %compare.363 = pred[2,8192]{1,0} compare(%param.47, %broadcast.2027), direction=NE
  %constant.2629 = f32[] constant(1)
  %convert.445 = s32[2,8192]{1,0} convert(%compare.363)
  %reduce.226 = s32[] reduce(%convert.445, %constant.2627), dimensions={0,1}, to_apply=%region_26.1375
  %all-reduce.37 = s32[] all-reduce(%reduce.226), channel_id=1, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_26.1375.clone
  %convert.446 = f32[] convert(%all-reduce.37)
  %constant.2631 = f32[] constant(1e-08)
  %add.268 = f32[] add(%convert.446, %constant.2631)
  %divide.442 = f32[] divide(%constant.2629, %add.268)
  %broadcast.2029 = f32[2,8192]{1,0} broadcast(%divide.442), dimensions={}
  %constant.2632 = f32[] constant(0)
  %broadcast.2030 = f32[2,8192]{1,0} broadcast(%constant.2632), dimensions={}
  %select.450 = f32[2,8192]{1,0} select(%compare.363, %broadcast.2029, %broadcast.2030)
  %copy.80 = f32[2,8192]{1,0} copy(%select.450)
  %broadcast.2031 = f32[2,8192,128256]{2,1,0} broadcast(%copy.80), dimensions={0,1}
  %param.48 = s32[2,8192]{1,0} parameter(81), sharding={devices=[256,1]<=[256]}
  %broadcast.2032 = s32[2,8192,128256]{2,1,0} broadcast(%param.48), dimensions={0,1}
  %iota.23 = s32[2,8192,128256]{2,1,0} iota(), iota_dimension=2
  %compare.365 = pred[2,8192,128256]{2,1,0} compare(%broadcast.2032, %iota.23), direction=EQ
  %convert.447 = bf16[2,8192,128256]{2,1,0} convert(%compare.365)
  %param.49 = f32[128256,64]{1,0} parameter(54), sharding={devices=[1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %convert.448 = bf16[128256,64]{1,0} convert(%param.49)
  %all-gather.14 = bf16[128256,8192]{1,0} all-gather(%convert.448), channel_id=2, replica_groups=[2,128]<=[256], dimensions={1}, use_global_device_ids=true
  %dot.59 = bf16[2,8192,8192]{2,1,0} dot(%convert.447, %all-gather.14), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %copy.81 = bf16[2,8192,8192]{2,1,0} copy(%dot.59)
  %constant.2634 = bf16[] constant(0)
  %broadcast.2033 = bf16[80,2,8192,8192]{3,2,1,0} broadcast(%constant.2634), dimensions={}
  %param.50 = f32[64,80,28672]{2,1,0} parameter(44), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.60 = f32[80,64,28672]{2,0,1} transpose(%param.50), dimensions={1,0,2}
  %param.51 = f32[64,80,28672]{2,1,0} parameter(45), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.61 = f32[80,64,28672]{2,0,1} transpose(%param.51), dimensions={1,0,2}
  %param.52 = f32[28672,80,64]{2,1,0} parameter(46), sharding={devices=[1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.62 = f32[80,28672,64]{2,0,1} transpose(%param.52), dimensions={1,0,2}
  %param.53 = f32[8192,80]{1,0} parameter(47), sharding={replicated}
  %transpose.63 = f32[80,8192]{0,1} transpose(%param.53), dimensions={1,0}
  %param.54 = f32[8192,80]{1,0} parameter(48), sharding={replicated}
  %transpose.64 = f32[80,8192]{0,1} transpose(%param.54), dimensions={1,0}
  %param.55 = f32[64,80,8,128]{3,2,1,0} parameter(49), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.65 = f32[80,64,8,128]{3,2,0,1} transpose(%param.55), dimensions={1,0,2,3}
  %param.56 = f32[64,80,128,64]{3,2,1,0} parameter(50), sharding={devices=[1,1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.66 = f32[80,64,128,64]{3,2,0,1} transpose(%param.56), dimensions={1,0,2,3}
  %param.57 = f32[64,80,64,128]{3,2,1,0} parameter(51), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.67 = f32[80,64,64,128]{3,2,0,1} transpose(%param.57), dimensions={1,0,2,3}
  %param.58 = f32[64,80,8,128]{3,2,1,0} parameter(52), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %transpose.68 = f32[80,64,8,128]{3,2,0,1} transpose(%param.58), dimensions={1,0,2,3}
  %param.59 = f32[80,1024]{1,0} parameter(1), sharding={replicated}
  %param.60 = f32[80,1]{1,0} parameter(2), sharding={replicated}
  %param.61 = f32[80,1024]{1,0} parameter(3), sharding={replicated}
  %param.62 = f32[80,1]{1,0} parameter(4), sharding={replicated}
  %param.63 = f32[80,1024]{1,0} parameter(7), sharding={replicated}
  %param.64 = f32[80,1]{1,0} parameter(8), sharding={replicated}
  %param.65 = f32[80,1024]{1,0} parameter(9), sharding={replicated}
  %param.66 = f32[80,1]{1,0} parameter(10), sharding={replicated}
  %param.67 = f32[80,1024]{1,0} parameter(13), sharding={replicated}
  %param.68 = f32[80,1]{1,0} parameter(14), sharding={replicated}
  %param.69 = f32[80,1024]{1,0} parameter(15), sharding={replicated}
  %param.70 = f32[80,1]{1,0} parameter(16), sharding={replicated}
  %param.71 = f32[80,1024]{1,0} parameter(19), sharding={replicated}
  %param.72 = f32[80,1]{1,0} parameter(20), sharding={replicated}
  %param.73 = f32[80,1024]{1,0} parameter(21), sharding={replicated}
  %param.74 = f32[80,1]{1,0} parameter(22), sharding={replicated}
  %param.75 = f32[80,1024]{1,0} parameter(25), sharding={replicated}
  %param.76 = f32[80,1]{1,0} parameter(26), sharding={replicated}
  %param.77 = f32[80,1024]{1,0} parameter(27), sharding={replicated}
  %param.78 = f32[80,1]{1,0} parameter(28), sharding={replicated}
  %param.79 = f32[80,1024]{1,0} parameter(31), sharding={replicated}
  %param.80 = f32[80,1]{1,0} parameter(32), sharding={replicated}
  %param.81 = f32[80,1024]{1,0} parameter(33), sharding={replicated}
  %param.82 = f32[80,1]{1,0} parameter(34), sharding={replicated}
  %param.83 = f32[80,1024]{1,0} parameter(37), sharding={replicated}
  %param.84 = f32[80,1]{1,0} parameter(38), sharding={replicated}
  %param.85 = f32[80,1024]{1,0} parameter(39), sharding={replicated}
  %param.86 = f32[80,1]{1,0} parameter(40), sharding={replicated}
  %param.87 = s32[2,8192]{1,0} parameter(82), sharding={devices=[256,1]<=[256]}
  %convert.449 = f32[2,8192]{1,0} convert(%param.87)
  %broadcast.2034 = f32[2,8192,1,128]{3,2,1,0} broadcast(%convert.449), dimensions={0,1}
  %broadcast.2035 = f32[128]{0} broadcast(%constant.2629), dimensions={}
  %constant.2636 = f32[] constant(6.28318548)
  %broadcast.2036 = f32[128]{0} broadcast(%constant.2636), dimensions={}
  %constant.2637 = f32[] constant(500000)
  %broadcast.2037 = f32[128]{0} broadcast(%constant.2637), dimensions={}
  %iota.24 = s32[64]{0} iota(), iota_dimension=0
  %constant.2638 = s32[] constant(2)
  %broadcast.2038 = s32[64]{0} broadcast(%constant.2638), dimensions={}
  %multiply.383 = s32[64]{0} multiply(%iota.24, %broadcast.2038)
  %convert.450 = f32[64]{0} convert(%multiply.383)
  %constant.2639 = f32[] constant(0.0078125)
  %broadcast.2039 = f32[64]{0} broadcast(%constant.2639), dimensions={}
  %multiply.384 = f32[64]{0} multiply(%convert.450, %broadcast.2039)
  %broadcast.2040 = f32[64,2]{1,0} broadcast(%multiply.384), dimensions={0}
  %reshape.2107 = f32[128]{0} reshape(%broadcast.2040)
  %power.14 = f32[128]{0} power(%broadcast.2037, %reshape.2107)
  %multiply.385 = f32[128]{0} multiply(%broadcast.2036, %power.14)
  %constant.2640 = f32[] constant(2048)
  %broadcast.2041 = f32[128]{0} broadcast(%constant.2640), dimensions={}
  %compare.366 = pred[128]{0} compare(%multiply.385, %broadcast.2041), direction=LT
  %convert.451 = s32[128]{0} convert(%compare.366)
  %broadcast.2042 = s32[128]{0} broadcast(%constant.2626), dimensions={}
  %compare.367 = pred[128]{0} compare(%convert.451, %broadcast.2042), direction=LT
  %constant.2642 = f32[] constant(8192)
  %broadcast.2043 = f32[128]{0} broadcast(%constant.2642), dimensions={}
  %compare.368 = pred[128]{0} compare(%multiply.385, %broadcast.2043), direction=GT
  %convert.452 = s32[128]{0} convert(%compare.368)
  %compare.369 = pred[128]{0} compare(%convert.452, %broadcast.2042), direction=LT
  %negate.30 = f32[128]{0} negate(%reshape.2107)
  %power.15 = f32[128]{0} power(%broadcast.2037, %negate.30)
  %multiply.386 = f32[128]{0} multiply(%broadcast.2043, %power.15)
  %constant.2643 = f32[] constant(0.159154937)
  %broadcast.2044 = f32[128]{0} broadcast(%constant.2643), dimensions={}
  %multiply.387 = f32[128]{0} multiply(%multiply.386, %broadcast.2044)
  %constant.2644 = f32[] constant(-1)
  %broadcast.2045 = f32[128]{0} broadcast(%constant.2644), dimensions={}
  %add.269 = f32[128]{0} add(%multiply.387, %broadcast.2045)
  %constant.2645 = f32[] constant(0.333333343)
  %broadcast.2046 = f32[128]{0} broadcast(%constant.2645), dimensions={}
  %multiply.388 = f32[128]{0} multiply(%add.269, %broadcast.2046)
  %subtract.17 = f32[128]{0} subtract(%broadcast.2035, %multiply.388)
  %multiply.389 = f32[128]{0} multiply(%subtract.17, %power.15)
  %constant.2646 = f32[] constant(0.125)
  %broadcast.2047 = f32[128]{0} broadcast(%constant.2646), dimensions={}
  %multiply.390 = f32[128]{0} multiply(%multiply.389, %broadcast.2047)
  %multiply.391 = f32[128]{0} multiply(%multiply.388, %power.15)
  %add.270 = f32[128]{0} add(%multiply.390, %multiply.391)
  %multiply.392 = f32[128]{0} multiply(%power.15, %broadcast.2047)
  %select.451 = f32[128]{0} select(%compare.369, %add.270, %multiply.392)
  %select.452 = f32[128]{0} select(%compare.367, %select.451, %power.15)
  %divide.443 = f32[128]{0} divide(%broadcast.2035, %select.452)
  %broadcast.2049 = f32[2,8192,1,128]{3,2,1,0} broadcast(%divide.443), dimensions={3}
  %divide.444 = f32[2,8192,1,128]{3,2,1,0} divide(%broadcast.2034, %broadcast.2049)
  %cosine.4 = f32[2,8192,1,128]{3,2,1,0} cosine(%divide.444)
  %iota.25 = s32[128]{0} iota(), iota_dimension=0
  %and.95 = s32[128]{0} and(%iota.25, %broadcast.2042)
  %broadcast.2051 = s32[128]{0} broadcast(%constant.2627), dimensions={}
  %compare.370 = pred[128]{0} compare(%and.95, %broadcast.2051), direction=LT
  %compare.372 = pred[128]{0} compare(%and.95, %broadcast.2051), direction=NE
  %and.96 = pred[128]{0} and(%compare.370, %compare.372)
  %broadcast.2052 = s32[128]{0} broadcast(%constant.2638), dimensions={}
  %add.271 = s32[128]{0} add(%and.95, %broadcast.2052)
  %select.453 = s32[128]{0} select(%and.96, %add.271, %and.95)
  %broadcast.2053 = s32[2,8192,64,128]{3,2,1,0} broadcast(%select.453), dimensions={3}
  %sine.4 = f32[2,8192,1,128]{3,2,1,0} sine(%divide.444)
  %constant.2651 = s32[2]{0} constant({-1, 1})
  %broadcast.2054 = s32[64,2]{1,0} broadcast(%constant.2651), dimensions={1}
  %reshape.2109 = s32[128]{0} reshape(%broadcast.2054)
  %convert.453 = f32[128]{0} convert(%reshape.2109)
  %reshape.2110 = f32[1,1,1,128]{3,2,1,0} reshape(%convert.453)
  %broadcast.2071 = s32[2,8192,8,128]{3,2,1,0} broadcast(%select.453), dimensions={3}
  %param.88 = s32[2,8192]{1,0} parameter(83), sharding={devices=[256,1]<=[256]}
  %broadcast.2073 = s32[2,8192,8192]{2,1,0} broadcast(%param.88), dimensions={0,1}
  %broadcast.2074 = s32[2,8192,8192]{2,1,0} broadcast(%param.88), dimensions={0,2}
  %compare.380 = pred[2,8192,8192]{2,1,0} compare(%broadcast.2073, %broadcast.2074), direction=EQ
  %iota.28 = s32[8192,8192]{1,0} iota(), iota_dimension=1
  %iota.29 = s32[8192,8192]{1,0} iota(), iota_dimension=0
  %compare.381 = pred[8192,8192]{1,0} compare(%iota.28, %iota.29), direction=LE
  %broadcast.2075 = pred[2,8192,8192]{2,1,0} broadcast(%compare.381), dimensions={1,2}
  %and.99 = pred[2,8192,8192]{2,1,0} and(%compare.380, %broadcast.2075)
  %broadcast.2076 = f32[2,8192,8192]{2,1,0} broadcast(%constant.2632), dimensions={}
  %constant.2663 = f32[] constant(-2.38197633e+38)
  %broadcast.2077 = f32[2,8192,8192]{2,1,0} broadcast(%constant.2663), dimensions={}
  %select.457 = f32[2,8192,8192]{2,1,0} select(%and.99, %broadcast.2076, %broadcast.2077)
  %compare.382 = pred[2,8192,8192]{2,1,0} compare(%select.457, %broadcast.2076), direction=NE
  %not.4 = pred[2,8192,8192]{2,1,0} not(%compare.382)
  %convert.459 = s32[2,8192,8192]{2,1,0} convert(%not.4)
  %reduce.227 = s32[2,8192]{1,0} reduce(%convert.459, %constant.2627), dimensions={1}, to_apply=%region_0.440
  %reshape.2115 = s32[2,1,1,8192]{3,2,1,0} reshape(%reduce.227)
  %slice.467 = s32[2,1,1,1]{3,2,1,0} slice(%reshape.2115), slice={[0:2], [0:1], [0:1], [0:1]}
  %reshape.2118 = s32[2,1]{1,0} reshape(%slice.467)
  %reduce.228 = s32[2,8192]{1,0} reduce(%convert.459, %constant.2627), dimensions={2}, to_apply=%region_1.448
  %reshape.2119 = s32[2,1,1,8192]{3,2,1,0} reshape(%reduce.228)
  %constant.2676 = s32[] constant(-2147483648)
  %reduce.229 = s32[2,1]{1,0} reduce(%reshape.2119, %constant.2676), dimensions={3,2}, to_apply=%region_2.453
  %tuple.112 = (s32[], bf16[2,8192,8192]{2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, f32[80,64,28672]{2,0,1}, f32[80,64,28672]{2,0,1}, /*index=5*/f32[80,28672,64]{2,0,1}, f32[80,8192]{0,1}, f32[80,8192]{0,1}, f32[80,64,8,128]{3,2,0,1}, f32[80,64,128,64]{3,2,0,1}, /*index=10*/f32[80,64,64,128]{3,2,0,1}, f32[80,64,8,128]{3,2,0,1}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=15*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=20*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=25*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=30*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=35*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=40*/f32[2,8192,1,128]{3,2,1,0}, s32[2,8192,64,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, /*index=45*/s32[2,8192,8,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, s32[2,1]{1,0}, s32[2,1]{1,0}) tuple(%constant.2627, %copy.81, %broadcast.2033, %transpose.60, %transpose.61, /*index=5*/%transpose.62, %transpose.63, %transpose.64, %transpose.65, %transpose.66, /*index=10*/%transpose.67, %transpose.68, %param.59, %param.60, %param.61, /*index=15*/%param.62, %param.63, %param.64, %param.65, %param.66, /*index=20*/%param.67, %param.68, %param.69, %param.70, %param.71, /*index=25*/%param.72, %param.73, %param.74, %param.75, %param.76, /*index=30*/%param.77, %param.78, %param.79, %param.80, %param.81, /*index=35*/%param.82, %param.83, %param.84, %param.85, %param.86, /*index=40*/%cosine.4, %broadcast.2053, %sine.4, %reshape.2110, %cosine.4, /*index=45*/%broadcast.2071, %sine.4, %reshape.2110, %reshape.2118, %reduce.229)
  %while.21 = (s32[], bf16[2,8192,8192]{2,1,0}, bf16[80,2,8192,8192]{3,2,1,0}, f32[80,64,28672]{2,0,1}, f32[80,64,28672]{2,0,1}, /*index=5*/f32[80,28672,64]{2,0,1}, f32[80,8192]{0,1}, f32[80,8192]{0,1}, f32[80,64,8,128]{3,2,0,1}, f32[80,64,128,64]{3,2,0,1}, /*index=10*/f32[80,64,64,128]{3,2,0,1}, f32[80,64,8,128]{3,2,0,1}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=15*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=20*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=25*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=30*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=35*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=40*/f32[2,8192,1,128]{3,2,1,0}, s32[2,8192,64,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, /*index=45*/s32[2,8192,8,128]{3,2,1,0}, f32[2,8192,1,128]{3,2,1,0}, f32[1,1,1,128]{3,2,1,0}, s32[2,1]{1,0}, s32[2,1]{1,0}) while(%tuple.112), condition=%region_20.1277_spmd, body=%region_3.1223_spmd
  %get-tuple-element.447 = bf16[2,8192,8192]{2,1,0} get-tuple-element(%while.21), index=1
  %convert.461 = f32[2,8192,8192]{2,1,0} convert(%get-tuple-element.447)
  %multiply.404 = f32[2,8192,8192]{2,1,0} multiply(%convert.461, %convert.461)
  %reduce.230 = f32[2,8192]{1,0} reduce(%multiply.404, %constant.2632), dimensions={2}, to_apply=%region_21.1289
  %constant.2678 = f32[] constant(0.000122070312)
  %broadcast.2079 = f32[2,8192]{1,0} broadcast(%constant.2678), dimensions={}
  %multiply.405 = f32[2,8192]{1,0} multiply(%reduce.230, %broadcast.2079)
  %constant.2679 = f32[] constant(1e-05)
  %broadcast.2080 = f32[2,8192]{1,0} broadcast(%constant.2679), dimensions={}
  %add.275 = f32[2,8192]{1,0} add(%multiply.405, %broadcast.2080)
  %reshape.2120 = f32[2,8192,1]{2,1,0} reshape(%add.275)
  %rsqrt.10 = f32[2,8192,1]{2,1,0} rsqrt(%reshape.2120)
  %reshape.2121 = f32[2,8192]{1,0} reshape(%rsqrt.10)
  %broadcast.2082 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.2121), dimensions={0,1}
  %multiply.406 = f32[2,8192,8192]{2,1,0} multiply(%convert.461, %broadcast.2082)
  %convert.462 = bf16[2,8192,8192]{2,1,0} convert(%multiply.406)
  %param.89 = f32[8192]{0} parameter(43), sharding={replicated}
  %convert.463 = bf16[8192]{0} convert(%param.89)
  %broadcast.2083 = bf16[2,8192,8192]{2,1,0} broadcast(%convert.463), dimensions={2}
  %multiply.407 = bf16[2,8192,8192]{2,1,0} multiply(%convert.462, %broadcast.2083)
  %param.90 = f32[64,128256]{1,0} parameter(53), sharding={devices=[128,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %convert.464 = bf16[64,128256]{1,0} convert(%param.90)
  %all-gather.15 = bf16[8192,128256]{1,0} all-gather(%convert.464), channel_id=10, replica_groups=[2,128]<=[256], dimensions={0}, use_global_device_ids=true
  %dot.60 = bf16[2,8192,128256]{2,1,0} dot(%multiply.407, %all-gather.15), lhs_contracting_dims={2}, rhs_contracting_dims={0}
  %copy.82 = bf16[2,8192,128256]{2,1,0} copy(%dot.60)
  %convert.465 = f32[2,8192,128256]{2,1,0} convert(%copy.82)
  %constant.2680 = f32[] constant(-inf)
  %reduce.231 = f32[2,8192]{1,0} reduce(%convert.465, %constant.2680), dimensions={2}, to_apply=%region_22.1329
  %broadcast.2084 = f32[2,8192,128256]{2,1,0} broadcast(%reduce.231), dimensions={0,1}
  %subtract.19 = f32[2,8192,128256]{2,1,0} subtract(%convert.465, %broadcast.2084)
  %exponential.6 = f32[2,8192,128256]{2,1,0} exponential(%subtract.19)
  %reduce.232 = f32[2,8192]{1,0} reduce(%exponential.6, %constant.2632), dimensions={2}, to_apply=%region_23.1340
  %log.2 = f32[2,8192]{1,0} log(%reduce.232)
  %add.276 = f32[2,8192]{1,0} add(%log.2, %reduce.231)
  %multiply.408 = f32[2,8192]{1,0} multiply(%add.276, %broadcast.2030)
  %broadcast.2086 = f32[2,8192]{1,0} broadcast(%constant.2629), dimensions={}
  %add.277 = f32[2,8192]{1,0} add(%multiply.408, %broadcast.2086)
  %broadcast.2087 = f32[2,8192,128256]{2,1,0} broadcast(%add.277), dimensions={0,1}
  %multiply.409 = f32[2,8192,128256]{2,1,0} multiply(%broadcast.2087, %exponential.6)
  %broadcast.2088 = f32[2,8192,128256]{2,1,0} broadcast(%reduce.232), dimensions={0,1}
  %divide.447 = f32[2,8192,128256]{2,1,0} divide(%multiply.409, %broadcast.2088)
  %param.91 = s32[2,8192]{1,0} parameter(84), sharding={devices=[256,1]<=[256]}
  %broadcast.2089 = s32[2,8192,128256]{2,1,0} broadcast(%param.91), dimensions={0,1}
  %iota.30 = s32[2,8192,128256]{2,1,0} iota(), iota_dimension=2
  %compare.383 = pred[2,8192,128256]{2,1,0} compare(%broadcast.2089, %iota.30), direction=EQ
  %convert.466 = f32[2,8192,128256]{2,1,0} convert(%compare.383)
  %subtract.20 = f32[2,8192,128256]{2,1,0} subtract(%divide.447, %convert.466)
  %multiply.410 = f32[2,8192,128256]{2,1,0} multiply(%broadcast.2031, %subtract.20)
  %convert.467 = bf16[2,8192,128256]{2,1,0} convert(%multiply.410)
  %copy.83 = bf16[2,8192,128256]{2,1,0} copy(%convert.467)
  %dot.61 = bf16[2,8192,8192]{2,1,0} dot(%copy.83, %all-gather.15), lhs_contracting_dims={2}, rhs_contracting_dims={1}
  %multiply.411 = bf16[2,8192,8192]{2,1,0} multiply(%dot.61, %broadcast.2083)
  %convert.468 = f32[2,8192,8192]{2,1,0} convert(%multiply.411)
  %multiply.412 = f32[2,8192,8192]{2,1,0} multiply(%convert.468, %broadcast.2082)
  %multiply.413 = f32[2,8192,8192]{2,1,0} multiply(%convert.461, %convert.468)
  %reduce.233 = f32[2,8192]{1,0} reduce(%multiply.413, %constant.2632), dimensions={2}, to_apply=%region_29.1429
  %reshape.2123 = f32[2,8192,1]{2,1,0} reshape(%reduce.233)
  %divide.448 = f32[2,8192,1]{2,1,0} divide(%rsqrt.10, %reshape.2120)
  %constant.2685 = f32[] constant(-0.5)
  %broadcast.2093 = f32[2,8192,1]{2,1,0} broadcast(%constant.2685), dimensions={}
  %multiply.414 = f32[2,8192,1]{2,1,0} multiply(%divide.448, %broadcast.2093)
  %multiply.415 = f32[2,8192,1]{2,1,0} multiply(%reshape.2123, %multiply.414)
  %constant.2686 = f32[] constant(0.000244140625)
  %broadcast.2094 = f32[2,8192,1]{2,1,0} broadcast(%constant.2686), dimensions={}
  %multiply.416 = f32[2,8192,1]{2,1,0} multiply(%multiply.415, %broadcast.2094)
  %reshape.2124 = f32[2,8192]{1,0} reshape(%multiply.416)
  %broadcast.2095 = f32[2,8192,8192]{2,1,0} broadcast(%reshape.2124), dimensions={0,1}
  %multiply.417 = f32[2,8192,8192]{2,1,0} multiply(%convert.461, %broadcast.2095)
  %add.278 = f32[2,8192,8192]{2,1,0} add(%multiply.412, %multiply.417)
  %convert.469 = bf16[2,8192,8192]{2,1,0} convert(%add.278)
  %broadcast.2097 = f32[80,64,28672]{2,1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2098 = f32[80,28672,64]{2,1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2100 = f32[80,8192]{1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2101 = f32[80,64,8,128]{3,2,1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2102 = f32[80,64,128,64]{3,2,1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2103 = f32[80,64,64,128]{3,2,1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2104 = f32[80,1024]{1,0} broadcast(%constant.2632), dimensions={}
  %broadcast.2106 = f32[80,1]{1,0} broadcast(%constant.2632), dimensions={}
  %param.92 = f32[80,1024]{1,0} parameter(5), sharding={replicated}
  %param.93 = f32[80,1]{1,0} parameter(6), sharding={replicated}
  %param.94 = f32[80,1024]{1,0} parameter(11), sharding={replicated}
  %param.95 = f32[80,1]{1,0} parameter(12), sharding={replicated}
  %param.96 = f32[80,1024]{1,0} parameter(17), sharding={replicated}
  %param.97 = f32[80,1]{1,0} parameter(18), sharding={replicated}
  %param.98 = f32[80,1024]{1,0} parameter(23), sharding={replicated}
  %param.99 = f32[80,1]{1,0} parameter(24), sharding={replicated}
  %param.100 = f32[80,1024]{1,0} parameter(29), sharding={replicated}
  %param.101 = f32[80,1]{1,0} parameter(30), sharding={replicated}
  %param.102 = f32[80,1024]{1,0} parameter(35), sharding={replicated}
  %param.103 = f32[80,1]{1,0} parameter(36), sharding={replicated}
  %param.104 = f32[80,1024]{1,0} parameter(41), sharding={replicated}
  %param.105 = f32[80,1]{1,0} parameter(42), sharding={replicated}
  %get-tuple-element.448 = bf16[80,2,8192,8192]{3,2,1,0} get-tuple-element(%while.21), index=2
  %tuple.113 = (s32[], bf16[2,8192,8192]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, /*index=5*/f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, /*index=10*/f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=45*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=50*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=55*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=60*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=65*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=70*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=75*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=80*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=85*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=90*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=95*/f32[80,64,28672]{2,0,1}, f32[80,64,28672]{2,0,1}, f32[80,28672,64]{2,0,1}, f32[80,8192]{0,1}, f32[80,8192]{0,1}, /*index=100*/f32[80,64,8,128]{3,2,0,1}, f32[80,64,128,64]{3,2,0,1}, f32[80,64,64,128]{3,2,0,1}, f32[80,64,8,128]{3,2,0,1}, bf16[80,2,8192,8192]{3,2,1,0}, /*index=105*/s32[2,8192]{1,0}, s32[2,8192]{1,0}) tuple(%constant.2627, %convert.469, %broadcast.2097, %broadcast.2097, %broadcast.2098, /*index=5*/%broadcast.2100, %broadcast.2100, %broadcast.2101, %broadcast.2102, %broadcast.2103, /*index=10*/%broadcast.2101, %broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, /*index=15*/%broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, /*index=20*/%broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, /*index=25*/%broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, /*index=30*/%broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, /*index=35*/%broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, /*index=40*/%broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, /*index=45*/%broadcast.2104, %broadcast.2106, %broadcast.2104, %broadcast.2106, %broadcast.2104, /*index=50*/%broadcast.2106, %broadcast.2104, %broadcast.2106, %param.59, %param.60, /*index=55*/%param.61, %param.62, %param.92, %param.93, %param.63, /*index=60*/%param.64, %param.65, %param.66, %param.94, %param.95, /*index=65*/%param.67, %param.68, %param.69, %param.70, %param.96, /*index=70*/%param.97, %param.71, %param.72, %param.73, %param.74, /*index=75*/%param.98, %param.99, %param.75, %param.76, %param.77, /*index=80*/%param.78, %param.100, %param.101, %param.79, %param.80, /*index=85*/%param.81, %param.82, %param.102, %param.103, %param.83, /*index=90*/%param.84, %param.85, %param.86, %param.104, %param.105, /*index=95*/%transpose.60, %transpose.61, %transpose.62, %transpose.63, %transpose.64, /*index=100*/%transpose.65, %transpose.66, %transpose.67, %transpose.68, %get-tuple-element.448, /*index=105*/%param.88, %param.87)
  %while.22 = (s32[], bf16[2,8192,8192]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,64,28672]{2,1,0}, f32[80,28672,64]{2,1,0}, /*index=5*/f32[80,8192]{1,0}, f32[80,8192]{1,0}, f32[80,64,8,128]{3,2,1,0}, f32[80,64,128,64]{3,2,1,0}, f32[80,64,64,128]{3,2,1,0}, /*index=10*/f32[80,64,8,128]{3,2,1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=45*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=50*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=55*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=60*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=65*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=70*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=75*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=80*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=85*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=90*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=95*/f32[80,64,28672]{2,0,1}, f32[80,64,28672]{2,0,1}, f32[80,28672,64]{2,0,1}, f32[80,8192]{0,1}, f32[80,8192]{0,1}, /*index=100*/f32[80,64,8,128]{3,2,0,1}, f32[80,64,128,64]{3,2,0,1}, f32[80,64,64,128]{3,2,0,1}, f32[80,64,8,128]{3,2,0,1}, bf16[80,2,8192,8192]{3,2,1,0}, /*index=105*/s32[2,8192]{1,0}, s32[2,8192]{1,0}) while(%tuple.113), condition=%region_108.3507_spmd, body=%region_31.3396_spmd
  %get-tuple-element.449 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=11
  %get-tuple-element.450 = f32[80,1]{1,0} get-tuple-element(%while.22), index=12
  %get-tuple-element.451 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=13
  %get-tuple-element.452 = f32[80,1]{1,0} get-tuple-element(%while.22), index=14
  %get-tuple-element.453 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=15
  %get-tuple-element.454 = f32[80,1]{1,0} get-tuple-element(%while.22), index=16
  %get-tuple-element.455 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=17
  %get-tuple-element.506 = f32[80,1]{1,0} get-tuple-element(%while.22), index=18
  %get-tuple-element.507 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=19
  %get-tuple-element.508 = f32[80,1]{1,0} get-tuple-element(%while.22), index=20
  %get-tuple-element.509 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=21
  %get-tuple-element.510 = f32[80,1]{1,0} get-tuple-element(%while.22), index=22
  %get-tuple-element.511 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=23
  %get-tuple-element.512 = f32[80,1]{1,0} get-tuple-element(%while.22), index=24
  %get-tuple-element.513 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=25
  %get-tuple-element.514 = f32[80,1]{1,0} get-tuple-element(%while.22), index=26
  %get-tuple-element.515 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=27
  %get-tuple-element.516 = f32[80,1]{1,0} get-tuple-element(%while.22), index=28
  %get-tuple-element.517 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=29
  %get-tuple-element.518 = f32[80,1]{1,0} get-tuple-element(%while.22), index=30
  %get-tuple-element.519 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=31
  %get-tuple-element.520 = f32[80,1]{1,0} get-tuple-element(%while.22), index=32
  %get-tuple-element.521 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=33
  %get-tuple-element.522 = f32[80,1]{1,0} get-tuple-element(%while.22), index=34
  %get-tuple-element.523 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=35
  %get-tuple-element.524 = f32[80,1]{1,0} get-tuple-element(%while.22), index=36
  %get-tuple-element.525 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=37
  %get-tuple-element.526 = f32[80,1]{1,0} get-tuple-element(%while.22), index=38
  %get-tuple-element.527 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=39
  %get-tuple-element.528 = f32[80,1]{1,0} get-tuple-element(%while.22), index=40
  %get-tuple-element.529 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=41
  %get-tuple-element.530 = f32[80,1]{1,0} get-tuple-element(%while.22), index=42
  %get-tuple-element.531 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=43
  %get-tuple-element.532 = f32[80,1]{1,0} get-tuple-element(%while.22), index=44
  %get-tuple-element.533 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=45
  %get-tuple-element.534 = f32[80,1]{1,0} get-tuple-element(%while.22), index=46
  %get-tuple-element.535 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=47
  %get-tuple-element.536 = f32[80,1]{1,0} get-tuple-element(%while.22), index=48
  %get-tuple-element.537 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=49
  %get-tuple-element.538 = f32[80,1]{1,0} get-tuple-element(%while.22), index=50
  %get-tuple-element.539 = f32[80,1024]{1,0} get-tuple-element(%while.22), index=51
  %get-tuple-element.540 = f32[80,1]{1,0} get-tuple-element(%while.22), index=52
  %param.106 = s32[] parameter(80), sharding={replicated}
  %constant.2695 = s32[] constant(15000)
  %compare.385 = pred[] compare(%param.106, %constant.2695), direction=LT
  %maximum.119 = s32[] maximum(%constant.2627, %param.106)
  %minimum.92 = s32[] minimum(%constant.2695, %maximum.119)
  %convert.470 = f32[] convert(%minimum.92)
  %constant.2699 = f32[] constant(6.66666674e-05)
  %multiply.418 = f32[] multiply(%convert.470, %constant.2699)
  %subtract.21 = f32[] subtract(%constant.2629, %multiply.418)
  %constant.2700 = f32[] constant(-0.001)
  %multiply.419 = f32[] multiply(%subtract.21, %constant.2700)
  %constant.2701 = f32[] constant(0.001)
  %add.279 = f32[] add(%multiply.419, %constant.2701)
  %constant.2702 = s32[] constant(-15000)
  %add.280 = s32[] add(%param.106, %constant.2702)
  %convert.471 = f32[] convert(%add.280)
  %constant.2703 = f32[] constant(2.32708844e-05)
  %multiply.420 = f32[] multiply(%convert.471, %constant.2703)
  %cosine.6 = f32[] cosine(%multiply.420)
  %add.281 = f32[] add(%cosine.6, %constant.2629)
  %constant.2705 = f32[] constant(0.0005)
  %multiply.421 = f32[] multiply(%add.281, %constant.2705)
  %constant.2707 = f32[] constant(0.5)
  %multiply.422 = f32[] multiply(%add.281, %constant.2707)
  %subtract.22 = f32[] subtract(%constant.2629, %multiply.422)
  %constant.2708 = f32[] constant(0.0001)
  %multiply.423 = f32[] multiply(%subtract.22, %constant.2708)
  %add.282 = f32[] add(%multiply.421, %multiply.423)
  %select.458 = f32[] select(%compare.385, %add.279, %add.282)
  %multiply.424 = f32[] multiply(%select.458, %constant.2644)
  %broadcast.2108 = f32[8192]{0} broadcast(%multiply.424), dimensions={}
  %multiply.425 = bf16[2,8192,8192]{2,1,0} multiply(%convert.462, %dot.61)
  %reduce.234 = bf16[8192]{0} reduce(%multiply.425, %constant.2634), dimensions={0,1}, to_apply=%region_27.1411
  %all-reduce.38 = bf16[8192]{0} all-reduce(%reduce.234), channel_id=55, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_27.1411.clone
  %convert.472 = f32[8192]{0} convert(%all-reduce.38)
  %multiply.426 = f32[8192]{0} multiply(%convert.472, %convert.472)
  %reduce.235 = f32[] reduce(%multiply.426, %constant.2632), dimensions={0}, to_apply=%region_109.3580
  %get-tuple-element.541 = f32[80,64,28672]{2,1,0} get-tuple-element(%while.22), index=2
  %transpose.69 = f32[64,80,28672]{2,0,1} transpose(%get-tuple-element.541), dimensions={1,0,2}
  %multiply.427 = f32[64,80,28672]{2,0,1} multiply(%transpose.69, %transpose.69)
  %reduce.236 = f32[] reduce(%multiply.427, %constant.2632), dimensions={0,1,2}, to_apply=%region_110.3586
  %all-reduce.39 = f32[] all-reduce(%reduce.236), channel_id=56, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_110.3586.clone
  %add.283 = f32[] add(%reduce.235, %all-reduce.39)
  %get-tuple-element.542 = f32[80,64,28672]{2,1,0} get-tuple-element(%while.22), index=3
  %transpose.70 = f32[64,80,28672]{2,0,1} transpose(%get-tuple-element.542), dimensions={1,0,2}
  %multiply.428 = f32[64,80,28672]{2,0,1} multiply(%transpose.70, %transpose.70)
  %reduce.237 = f32[] reduce(%multiply.428, %constant.2632), dimensions={0,1,2}, to_apply=%region_111.3593
  %all-reduce.40 = f32[] all-reduce(%reduce.237), channel_id=57, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_111.3593.clone
  %add.284 = f32[] add(%add.283, %all-reduce.40)
  %get-tuple-element.543 = f32[80,28672,64]{2,1,0} get-tuple-element(%while.22), index=4
  %transpose.71 = f32[28672,80,64]{2,0,1} transpose(%get-tuple-element.543), dimensions={1,0,2}
  %multiply.429 = f32[28672,80,64]{2,0,1} multiply(%transpose.71, %transpose.71)
  %reduce.238 = f32[] reduce(%multiply.429, %constant.2632), dimensions={0,1,2}, to_apply=%region_112.3600
  %all-reduce.41 = f32[] all-reduce(%reduce.238), channel_id=58, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_112.3600.clone
  %add.285 = f32[] add(%add.284, %all-reduce.41)
  %get-tuple-element.544 = f32[80,8192]{1,0} get-tuple-element(%while.22), index=5
  %transpose.72 = f32[8192,80]{0,1} transpose(%get-tuple-element.544), dimensions={1,0}
  %multiply.430 = f32[8192,80]{0,1} multiply(%transpose.72, %transpose.72)
  %reduce.239 = f32[] reduce(%multiply.430, %constant.2632), dimensions={0,1}, to_apply=%region_113.3607
  %add.286 = f32[] add(%add.285, %reduce.239)
  %get-tuple-element.545 = f32[80,8192]{1,0} get-tuple-element(%while.22), index=6
  %transpose.73 = f32[8192,80]{0,1} transpose(%get-tuple-element.545), dimensions={1,0}
  %multiply.431 = f32[8192,80]{0,1} multiply(%transpose.73, %transpose.73)
  %reduce.240 = f32[] reduce(%multiply.431, %constant.2632), dimensions={0,1}, to_apply=%region_114.3614
  %add.287 = f32[] add(%add.286, %reduce.240)
  %get-tuple-element.546 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%while.22), index=7
  %transpose.74 = f32[64,80,8,128]{3,2,0,1} transpose(%get-tuple-element.546), dimensions={1,0,2,3}
  %multiply.432 = f32[64,80,8,128]{3,2,0,1} multiply(%transpose.74, %transpose.74)
  %reduce.241 = f32[] reduce(%multiply.432, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_115.3621
  %all-reduce.42 = f32[] all-reduce(%reduce.241), channel_id=59, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_115.3621.clone
  %add.288 = f32[] add(%add.287, %all-reduce.42)
  %get-tuple-element.547 = f32[80,64,128,64]{3,2,1,0} get-tuple-element(%while.22), index=8
  %transpose.75 = f32[64,80,128,64]{3,2,0,1} transpose(%get-tuple-element.547), dimensions={1,0,2,3}
  %multiply.433 = f32[64,80,128,64]{3,2,0,1} multiply(%transpose.75, %transpose.75)
  %reduce.242 = f32[] reduce(%multiply.433, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_116.3628
  %all-reduce.43 = f32[] all-reduce(%reduce.242), channel_id=60, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_116.3628.clone
  %add.289 = f32[] add(%add.288, %all-reduce.43)
  %get-tuple-element.548 = f32[80,64,64,128]{3,2,1,0} get-tuple-element(%while.22), index=9
  %transpose.76 = f32[64,80,64,128]{3,2,0,1} transpose(%get-tuple-element.548), dimensions={1,0,2,3}
  %multiply.434 = f32[64,80,64,128]{3,2,0,1} multiply(%transpose.76, %transpose.76)
  %reduce.243 = f32[] reduce(%multiply.434, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_117.3635
  %all-reduce.44 = f32[] all-reduce(%reduce.243), channel_id=61, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_117.3635.clone
  %add.290 = f32[] add(%add.289, %all-reduce.44)
  %get-tuple-element.549 = f32[80,64,8,128]{3,2,1,0} get-tuple-element(%while.22), index=10
  %transpose.77 = f32[64,80,8,128]{3,2,0,1} transpose(%get-tuple-element.549), dimensions={1,0,2,3}
  %multiply.435 = f32[64,80,8,128]{3,2,0,1} multiply(%transpose.77, %transpose.77)
  %reduce.244 = f32[] reduce(%multiply.435, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_118.3642
  %all-reduce.45 = f32[] all-reduce(%reduce.244), channel_id=62, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_118.3642.clone
  %add.291 = f32[] add(%add.290, %all-reduce.45)
  %dot.62 = bf16[8192,128256]{1,0} dot(%multiply.407, %copy.83), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}
  %all-reduce.46 = bf16[8192,128256]{1,0} all-reduce(%dot.62), channel_id=63, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.14.clone
  %constant.2725 = s32[128]{0} constant({0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120, 5184, 5248, 5312, 5376, 5440, 5504, 5568, 5632, 5696, 5760, 5824, 5888, 5952, 6016, 6080, 6144, 6208, 6272, 6336, 6400, 6464, 6528, 6592, 6656, 6720, 6784, 6848, 6912, 6976, 7040, 7104, 7168, 7232, 7296, 7360, 7424, 7488, 7552, 7616, 7680, 7744, 7808, 7872, 7936, 8000, 8064, 8128})
  %constant.2724 = u32[256]{0} constant({0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127})
  %partition-id.12 = u32[] partition-id()
  %dynamic-slice.282 = u32[1]{0} dynamic-slice(%constant.2724, %partition-id.12), dynamic_slice_sizes={1}
  %reshape.2126 = u32[] reshape(%dynamic-slice.282)
  %dynamic-slice.283 = s32[1]{0} dynamic-slice(%constant.2725, %reshape.2126), dynamic_slice_sizes={1}
  %reshape.2127 = s32[] reshape(%dynamic-slice.283)
  %dynamic-slice.284 = bf16[64,128256]{1,0} dynamic-slice(%all-reduce.46, %reshape.2127, %constant.2627), dynamic_slice_sizes={64,128256}
  %all-reduce.47 = bf16[64,128256]{1,0} all-reduce(%dynamic-slice.284), channel_id=64, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.15.clone
  %convert.473 = f32[64,128256]{0,1} convert(%all-reduce.47)
  %multiply.436 = f32[64,128256]{0,1} multiply(%convert.473, %convert.473)
  %reduce.245 = f32[] reduce(%multiply.436, %constant.2632), dimensions={0,1}, to_apply=%region_119.3649
  %all-reduce.48 = f32[] all-reduce(%reduce.245), channel_id=65, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_119.3649.clone
  %add.292 = f32[] add(%add.291, %all-reduce.48)
  %get-tuple-element.550 = bf16[2,8192,8192]{2,1,0} get-tuple-element(%while.22), index=1
  %copy.84 = bf16[2,8192,8192]{2,1,0} copy(%get-tuple-element.550)
  %dot.63 = bf16[128256,8192]{1,0} dot(%convert.447, %copy.84), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}
  %all-reduce.49 = bf16[128256,8192]{1,0} all-reduce(%dot.63), channel_id=66, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%add.16.clone
  %dynamic-slice.288 = bf16[128256,64]{1,0} dynamic-slice(%all-reduce.49, %constant.2627, %reshape.2127), dynamic_slice_sizes={128256,64}
  %all-reduce.50 = bf16[128256,64]{1,0} all-reduce(%dynamic-slice.288), channel_id=67, replica_groups=[128,2]<=[2,128]T(1,0), use_global_device_ids=true, to_apply=%add.17.clone
  %convert.474 = f32[128256,64]{0,1} convert(%all-reduce.50)
  %multiply.437 = f32[128256,64]{0,1} multiply(%convert.474, %convert.474)
  %reduce.246 = f32[] reduce(%multiply.437, %constant.2632), dimensions={0,1}, to_apply=%region_120.3656
  %all-reduce.51 = f32[] all-reduce(%reduce.246), channel_id=68, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_120.3656.clone
  %add.293 = f32[] add(%add.292, %all-reduce.51)
  %sqrt.0 = f32[] sqrt(%add.293)
  %compare.387 = pred[] compare(%sqrt.0, %constant.2629), direction=LT
  %broadcast.2109 = pred[8192]{0} broadcast(%compare.387), dimensions={}
  %broadcast.2110 = f32[8192]{0} broadcast(%sqrt.0), dimensions={}
  %divide.449 = f32[8192]{0} divide(%convert.472, %broadcast.2110)
  %select.459 = f32[8192]{0} select(%broadcast.2109, %convert.472, %divide.449)
  %constant.2736 = f32[] constant(0.1)
  %broadcast.2111 = f32[8192]{0} broadcast(%constant.2736), dimensions={}
  %multiply.438 = f32[8192]{0} multiply(%select.459, %broadcast.2111)
  %param.107 = f32[8192]{0} parameter(56), sharding={replicated}
  %constant.2737 = f32[] constant(0.9)
  %broadcast.2112 = f32[8192]{0} broadcast(%constant.2737), dimensions={}
  %multiply.439 = f32[8192]{0} multiply(%param.107, %broadcast.2112)
  %add.294 = f32[8192]{0} add(%multiply.438, %multiply.439)
  %param.108 = s32[] parameter(55), sharding={replicated}
  %constant.2740 = s32[] constant(2147483647)
  %compare.388 = pred[] compare(%param.108, %constant.2740), direction=LT
  %add.295 = s32[] add(%param.108, %constant.2626)
  %select.460 = s32[] select(%compare.388, %add.295, %constant.2740)
  %convert.475 = f32[] convert(%select.460)
  %power.18 = f32[] power(%constant.2737, %convert.475)
  %subtract.23 = f32[] subtract(%constant.2629, %power.18)
  %broadcast.2113 = f32[8192]{0} broadcast(%subtract.23), dimensions={}
  %multiply.440 = f32[8192]{0} multiply(%select.459, %select.459)
  %constant.2743 = f32[] constant(0.05)
  %broadcast.2114 = f32[8192]{0} broadcast(%constant.2743), dimensions={}
  %multiply.441 = f32[8192]{0} multiply(%multiply.440, %broadcast.2114)
  %param.109 = f32[8192]{0} parameter(68), sharding={replicated}
  %constant.2744 = f32[] constant(0.95)
  %broadcast.2115 = f32[8192]{0} broadcast(%constant.2744), dimensions={}
  %multiply.442 = f32[8192]{0} multiply(%param.109, %broadcast.2115)
  %add.296 = f32[8192]{0} add(%multiply.441, %multiply.442)
  %power.19 = f32[] power(%constant.2744, %convert.475)
  %subtract.24 = f32[] subtract(%constant.2629, %power.19)
  %broadcast.2117 = f32[8192]{0} broadcast(%subtract.24), dimensions={}
  %divide.450 = f32[8192]{0} divide(%add.296, %broadcast.2117)
  %sqrt.1 = f32[8192]{0} sqrt(%divide.450)
  %broadcast.2118 = f32[8192]{0} broadcast(%constant.2631), dimensions={}
  %add.297 = f32[8192]{0} add(%sqrt.1, %broadcast.2118)
  %multiply.443 = f32[8192]{0} multiply(%broadcast.2113, %add.297)
  %divide.451 = f32[8192]{0} divide(%add.294, %multiply.443)
  %multiply.444 = f32[8192]{0} multiply(%param.89, %broadcast.2111)
  %add.298 = f32[8192]{0} add(%divide.451, %multiply.444)
  %multiply.445 = f32[8192]{0} multiply(%broadcast.2108, %add.298)
  %add.299 = f32[8192]{0} add(%param.89, %multiply.445)
  %broadcast.2119 = f32[64,80,28672]{2,1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2120 = pred[64,80,28672]{2,0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2121 = f32[64,80,28672]{2,1,0} broadcast(%sqrt.0), dimensions={}
  %divide.452 = f32[64,80,28672]{2,0,1} divide(%transpose.69, %broadcast.2121)
  %select.461 = f32[64,80,28672]{2,0,1} select(%broadcast.2120, %transpose.69, %divide.452)
  %broadcast.2122 = f32[64,80,28672]{2,1,0} broadcast(%constant.2736), dimensions={}
  %multiply.446 = f32[64,80,28672]{2,0,1} multiply(%select.461, %broadcast.2122)
  %param.110 = f32[64,80,28672]{2,1,0} parameter(57), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2123 = f32[64,80,28672]{2,1,0} broadcast(%constant.2737), dimensions={}
  %multiply.447 = f32[64,80,28672]{2,1,0} multiply(%param.110, %broadcast.2123)
  %add.301 = f32[64,80,28672]{2,0,1} add(%multiply.446, %multiply.447)
  %broadcast.2124 = f32[64,80,28672]{2,1,0} broadcast(%subtract.23), dimensions={}
  %multiply.448 = f32[64,80,28672]{2,0,1} multiply(%select.461, %select.461)
  %broadcast.2125 = f32[64,80,28672]{2,1,0} broadcast(%constant.2743), dimensions={}
  %multiply.449 = f32[64,80,28672]{2,0,1} multiply(%multiply.448, %broadcast.2125)
  %param.111 = f32[64,80,28672]{2,1,0} parameter(69), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2126 = f32[64,80,28672]{2,1,0} broadcast(%constant.2744), dimensions={}
  %multiply.450 = f32[64,80,28672]{2,1,0} multiply(%param.111, %broadcast.2126)
  %add.302 = f32[64,80,28672]{2,0,1} add(%multiply.449, %multiply.450)
  %broadcast.2127 = f32[64,80,28672]{2,1,0} broadcast(%subtract.24), dimensions={}
  %divide.453 = f32[64,80,28672]{2,0,1} divide(%add.302, %broadcast.2127)
  %sqrt.2 = f32[64,80,28672]{2,0,1} sqrt(%divide.453)
  %broadcast.2128 = f32[64,80,28672]{2,1,0} broadcast(%constant.2631), dimensions={}
  %add.303 = f32[64,80,28672]{2,0,1} add(%sqrt.2, %broadcast.2128)
  %multiply.451 = f32[64,80,28672]{2,1,0} multiply(%broadcast.2124, %add.303)
  %divide.454 = f32[64,80,28672]{2,0,1} divide(%add.301, %multiply.451)
  %multiply.452 = f32[64,80,28672]{2,1,0} multiply(%param.50, %broadcast.2122)
  %add.304 = f32[64,80,28672]{2,0,1} add(%divide.454, %multiply.452)
  %multiply.453 = f32[64,80,28672]{2,1,0} multiply(%broadcast.2119, %add.304)
  %add.305 = f32[64,80,28672]{2,1,0} add(%param.50, %multiply.453)
  %divide.455 = f32[64,80,28672]{2,0,1} divide(%transpose.70, %broadcast.2121)
  %select.462 = f32[64,80,28672]{2,0,1} select(%broadcast.2120, %transpose.70, %divide.455)
  %multiply.454 = f32[64,80,28672]{2,0,1} multiply(%select.462, %broadcast.2122)
  %param.112 = f32[64,80,28672]{2,1,0} parameter(58), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %multiply.455 = f32[64,80,28672]{2,1,0} multiply(%param.112, %broadcast.2123)
  %add.306 = f32[64,80,28672]{2,0,1} add(%multiply.454, %multiply.455)
  %multiply.456 = f32[64,80,28672]{2,0,1} multiply(%select.462, %select.462)
  %multiply.457 = f32[64,80,28672]{2,0,1} multiply(%multiply.456, %broadcast.2125)
  %param.113 = f32[64,80,28672]{2,1,0} parameter(70), sharding={devices=[128,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %multiply.458 = f32[64,80,28672]{2,1,0} multiply(%param.113, %broadcast.2126)
  %add.307 = f32[64,80,28672]{2,0,1} add(%multiply.457, %multiply.458)
  %divide.456 = f32[64,80,28672]{2,0,1} divide(%add.307, %broadcast.2127)
  %sqrt.3 = f32[64,80,28672]{2,0,1} sqrt(%divide.456)
  %add.308 = f32[64,80,28672]{2,0,1} add(%sqrt.3, %broadcast.2128)
  %multiply.459 = f32[64,80,28672]{2,1,0} multiply(%broadcast.2124, %add.308)
  %divide.457 = f32[64,80,28672]{2,0,1} divide(%add.306, %multiply.459)
  %multiply.460 = f32[64,80,28672]{2,1,0} multiply(%param.51, %broadcast.2122)
  %add.309 = f32[64,80,28672]{2,0,1} add(%divide.457, %multiply.460)
  %multiply.461 = f32[64,80,28672]{2,1,0} multiply(%broadcast.2119, %add.309)
  %add.310 = f32[64,80,28672]{2,1,0} add(%param.51, %multiply.461)
  %broadcast.2134 = f32[28672,80,64]{2,1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2135 = pred[28672,80,64]{2,0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2136 = f32[28672,80,64]{2,1,0} broadcast(%sqrt.0), dimensions={}
  %divide.458 = f32[28672,80,64]{2,0,1} divide(%transpose.71, %broadcast.2136)
  %select.463 = f32[28672,80,64]{2,0,1} select(%broadcast.2135, %transpose.71, %divide.458)
  %broadcast.2137 = f32[28672,80,64]{2,1,0} broadcast(%constant.2736), dimensions={}
  %multiply.462 = f32[28672,80,64]{2,0,1} multiply(%select.463, %broadcast.2137)
  %param.114 = f32[28672,80,64]{2,1,0} parameter(59), sharding={devices=[1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2138 = f32[28672,80,64]{2,1,0} broadcast(%constant.2737), dimensions={}
  %multiply.463 = f32[28672,80,64]{2,1,0} multiply(%param.114, %broadcast.2138)
  %add.311 = f32[28672,80,64]{2,0,1} add(%multiply.462, %multiply.463)
  %broadcast.2139 = f32[28672,80,64]{2,1,0} broadcast(%subtract.23), dimensions={}
  %multiply.464 = f32[28672,80,64]{2,0,1} multiply(%select.463, %select.463)
  %broadcast.2140 = f32[28672,80,64]{2,1,0} broadcast(%constant.2743), dimensions={}
  %multiply.465 = f32[28672,80,64]{2,0,1} multiply(%multiply.464, %broadcast.2140)
  %param.115 = f32[28672,80,64]{2,1,0} parameter(71), sharding={devices=[1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2142 = f32[28672,80,64]{2,1,0} broadcast(%constant.2744), dimensions={}
  %multiply.466 = f32[28672,80,64]{2,1,0} multiply(%param.115, %broadcast.2142)
  %add.312 = f32[28672,80,64]{2,0,1} add(%multiply.465, %multiply.466)
  %broadcast.2145 = f32[28672,80,64]{2,1,0} broadcast(%subtract.24), dimensions={}
  %divide.459 = f32[28672,80,64]{2,0,1} divide(%add.312, %broadcast.2145)
  %sqrt.4 = f32[28672,80,64]{2,0,1} sqrt(%divide.459)
  %broadcast.2147 = f32[28672,80,64]{2,1,0} broadcast(%constant.2631), dimensions={}
  %add.313 = f32[28672,80,64]{2,0,1} add(%sqrt.4, %broadcast.2147)
  %multiply.467 = f32[28672,80,64]{2,1,0} multiply(%broadcast.2139, %add.313)
  %divide.460 = f32[28672,80,64]{2,0,1} divide(%add.311, %multiply.467)
  %multiply.468 = f32[28672,80,64]{2,1,0} multiply(%param.52, %broadcast.2137)
  %add.314 = f32[28672,80,64]{2,0,1} add(%divide.460, %multiply.468)
  %multiply.469 = f32[28672,80,64]{2,1,0} multiply(%broadcast.2134, %add.314)
  %add.315 = f32[28672,80,64]{2,1,0} add(%param.52, %multiply.469)
  %broadcast.2148 = f32[8192,80]{1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2149 = pred[8192,80]{0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2150 = f32[8192,80]{1,0} broadcast(%sqrt.0), dimensions={}
  %divide.461 = f32[8192,80]{0,1} divide(%transpose.72, %broadcast.2150)
  %select.464 = f32[8192,80]{0,1} select(%broadcast.2149, %transpose.72, %divide.461)
  %broadcast.2152 = f32[8192,80]{1,0} broadcast(%constant.2736), dimensions={}
  %multiply.470 = f32[8192,80]{0,1} multiply(%select.464, %broadcast.2152)
  %param.116 = f32[8192,80]{1,0} parameter(60), sharding={replicated}
  %broadcast.2154 = f32[8192,80]{1,0} broadcast(%constant.2737), dimensions={}
  %multiply.471 = f32[8192,80]{1,0} multiply(%param.116, %broadcast.2154)
  %add.316 = f32[8192,80]{0,1} add(%multiply.470, %multiply.471)
  %broadcast.2155 = f32[8192,80]{1,0} broadcast(%subtract.23), dimensions={}
  %multiply.472 = f32[8192,80]{0,1} multiply(%select.464, %select.464)
  %broadcast.2157 = f32[8192,80]{1,0} broadcast(%constant.2743), dimensions={}
  %multiply.473 = f32[8192,80]{0,1} multiply(%multiply.472, %broadcast.2157)
  %param.117 = f32[8192,80]{1,0} parameter(72), sharding={replicated}
  %broadcast.2159 = f32[8192,80]{1,0} broadcast(%constant.2744), dimensions={}
  %multiply.474 = f32[8192,80]{1,0} multiply(%param.117, %broadcast.2159)
  %add.317 = f32[8192,80]{0,1} add(%multiply.473, %multiply.474)
  %broadcast.2160 = f32[8192,80]{1,0} broadcast(%subtract.24), dimensions={}
  %divide.462 = f32[8192,80]{0,1} divide(%add.317, %broadcast.2160)
  %sqrt.5 = f32[8192,80]{0,1} sqrt(%divide.462)
  %broadcast.2162 = f32[8192,80]{1,0} broadcast(%constant.2631), dimensions={}
  %add.318 = f32[8192,80]{0,1} add(%sqrt.5, %broadcast.2162)
  %multiply.475 = f32[8192,80]{1,0} multiply(%broadcast.2155, %add.318)
  %divide.463 = f32[8192,80]{0,1} divide(%add.316, %multiply.475)
  %multiply.476 = f32[8192,80]{1,0} multiply(%param.53, %broadcast.2152)
  %add.319 = f32[8192,80]{0,1} add(%divide.463, %multiply.476)
  %multiply.477 = f32[8192,80]{1,0} multiply(%broadcast.2148, %add.319)
  %add.320 = f32[8192,80]{1,0} add(%param.53, %multiply.477)
  %divide.464 = f32[8192,80]{0,1} divide(%transpose.73, %broadcast.2150)
  %select.465 = f32[8192,80]{0,1} select(%broadcast.2149, %transpose.73, %divide.464)
  %multiply.478 = f32[8192,80]{0,1} multiply(%select.465, %broadcast.2152)
  %param.118 = f32[8192,80]{1,0} parameter(61), sharding={replicated}
  %multiply.479 = f32[8192,80]{1,0} multiply(%param.118, %broadcast.2154)
  %add.321 = f32[8192,80]{0,1} add(%multiply.478, %multiply.479)
  %multiply.480 = f32[8192,80]{0,1} multiply(%select.465, %select.465)
  %multiply.481 = f32[8192,80]{0,1} multiply(%multiply.480, %broadcast.2157)
  %param.119 = f32[8192,80]{1,0} parameter(73), sharding={replicated}
  %multiply.482 = f32[8192,80]{1,0} multiply(%param.119, %broadcast.2159)
  %add.322 = f32[8192,80]{0,1} add(%multiply.481, %multiply.482)
  %divide.465 = f32[8192,80]{0,1} divide(%add.322, %broadcast.2160)
  %sqrt.6 = f32[8192,80]{0,1} sqrt(%divide.465)
  %add.323 = f32[8192,80]{0,1} add(%sqrt.6, %broadcast.2162)
  %multiply.483 = f32[8192,80]{1,0} multiply(%broadcast.2155, %add.323)
  %divide.466 = f32[8192,80]{0,1} divide(%add.321, %multiply.483)
  %multiply.484 = f32[8192,80]{1,0} multiply(%param.54, %broadcast.2152)
  %add.324 = f32[8192,80]{0,1} add(%divide.466, %multiply.484)
  %multiply.485 = f32[8192,80]{1,0} multiply(%broadcast.2148, %add.324)
  %add.325 = f32[8192,80]{1,0} add(%param.54, %multiply.485)
  %broadcast.2171 = f32[64,80,8,128]{3,2,1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2172 = pred[64,80,8,128]{3,2,0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2173 = f32[64,80,8,128]{3,2,1,0} broadcast(%sqrt.0), dimensions={}
  %divide.467 = f32[64,80,8,128]{3,2,0,1} divide(%transpose.74, %broadcast.2173)
  %select.466 = f32[64,80,8,128]{3,2,0,1} select(%broadcast.2172, %transpose.74, %divide.467)
  %broadcast.2174 = f32[64,80,8,128]{3,2,1,0} broadcast(%constant.2736), dimensions={}
  %multiply.486 = f32[64,80,8,128]{3,2,0,1} multiply(%select.466, %broadcast.2174)
  %param.120 = f32[64,80,8,128]{3,2,1,0} parameter(62), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2175 = f32[64,80,8,128]{3,2,1,0} broadcast(%constant.2737), dimensions={}
  %multiply.487 = f32[64,80,8,128]{3,2,1,0} multiply(%param.120, %broadcast.2175)
  %add.326 = f32[64,80,8,128]{3,2,0,1} add(%multiply.486, %multiply.487)
  %broadcast.2176 = f32[64,80,8,128]{3,2,1,0} broadcast(%subtract.23), dimensions={}
  %multiply.488 = f32[64,80,8,128]{3,2,0,1} multiply(%select.466, %select.466)
  %broadcast.2177 = f32[64,80,8,128]{3,2,1,0} broadcast(%constant.2743), dimensions={}
  %multiply.489 = f32[64,80,8,128]{3,2,0,1} multiply(%multiply.488, %broadcast.2177)
  %param.121 = f32[64,80,8,128]{3,2,1,0} parameter(74), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2178 = f32[64,80,8,128]{3,2,1,0} broadcast(%constant.2744), dimensions={}
  %multiply.490 = f32[64,80,8,128]{3,2,1,0} multiply(%param.121, %broadcast.2178)
  %add.327 = f32[64,80,8,128]{3,2,0,1} add(%multiply.489, %multiply.490)
  %broadcast.2179 = f32[64,80,8,128]{3,2,1,0} broadcast(%subtract.24), dimensions={}
  %divide.468 = f32[64,80,8,128]{3,2,0,1} divide(%add.327, %broadcast.2179)
  %sqrt.7 = f32[64,80,8,128]{3,2,0,1} sqrt(%divide.468)
  %broadcast.2180 = f32[64,80,8,128]{3,2,1,0} broadcast(%constant.2631), dimensions={}
  %add.328 = f32[64,80,8,128]{3,2,0,1} add(%sqrt.7, %broadcast.2180)
  %multiply.491 = f32[64,80,8,128]{3,2,1,0} multiply(%broadcast.2176, %add.328)
  %divide.469 = f32[64,80,8,128]{3,2,0,1} divide(%add.326, %multiply.491)
  %multiply.492 = f32[64,80,8,128]{3,2,1,0} multiply(%param.55, %broadcast.2174)
  %add.329 = f32[64,80,8,128]{3,2,0,1} add(%divide.469, %multiply.492)
  %multiply.493 = f32[64,80,8,128]{3,2,1,0} multiply(%broadcast.2171, %add.329)
  %add.331 = f32[64,80,8,128]{3,2,1,0} add(%param.55, %multiply.493)
  %broadcast.2181 = f32[64,80,128,64]{3,2,1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2183 = pred[64,80,128,64]{3,2,0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2185 = f32[64,80,128,64]{3,2,1,0} broadcast(%sqrt.0), dimensions={}
  %divide.470 = f32[64,80,128,64]{3,2,0,1} divide(%transpose.75, %broadcast.2185)
  %select.467 = f32[64,80,128,64]{3,2,0,1} select(%broadcast.2183, %transpose.75, %divide.470)
  %broadcast.2186 = f32[64,80,128,64]{3,2,1,0} broadcast(%constant.2736), dimensions={}
  %multiply.494 = f32[64,80,128,64]{3,2,0,1} multiply(%select.467, %broadcast.2186)
  %param.122 = f32[64,80,128,64]{3,2,1,0} parameter(63), sharding={devices=[1,1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2187 = f32[64,80,128,64]{3,2,1,0} broadcast(%constant.2737), dimensions={}
  %multiply.495 = f32[64,80,128,64]{3,2,1,0} multiply(%param.122, %broadcast.2187)
  %add.332 = f32[64,80,128,64]{3,2,0,1} add(%multiply.494, %multiply.495)
  %broadcast.2188 = f32[64,80,128,64]{3,2,1,0} broadcast(%subtract.23), dimensions={}
  %multiply.496 = f32[64,80,128,64]{3,2,0,1} multiply(%select.467, %select.467)
  %broadcast.2189 = f32[64,80,128,64]{3,2,1,0} broadcast(%constant.2743), dimensions={}
  %multiply.497 = f32[64,80,128,64]{3,2,0,1} multiply(%multiply.496, %broadcast.2189)
  %param.123 = f32[64,80,128,64]{3,2,1,0} parameter(75), sharding={devices=[1,1,1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2190 = f32[64,80,128,64]{3,2,1,0} broadcast(%constant.2744), dimensions={}
  %multiply.498 = f32[64,80,128,64]{3,2,1,0} multiply(%param.123, %broadcast.2190)
  %add.333 = f32[64,80,128,64]{3,2,0,1} add(%multiply.497, %multiply.498)
  %broadcast.2191 = f32[64,80,128,64]{3,2,1,0} broadcast(%subtract.24), dimensions={}
  %divide.471 = f32[64,80,128,64]{3,2,0,1} divide(%add.333, %broadcast.2191)
  %sqrt.8 = f32[64,80,128,64]{3,2,0,1} sqrt(%divide.471)
  %broadcast.2192 = f32[64,80,128,64]{3,2,1,0} broadcast(%constant.2631), dimensions={}
  %add.334 = f32[64,80,128,64]{3,2,0,1} add(%sqrt.8, %broadcast.2192)
  %multiply.499 = f32[64,80,128,64]{3,2,1,0} multiply(%broadcast.2188, %add.334)
  %divide.472 = f32[64,80,128,64]{3,2,0,1} divide(%add.332, %multiply.499)
  %multiply.500 = f32[64,80,128,64]{3,2,1,0} multiply(%param.56, %broadcast.2186)
  %add.335 = f32[64,80,128,64]{3,2,0,1} add(%divide.472, %multiply.500)
  %multiply.501 = f32[64,80,128,64]{3,2,1,0} multiply(%broadcast.2181, %add.335)
  %add.336 = f32[64,80,128,64]{3,2,1,0} add(%param.56, %multiply.501)
  %broadcast.2194 = f32[64,80,64,128]{3,2,1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2195 = pred[64,80,64,128]{3,2,0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2196 = f32[64,80,64,128]{3,2,1,0} broadcast(%sqrt.0), dimensions={}
  %divide.473 = f32[64,80,64,128]{3,2,0,1} divide(%transpose.76, %broadcast.2196)
  %select.468 = f32[64,80,64,128]{3,2,0,1} select(%broadcast.2195, %transpose.76, %divide.473)
  %broadcast.2197 = f32[64,80,64,128]{3,2,1,0} broadcast(%constant.2736), dimensions={}
  %multiply.502 = f32[64,80,64,128]{3,2,0,1} multiply(%select.468, %broadcast.2197)
  %param.124 = f32[64,80,64,128]{3,2,1,0} parameter(64), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2198 = f32[64,80,64,128]{3,2,1,0} broadcast(%constant.2737), dimensions={}
  %multiply.503 = f32[64,80,64,128]{3,2,1,0} multiply(%param.124, %broadcast.2198)
  %add.337 = f32[64,80,64,128]{3,2,0,1} add(%multiply.502, %multiply.503)
  %broadcast.2199 = f32[64,80,64,128]{3,2,1,0} broadcast(%subtract.23), dimensions={}
  %multiply.504 = f32[64,80,64,128]{3,2,0,1} multiply(%select.468, %select.468)
  %broadcast.2200 = f32[64,80,64,128]{3,2,1,0} broadcast(%constant.2743), dimensions={}
  %multiply.505 = f32[64,80,64,128]{3,2,0,1} multiply(%multiply.504, %broadcast.2200)
  %param.125 = f32[64,80,64,128]{3,2,1,0} parameter(76), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2201 = f32[64,80,64,128]{3,2,1,0} broadcast(%constant.2744), dimensions={}
  %multiply.506 = f32[64,80,64,128]{3,2,1,0} multiply(%param.125, %broadcast.2201)
  %add.338 = f32[64,80,64,128]{3,2,0,1} add(%multiply.505, %multiply.506)
  %broadcast.2202 = f32[64,80,64,128]{3,2,1,0} broadcast(%subtract.24), dimensions={}
  %divide.474 = f32[64,80,64,128]{3,2,0,1} divide(%add.338, %broadcast.2202)
  %sqrt.9 = f32[64,80,64,128]{3,2,0,1} sqrt(%divide.474)
  %broadcast.2203 = f32[64,80,64,128]{3,2,1,0} broadcast(%constant.2631), dimensions={}
  %add.339 = f32[64,80,64,128]{3,2,0,1} add(%sqrt.9, %broadcast.2203)
  %multiply.507 = f32[64,80,64,128]{3,2,1,0} multiply(%broadcast.2199, %add.339)
  %divide.475 = f32[64,80,64,128]{3,2,0,1} divide(%add.337, %multiply.507)
  %multiply.508 = f32[64,80,64,128]{3,2,1,0} multiply(%param.57, %broadcast.2197)
  %add.340 = f32[64,80,64,128]{3,2,0,1} add(%divide.475, %multiply.508)
  %multiply.509 = f32[64,80,64,128]{3,2,1,0} multiply(%broadcast.2194, %add.340)
  %add.341 = f32[64,80,64,128]{3,2,1,0} add(%param.57, %multiply.509)
  %divide.476 = f32[64,80,8,128]{3,2,0,1} divide(%transpose.77, %broadcast.2173)
  %select.469 = f32[64,80,8,128]{3,2,0,1} select(%broadcast.2172, %transpose.77, %divide.476)
  %multiply.510 = f32[64,80,8,128]{3,2,0,1} multiply(%select.469, %broadcast.2174)
  %param.126 = f32[64,80,8,128]{3,2,1,0} parameter(65), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %multiply.511 = f32[64,80,8,128]{3,2,1,0} multiply(%param.126, %broadcast.2175)
  %add.342 = f32[64,80,8,128]{3,2,0,1} add(%multiply.510, %multiply.511)
  %multiply.512 = f32[64,80,8,128]{3,2,0,1} multiply(%select.469, %select.469)
  %multiply.513 = f32[64,80,8,128]{3,2,0,1} multiply(%multiply.512, %broadcast.2177)
  %param.127 = f32[64,80,8,128]{3,2,1,0} parameter(77), sharding={devices=[128,1,1,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %multiply.514 = f32[64,80,8,128]{3,2,1,0} multiply(%param.127, %broadcast.2178)
  %add.343 = f32[64,80,8,128]{3,2,0,1} add(%multiply.513, %multiply.514)
  %divide.477 = f32[64,80,8,128]{3,2,0,1} divide(%add.343, %broadcast.2179)
  %sqrt.10 = f32[64,80,8,128]{3,2,0,1} sqrt(%divide.477)
  %add.344 = f32[64,80,8,128]{3,2,0,1} add(%sqrt.10, %broadcast.2180)
  %multiply.515 = f32[64,80,8,128]{3,2,1,0} multiply(%broadcast.2176, %add.344)
  %divide.478 = f32[64,80,8,128]{3,2,0,1} divide(%add.342, %multiply.515)
  %multiply.516 = f32[64,80,8,128]{3,2,1,0} multiply(%param.58, %broadcast.2174)
  %add.345 = f32[64,80,8,128]{3,2,0,1} add(%divide.478, %multiply.516)
  %multiply.517 = f32[64,80,8,128]{3,2,1,0} multiply(%broadcast.2171, %add.345)
  %add.346 = f32[64,80,8,128]{3,2,1,0} add(%param.58, %multiply.517)
  %broadcast.2209 = f32[64,128256]{1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2210 = pred[64,128256]{0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2211 = f32[64,128256]{1,0} broadcast(%sqrt.0), dimensions={}
  %divide.479 = f32[64,128256]{0,1} divide(%convert.473, %broadcast.2211)
  %select.470 = f32[64,128256]{0,1} select(%broadcast.2210, %convert.473, %divide.479)
  %broadcast.2212 = f32[64,128256]{1,0} broadcast(%constant.2736), dimensions={}
  %multiply.518 = f32[64,128256]{0,1} multiply(%select.470, %broadcast.2212)
  %param.128 = f32[64,128256]{1,0} parameter(66), sharding={devices=[128,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2213 = f32[64,128256]{1,0} broadcast(%constant.2737), dimensions={}
  %multiply.519 = f32[64,128256]{1,0} multiply(%param.128, %broadcast.2213)
  %add.347 = f32[64,128256]{0,1} add(%multiply.518, %multiply.519)
  %broadcast.2214 = f32[64,128256]{1,0} broadcast(%subtract.23), dimensions={}
  %multiply.520 = f32[64,128256]{0,1} multiply(%select.470, %select.470)
  %broadcast.2215 = f32[64,128256]{1,0} broadcast(%constant.2743), dimensions={}
  %multiply.521 = f32[64,128256]{0,1} multiply(%multiply.520, %broadcast.2215)
  %param.129 = f32[64,128256]{1,0} parameter(78), sharding={devices=[128,1,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2216 = f32[64,128256]{1,0} broadcast(%constant.2744), dimensions={}
  %multiply.522 = f32[64,128256]{1,0} multiply(%param.129, %broadcast.2216)
  %add.348 = f32[64,128256]{0,1} add(%multiply.521, %multiply.522)
  %broadcast.2217 = f32[64,128256]{1,0} broadcast(%subtract.24), dimensions={}
  %divide.480 = f32[64,128256]{0,1} divide(%add.348, %broadcast.2217)
  %sqrt.11 = f32[64,128256]{0,1} sqrt(%divide.480)
  %broadcast.2219 = f32[64,128256]{1,0} broadcast(%constant.2631), dimensions={}
  %add.349 = f32[64,128256]{0,1} add(%sqrt.11, %broadcast.2219)
  %multiply.523 = f32[64,128256]{1,0} multiply(%broadcast.2214, %add.349)
  %divide.481 = f32[64,128256]{0,1} divide(%add.347, %multiply.523)
  %multiply.524 = f32[64,128256]{1,0} multiply(%param.90, %broadcast.2212)
  %add.350 = f32[64,128256]{0,1} add(%divide.481, %multiply.524)
  %multiply.525 = f32[64,128256]{1,0} multiply(%broadcast.2209, %add.350)
  %add.351 = f32[64,128256]{1,0} add(%param.90, %multiply.525)
  %broadcast.2222 = f32[128256,64]{1,0} broadcast(%multiply.424), dimensions={}
  %broadcast.2224 = pred[128256,64]{0,1} broadcast(%compare.387), dimensions={}
  %broadcast.2225 = f32[128256,64]{1,0} broadcast(%sqrt.0), dimensions={}
  %divide.482 = f32[128256,64]{0,1} divide(%convert.474, %broadcast.2225)
  %select.471 = f32[128256,64]{0,1} select(%broadcast.2224, %convert.474, %divide.482)
  %broadcast.2226 = f32[128256,64]{1,0} broadcast(%constant.2736), dimensions={}
  %multiply.526 = f32[128256,64]{0,1} multiply(%select.471, %broadcast.2226)
  %param.130 = f32[128256,64]{1,0} parameter(67), sharding={devices=[1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2227 = f32[128256,64]{1,0} broadcast(%constant.2737), dimensions={}
  %multiply.527 = f32[128256,64]{1,0} multiply(%param.130, %broadcast.2227)
  %add.352 = f32[128256,64]{0,1} add(%multiply.526, %multiply.527)
  %broadcast.2229 = f32[128256,64]{1,0} broadcast(%subtract.23), dimensions={}
  %multiply.528 = f32[128256,64]{0,1} multiply(%select.471, %select.471)
  %broadcast.2231 = f32[128256,64]{1,0} broadcast(%constant.2743), dimensions={}
  %multiply.529 = f32[128256,64]{0,1} multiply(%multiply.528, %broadcast.2231)
  %param.131 = f32[128256,64]{1,0} parameter(79), sharding={devices=[1,128,2]<=[2,128]T(1,0) last_tile_dim_replicate}
  %broadcast.2232 = f32[128256,64]{1,0} broadcast(%constant.2744), dimensions={}
  %multiply.530 = f32[128256,64]{1,0} multiply(%param.131, %broadcast.2232)
  %add.353 = f32[128256,64]{0,1} add(%multiply.529, %multiply.530)
  %broadcast.2234 = f32[128256,64]{1,0} broadcast(%subtract.24), dimensions={}
  %divide.483 = f32[128256,64]{0,1} divide(%add.353, %broadcast.2234)
  %sqrt.12 = f32[128256,64]{0,1} sqrt(%divide.483)
  %broadcast.2236 = f32[128256,64]{1,0} broadcast(%constant.2631), dimensions={}
  %add.354 = f32[128256,64]{0,1} add(%sqrt.12, %broadcast.2236)
  %multiply.531 = f32[128256,64]{1,0} multiply(%broadcast.2229, %add.354)
  %divide.484 = f32[128256,64]{0,1} divide(%add.352, %multiply.531)
  %multiply.532 = f32[128256,64]{1,0} multiply(%param.49, %broadcast.2226)
  %add.355 = f32[128256,64]{0,1} add(%divide.484, %multiply.532)
  %multiply.533 = f32[128256,64]{1,0} multiply(%broadcast.2222, %add.355)
  %add.356 = f32[128256,64]{1,0} add(%param.49, %multiply.533)
  %compare.389 = pred[] compare(%param.106, %constant.2740), direction=LT
  %add.357 = s32[] add(%param.106, %constant.2626)
  %select.472 = s32[] select(%compare.389, %add.357, %constant.2740)
  %multiply.534 = f32[80,1024]{1,0} multiply(%get-tuple-element.449, %get-tuple-element.449)
  %reduce.247 = f32[] reduce(%multiply.534, %constant.2632), dimensions={0,1}, to_apply=%region_121.3991
  %multiply.535 = f32[80,1]{1,0} multiply(%get-tuple-element.450, %get-tuple-element.450)
  %reduce.248 = f32[] reduce(%multiply.535, %constant.2632), dimensions={0,1}, to_apply=%region_122.3997
  %add.358 = f32[] add(%reduce.247, %reduce.248)
  %multiply.536 = f32[80,1024]{1,0} multiply(%get-tuple-element.451, %get-tuple-element.451)
  %reduce.249 = f32[] reduce(%multiply.536, %constant.2632), dimensions={0,1}, to_apply=%region_123.4004
  %add.359 = f32[] add(%add.358, %reduce.249)
  %multiply.537 = f32[80,1]{1,0} multiply(%get-tuple-element.452, %get-tuple-element.452)
  %reduce.250 = f32[] reduce(%multiply.537, %constant.2632), dimensions={0,1}, to_apply=%region_124.4011
  %add.360 = f32[] add(%add.359, %reduce.250)
  %multiply.538 = f32[80,1024]{1,0} multiply(%get-tuple-element.453, %get-tuple-element.453)
  %reduce.251 = f32[] reduce(%multiply.538, %constant.2632), dimensions={0,1}, to_apply=%region_125.4018
  %add.361 = f32[] add(%add.360, %reduce.251)
  %multiply.539 = f32[80,1]{1,0} multiply(%get-tuple-element.454, %get-tuple-element.454)
  %reduce.252 = f32[] reduce(%multiply.539, %constant.2632), dimensions={0,1}, to_apply=%region_126.4025
  %add.362 = f32[] add(%add.361, %reduce.252)
  %multiply.540 = f32[80,1024]{1,0} multiply(%get-tuple-element.455, %get-tuple-element.455)
  %reduce.253 = f32[] reduce(%multiply.540, %constant.2632), dimensions={0,1}, to_apply=%region_127.4032
  %add.363 = f32[] add(%add.362, %reduce.253)
  %multiply.541 = f32[80,1]{1,0} multiply(%get-tuple-element.506, %get-tuple-element.506)
  %reduce.254 = f32[] reduce(%multiply.541, %constant.2632), dimensions={0,1}, to_apply=%region_128.4039
  %add.364 = f32[] add(%add.363, %reduce.254)
  %multiply.542 = f32[80,1024]{1,0} multiply(%get-tuple-element.507, %get-tuple-element.507)
  %reduce.255 = f32[] reduce(%multiply.542, %constant.2632), dimensions={0,1}, to_apply=%region_129.4046
  %add.365 = f32[] add(%add.364, %reduce.255)
  %multiply.543 = f32[80,1]{1,0} multiply(%get-tuple-element.508, %get-tuple-element.508)
  %reduce.256 = f32[] reduce(%multiply.543, %constant.2632), dimensions={0,1}, to_apply=%region_130.4053
  %add.366 = f32[] add(%add.365, %reduce.256)
  %multiply.544 = f32[80,1024]{1,0} multiply(%get-tuple-element.509, %get-tuple-element.509)
  %reduce.257 = f32[] reduce(%multiply.544, %constant.2632), dimensions={0,1}, to_apply=%region_131.4060
  %add.367 = f32[] add(%add.366, %reduce.257)
  %multiply.545 = f32[80,1]{1,0} multiply(%get-tuple-element.510, %get-tuple-element.510)
  %reduce.258 = f32[] reduce(%multiply.545, %constant.2632), dimensions={0,1}, to_apply=%region_132.4067
  %add.368 = f32[] add(%add.367, %reduce.258)
  %multiply.546 = f32[80,1024]{1,0} multiply(%get-tuple-element.511, %get-tuple-element.511)
  %reduce.259 = f32[] reduce(%multiply.546, %constant.2632), dimensions={0,1}, to_apply=%region_133.4074
  %add.369 = f32[] add(%add.368, %reduce.259)
  %multiply.547 = f32[80,1]{1,0} multiply(%get-tuple-element.512, %get-tuple-element.512)
  %reduce.260 = f32[] reduce(%multiply.547, %constant.2632), dimensions={0,1}, to_apply=%region_134.4081
  %add.370 = f32[] add(%add.369, %reduce.260)
  %multiply.548 = f32[80,1024]{1,0} multiply(%get-tuple-element.513, %get-tuple-element.513)
  %reduce.261 = f32[] reduce(%multiply.548, %constant.2632), dimensions={0,1}, to_apply=%region_135.4088
  %add.371 = f32[] add(%add.370, %reduce.261)
  %multiply.549 = f32[80,1]{1,0} multiply(%get-tuple-element.514, %get-tuple-element.514)
  %reduce.262 = f32[] reduce(%multiply.549, %constant.2632), dimensions={0,1}, to_apply=%region_136.4095
  %add.372 = f32[] add(%add.371, %reduce.262)
  %multiply.550 = f32[80,1024]{1,0} multiply(%get-tuple-element.515, %get-tuple-element.515)
  %reduce.263 = f32[] reduce(%multiply.550, %constant.2632), dimensions={0,1}, to_apply=%region_137.4102
  %add.373 = f32[] add(%add.372, %reduce.263)
  %multiply.551 = f32[80,1]{1,0} multiply(%get-tuple-element.516, %get-tuple-element.516)
  %reduce.264 = f32[] reduce(%multiply.551, %constant.2632), dimensions={0,1}, to_apply=%region_138.4109
  %add.374 = f32[] add(%add.373, %reduce.264)
  %multiply.552 = f32[80,1024]{1,0} multiply(%get-tuple-element.517, %get-tuple-element.517)
  %reduce.265 = f32[] reduce(%multiply.552, %constant.2632), dimensions={0,1}, to_apply=%region_139.4116
  %add.375 = f32[] add(%add.374, %reduce.265)
  %multiply.553 = f32[80,1]{1,0} multiply(%get-tuple-element.518, %get-tuple-element.518)
  %reduce.266 = f32[] reduce(%multiply.553, %constant.2632), dimensions={0,1}, to_apply=%region_140.4123
  %add.376 = f32[] add(%add.375, %reduce.266)
  %multiply.554 = f32[80,1024]{1,0} multiply(%get-tuple-element.519, %get-tuple-element.519)
  %reduce.267 = f32[] reduce(%multiply.554, %constant.2632), dimensions={0,1}, to_apply=%region_141.4130
  %add.377 = f32[] add(%add.376, %reduce.267)
  %multiply.555 = f32[80,1]{1,0} multiply(%get-tuple-element.520, %get-tuple-element.520)
  %reduce.268 = f32[] reduce(%multiply.555, %constant.2632), dimensions={0,1}, to_apply=%region_142.4137
  %add.378 = f32[] add(%add.377, %reduce.268)
  %multiply.556 = f32[80,1024]{1,0} multiply(%get-tuple-element.521, %get-tuple-element.521)
  %reduce.269 = f32[] reduce(%multiply.556, %constant.2632), dimensions={0,1}, to_apply=%region_143.4144
  %add.379 = f32[] add(%add.378, %reduce.269)
  %multiply.557 = f32[80,1]{1,0} multiply(%get-tuple-element.522, %get-tuple-element.522)
  %reduce.270 = f32[] reduce(%multiply.557, %constant.2632), dimensions={0,1}, to_apply=%region_144.4151
  %add.380 = f32[] add(%add.379, %reduce.270)
  %multiply.558 = f32[80,1024]{1,0} multiply(%get-tuple-element.523, %get-tuple-element.523)
  %reduce.271 = f32[] reduce(%multiply.558, %constant.2632), dimensions={0,1}, to_apply=%region_145.4158
  %add.381 = f32[] add(%add.380, %reduce.271)
  %multiply.559 = f32[80,1]{1,0} multiply(%get-tuple-element.524, %get-tuple-element.524)
  %reduce.272 = f32[] reduce(%multiply.559, %constant.2632), dimensions={0,1}, to_apply=%region_146.4165
  %add.383 = f32[] add(%add.381, %reduce.272)
  %multiply.560 = f32[80,1024]{1,0} multiply(%get-tuple-element.525, %get-tuple-element.525)
  %reduce.273 = f32[] reduce(%multiply.560, %constant.2632), dimensions={0,1}, to_apply=%region_147.4172
  %add.384 = f32[] add(%add.383, %reduce.273)
  %multiply.561 = f32[80,1]{1,0} multiply(%get-tuple-element.526, %get-tuple-element.526)
  %reduce.274 = f32[] reduce(%multiply.561, %constant.2632), dimensions={0,1}, to_apply=%region_148.4179
  %add.385 = f32[] add(%add.384, %reduce.274)
  %multiply.562 = f32[80,1024]{1,0} multiply(%get-tuple-element.527, %get-tuple-element.527)
  %reduce.275 = f32[] reduce(%multiply.562, %constant.2632), dimensions={0,1}, to_apply=%region_149.4186
  %add.386 = f32[] add(%add.385, %reduce.275)
  %multiply.563 = f32[80,1]{1,0} multiply(%get-tuple-element.528, %get-tuple-element.528)
  %reduce.276 = f32[] reduce(%multiply.563, %constant.2632), dimensions={0,1}, to_apply=%region_150.4193
  %add.387 = f32[] add(%add.386, %reduce.276)
  %multiply.564 = f32[80,1024]{1,0} multiply(%get-tuple-element.529, %get-tuple-element.529)
  %reduce.277 = f32[] reduce(%multiply.564, %constant.2632), dimensions={0,1}, to_apply=%region_151.4200
  %add.388 = f32[] add(%add.387, %reduce.277)
  %multiply.565 = f32[80,1]{1,0} multiply(%get-tuple-element.530, %get-tuple-element.530)
  %reduce.278 = f32[] reduce(%multiply.565, %constant.2632), dimensions={0,1}, to_apply=%region_152.4207
  %add.389 = f32[] add(%add.388, %reduce.278)
  %multiply.566 = f32[80,1024]{1,0} multiply(%get-tuple-element.531, %get-tuple-element.531)
  %reduce.279 = f32[] reduce(%multiply.566, %constant.2632), dimensions={0,1}, to_apply=%region_153.4214
  %add.390 = f32[] add(%add.389, %reduce.279)
  %multiply.567 = f32[80,1]{1,0} multiply(%get-tuple-element.532, %get-tuple-element.532)
  %reduce.280 = f32[] reduce(%multiply.567, %constant.2632), dimensions={0,1}, to_apply=%region_154.4221
  %add.391 = f32[] add(%add.390, %reduce.280)
  %multiply.568 = f32[80,1024]{1,0} multiply(%get-tuple-element.533, %get-tuple-element.533)
  %reduce.281 = f32[] reduce(%multiply.568, %constant.2632), dimensions={0,1}, to_apply=%region_155.4228
  %add.392 = f32[] add(%add.391, %reduce.281)
  %multiply.569 = f32[80,1]{1,0} multiply(%get-tuple-element.534, %get-tuple-element.534)
  %reduce.282 = f32[] reduce(%multiply.569, %constant.2632), dimensions={0,1}, to_apply=%region_156.4235
  %add.393 = f32[] add(%add.392, %reduce.282)
  %multiply.570 = f32[80,1024]{1,0} multiply(%get-tuple-element.535, %get-tuple-element.535)
  %reduce.283 = f32[] reduce(%multiply.570, %constant.2632), dimensions={0,1}, to_apply=%region_157.4242
  %add.394 = f32[] add(%add.393, %reduce.283)
  %multiply.571 = f32[80,1]{1,0} multiply(%get-tuple-element.536, %get-tuple-element.536)
  %reduce.284 = f32[] reduce(%multiply.571, %constant.2632), dimensions={0,1}, to_apply=%region_158.4249
  %add.395 = f32[] add(%add.394, %reduce.284)
  %multiply.572 = f32[80,1024]{1,0} multiply(%get-tuple-element.537, %get-tuple-element.537)
  %reduce.285 = f32[] reduce(%multiply.572, %constant.2632), dimensions={0,1}, to_apply=%region_159.4256
  %add.396 = f32[] add(%add.395, %reduce.285)
  %multiply.573 = f32[80,1]{1,0} multiply(%get-tuple-element.538, %get-tuple-element.538)
  %reduce.286 = f32[] reduce(%multiply.573, %constant.2632), dimensions={0,1}, to_apply=%region_160.4263
  %add.397 = f32[] add(%add.396, %reduce.286)
  %multiply.574 = f32[80,1024]{1,0} multiply(%get-tuple-element.539, %get-tuple-element.539)
  %reduce.287 = f32[] reduce(%multiply.574, %constant.2632), dimensions={0,1}, to_apply=%region_161.4270
  %add.398 = f32[] add(%add.397, %reduce.287)
  %multiply.575 = f32[80,1]{1,0} multiply(%get-tuple-element.540, %get-tuple-element.540)
  %reduce.288 = f32[] reduce(%multiply.575, %constant.2632), dimensions={0,1}, to_apply=%region_162.4277
  %add.399 = f32[] add(%add.398, %reduce.288)
  %reduce.289 = f32[] reduce(%multiply.440, %constant.2632), dimensions={0}, to_apply=%region_163.4284
  %add.400 = f32[] add(%add.399, %reduce.289)
  %reduce.290 = f32[] reduce(%multiply.448, %constant.2632), dimensions={0,1,2}, to_apply=%region_164.4291
  %all-reduce.52 = f32[] all-reduce(%reduce.290), channel_id=69, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_164.4291.clone
  %add.401 = f32[] add(%add.400, %all-reduce.52)
  %reduce.291 = f32[] reduce(%multiply.456, %constant.2632), dimensions={0,1,2}, to_apply=%region_165.4298
  %all-reduce.53 = f32[] all-reduce(%reduce.291), channel_id=70, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_165.4298.clone
  %add.402 = f32[] add(%add.401, %all-reduce.53)
  %reduce.292 = f32[] reduce(%multiply.464, %constant.2632), dimensions={0,1,2}, to_apply=%region_166.4305
  %all-reduce.54 = f32[] all-reduce(%reduce.292), channel_id=71, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_166.4305.clone
  %add.403 = f32[] add(%add.402, %all-reduce.54)
  %reduce.293 = f32[] reduce(%multiply.472, %constant.2632), dimensions={0,1}, to_apply=%region_167.4312
  %add.404 = f32[] add(%add.403, %reduce.293)
  %reduce.294 = f32[] reduce(%multiply.480, %constant.2632), dimensions={0,1}, to_apply=%region_168.4319
  %add.405 = f32[] add(%add.404, %reduce.294)
  %reduce.295 = f32[] reduce(%multiply.488, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_169.4326
  %all-reduce.55 = f32[] all-reduce(%reduce.295), channel_id=72, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_169.4326.clone
  %add.406 = f32[] add(%add.405, %all-reduce.55)
  %reduce.296 = f32[] reduce(%multiply.496, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_170.4333
  %all-reduce.56 = f32[] all-reduce(%reduce.296), channel_id=73, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_170.4333.clone
  %add.407 = f32[] add(%add.406, %all-reduce.56)
  %reduce.297 = f32[] reduce(%multiply.504, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_171.4340
  %all-reduce.57 = f32[] all-reduce(%reduce.297), channel_id=74, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_171.4340.clone
  %add.408 = f32[] add(%add.407, %all-reduce.57)
  %reduce.298 = f32[] reduce(%multiply.512, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_172.4347
  %all-reduce.58 = f32[] all-reduce(%reduce.298), channel_id=75, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_172.4347.clone
  %add.409 = f32[] add(%add.408, %all-reduce.58)
  %reduce.299 = f32[] reduce(%multiply.520, %constant.2632), dimensions={0,1}, to_apply=%region_173.4354
  %all-reduce.59 = f32[] all-reduce(%reduce.299), channel_id=76, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_173.4354.clone
  %add.410 = f32[] add(%add.409, %all-reduce.59)
  %reduce.300 = f32[] reduce(%multiply.528, %constant.2632), dimensions={0,1}, to_apply=%region_174.4361
  %all-reduce.60 = f32[] all-reduce(%reduce.300), channel_id=77, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_174.4361.clone
  %add.411 = f32[] add(%add.410, %all-reduce.60)
  %sqrt.13 = f32[] sqrt(%add.411)
  %broadcast.2237 = f32[2,8192,128256]{2,1,0} broadcast(%log.2), dimensions={0,1}
  %subtract.25 = f32[2,8192,128256]{2,1,0} subtract(%subtract.19, %broadcast.2237)
  %broadcast.2239 = f32[2,8192,128256]{2,1,0} broadcast(%constant.2632), dimensions={}
  %select.473 = f32[2,8192,128256]{2,1,0} select(%compare.383, %subtract.25, %broadcast.2239)
  %reduce.301 = f32[2,8192]{1,0} reduce(%select.473, %constant.2632), dimensions={2}, to_apply=%region_24.1352
  %negate.32 = f32[2,8192]{1,0} negate(%reduce.301)
  %multiply.588 = f32[2,8192]{1,0} multiply(%add.276, %add.276)
  %multiply.589 = f32[2,8192]{1,0} multiply(%multiply.588, %broadcast.2030)
  %add.412 = f32[2,8192]{1,0} add(%negate.32, %multiply.589)
  %copy.85 = f32[2,8192]{1,0} copy(%add.412)
  %select.474 = f32[2,8192]{1,0} select(%compare.363, %copy.85, %broadcast.2030)
  %reduce.302 = f32[] reduce(%select.474, %constant.2632), dimensions={0,1}, to_apply=%region_25.1368
  %all-reduce.61 = f32[] all-reduce(%reduce.302), channel_id=78, replica_groups=[1,256]<=[256], use_global_device_ids=true, to_apply=%region_25.1368.clone
  %divide.485 = f32[] divide(%all-reduce.61, %add.268)
  %multiply.632 = f32[8192]{0} multiply(%add.299, %add.299)
  %reduce.345 = f32[] reduce(%multiply.632, %constant.2632), dimensions={0}, to_apply=%region_271.5040
  %add.456 = f32[] add(%add.399, %reduce.345)
  %multiply.633 = f32[64,80,28672]{2,1,0} multiply(%add.305, %add.305)
  %reduce.346 = f32[] reduce(%multiply.633, %constant.2632), dimensions={0,1,2}, to_apply=%region_272.5047
  %all-reduce.62 = f32[] all-reduce(%reduce.346), channel_id=79, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_272.5047.clone
  %add.457 = f32[] add(%add.456, %all-reduce.62)
  %multiply.634 = f32[64,80,28672]{2,1,0} multiply(%add.310, %add.310)
  %reduce.347 = f32[] reduce(%multiply.634, %constant.2632), dimensions={0,1,2}, to_apply=%region_273.5054
  %all-reduce.63 = f32[] all-reduce(%reduce.347), channel_id=80, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_273.5054.clone
  %add.458 = f32[] add(%add.457, %all-reduce.63)
  %multiply.635 = f32[28672,80,64]{2,1,0} multiply(%add.315, %add.315)
  %reduce.348 = f32[] reduce(%multiply.635, %constant.2632), dimensions={0,1,2}, to_apply=%region_274.5061
  %all-reduce.64 = f32[] all-reduce(%reduce.348), channel_id=81, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_274.5061.clone
  %add.459 = f32[] add(%add.458, %all-reduce.64)
  %multiply.636 = f32[8192,80]{1,0} multiply(%add.320, %add.320)
  %reduce.349 = f32[] reduce(%multiply.636, %constant.2632), dimensions={0,1}, to_apply=%region_275.5068
  %add.460 = f32[] add(%add.459, %reduce.349)
  %multiply.637 = f32[8192,80]{1,0} multiply(%add.325, %add.325)
  %reduce.350 = f32[] reduce(%multiply.637, %constant.2632), dimensions={0,1}, to_apply=%region_276.5075
  %add.461 = f32[] add(%add.460, %reduce.350)
  %multiply.638 = f32[64,80,8,128]{3,2,1,0} multiply(%add.331, %add.331)
  %reduce.351 = f32[] reduce(%multiply.638, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_277.5082
  %all-reduce.65 = f32[] all-reduce(%reduce.351), channel_id=82, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_277.5082.clone
  %add.462 = f32[] add(%add.461, %all-reduce.65)
  %multiply.639 = f32[64,80,128,64]{3,2,1,0} multiply(%add.336, %add.336)
  %reduce.352 = f32[] reduce(%multiply.639, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_278.5089
  %all-reduce.66 = f32[] all-reduce(%reduce.352), channel_id=83, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_278.5089.clone
  %add.463 = f32[] add(%add.462, %all-reduce.66)
  %multiply.640 = f32[64,80,64,128]{3,2,1,0} multiply(%add.341, %add.341)
  %reduce.353 = f32[] reduce(%multiply.640, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_279.5096
  %all-reduce.67 = f32[] all-reduce(%reduce.353), channel_id=84, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_279.5096.clone
  %add.464 = f32[] add(%add.463, %all-reduce.67)
  %multiply.641 = f32[64,80,8,128]{3,2,1,0} multiply(%add.346, %add.346)
  %reduce.354 = f32[] reduce(%multiply.641, %constant.2632), dimensions={0,1,2,3}, to_apply=%region_280.5103
  %all-reduce.68 = f32[] all-reduce(%reduce.354), channel_id=85, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_280.5103.clone
  %add.465 = f32[] add(%add.464, %all-reduce.68)
  %multiply.642 = f32[64,128256]{1,0} multiply(%add.351, %add.351)
  %reduce.355 = f32[] reduce(%multiply.642, %constant.2632), dimensions={0,1}, to_apply=%region_281.5110
  %all-reduce.69 = f32[] all-reduce(%reduce.355), channel_id=86, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_281.5110.clone
  %add.466 = f32[] add(%add.465, %all-reduce.69)
  %multiply.643 = f32[128256,64]{1,0} multiply(%add.356, %add.356)
  %reduce.356 = f32[] reduce(%multiply.643, %constant.2632), dimensions={0,1}, to_apply=%region_282.5117
  %all-reduce.70 = f32[] all-reduce(%reduce.356), channel_id=87, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_282.5117.clone
  %add.467 = f32[] add(%add.466, %all-reduce.70)
  %sqrt.14 = f32[] sqrt(%add.467)
  %add.509 = f32[] add(%add.399, %reduce.235)
  %all-reduce.71 = f32[] all-reduce(%reduce.236), channel_id=88, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_218.4669.clone
  %add.510 = f32[] add(%add.509, %all-reduce.71)
  %all-reduce.72 = f32[] all-reduce(%reduce.237), channel_id=89, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_219.4676.clone
  %add.511 = f32[] add(%add.510, %all-reduce.72)
  %all-reduce.73 = f32[] all-reduce(%reduce.238), channel_id=90, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_220.4683.clone
  %add.512 = f32[] add(%add.511, %all-reduce.73)
  %add.513 = f32[] add(%add.512, %reduce.239)
  %add.514 = f32[] add(%add.513, %reduce.240)
  %all-reduce.74 = f32[] all-reduce(%reduce.241), channel_id=91, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_223.4704.clone
  %add.515 = f32[] add(%add.514, %all-reduce.74)
  %all-reduce.75 = f32[] all-reduce(%reduce.242), channel_id=92, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_224.4711.clone
  %add.516 = f32[] add(%add.515, %all-reduce.75)
  %all-reduce.76 = f32[] all-reduce(%reduce.243), channel_id=93, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_225.4718.clone
  %add.517 = f32[] add(%add.516, %all-reduce.76)
  %all-reduce.77 = f32[] all-reduce(%reduce.244), channel_id=94, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_226.4725.clone
  %add.518 = f32[] add(%add.517, %all-reduce.77)
  %all-reduce.78 = f32[] all-reduce(%reduce.245), channel_id=95, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_227.4732.clone
  %add.519 = f32[] add(%add.518, %all-reduce.78)
  %all-reduce.79 = f32[] all-reduce(%reduce.246), channel_id=96, replica_groups=[2,128]<=[256], use_global_device_ids=true, to_apply=%region_228.4739.clone
  %add.520 = f32[] add(%add.519, %all-reduce.79)
  %sqrt.15 = f32[] sqrt(%add.520)
  ROOT %tuple.114 = (s32[], f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=5*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=10*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=15*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=20*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=25*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=30*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, /*index=35*/f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[80,1024]{1,0}, /*index=40*/f32[80,1]{1,0}, f32[80,1024]{1,0}, f32[80,1]{1,0}, f32[8192]{0}, f32[64,80,28672]{2,1,0}, /*index=45*/f32[64,80,28672]{2,1,0}, f32[28672,80,64]{2,1,0}, f32[8192,80]{1,0}, f32[8192,80]{1,0}, f32[64,80,8,128]{3,2,1,0}, /*index=50*/f32[64,80,128,64]{3,2,1,0}, f32[64,80,64,128]{3,2,1,0}, f32[64,80,8,128]{3,2,1,0}, f32[64,128256]{1,0}, f32[128256,64]{1,0}, /*index=55*/s32[], f32[8192]{0}, f32[64,80,28672]{2,0,1}, f32[64,80,28672]{2,0,1}, f32[28672,80,64]{2,0,1}, /*index=60*/f32[8192,80]{0,1}, f32[8192,80]{0,1}, f32[64,80,8,128]{3,2,0,1}, f32[64,80,128,64]{3,2,0,1}, f32[64,80,64,128]{3,2,0,1}, /*index=65*/f32[64,80,8,128]{3,2,0,1}, f32[64,128256]{0,1}, f32[128256,64]{0,1}, f32[8192]{0}, f32[64,80,28672]{2,0,1}, /*index=70*/f32[64,80,28672]{2,0,1}, f32[28672,80,64]{2,0,1}, f32[8192,80]{0,1}, f32[8192,80]{0,1}, f32[64,80,8,128]{3,2,0,1}, /*index=75*/f32[64,80,128,64]{3,2,0,1}, f32[64,80,64,128]{3,2,0,1}, f32[64,80,8,128]{3,2,0,1}, f32[64,128256]{0,1}, f32[128256,64]{0,1}, /*index=80*/s32[], f32[], f32[], f32[], f32[], /*index=85*/f32[], s32[]) tuple(%add.267, %get-tuple-element.449, %get-tuple-element.450, %get-tuple-element.451, %get-tuple-element.452, /*index=5*/%get-tuple-element.453, %get-tuple-element.454, %get-tuple-element.455, %get-tuple-element.506, %get-tuple-element.507, /*index=10*/%get-tuple-element.508, %get-tuple-element.509, %get-tuple-element.510, %get-tuple-element.511, %get-tuple-element.512, /*index=15*/%get-tuple-element.513, %get-tuple-element.514, %get-tuple-element.515, %get-tuple-element.516, %get-tuple-element.517, /*index=20*/%get-tuple-element.518, %get-tuple-element.519, %get-tuple-element.520, %get-tuple-element.521, %get-tuple-element.522, /*index=25*/%get-tuple-element.523, %get-tuple-element.524, %get-tuple-element.525, %get-tuple-element.526, %get-tuple-element.527, /*index=30*/%get-tuple-element.528, %get-tuple-element.529, %get-tuple-element.530, %get-tuple-element.531, %get-tuple-element.532, /*index=35*/%get-tuple-element.533, %get-tuple-element.534, %get-tuple-element.535, %get-tuple-element.536, %get-tuple-element.537, /*index=40*/%get-tuple-element.538, %get-tuple-element.539, %get-tuple-element.540, %add.299, %add.305, /*index=45*/%add.310, %add.315, %add.320, %add.325, %add.331, /*index=50*/%add.336, %add.341, %add.346, %add.351, %add.356, /*index=55*/%select.460, %add.294, %add.301, %add.306, %add.311, /*index=60*/%add.316, %add.321, %add.326, %add.332, %add.337, /*index=65*/%add.342, %add.347, %add.352, %add.296, %add.302, /*index=70*/%add.307, %add.312, %add.317, %add.322, %add.327, /*index=75*/%add.333, %add.338, %add.343, %add.348, %add.353, /*index=80*/%select.472, %sqrt.13, %divide.485, %constant.2632, %sqrt.14, /*index=85*/%sqrt.15, %all-reduce.37)
}

