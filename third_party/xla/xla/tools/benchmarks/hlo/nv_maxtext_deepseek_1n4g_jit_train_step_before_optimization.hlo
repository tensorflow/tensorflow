HloModule jit_train_step, input_output_alias={ {0}: (0, {}, may-alias), {1}: (1, {}, may-alias), {2}: (2, {}, may-alias), {3}: (3, {}, may-alias), {4}: (4, {}, may-alias), {5}: (5, {}, may-alias), {6}: (6, {}, may-alias), {7}: (7, {}, may-alias), {8}: (8, {}, may-alias), {9}: (9, {}, may-alias), {10}: (10, {}, may-alias), {11}: (11, {}, may-alias), {12}: (12, {}, may-alias), {13}: (13, {}, may-alias), {14}: (14, {}, may-alias), {15}: (15, {}, may-alias), {16}: (16, {}, may-alias), {17}: (17, {}, may-alias), {18}: (18, {}, may-alias), {19}: (19, {}, may-alias), {20}: (20, {}, may-alias), {21}: (21, {}, may-alias), {22}: (22, {}, may-alias), {23}: (23, {}, may-alias), {24}: (24, {}, may-alias), {25}: (25, {}, may-alias), {26}: (26, {}, may-alias), {27}: (27, {}, may-alias), {28}: (28, {}, may-alias), {29}: (29, {}, may-alias), {30}: (30, {}, may-alias), {31}: (31, {}, may-alias), {32}: (32, {}, may-alias), {33}: (33, {}, may-alias), {34}: (34, {}, may-alias), {35}: (35, {}, may-alias), {36}: (36, {}, may-alias), {37}: (37, {}, may-alias), {38}: (38, {}, may-alias), {39}: (39, {}, may-alias), {40}: (40, {}, may-alias), {41}: (41, {}, may-alias), {42}: (42, {}, may-alias), {43}: (43, {}, may-alias), {44}: (44, {}, may-alias), {45}: (45, {}, may-alias), {46}: (46, {}, may-alias), {47}: (47, {}, may-alias), {48}: (48, {}, may-alias), {49}: (49, {}, may-alias), {50}: (50, {}, may-alias), {51}: (51, {}, may-alias), {52}: (52, {}, may-alias), {53}: (53, {}, may-alias), {54}: (54, {}, may-alias), {55}: (55, {}, may-alias), {56}: (56, {}, may-alias), {57}: (57, {}, may-alias), {58}: (58, {}, may-alias), {59}: (59, {}, may-alias), {60}: (60, {}, may-alias), {61}: (61, {}, may-alias), {62}: (62, {}, may-alias), {63}: (63, {}, may-alias), {64}: (64, {}, may-alias), {65}: (65, {}, may-alias), {66}: (66, {}, may-alias), {67}: (67, {}, may-alias), {68}: (68, {}, may-alias), {69}: (69, {}, may-alias), {70}: (70, {}, may-alias), {71}: (71, {}, may-alias), {72}: (72, {}, may-alias), {73}: (73, {}, may-alias), {74}: (74, {}, may-alias), {75}: (75, {}, may-alias), {76}: (76, {}, may-alias), {77}: (77, {}, may-alias), {78}: (78, {}, may-alias), {79}: (79, {}, may-alias), {80}: (80, {}, may-alias), {81}: (81, {}, may-alias), {82}: (82, {}, may-alias), {83}: (83, {}, may-alias), {84}: (84, {}, may-alias), {85}: (85, {}, may-alias), {86}: (86, {}, may-alias), {87}: (87, {}, may-alias), {88}: (88, {}, may-alias), {89}: (89, {}, may-alias), {90}: (90, {}, may-alias), {91}: (91, {}, may-alias), {92}: (92, {}, may-alias), {93}: (93, {}, may-alias), {94}: (94, {}, may-alias), {95}: (95, {}, may-alias), {96}: (96, {}, may-alias), {97}: (97, {}, may-alias), {98}: (98, {}, may-alias), {99}: (99, {}, may-alias), {100}: (100, {}, may-alias), {101}: (101, {}, may-alias), {102}: (102, {}, may-alias), {103}: (103, {}, may-alias), {104}: (104, {}, may-alias), {105}: (105, {}, may-alias), {106}: (106, {}, may-alias), {107}: (107, {}, may-alias), {108}: (108, {}, may-alias), {109}: (109, {}, may-alias), {110}: (110, {}, may-alias), {111}: (111, {}, may-alias), {112}: (112, {}, may-alias), {113}: (113, {}, may-alias), {114}: (114, {}, may-alias), {115}: (115, {}, may-alias), {116}: (116, {}, may-alias), {117}: (117, {}, may-alias), {118}: (118, {}, may-alias), {119}: (119, {}, may-alias), {120}: (120, {}, may-alias), {121}: (121, {}, may-alias), {122}: (122, {}, may-alias), {123}: (123, {}, may-alias), {124}: (124, {}, may-alias), {125}: (125, {}, may-alias), {126}: (126, {}, may-alias), {127}: (127, {}, may-alias), {128}: (128, {}, may-alias), {129}: (129, {}, may-alias), {130}: (130, {}, may-alias), {131}: (131, {}, may-alias), {132}: (132, {}, may-alias), {133}: (133, {}, may-alias), {134}: (134, {}, may-alias), {135}: (135, {}, may-alias), {136}: (136, {}, may-alias), {137}: (137, {}, may-alias), {138}: (138, {}, may-alias), {139}: (139, {}, may-alias), {140}: (140, {}, may-alias), {141}: (141, {}, may-alias), {142}: (142, {}, may-alias), {143}: (143, {}, may-alias), {144}: (144, {}, may-alias), {145}: (145, {}, may-alias), {146}: (146, {}, may-alias), {147}: (147, {}, may-alias), {148}: (148, {}, may-alias), {149}: (149, {}, may-alias), {150}: (150, {}, may-alias), {151}: (151, {}, may-alias), {152}: (152, {}, may-alias), {153}: (153, {}, may-alias), {154}: (154, {}, may-alias), {155}: (155, {}, may-alias), {156}: (156, {}, may-alias), {157}: (157, {}, may-alias), {158}: (158, {}, may-alias), {159}: (159, {}, may-alias), {160}: (160, {}, may-alias), {161}: (161, {}, may-alias), {162}: (162, {}, may-alias), {163}: (163, {}, may-alias), {164}: (164, {}, may-alias), {165}: (165, {}, may-alias), {166}: (166, {}, may-alias), {167}: (167, {}, may-alias), {168}: (168, {}, may-alias), {169}: (169, {}, may-alias), {170}: (170, {}, may-alias), {171}: (171, {}, may-alias), {172}: (172, {}, may-alias), {173}: (173, {}, may-alias), {174}: (174, {}, may-alias), {175}: (175, {}, may-alias), {176}: (176, {}, may-alias), {177}: (177, {}, may-alias), {178}: (178, {}, may-alias), {179}: (179, {}, may-alias), {180}: (180, {}, may-alias), {181}: (181, {}, may-alias), {182}: (182, {}, may-alias), {183}: (183, {}, may-alias), {184}: (184, {}, may-alias), {185}: (185, {}, may-alias), {186}: (186, {}, may-alias), {187}: (187, {}, may-alias), {188}: (188, {}, may-alias), {189}: (189, {}, may-alias), {190}: (190, {}, may-alias), {191}: (191, {}, may-alias), {192}: (192, {}, may-alias), {193}: (193, {}, may-alias), {194}: (194, {}, may-alias), {195}: (195, {}, may-alias), {196}: (196, {}, may-alias), {197}: (197, {}, may-alias), {198}: (198, {}, may-alias), {199}: (199, {}, may-alias), {200}: (200, {}, may-alias), {201}: (201, {}, may-alias), {202}: (202, {}, may-alias), {203}: (203, {}, may-alias), {204}: (204, {}, may-alias), {205}: (205, {}, may-alias), {206}: (206, {}, may-alias), {207}: (207, {}, may-alias), {208}: (208, {}, may-alias), {209}: (209, {}, may-alias), {210}: (210, {}, may-alias), {211}: (211, {}, may-alias), {212}: (212, {}, may-alias), {213}: (213, {}, may-alias), {214}: (214, {}, may-alias), {215}: (215, {}, may-alias), {216}: (216, {}, may-alias), {217}: (217, {}, may-alias), {218}: (218, {}, may-alias), {219}: (219, {}, may-alias), {220}: (220, {}, may-alias), {221}: (221, {}, may-alias), {222}: (222, {}, may-alias), {223}: (223, {}, may-alias), {224}: (224, {}, may-alias), {225}: (225, {}, may-alias), {226}: (226, {}, may-alias), {227}: (227, {}, may-alias) }, entry_computation_layout={(s32[], f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=5*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=10*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=15*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=20*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=25*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=30*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=45*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=100*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=105*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, /*index=130*/bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, /*index=135*/bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, /*index=140*/bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=145*/bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, /*index=150*/bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, /*index=155*/bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, /*index=160*/s32[], bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, /*index=165*/bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, /*index=170*/bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, /*index=175*/bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=180*/bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, /*index=185*/bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, /*index=190*/bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, bf16[7168]{0}, /*index=195*/bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, /*index=200*/bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, /*index=205*/bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, /*index=210*/bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, /*index=215*/bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, /*index=220*/bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, /*index=225*/bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, s32[], s32[32,4096]{1,0}, s32[32,4096]{1,0}, /*index=230*/s32[32,4096]{1,0}, s32[32,4096]{1,0})->(s32[], f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=5*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=10*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=15*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=20*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=25*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=30*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=45*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=100*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=105*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, /*index=130*/bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, /*index=135*/bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, /*index=140*/bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=145*/bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, /*index=150*/bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, /*index=155*/bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, /*index=160*/s32[], bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, /*index=165*/bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, /*index=170*/bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, /*index=175*/bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=180*/bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, /*index=185*/bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, /*index=190*/bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, bf16[7168]{0}, /*index=195*/bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, /*index=200*/bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, /*index=205*/bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, /*index=210*/bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, /*index=215*/bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, /*index=220*/bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, /*index=225*/bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, s32[], f32[], f32[], /*index=230*/f32[], f32[], f32[], f32[], s32[])}, allow_spmd_sharding_propagation_to_parameters={false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false}, allow_spmd_sharding_propagation_to_output={false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,true,true,true,true,true}, num_partitions=4, frontend_attributes={xla.sdy.meshes={mesh = #sdy.mesh<["data"=1, "stage"=1, "fsdp"=1, "fsdp_transpose"=1, "sequence"=1, "context"=1, "context_autoregressive"=1, "tensor"=1, "tensor_transpose"=1, "tensor_sequence"=1, "expert"=4, "autoregressive"=1]>}}

%clip.1 (Arg_0.1: f32[32], Arg_1.1: s32[], Arg_2.1: s32[]) -> f32[32] {
  %Arg_2.1 = s32[] parameter(2)
  %convert_element_type.3 = f32[] convert(%Arg_2.1), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %min.2 = f32[32]{0} broadcast(%convert_element_type.3), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %Arg_1.1 = s32[] parameter(1)
  %convert_element_type.2 = f32[] convert(%Arg_1.1), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %max.2 = f32[32]{0} broadcast(%convert_element_type.2), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %Arg_0.1 = f32[32]{0} parameter(0)
  %max.3 = f32[32]{0} maximum(%max.2, %Arg_0.1), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  ROOT %min.3 = f32[32]{0} minimum(%min.2, %max.3), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
}

%_where.2 (Arg_0.4: pred[32,4096], Arg_1.4: s32[32,4096], Arg_2.3: s32[32,4096]) -> s32[32,4096] {
  %Arg_0.4 = pred[32,4096]{1,0} parameter(0)
  %Arg_1.4 = s32[32,4096]{1,0} parameter(1)
  %Arg_2.3 = s32[32,4096]{1,0} parameter(2)
  ROOT %select_n.2 = s32[32,4096]{1,0} select(%Arg_0.4, %Arg_1.4, %Arg_2.3), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%region_0.3 (reduce_and.3: pred[], reduce_and.4: pred[]) -> pred[] {
  %reduce_and.3 = pred[] parameter(0), metadata={op_name="reduce_and"}
  %reduce_and.4 = pred[] parameter(1), metadata={op_name="reduce_and"}
  ROOT %reduce_and.5 = pred[] and(%reduce_and.3, %reduce_and.4), metadata={op_name="reduce_and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%_take.4 (Arg_0.5: c64[163840,32], Arg_1.5: s32[32,4096]) -> c64[32,4096,32] {
  %Arg_1.5 = s32[32,4096]{1,0} parameter(1)
  %constant.223 = s32[] constant(0)
  %lt.3 = s32[32,4096]{1,0} broadcast(%constant.223), dimensions={}, metadata={op_name="lt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %lt.4 = pred[32,4096]{1,0} compare(%Arg_1.5, %lt.3), direction=LT, metadata={op_name="lt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.221 = s32[] constant(163840)
  %add.28 = s32[32,4096]{1,0} broadcast(%constant.221), dimensions={}, metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %add.29 = s32[32,4096]{1,0} add(%Arg_1.5, %add.28), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %jit__where_.1 = s32[32,4096]{1,0} call(%lt.4, %add.29, %Arg_1.5), to_apply=%_where.2, metadata={op_name="jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.32 = s32[32,4096,1]{2,1,0} reshape(%jit__where_.1), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.220 = s32[] constant(0)
  %ge.2 = s32[32,4096,1]{2,1,0} broadcast(%constant.220), dimensions={}, metadata={op_name="ge" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %ge.3 = pred[32,4096,1]{2,1,0} compare(%broadcast_in_dim.32, %ge.2), direction=GE, metadata={op_name="ge" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.219 = s32[] constant(163839)
  %le.2 = s32[32,4096,1]{2,1,0} broadcast(%constant.219), dimensions={}, metadata={op_name="le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %le.3 = pred[32,4096,1]{2,1,0} compare(%broadcast_in_dim.32, %le.2), direction=LE, metadata={op_name="le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %and.1 = pred[32,4096,1]{2,1,0} and(%ge.3, %le.3), metadata={op_name="and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.222 = pred[] constant(true)
  %reduce_and.7 = pred[32,4096]{1,0} reduce(%and.1, %constant.222), dimensions={2}, to_apply=%region_0.3, metadata={op_name="reduce_and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.33 = pred[32,4096,32]{2,1,0} broadcast(%reduce_and.7), dimensions={0,1}, metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %Arg_0.5 = c64[163840,32]{1,0} parameter(0)
  %gather.2 = c64[32,4096,32]{2,1,0} gather(%Arg_0.5, %broadcast_in_dim.32), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,32}, metadata={op_name="gather" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.218 = c64[] constant((nan, 0))
  %broadcast_in_dim.31 = c64[32,4096,32]{2,1,0} broadcast(%constant.218), dimensions={}, metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  ROOT %select_n.4 = c64[32,4096,32]{2,1,0} select(%broadcast_in_dim.33, %gather.2, %broadcast_in_dim.31), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%region_2.5 (reduce_sum.3: f32[], reduce_sum.4: f32[]) -> f32[] {
  %reduce_sum.3 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.5 = f32[] add(%reduce_sum.3, %reduce_sum.4), metadata={op_name="dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_3.6 (reduce_max.3: f32[], reduce_max.4: f32[]) -> f32[] {
  %reduce_max.3 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.4 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.5 = f32[] maximum(%reduce_max.3, %reduce_max.4), metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%_where_68.7 (Arg_0.8: pred[], Arg_1.8: f32[], Arg_2.6: f32[1]) -> f32[1] {
  %Arg_0.8 = pred[] parameter(0)
  %select_n.7 = pred[1]{0} broadcast(%Arg_0.8), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.8 = f32[] parameter(1)
  %broadcast_in_dim.41 = f32[1]{0} reshape(%Arg_1.8), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_2.6 = f32[1]{0} parameter(2)
  ROOT %select_n.8 = f32[1]{0} select(%select_n.7, %broadcast_in_dim.41, %Arg_2.6), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%_where_71.8 (Arg_0.10: pred[], Arg_1.10: f32[1], Arg_2.8: f32[1]) -> f32[1] {
  %Arg_0.10 = pred[] parameter(0)
  %select_n.11 = pred[1]{0} broadcast(%Arg_0.10), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.10 = f32[1]{0} parameter(1)
  %Arg_2.8 = f32[1]{0} parameter(2)
  ROOT %select_n.12 = f32[1]{0} select(%select_n.11, %Arg_1.10, %Arg_2.8), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%clip_75.9 (Arg_0.12: bf16[32,4096,7168], Arg_1.12: bf16[], Arg_2.10: bf16[]) -> bf16[32,4096,7168] {
  %Arg_1.12 = bf16[] parameter(1)
  %min.6 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_1.12), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_2.10 = bf16[] parameter(2)
  %max.6 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_2.10), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.12 = bf16[32,4096,7168]{2,1,0} parameter(0)
  %max.7 = bf16[32,4096,7168]{2,1,0} maximum(%max.6, %Arg_0.12), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.7 = bf16[32,4096,7168]{2,1,0} minimum(%min.6, %max.7), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_4.10 (reduce_max.10: f32[], reduce_max.11: f32[]) -> f32[] {
  %reduce_max.10 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.11 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.12 = f32[] maximum(%reduce_max.10, %reduce_max.11), metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%clip_81.11 (Arg_0.14: bf16[7168,1536], Arg_1.14: bf16[], Arg_2.12: bf16[]) -> bf16[7168,1536] {
  %Arg_1.14 = bf16[] parameter(1)
  %min.10 = bf16[7168,1536]{1,0} broadcast(%Arg_1.14), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_2.12 = bf16[] parameter(2)
  %max.10 = bf16[7168,1536]{1,0} broadcast(%Arg_2.12), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.14 = bf16[7168,1536]{1,0} parameter(0)
  %max.11 = bf16[7168,1536]{1,0} maximum(%max.10, %Arg_0.14), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.11 = bf16[7168,1536]{1,0} minimum(%min.10, %max.11), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_6.14 (reduce_sum.10: f32[], reduce_sum.11: f32[]) -> f32[] {
  %reduce_sum.10 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.11 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.12 = f32[] add(%reduce_sum.10, %reduce_sum.11), metadata={op_name="dense_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_7.15 (reduce_max.24: f32[], reduce_max.25: f32[]) -> f32[] {
  %reduce_max.24 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.25 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.26 = f32[] maximum(%reduce_max.24, %reduce_max.25), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%clip_106.16 (Arg_0.18: bf16[32,4096,1536], Arg_1.18: bf16[], Arg_2.16: bf16[]) -> bf16[32,4096,1536] {
  %Arg_1.18 = bf16[] parameter(1)
  %min.18 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_1.18), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_2.16 = bf16[] parameter(2)
  %max.18 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_2.16), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.18 = bf16[32,4096,1536]{2,1,0} parameter(0)
  %max.19 = bf16[32,4096,1536]{2,1,0} maximum(%max.18, %Arg_0.18), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.19 = bf16[32,4096,1536]{2,1,0} minimum(%min.18, %max.19), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_8.17 (reduce_max.31: f32[], reduce_max.32: f32[]) -> f32[] {
  %reduce_max.31 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.32 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.33 = f32[] maximum(%reduce_max.31, %reduce_max.32), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_112.18 (Arg_0.20: bf16[1536,128,192], Arg_1.20: bf16[], Arg_2.18: bf16[]) -> bf16[1536,128,192] {
  %Arg_1.20 = bf16[] parameter(1)
  %min.22 = bf16[1536,128,192]{2,1,0} broadcast(%Arg_1.20), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.18 = bf16[] parameter(2)
  %max.22 = bf16[1536,128,192]{2,1,0} broadcast(%Arg_2.18), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.20 = bf16[1536,128,192]{2,1,0} parameter(0)
  %max.23 = bf16[1536,128,192]{2,1,0} maximum(%max.22, %Arg_0.20), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.23 = bf16[1536,128,192]{2,1,0} minimum(%min.22, %max.23), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_5.12 (reduce_max.17: f32[], reduce_max.18: f32[]) -> f32[] {
  %reduce_max.17 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.18 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.19 = f32[] maximum(%reduce_max.17, %reduce_max.18), metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%clip_90.13 (Arg_0.16: bf16[7168,576], Arg_1.16: bf16[], Arg_2.14: bf16[]) -> bf16[7168,576] {
  %Arg_1.16 = bf16[] parameter(1)
  %min.14 = bf16[7168,576]{1,0} broadcast(%Arg_1.16), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_2.14 = bf16[] parameter(2)
  %max.14 = bf16[7168,576]{1,0} broadcast(%Arg_2.14), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.16 = bf16[7168,576]{1,0} parameter(0)
  %max.15 = bf16[7168,576]{1,0} maximum(%max.14, %Arg_0.16), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.15 = bf16[7168,576]{1,0} minimum(%min.14, %max.15), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_9.19 (reduce_sum.17: f32[], reduce_sum.18: f32[]) -> f32[] {
  %reduce_sum.17 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.18 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.19 = f32[] add(%reduce_sum.17, %reduce_sum.18), metadata={op_name="dense_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_10.20 (reduce_max.38: f32[], reduce_max.39: f32[]) -> f32[] {
  %reduce_max.38 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.39 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.40 = f32[] maximum(%reduce_max.38, %reduce_max.39), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%clip_154.21 (Arg_0.22: bf16[32,4096,512], Arg_1.22: bf16[], Arg_2.20: bf16[]) -> bf16[32,4096,512] {
  %Arg_1.22 = bf16[] parameter(1)
  %min.26 = bf16[32,4096,512]{2,1,0} broadcast(%Arg_1.22), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_2.20 = bf16[] parameter(2)
  %max.26 = bf16[32,4096,512]{2,1,0} broadcast(%Arg_2.20), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.22 = bf16[32,4096,512]{2,1,0} parameter(0)
  %max.27 = bf16[32,4096,512]{2,1,0} maximum(%max.26, %Arg_0.22), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.27 = bf16[32,4096,512]{2,1,0} minimum(%min.26, %max.27), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_11.22 (reduce_max.45: f32[], reduce_max.46: f32[]) -> f32[] {
  %reduce_max.45 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.46 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.47 = f32[] maximum(%reduce_max.45, %reduce_max.46), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_160.23 (Arg_0.24: bf16[512,128,256], Arg_1.24: bf16[], Arg_2.22: bf16[]) -> bf16[512,128,256] {
  %Arg_1.24 = bf16[] parameter(1)
  %min.30 = bf16[512,128,256]{2,1,0} broadcast(%Arg_1.24), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.22 = bf16[] parameter(2)
  %max.30 = bf16[512,128,256]{2,1,0} broadcast(%Arg_2.22), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.24 = bf16[512,128,256]{2,1,0} parameter(0)
  %max.31 = bf16[512,128,256]{2,1,0} maximum(%max.30, %Arg_0.24), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.31 = bf16[512,128,256]{2,1,0} minimum(%min.30, %max.31), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_12.24 (reduce_max.52: f32[], reduce_max.53: f32[]) -> f32[] {
  %reduce_max.52 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.53 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.54 = f32[] maximum(%reduce_max.52, %reduce_max.53), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%clip_177.25 (Arg_0.26: bf16[32,4096,128,128], Arg_1.26: bf16[], Arg_2.24: bf16[]) -> bf16[32,4096,128,128] {
  %Arg_1.26 = bf16[] parameter(1)
  %min.34 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%Arg_1.26), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_2.24 = bf16[] parameter(2)
  %max.34 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%Arg_2.24), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.26 = bf16[32,4096,128,128]{3,2,1,0} parameter(0)
  %max.35 = bf16[32,4096,128,128]{3,2,1,0} maximum(%max.34, %Arg_0.26), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.35 = bf16[32,4096,128,128]{3,2,1,0} minimum(%min.34, %max.35), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_13.26 (reduce_max.59: f32[], reduce_max.60: f32[]) -> f32[] {
  %reduce_max.59 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.60 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.61 = f32[] maximum(%reduce_max.59, %reduce_max.60), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_183.27 (Arg_0.28: bf16[128,128,7168], Arg_1.28: bf16[], Arg_2.26: bf16[]) -> bf16[128,128,7168] {
  %Arg_1.28 = bf16[] parameter(1)
  %min.38 = bf16[128,128,7168]{2,1,0} broadcast(%Arg_1.28), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.26 = bf16[] parameter(2)
  %max.38 = bf16[128,128,7168]{2,1,0} broadcast(%Arg_2.26), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.28 = bf16[128,128,7168]{2,1,0} parameter(0)
  %max.39 = bf16[128,128,7168]{2,1,0} maximum(%max.38, %Arg_0.28), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.39 = bf16[128,128,7168]{2,1,0} minimum(%min.38, %max.39), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_14.28 (reduce_sum.24: f32[], reduce_sum.25: f32[]) -> f32[] {
  %reduce_sum.24 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.25 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.26 = f32[] add(%reduce_sum.24, %reduce_sum.25), metadata={op_name="dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_15.29 (reduce_max.66: f32[], reduce_max.67: f32[]) -> f32[] {
  %reduce_max.66 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.67 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.68 = f32[] maximum(%reduce_max.66, %reduce_max.67), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_16.30 (reduce_max.73: f32[], reduce_max.74: f32[]) -> f32[] {
  %reduce_max.73 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.74 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.75 = f32[] maximum(%reduce_max.73, %reduce_max.74), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_193.31 (Arg_0.30: bf16[7168,18432], Arg_1.30: bf16[], Arg_2.28: bf16[]) -> bf16[7168,18432] {
  %Arg_1.30 = bf16[] parameter(1)
  %min.42 = bf16[7168,18432]{1,0} broadcast(%Arg_1.30), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.28 = bf16[] parameter(2)
  %max.42 = bf16[7168,18432]{1,0} broadcast(%Arg_2.28), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.30 = bf16[7168,18432]{1,0} parameter(0)
  %max.43 = bf16[7168,18432]{1,0} maximum(%max.42, %Arg_0.30), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.43 = bf16[7168,18432]{1,0} minimum(%min.42, %max.43), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%silu.32 (Arg_0.32: bf16[32,4096,18432]) -> bf16[32,4096,18432] {
  %Arg_0.32 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %constant.242 = bf16[] constant(1)
  %broadcast.82 = bf16[32,4096,18432]{2,1,0} broadcast(%constant.242), dimensions={}
  %neg.1 = bf16[32,4096,18432]{2,1,0} negate(%Arg_0.32), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %exp.39 = bf16[32,4096,18432]{2,1,0} exponential(%neg.1), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %add.39 = bf16[32,4096,18432]{2,1,0} add(%exp.39, %broadcast.82), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %div.70 = bf16[32,4096,18432]{2,1,0} divide(%broadcast.82, %add.39), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %mul.143 = bf16[32,4096,18432]{2,1,0} multiply(%Arg_0.32, %div.70), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
}

%region_17.33 (reduce_max.80: f32[], reduce_max.81: f32[]) -> f32[] {
  %reduce_max.80 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.81 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.82 = f32[] maximum(%reduce_max.80, %reduce_max.81), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_18.34 (reduce_max.87: f32[], reduce_max.88: f32[]) -> f32[] {
  %reduce_max.87 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.88 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.89 = f32[] maximum(%reduce_max.87, %reduce_max.88), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_19.35 (reduce_max.94: f32[], reduce_max.95: f32[]) -> f32[] {
  %reduce_max.94 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.95 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.96 = f32[] maximum(%reduce_max.94, %reduce_max.95), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%clip_208.36 (Arg_0.34: bf16[32,4096,18432], Arg_1.32: bf16[], Arg_2.30: bf16[]) -> bf16[32,4096,18432] {
  %Arg_1.32 = bf16[] parameter(1)
  %min.46 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_1.32), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_2.30 = bf16[] parameter(2)
  %max.46 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_2.30), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.34 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %max.47 = bf16[32,4096,18432]{2,1,0} maximum(%max.46, %Arg_0.34), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.47 = bf16[32,4096,18432]{2,1,0} minimum(%min.46, %max.47), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_20.37 (reduce_max.101: f32[], reduce_max.102: f32[]) -> f32[] {
  %reduce_max.101 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.102 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.103 = f32[] maximum(%reduce_max.101, %reduce_max.102), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_214.38 (Arg_0.36: bf16[18432,7168], Arg_1.34: bf16[], Arg_2.32: bf16[]) -> bf16[18432,7168] {
  %Arg_1.34 = bf16[] parameter(1)
  %min.50 = bf16[18432,7168]{1,0} broadcast(%Arg_1.34), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.32 = bf16[] parameter(2)
  %max.50 = bf16[18432,7168]{1,0} broadcast(%Arg_2.32), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.36 = bf16[18432,7168]{1,0} parameter(0)
  %max.51 = bf16[18432,7168]{1,0} maximum(%max.50, %Arg_0.36), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.51 = bf16[18432,7168]{1,0} minimum(%min.50, %max.51), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%closed_call.39 (Arg_0.37: bf16[], Arg_1.35: bf16[], Arg_2.33: bf16[], Arg_3.1: bf16[], Arg_4.1: bf16[], Arg_5.1: bf16[], Arg_6.1: bf16[], Arg_7.1: bf16[], Arg_8.1: c64[32,4096,1,32], Arg_9.1: bf16[], Arg_10.1: bf16[], Arg_11.1: bf16[], Arg_12.1: bf16[], Arg_13.1: bf16[], Arg_14.1: bf16[], Arg_15.1: c64[32,4096,1,32], Arg_16.1: bf16[0], Arg_17.1: bf16[], Arg_18.1: bf16[], Arg_19.1: bf16[], Arg_20.1: bf16[], Arg_21.1: bf16[], Arg_22.1: bf16[], Arg_23.1: bf16[], Arg_24.1: bf16[], Arg_25.1: bf16[], Arg_26.1: bf16[], Arg_27.1: bf16[], Arg_28.1: bf16[], Arg_29.1: bf16[], Arg_30.1: bf16[], Arg_31.1: bf16[], Arg_32.1: bf16[], Arg_33.1: bf16[32,4096,7168], Arg_34.1: bf16[7168,18432], Arg_35.1: bf16[7168,18432], Arg_36.1: bf16[18432,7168], Arg_37.1: bf16[7168], Arg_38.1: bf16[7168], Arg_39.1: bf16[512], Arg_40.1: bf16[128,128,7168], Arg_41.1: bf16[1536], Arg_42.1: bf16[7168,576], Arg_43.1: bf16[512,128,256], Arg_44.1: bf16[7168,1536], Arg_45.1: bf16[1536,128,192], Arg_46.1: f32[1024], Arg_47.1: f32[1], Arg_48.1: f32[1024], Arg_49.1: f32[1], Arg_50.1: f32[1024], Arg_51.1: f32[1], Arg_52.1: f32[1024], Arg_53.1: f32[1], Arg_54.1: f32[1024], Arg_55.1: f32[1], Arg_56.1: f32[1024], Arg_57.1: f32[1], Arg_58.1: f32[1024], Arg_59.1: f32[1], Arg_60.1: f32[1024], Arg_61.1: f32[1024], Arg_62.1: f32[1], Arg_63.1: f32[1], Arg_64.1: f32[1024], Arg_65.1: f32[1], Arg_66.1: f32[1024], Arg_67.1: f32[1], Arg_68.1: f32[1024], Arg_69.1: f32[1], Arg_70.1: f32[1024], Arg_71.1: f32[1], Arg_72.1: f32[1024], Arg_73.1: f32[1], Arg_74.1: f32[1024], Arg_75.1: f32[1]) -> (bf16[32,4096,7168], bf16[32,4096,7168], bf16[32,4096,1536], bf16[32,4096,576], bf16[32,4096,7168], /*index=5*/bf16[32,4096,18432], bf16[32,4096,18432]) {
  %Arg_33.1 = bf16[32,4096,7168]{2,1,0} parameter(33)
  %sharding_constraint.13 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_33.1), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %reduce_precision.2 = bf16[32,4096,7168]{2,1,0} reduce-precision(%sharding_constraint.13), exponent_bits=8, mantissa_bits=7, metadata={op_name="dense_layers/reduce_precision" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=173 source_end_line=173 source_column=13 source_end_column=59}
  %convert_element_type.58 = f32[32,4096,7168]{2,1,0} convert(%reduce_precision.2), metadata={op_name="dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.4 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.58, %convert_element_type.58), metadata={op_name="dense_layers/pre_self_attention_layer_norm/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %constant.254 = f32[] constant(0)
  %reduce_sum.28 = f32[32,4096]{1,0} reduce(%square.4, %constant.254), dimensions={2}, to_apply=%region_2.5, metadata={op_name="dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.120 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.28), metadata={op_name="dense_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.250 = f32[] constant(7168)
  %broadcast.84 = f32[32,4096,1]{2,1,0} broadcast(%constant.250), dimensions={}
  %div.93 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.120, %broadcast.84), metadata={op_name="dense_layers/pre_self_attention_layer_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.249 = f32[] constant(1e-06)
  %broadcast.83 = f32[32,4096,1]{2,1,0} broadcast(%constant.249), dimensions={}
  %add.41 = f32[32,4096,1]{2,1,0} add(%div.93, %broadcast.83), metadata={op_name="dense_layers/pre_self_attention_layer_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.4 = f32[32,4096,1]{2,1,0} rsqrt(%add.41), metadata={op_name="dense_layers/pre_self_attention_layer_norm/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.152 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.4), dimensions={0,1,2}, metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.153 = f32[32,4096]{1,0} reshape(%mul.152), metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.154 = f32[32,4096,7168]{2,1,0} broadcast(%mul.153), dimensions={0,1}, metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.155 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.58, %mul.154), metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.59 = bf16[32,4096,7168]{2,1,0} convert(%mul.155), metadata={op_name="dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_38.1 = bf16[7168]{0} parameter(38)
  %broadcast_in_dim.121 = bf16[1,1,7168]{2,1,0} reshape(%Arg_38.1), metadata={op_name="dense_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.156 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.121), dimensions={0,1,2}, metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.157 = bf16[7168]{0} reshape(%mul.156), metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.158 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.157), dimensions={2}, metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.159 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.59, %mul.158), metadata={op_name="dense_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %sharding_constraint.14 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.159), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %sharding_constraint.15 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.14), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %constant.248 = f32[1]{0} constant({1})
  %Arg_58.1 = f32[1024]{0} parameter(58)
  %constant.253 = f32[] constant(-inf)
  %reduce_max.105 = f32[] reduce(%Arg_58.1, %constant.253), dimensions={0}, to_apply=%region_3.6, metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %is_finite.15 = pred[] is-finite(%reduce_max.105), metadata={op_name="dense_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %gt.15 = pred[] compare(%reduce_max.105, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %constant.251 = f32[] constant(448)
  %div.95 = f32[] divide(%constant.251, %reduce_max.105), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %constant.252 = f32[] constant(1)
  %div.96 = f32[] divide(%div.95, %constant.252), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_59.1 = f32[1]{0} parameter(59)
  %div.94 = f32[1]{0} divide(%constant.248, %Arg_59.1), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.32 = f32[1]{0} call(%gt.15, %div.96, %div.94), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.33 = f32[1]{0} call(%is_finite.15, %jit__where_.32, %div.94), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.97 = f32[1]{0} divide(%constant.248, %jit__where_.33), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.60 = bf16[1]{0} convert(%div.97), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.122 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.60), dimensions={2}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.123 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.122), metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.124 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.123), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.98 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.15, %broadcast_in_dim.124), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.37 = bf16[] parameter(0)
  %Arg_1.35 = bf16[] parameter(1)
  %jit_clip_.17 = bf16[32,4096,7168]{2,1,0} call(%div.98, %Arg_0.37, %Arg_1.35), to_apply=%clip_75.9, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.61 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.17), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_44.1 = bf16[7168,1536]{1,0} parameter(44)
  %Arg_60.1 = f32[1024]{0} parameter(60)
  %reduce_max.106 = f32[] reduce(%Arg_60.1, %constant.253), dimensions={0}, to_apply=%region_4.10, metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.16 = pred[] is-finite(%reduce_max.106), metadata={op_name="dense_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.16 = pred[] compare(%reduce_max.106, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.100 = f32[] divide(%constant.251, %reduce_max.106), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.101 = f32[] divide(%div.100, %constant.252), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_62.1 = f32[1]{0} parameter(62)
  %div.99 = f32[1]{0} divide(%constant.248, %Arg_62.1), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.34 = f32[1]{0} call(%gt.16, %div.101, %div.99), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.35 = f32[1]{0} call(%is_finite.16, %jit__where_.34, %div.99), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.102 = f32[1]{0} divide(%constant.248, %jit__where_.35), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.62 = bf16[1]{0} convert(%div.102), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.125 = bf16[7168,1]{1,0} broadcast(%convert_element_type.62), dimensions={1}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.126 = bf16[7168]{0} reshape(%broadcast_in_dim.125), metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.127 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.126), dimensions={0}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.103 = bf16[7168,1536]{1,0} divide(%Arg_44.1, %broadcast_in_dim.127), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_2.33 = bf16[] parameter(2)
  %Arg_3.1 = bf16[] parameter(3)
  %jit_clip_.18 = bf16[7168,1536]{1,0} call(%div.103, %Arg_2.33, %Arg_3.1), to_apply=%clip_81.11, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.63 = f8e4m3fn[7168,1536]{1,0} convert(%jit_clip_.18), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.8 = bf16[32,4096,1536]{2,1,0} dot(%convert_element_type.61, %convert_element_type.63), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.160 = f32[1]{0} multiply(%div.97, %div.102), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.64 = bf16[1]{0} convert(%mul.160), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.128 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.64), dimensions={2}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.129 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.128), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.130 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.129), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.161 = bf16[32,4096,1536]{2,1,0} multiply(%dot_general.8, %broadcast_in_dim.130), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.68 = f32[32,4096,1536]{2,1,0} convert(%mul.161), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.5 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.68, %convert_element_type.68), metadata={op_name="dense_layers/self_attention/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.29 = f32[32,4096]{1,0} reduce(%square.5, %constant.254), dimensions={2}, to_apply=%region_6.14, metadata={op_name="dense_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.137 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.29), metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.247 = f32[] constant(1536)
  %div.92 = f32[32,4096,1]{2,1,0} broadcast(%constant.247), dimensions={}, metadata={op_name="dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.109 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.137, %div.92), metadata={op_name="dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.42 = f32[32,4096,1]{2,1,0} add(%div.109, %broadcast.83), metadata={op_name="dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.5 = f32[32,4096,1]{2,1,0} rsqrt(%add.42), metadata={op_name="dense_layers/self_attention/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.164 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.5), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.165 = f32[32,4096]{1,0} reshape(%mul.164), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.166 = f32[32,4096,1536]{2,1,0} broadcast(%mul.165), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.167 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.68, %mul.166), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.69 = bf16[32,4096,1536]{2,1,0} convert(%mul.167), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_41.1 = bf16[1536]{0} parameter(41)
  %broadcast_in_dim.138 = bf16[1,1,1536]{2,1,0} reshape(%Arg_41.1), metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.168 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.138), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.169 = bf16[1536]{0} reshape(%mul.168), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.170 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.169), dimensions={2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.171 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.69, %mul.170), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %Arg_72.1 = f32[1024]{0} parameter(72)
  %reduce_max.108 = f32[] reduce(%Arg_72.1, %constant.253), dimensions={0}, to_apply=%region_7.15, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.18 = pred[] is-finite(%reduce_max.108), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.18 = pred[] compare(%reduce_max.108, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.111 = f32[] divide(%constant.251, %reduce_max.108), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.112 = f32[] divide(%div.111, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_73.1 = f32[1]{0} parameter(73)
  %div.110 = f32[1]{0} divide(%constant.248, %Arg_73.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.38 = f32[1]{0} call(%gt.18, %div.112, %div.110), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.39 = f32[1]{0} call(%is_finite.18, %jit__where_.38, %div.110), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.113 = f32[1]{0} divide(%constant.248, %jit__where_.39), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.70 = bf16[1]{0} convert(%div.113), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.139 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.70), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.140 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.139), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.141 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.140), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.114 = bf16[32,4096,1536]{2,1,0} divide(%mul.171, %broadcast_in_dim.141), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_4.1 = bf16[] parameter(4)
  %Arg_5.1 = bf16[] parameter(5)
  %jit_clip_.20 = bf16[32,4096,1536]{2,1,0} call(%div.114, %Arg_4.1, %Arg_5.1), to_apply=%clip_106.16, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.71 = f8e4m3fn[32,4096,1536]{2,1,0} convert(%jit_clip_.20), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_45.1 = bf16[1536,128,192]{2,1,0} parameter(45)
  %Arg_74.1 = f32[1024]{0} parameter(74)
  %reduce_max.109 = f32[] reduce(%Arg_74.1, %constant.253), dimensions={0}, to_apply=%region_8.17, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.19 = pred[] is-finite(%reduce_max.109), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.19 = pred[] compare(%reduce_max.109, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.116 = f32[] divide(%constant.251, %reduce_max.109), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.117 = f32[] divide(%div.116, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_75.1 = f32[1]{0} parameter(75)
  %div.115 = f32[1]{0} divide(%constant.248, %Arg_75.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.40 = f32[1]{0} call(%gt.19, %div.117, %div.115), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.41 = f32[1]{0} call(%is_finite.19, %jit__where_.40, %div.115), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.118 = f32[1]{0} divide(%constant.248, %jit__where_.41), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.72 = bf16[1]{0} convert(%div.118), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.142 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.72), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.143 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.142), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.144 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.143), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.119 = bf16[1536,128,192]{2,1,0} divide(%Arg_45.1, %broadcast_in_dim.144), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_6.1 = bf16[] parameter(6)
  %Arg_7.1 = bf16[] parameter(7)
  %jit_clip_.21 = bf16[1536,128,192]{2,1,0} call(%div.119, %Arg_6.1, %Arg_7.1), to_apply=%clip_112.18, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.73 = f8e4m3fn[1536,128,192]{2,1,0} convert(%jit_clip_.21), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.10 = bf16[32,4096,128,192]{3,2,1,0} dot(%convert_element_type.71, %convert_element_type.73), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.172 = f32[1]{0} multiply(%div.113, %div.118), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.74 = bf16[1]{0} convert(%mul.172), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.145 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.74), dimensions={3}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.146 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.145), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.147 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.146), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.173 = bf16[32,4096,128,192]{3,2,1,0} multiply(%dot_general.10, %broadcast_in_dim.147), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %split.6 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.173), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=541 source_end_line=541 source_column=19 source_end_column=65}
  %split.7 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.173), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=541 source_end_line=541 source_column=19 source_end_column=65}
  %reshape.2 = bf16[32,4096,128,32,2]{4,3,2,1,0} reshape(%split.7), metadata={op_name="dense_layers/self_attention/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=702 source_end_line=702 source_column=24 source_end_column=60}
  %slice.4 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.2), slice={[0:32], [0:4096], [0:128], [0:32], [0:1]}, metadata={op_name="dense_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %squeeze.46 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.4), metadata={op_name="dense_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %convert_element_type.76 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.46), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %slice.5 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.2), slice={[0:32], [0:4096], [0:128], [0:32], [1:2]}, metadata={op_name="dense_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %squeeze.47 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.5), metadata={op_name="dense_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %convert_element_type.75 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.47), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %constant.246 = c64[] constant((0, 1))
  %mul.151 = c64[32,4096,128,32]{3,2,1,0} broadcast(%constant.246), dimensions={}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %mul.174 = c64[32,4096,128,32]{3,2,1,0} multiply(%convert_element_type.75, %mul.151), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %add.43 = c64[32,4096,128,32]{3,2,1,0} add(%convert_element_type.76, %mul.174), metadata={op_name="dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %Arg_8.1 = c64[32,4096,1,32]{3,2,1,0} parameter(8)
  %mul.175 = c64[32,4096,1,32]{3,2,1,0} broadcast(%Arg_8.1), dimensions={0,1,2,3}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.176 = c64[32,4096,32]{2,1,0} reshape(%mul.175), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.177 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.176), dimensions={0,1,3}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.178 = c64[32,4096,128,32]{3,2,1,0} multiply(%add.43, %mul.177), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %real.2 = f32[32,4096,128,32]{3,2,1,0} real(%mul.178), metadata={op_name="dense_layers/self_attention/real" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=30 source_end_column=47}
  %imag.2 = f32[32,4096,128,32]{3,2,1,0} imag(%mul.178), metadata={op_name="dense_layers/self_attention/imag" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=49 source_end_column=66}
  %concatenate.4 = f32[32,4096,128,64]{3,2,1,0} concatenate(%real.2, %imag.2), dimensions={3}, metadata={op_name="dense_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=13 source_end_column=77}
  %convert_element_type.77 = bf16[32,4096,128,64]{3,2,1,0} convert(%concatenate.4), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=721 source_end_line=721 source_column=15 source_end_column=46}
  %concatenate.5 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.6, %convert_element_type.77), dimensions={3}, metadata={op_name="dense_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %constant.245 = bf16[] constant(0.1348)
  %mul.150 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%constant.245), dimensions={}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %mul.179 = bf16[32,4096,128,192]{3,2,1,0} multiply(%concatenate.5, %mul.150), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %sharding_constraint.16 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%mul.179), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_42.1 = bf16[7168,576]{1,0} parameter(42)
  %Arg_61.1 = f32[1024]{0} parameter(61)
  %reduce_max.107 = f32[] reduce(%Arg_61.1, %constant.253), dimensions={0}, to_apply=%region_5.12, metadata={op_name="dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.17 = pred[] is-finite(%reduce_max.107), metadata={op_name="dense_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.17 = pred[] compare(%reduce_max.107, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.105 = f32[] divide(%constant.251, %reduce_max.107), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.106 = f32[] divide(%div.105, %constant.252), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_63.1 = f32[1]{0} parameter(63)
  %div.104 = f32[1]{0} divide(%constant.248, %Arg_63.1), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.36 = f32[1]{0} call(%gt.17, %div.106, %div.104), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.37 = f32[1]{0} call(%is_finite.17, %jit__where_.36, %div.104), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.107 = f32[1]{0} divide(%constant.248, %jit__where_.37), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.65 = bf16[1]{0} convert(%div.107), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.131 = bf16[7168,1]{1,0} broadcast(%convert_element_type.65), dimensions={1}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.132 = bf16[7168]{0} reshape(%broadcast_in_dim.131), metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.133 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.132), dimensions={0}, metadata={op_name="dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.108 = bf16[7168,576]{1,0} divide(%Arg_42.1, %broadcast_in_dim.133), metadata={op_name="dense_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_9.1 = bf16[] parameter(9)
  %Arg_10.1 = bf16[] parameter(10)
  %jit_clip_.19 = bf16[7168,576]{1,0} call(%div.108, %Arg_9.1, %Arg_10.1), to_apply=%clip_90.13, metadata={op_name="dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.66 = f8e4m3fn[7168,576]{1,0} convert(%jit_clip_.19), metadata={op_name="dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.9 = bf16[32,4096,576]{2,1,0} dot(%convert_element_type.61, %convert_element_type.66), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.162 = f32[1]{0} multiply(%div.97, %div.107), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.67 = bf16[1]{0} convert(%mul.162), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.134 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.67), dimensions={2}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.135 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.134), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.136 = bf16[32,4096,576]{2,1,0} broadcast(%broadcast_in_dim.135), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.163 = bf16[32,4096,576]{2,1,0} multiply(%dot_general.9, %broadcast_in_dim.136), metadata={op_name="dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %split.8 = bf16[32,4096,512]{2,1,0} slice(%mul.163), slice={[0:32], [0:4096], [0:512]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=667 source_end_line=667 source_column=35 source_end_column=84}
  %convert_element_type.78 = f32[32,4096,512]{2,1,0} convert(%split.8), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.6 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.78, %convert_element_type.78), metadata={op_name="dense_layers/self_attention/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.30 = f32[32,4096]{1,0} reduce(%square.6, %constant.254), dimensions={2}, to_apply=%region_9.19, metadata={op_name="dense_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.148 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.30), metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.244 = f32[] constant(512)
  %div.91 = f32[32,4096,1]{2,1,0} broadcast(%constant.244), dimensions={}, metadata={op_name="dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.120 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.148, %div.91), metadata={op_name="dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.44 = f32[32,4096,1]{2,1,0} add(%div.120, %broadcast.83), metadata={op_name="dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.6 = f32[32,4096,1]{2,1,0} rsqrt(%add.44), metadata={op_name="dense_layers/self_attention/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.180 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.6), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.181 = f32[32,4096]{1,0} reshape(%mul.180), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.182 = f32[32,4096,512]{2,1,0} broadcast(%mul.181), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.183 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.78, %mul.182), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.79 = bf16[32,4096,512]{2,1,0} convert(%mul.183), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_39.1 = bf16[512]{0} parameter(39)
  %broadcast_in_dim.149 = bf16[1,1,512]{2,1,0} reshape(%Arg_39.1), metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.184 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.149), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.185 = bf16[512]{0} reshape(%mul.184), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.186 = bf16[32,4096,512]{2,1,0} broadcast(%mul.185), dimensions={2}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.187 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.79, %mul.186), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %Arg_68.1 = f32[1024]{0} parameter(68)
  %reduce_max.110 = f32[] reduce(%Arg_68.1, %constant.253), dimensions={0}, to_apply=%region_10.20, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.20 = pred[] is-finite(%reduce_max.110), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.20 = pred[] compare(%reduce_max.110, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.122 = f32[] divide(%constant.251, %reduce_max.110), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.123 = f32[] divide(%div.122, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_69.1 = f32[1]{0} parameter(69)
  %div.121 = f32[1]{0} divide(%constant.248, %Arg_69.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.42 = f32[1]{0} call(%gt.20, %div.123, %div.121), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.43 = f32[1]{0} call(%is_finite.20, %jit__where_.42, %div.121), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.124 = f32[1]{0} divide(%constant.248, %jit__where_.43), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.83 = bf16[1]{0} convert(%div.124), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.150 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.83), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.151 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.150), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.152 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.151), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.125 = bf16[32,4096,512]{2,1,0} divide(%mul.187, %broadcast_in_dim.152), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_11.1 = bf16[] parameter(11)
  %Arg_12.1 = bf16[] parameter(12)
  %jit_clip_.22 = bf16[32,4096,512]{2,1,0} call(%div.125, %Arg_11.1, %Arg_12.1), to_apply=%clip_154.21, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.84 = f8e4m3fn[32,4096,512]{2,1,0} convert(%jit_clip_.22), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_43.1 = bf16[512,128,256]{2,1,0} parameter(43)
  %Arg_70.1 = f32[1024]{0} parameter(70)
  %reduce_max.111 = f32[] reduce(%Arg_70.1, %constant.253), dimensions={0}, to_apply=%region_11.22, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.21 = pred[] is-finite(%reduce_max.111), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.21 = pred[] compare(%reduce_max.111, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.127 = f32[] divide(%constant.251, %reduce_max.111), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.128 = f32[] divide(%div.127, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_71.1 = f32[1]{0} parameter(71)
  %div.126 = f32[1]{0} divide(%constant.248, %Arg_71.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.44 = f32[1]{0} call(%gt.21, %div.128, %div.126), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.45 = f32[1]{0} call(%is_finite.21, %jit__where_.44, %div.126), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.129 = f32[1]{0} divide(%constant.248, %jit__where_.45), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.85 = bf16[1]{0} convert(%div.129), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.153 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.85), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.154 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.153), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.155 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.154), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.130 = bf16[512,128,256]{2,1,0} divide(%Arg_43.1, %broadcast_in_dim.155), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_13.1 = bf16[] parameter(13)
  %Arg_14.1 = bf16[] parameter(14)
  %jit_clip_.23 = bf16[512,128,256]{2,1,0} call(%div.130, %Arg_13.1, %Arg_14.1), to_apply=%clip_160.23, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.86 = f8e4m3fn[512,128,256]{2,1,0} convert(%jit_clip_.23), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.11 = bf16[32,4096,128,256]{3,2,1,0} dot(%convert_element_type.84, %convert_element_type.86), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.190 = f32[1]{0} multiply(%div.124, %div.129), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.87 = bf16[1]{0} convert(%mul.190), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.156 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.87), dimensions={3}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.157 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.156), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.158 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.157), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.191 = bf16[32,4096,128,256]{3,2,1,0} multiply(%dot_general.11, %broadcast_in_dim.158), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %split.10 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.191), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=560 source_end_line=560 source_column=22 source_end_column=73}
  %split.9 = bf16[32,4096,64]{2,1,0} slice(%mul.163), slice={[0:32], [0:4096], [512:576]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=667 source_end_line=667 source_column=35 source_end_column=84}
  %reshape.3 = bf16[32,4096,1,32,2]{4,3,2,1,0} reshape(%split.9), metadata={op_name="dense_layers/self_attention/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=702 source_end_line=702 source_column=24 source_end_column=60}
  %slice.6 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.3), slice={[0:32], [0:4096], [0:1], [0:32], [0:1]}, metadata={op_name="dense_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %squeeze.48 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.6), metadata={op_name="dense_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %convert_element_type.81 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.48), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %slice.7 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.3), slice={[0:32], [0:4096], [0:1], [0:32], [1:2]}, metadata={op_name="dense_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %squeeze.49 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.7), metadata={op_name="dense_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %convert_element_type.80 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.49), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %constant.243 = c64[] constant((0, 1))
  %mul.149 = c64[32,4096,1,32]{3,2,1,0} broadcast(%constant.243), dimensions={}, metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %mul.188 = c64[32,4096,1,32]{3,2,1,0} multiply(%convert_element_type.80, %mul.149), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %add.45 = c64[32,4096,1,32]{3,2,1,0} add(%convert_element_type.81, %mul.188), metadata={op_name="dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %Arg_15.1 = c64[32,4096,1,32]{3,2,1,0} parameter(15)
  %mul.189 = c64[32,4096,1,32]{3,2,1,0} multiply(%add.45, %Arg_15.1), metadata={op_name="dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %real.3 = f32[32,4096,1,32]{3,2,1,0} real(%mul.189), metadata={op_name="dense_layers/self_attention/real" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=30 source_end_column=47}
  %imag.3 = f32[32,4096,1,32]{3,2,1,0} imag(%mul.189), metadata={op_name="dense_layers/self_attention/imag" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=49 source_end_column=66}
  %concatenate.6 = f32[32,4096,1,64]{3,2,1,0} concatenate(%real.3, %imag.3), dimensions={3}, metadata={op_name="dense_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=13 source_end_column=77}
  %convert_element_type.82 = bf16[32,4096,1,64]{3,2,1,0} convert(%concatenate.6), metadata={op_name="dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=721 source_end_line=721 source_column=15 source_end_column=46}
  %broadcast_in_dim.159 = bf16[32,4096,1,64]{3,2,1,0} broadcast(%convert_element_type.82), dimensions={0,1,2,3}, metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %broadcast_in_dim.160 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.159), metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %broadcast_in_dim.161 = bf16[32,4096,128,64]{3,2,1,0} broadcast(%broadcast_in_dim.160), dimensions={0,1,3}, metadata={op_name="dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %concatenate.7 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.10, %broadcast_in_dim.161), dimensions={3}, metadata={op_name="dense_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=563 source_end_line=563 source_column=10 source_end_column=56}
  %sharding_constraint.17 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%concatenate.7), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %split.11 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.191), slice={[0:32], [0:4096], [0:128], [128:256]}, metadata={op_name="dense_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=560 source_end_line=560 source_column=22 source_end_column=73}
  %sharding_constraint.18 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%split.11), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_16.1 = bf16[0]{0} parameter(16)
  %custom_partitioning.3 = (bf16[32,4096,128,128]{3,2,1,0}, f32[32,128,4096]{2,1,0}) custom-call(%sharding_constraint.16, %sharding_constraint.17, %sharding_constraint.18, %Arg_16.1, %Arg_16.1, /*index=5*/%Arg_16.1, %Arg_16.1, %Arg_16.1, %Arg_16.1, %Arg_16.1), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="dense_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}, backend_config="281457329920656"
  %custom_partitioning.5 = f32[32,128,4096]{2,1,0} get-tuple-element(%custom_partitioning.3), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="dense_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}
  %custom_partitioning.4 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.3), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="dense_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}
  %sharding_constraint.19 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.4), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_64.1 = f32[1024]{0} parameter(64)
  %reduce_max.112 = f32[] reduce(%Arg_64.1, %constant.253), dimensions={0}, to_apply=%region_12.24, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.22 = pred[] is-finite(%reduce_max.112), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.22 = pred[] compare(%reduce_max.112, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.132 = f32[] divide(%constant.251, %reduce_max.112), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.133 = f32[] divide(%div.132, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_65.1 = f32[1]{0} parameter(65)
  %div.131 = f32[1]{0} divide(%constant.248, %Arg_65.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.46 = f32[1]{0} call(%gt.22, %div.133, %div.131), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.47 = f32[1]{0} call(%is_finite.22, %jit__where_.46, %div.131), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.134 = f32[1]{0} divide(%constant.248, %jit__where_.47), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.88 = bf16[1]{0} convert(%div.134), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.162 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.88), dimensions={3}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.163 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.162), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.164 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.163), dimensions={0,1,2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.135 = bf16[32,4096,128,128]{3,2,1,0} divide(%sharding_constraint.19, %broadcast_in_dim.164), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_17.1 = bf16[] parameter(17)
  %Arg_18.1 = bf16[] parameter(18)
  %jit_clip_.24 = bf16[32,4096,128,128]{3,2,1,0} call(%div.135, %Arg_17.1, %Arg_18.1), to_apply=%clip_177.25, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.89 = f8e4m3fn[32,4096,128,128]{3,2,1,0} convert(%jit_clip_.24), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_40.1 = bf16[128,128,7168]{2,1,0} parameter(40)
  %Arg_66.1 = f32[1024]{0} parameter(66)
  %reduce_max.113 = f32[] reduce(%Arg_66.1, %constant.253), dimensions={0}, to_apply=%region_13.26, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.23 = pred[] is-finite(%reduce_max.113), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.23 = pred[] compare(%reduce_max.113, %constant.254), direction=GT, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.137 = f32[] divide(%constant.251, %reduce_max.113), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.138 = f32[] divide(%div.137, %constant.252), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_67.1 = f32[1]{0} parameter(67)
  %div.136 = f32[1]{0} divide(%constant.248, %Arg_67.1), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.48 = f32[1]{0} call(%gt.23, %div.138, %div.136), to_apply=%_where_68.7, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.49 = f32[1]{0} call(%is_finite.23, %jit__where_.48, %div.136), to_apply=%_where_71.8, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.139 = f32[1]{0} divide(%constant.248, %jit__where_.49), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.90 = bf16[1]{0} convert(%div.139), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.165 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.90), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.166 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.165), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.167 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.166), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.140 = bf16[128,128,7168]{2,1,0} divide(%Arg_40.1, %broadcast_in_dim.167), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_19.1 = bf16[] parameter(19)
  %Arg_20.1 = bf16[] parameter(20)
  %jit_clip_.25 = bf16[128,128,7168]{2,1,0} call(%div.140, %Arg_19.1, %Arg_20.1), to_apply=%clip_183.27, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.91 = f8e4m3fn[128,128,7168]{2,1,0} convert(%jit_clip_.25), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.12 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.89, %convert_element_type.91), lhs_contracting_dims={2,3}, rhs_contracting_dims={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.192 = f32[1]{0} multiply(%div.134, %div.139), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.92 = bf16[1]{0} convert(%mul.192), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.168 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.92), dimensions={2}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.169 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.168), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.170 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.169), dimensions={0,1}, metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.193 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.12, %broadcast_in_dim.170), metadata={op_name="dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %reduce_precision.3 = bf16[32,4096,7168]{2,1,0} reduce-precision(%mul.193), exponent_bits=8, mantissa_bits=7, metadata={op_name="dense_layers/self_attention/reduce_precision" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=751 source_end_line=751 source_column=10 source_end_column=42}
  %sharding_constraint.20 = bf16[32,4096,7168]{2,1,0} custom-call(%reduce_precision.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %add.46 = bf16[32,4096,7168]{2,1,0} add(%reduce_precision.2, %sharding_constraint.20), metadata={op_name="dense_layers/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=115 source_end_line=115 source_column=24 source_end_column=46}
  %convert_element_type.93 = f32[32,4096,7168]{2,1,0} convert(%add.46), metadata={op_name="dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.7 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.93, %convert_element_type.93), metadata={op_name="dense_layers/post_self_attention_layer_norm/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.31 = f32[32,4096]{1,0} reduce(%square.7, %constant.254), dimensions={2}, to_apply=%region_14.28, metadata={op_name="dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.171 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.31), metadata={op_name="dense_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.141 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.171, %broadcast.84), metadata={op_name="dense_layers/post_self_attention_layer_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.47 = f32[32,4096,1]{2,1,0} add(%div.141, %broadcast.83), metadata={op_name="dense_layers/post_self_attention_layer_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.7 = f32[32,4096,1]{2,1,0} rsqrt(%add.47), metadata={op_name="dense_layers/post_self_attention_layer_norm/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.194 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.7), dimensions={0,1,2}, metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.195 = f32[32,4096]{1,0} reshape(%mul.194), metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.196 = f32[32,4096,7168]{2,1,0} broadcast(%mul.195), dimensions={0,1}, metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.197 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.93, %mul.196), metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.94 = bf16[32,4096,7168]{2,1,0} convert(%mul.197), metadata={op_name="dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_37.1 = bf16[7168]{0} parameter(37)
  %broadcast_in_dim.172 = bf16[1,1,7168]{2,1,0} reshape(%Arg_37.1), metadata={op_name="dense_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.198 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.172), dimensions={0,1,2}, metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.199 = bf16[7168]{0} reshape(%mul.198), metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.200 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.199), dimensions={2}, metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.201 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.94, %mul.200), metadata={op_name="dense_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %sharding_constraint.21 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.201), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_46.1 = f32[1024]{0} parameter(46)
  %reduce_max.114 = f32[] reduce(%Arg_46.1, %constant.253), dimensions={0}, to_apply=%region_15.29, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.24 = pred[] is-finite(%reduce_max.114), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.24 = pred[] compare(%reduce_max.114, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.143 = f32[] divide(%constant.251, %reduce_max.114), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.144 = f32[] divide(%div.143, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_47.1 = f32[1]{0} parameter(47)
  %div.142 = f32[1]{0} divide(%constant.248, %Arg_47.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.50 = f32[1]{0} call(%gt.24, %div.144, %div.142), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.51 = f32[1]{0} call(%is_finite.24, %jit__where_.50, %div.142), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.145 = f32[1]{0} divide(%constant.248, %jit__where_.51), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.95 = bf16[1]{0} convert(%div.145), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.173 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.95), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.174 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.173), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.175 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.174), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.146 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.21, %broadcast_in_dim.175), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_21.1 = bf16[] parameter(21)
  %Arg_22.1 = bf16[] parameter(22)
  %jit_clip_.26 = bf16[32,4096,7168]{2,1,0} call(%div.146, %Arg_21.1, %Arg_22.1), to_apply=%clip_75.9, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.96 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.26), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_34.1 = bf16[7168,18432]{1,0} parameter(34)
  %Arg_48.1 = f32[1024]{0} parameter(48)
  %reduce_max.115 = f32[] reduce(%Arg_48.1, %constant.253), dimensions={0}, to_apply=%region_16.30, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.25 = pred[] is-finite(%reduce_max.115), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.25 = pred[] compare(%reduce_max.115, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.148 = f32[] divide(%constant.251, %reduce_max.115), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.149 = f32[] divide(%div.148, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_49.1 = f32[1]{0} parameter(49)
  %div.147 = f32[1]{0} divide(%constant.248, %Arg_49.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.52 = f32[1]{0} call(%gt.25, %div.149, %div.147), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.53 = f32[1]{0} call(%is_finite.25, %jit__where_.52, %div.147), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.150 = f32[1]{0} divide(%constant.248, %jit__where_.53), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.97 = bf16[1]{0} convert(%div.150), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.176 = bf16[7168,1]{1,0} broadcast(%convert_element_type.97), dimensions={1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.177 = bf16[7168]{0} reshape(%broadcast_in_dim.176), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.178 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.177), dimensions={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.151 = bf16[7168,18432]{1,0} divide(%Arg_34.1, %broadcast_in_dim.178), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_23.1 = bf16[] parameter(23)
  %Arg_24.1 = bf16[] parameter(24)
  %jit_clip_.27 = bf16[7168,18432]{1,0} call(%div.151, %Arg_23.1, %Arg_24.1), to_apply=%clip_193.31, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.98 = f8e4m3fn[7168,18432]{1,0} convert(%jit_clip_.27), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.13 = bf16[32,4096,18432]{2,1,0} dot(%convert_element_type.96, %convert_element_type.98), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.202 = f32[1]{0} multiply(%div.145, %div.150), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.99 = bf16[1]{0} convert(%mul.202), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.179 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.99), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.180 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.179), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.181 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.180), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.203 = bf16[32,4096,18432]{2,1,0} multiply(%dot_general.13, %broadcast_in_dim.181), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %jit_silu_.1 = bf16[32,4096,18432]{2,1,0} call(%mul.203), to_apply=%silu.32, metadata={op_name="dense_layers/mlp/jit(silu)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_50.1 = f32[1024]{0} parameter(50)
  %reduce_max.116 = f32[] reduce(%Arg_50.1, %constant.253), dimensions={0}, to_apply=%region_17.33, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.26 = pred[] is-finite(%reduce_max.116), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.26 = pred[] compare(%reduce_max.116, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.153 = f32[] divide(%constant.251, %reduce_max.116), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.154 = f32[] divide(%div.153, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_51.1 = f32[1]{0} parameter(51)
  %div.152 = f32[1]{0} divide(%constant.248, %Arg_51.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.54 = f32[1]{0} call(%gt.26, %div.154, %div.152), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.55 = f32[1]{0} call(%is_finite.26, %jit__where_.54, %div.152), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.155 = f32[1]{0} divide(%constant.248, %jit__where_.55), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.100 = bf16[1]{0} convert(%div.155), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.182 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.100), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.183 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.182), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.184 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.183), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.156 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.21, %broadcast_in_dim.184), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_25.1 = bf16[] parameter(25)
  %Arg_26.1 = bf16[] parameter(26)
  %jit_clip_.28 = bf16[32,4096,7168]{2,1,0} call(%div.156, %Arg_25.1, %Arg_26.1), to_apply=%clip_75.9, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.101 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.28), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_35.1 = bf16[7168,18432]{1,0} parameter(35)
  %Arg_52.1 = f32[1024]{0} parameter(52)
  %reduce_max.117 = f32[] reduce(%Arg_52.1, %constant.253), dimensions={0}, to_apply=%region_18.34, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.27 = pred[] is-finite(%reduce_max.117), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.27 = pred[] compare(%reduce_max.117, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.158 = f32[] divide(%constant.251, %reduce_max.117), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.159 = f32[] divide(%div.158, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_53.1 = f32[1]{0} parameter(53)
  %div.157 = f32[1]{0} divide(%constant.248, %Arg_53.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.56 = f32[1]{0} call(%gt.27, %div.159, %div.157), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.57 = f32[1]{0} call(%is_finite.27, %jit__where_.56, %div.157), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.160 = f32[1]{0} divide(%constant.248, %jit__where_.57), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.102 = bf16[1]{0} convert(%div.160), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.185 = bf16[7168,1]{1,0} broadcast(%convert_element_type.102), dimensions={1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.186 = bf16[7168]{0} reshape(%broadcast_in_dim.185), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.187 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.186), dimensions={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.161 = bf16[7168,18432]{1,0} divide(%Arg_35.1, %broadcast_in_dim.187), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_27.1 = bf16[] parameter(27)
  %Arg_28.1 = bf16[] parameter(28)
  %jit_clip_.29 = bf16[7168,18432]{1,0} call(%div.161, %Arg_27.1, %Arg_28.1), to_apply=%clip_193.31, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.103 = f8e4m3fn[7168,18432]{1,0} convert(%jit_clip_.29), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.14 = bf16[32,4096,18432]{2,1,0} dot(%convert_element_type.101, %convert_element_type.103), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.204 = f32[1]{0} multiply(%div.155, %div.160), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.104 = bf16[1]{0} convert(%mul.204), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.188 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.104), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.189 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.188), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.190 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.189), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.205 = bf16[32,4096,18432]{2,1,0} multiply(%dot_general.14, %broadcast_in_dim.190), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.206 = bf16[32,4096,18432]{2,1,0} multiply(%jit_silu_.1, %mul.205), metadata={op_name="dense_layers/mlp/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=471 source_end_line=471 source_column=8 source_end_column=51}
  %sharding_constraint.22 = bf16[32,4096,18432]{2,1,0} custom-call(%mul.206), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="dense_layers/mlp/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_54.1 = f32[1024]{0} parameter(54)
  %reduce_max.118 = f32[] reduce(%Arg_54.1, %constant.253), dimensions={0}, to_apply=%region_19.35, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.28 = pred[] is-finite(%reduce_max.118), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.28 = pred[] compare(%reduce_max.118, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.163 = f32[] divide(%constant.251, %reduce_max.118), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.164 = f32[] divide(%div.163, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_55.1 = f32[1]{0} parameter(55)
  %div.162 = f32[1]{0} divide(%constant.248, %Arg_55.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.58 = f32[1]{0} call(%gt.28, %div.164, %div.162), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.59 = f32[1]{0} call(%is_finite.28, %jit__where_.58, %div.162), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.165 = f32[1]{0} divide(%constant.248, %jit__where_.59), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.105 = bf16[1]{0} convert(%div.165), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.191 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.105), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.192 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.191), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.193 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.192), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.166 = bf16[32,4096,18432]{2,1,0} divide(%sharding_constraint.22, %broadcast_in_dim.193), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_29.1 = bf16[] parameter(29)
  %Arg_30.1 = bf16[] parameter(30)
  %jit_clip_.30 = bf16[32,4096,18432]{2,1,0} call(%div.166, %Arg_29.1, %Arg_30.1), to_apply=%clip_208.36, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.106 = f8e4m3fn[32,4096,18432]{2,1,0} convert(%jit_clip_.30), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_36.1 = bf16[18432,7168]{1,0} parameter(36)
  %Arg_56.1 = f32[1024]{0} parameter(56)
  %reduce_max.119 = f32[] reduce(%Arg_56.1, %constant.253), dimensions={0}, to_apply=%region_20.37, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.29 = pred[] is-finite(%reduce_max.119), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.29 = pred[] compare(%reduce_max.119, %constant.254), direction=GT, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.168 = f32[] divide(%constant.251, %reduce_max.119), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.169 = f32[] divide(%div.168, %constant.252), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_57.1 = f32[1]{0} parameter(57)
  %div.167 = f32[1]{0} divide(%constant.248, %Arg_57.1), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.60 = f32[1]{0} call(%gt.29, %div.169, %div.167), to_apply=%_where_68.7, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.61 = f32[1]{0} call(%is_finite.29, %jit__where_.60, %div.167), to_apply=%_where_71.8, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.170 = f32[1]{0} divide(%constant.248, %jit__where_.61), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.107 = bf16[1]{0} convert(%div.170), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.194 = bf16[18432,1]{1,0} broadcast(%convert_element_type.107), dimensions={1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.195 = bf16[18432]{0} reshape(%broadcast_in_dim.194), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.196 = bf16[18432,7168]{1,0} broadcast(%broadcast_in_dim.195), dimensions={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.171 = bf16[18432,7168]{1,0} divide(%Arg_36.1, %broadcast_in_dim.196), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_31.1 = bf16[] parameter(31)
  %Arg_32.1 = bf16[] parameter(32)
  %jit_clip_.31 = bf16[18432,7168]{1,0} call(%div.171, %Arg_31.1, %Arg_32.1), to_apply=%clip_214.38, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.108 = f8e4m3fn[18432,7168]{1,0} convert(%jit_clip_.31), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.15 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.106, %convert_element_type.108), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.207 = f32[1]{0} multiply(%div.165, %div.170), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.109 = bf16[1]{0} convert(%mul.207), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.197 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.109), dimensions={2}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.198 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.197), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.199 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.198), dimensions={0,1}, metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.208 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.15, %broadcast_in_dim.199), metadata={op_name="dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %sharding_constraint.23 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.208), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %add.48 = bf16[32,4096,7168]{2,1,0} add(%sharding_constraint.23, %add.46), metadata={op_name="dense_layers/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=201 source_end_line=201 source_column=19 source_end_column=48}
  %sharding_constraint.24 = bf16[32,4096,7168]{2,1,0} custom-call(%add.48), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="dense_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %device_put.4 = bf16[32,4096,1536]{2,1,0} custom-call(%mul.161), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.5 = bf16[32,4096,576]{2,1,0} custom-call(%mul.163), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.6 = bf16[32,4096,18432]{2,1,0} custom-call(%mul.203), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.7 = bf16[32,4096,18432]{2,1,0} custom-call(%mul.205), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  ROOT %tuple.1 = (bf16[32,4096,7168]{2,1,0}, bf16[32,4096,7168]{2,1,0}, bf16[32,4096,1536]{2,1,0}, bf16[32,4096,576]{2,1,0}, bf16[32,4096,7168]{2,1,0}, /*index=5*/bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}) tuple(%sharding_constraint.24, %reduce_precision.2, %device_put.4, %device_put.5, %reduce_precision.3, /*index=5*/%device_put.6, %device_put.7)
}

%region_1.40 (arg_tuple.1: (s32[], bf16[32,4096,7168], bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], /*index=5*/bf16[1,32,4096,7168], bf16[1,32,4096,18432], bf16[1,32,4096,18432], bf16[1,7168,18432], bf16[1,7168,18432], /*index=10*/bf16[1,18432,7168], bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], /*index=15*/bf16[1,1536], bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1], /*index=40*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/c64[32,4096,1,32], c64[32,4096,1,32])) -> (s32[], bf16[32,4096,7168], bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], /*index=5*/bf16[1,32,4096,7168], bf16[1,32,4096,18432], bf16[1,32,4096,18432], bf16[1,7168,18432], bf16[1,7168,18432], /*index=10*/bf16[1,18432,7168], bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], /*index=15*/bf16[1,1536], bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1], /*index=40*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/c64[32,4096,1,32], c64[32,4096,1,32]) {
  %arg_tuple.1 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, /*index=5*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, /*index=10*/bf16[1,18432,7168]{2,1,0}, bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, /*index=15*/bf16[1,1536]{1,0}, bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=40*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/c64[32,4096,1,32]{3,2,1,0}, c64[32,4096,1,32]{3,2,1,0}) parameter(0)
  %get-tuple-element.52 = s32[] get-tuple-element(%arg_tuple.1), index=0
  %constant.255 = s32[] constant(1)
  %add.50 = s32[] add(%get-tuple-element.52, %constant.255), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.258 = bf16[] constant(448)
  %constant.257 = bf16[] constant(-448)
  %get-tuple-element.102 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=50
  %get-tuple-element.103 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=51
  %constant.256 = bf16[0]{0} constant({})
  %get-tuple-element.53 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.1), index=1
  %get-tuple-element.60 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.1), index=8
  %constant.259 = s32[] constant(0)
  %dynamic_slice.42 = bf16[1,7168,18432]{2,1,0} dynamic-slice(%get-tuple-element.60, %get-tuple-element.52, %constant.259, %constant.259), dynamic_slice_sizes={1,7168,18432}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.50 = bf16[7168,18432]{1,0} reshape(%dynamic_slice.42), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.61 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.1), index=9
  %dynamic_slice.43 = bf16[1,7168,18432]{2,1,0} dynamic-slice(%get-tuple-element.61, %get-tuple-element.52, %constant.259, %constant.259), dynamic_slice_sizes={1,7168,18432}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.51 = bf16[7168,18432]{1,0} reshape(%dynamic_slice.43), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.62 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.1), index=10
  %dynamic_slice.44 = bf16[1,18432,7168]{2,1,0} dynamic-slice(%get-tuple-element.62, %get-tuple-element.52, %constant.259, %constant.259), dynamic_slice_sizes={1,18432,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.52 = bf16[18432,7168]{1,0} reshape(%dynamic_slice.44), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.63 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.1), index=11
  %dynamic_slice.45 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.63, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.53 = bf16[7168]{0} reshape(%dynamic_slice.45), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.64 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.1), index=12
  %dynamic_slice.46 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.64, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.54 = bf16[7168]{0} reshape(%dynamic_slice.46), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.65 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.1), index=13
  %dynamic_slice.47 = bf16[1,512]{1,0} dynamic-slice(%get-tuple-element.65, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,512}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.55 = bf16[512]{0} reshape(%dynamic_slice.47), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.66 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=14
  %dynamic_slice.48 = bf16[1,128,128,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.66, %get-tuple-element.52, %constant.259, %constant.259, %constant.259), dynamic_slice_sizes={1,128,128,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.56 = bf16[128,128,7168]{2,1,0} reshape(%dynamic_slice.48), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.67 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.1), index=15
  %dynamic_slice.49 = bf16[1,1536]{1,0} dynamic-slice(%get-tuple-element.67, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1536}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.57 = bf16[1536]{0} reshape(%dynamic_slice.49), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.68 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.1), index=16
  %dynamic_slice.50 = bf16[1,7168,576]{2,1,0} dynamic-slice(%get-tuple-element.68, %get-tuple-element.52, %constant.259, %constant.259), dynamic_slice_sizes={1,7168,576}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.58 = bf16[7168,576]{1,0} reshape(%dynamic_slice.50), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.69 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=17
  %dynamic_slice.51 = bf16[1,512,128,256]{3,2,1,0} dynamic-slice(%get-tuple-element.69, %get-tuple-element.52, %constant.259, %constant.259, %constant.259), dynamic_slice_sizes={1,512,128,256}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.59 = bf16[512,128,256]{2,1,0} reshape(%dynamic_slice.51), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.70 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.1), index=18
  %dynamic_slice.52 = bf16[1,7168,1536]{2,1,0} dynamic-slice(%get-tuple-element.70, %get-tuple-element.52, %constant.259, %constant.259), dynamic_slice_sizes={1,7168,1536}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.60 = bf16[7168,1536]{1,0} reshape(%dynamic_slice.52), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.71 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=19
  %dynamic_slice.53 = bf16[1,1536,128,192]{3,2,1,0} dynamic-slice(%get-tuple-element.71, %get-tuple-element.52, %constant.259, %constant.259, %constant.259), dynamic_slice_sizes={1,1536,128,192}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.61 = bf16[1536,128,192]{2,1,0} reshape(%dynamic_slice.53), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.72 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=20
  %dynamic_slice.54 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.72, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.62 = f32[1024]{0} reshape(%dynamic_slice.54), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.73 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=21
  %dynamic_slice.55 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.73, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.63 = f32[1]{0} reshape(%dynamic_slice.55), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.74 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=22
  %dynamic_slice.56 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.74, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.64 = f32[1024]{0} reshape(%dynamic_slice.56), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.75 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=23
  %dynamic_slice.57 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.75, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.65 = f32[1]{0} reshape(%dynamic_slice.57), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.76 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=24
  %dynamic_slice.58 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.76, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.66 = f32[1024]{0} reshape(%dynamic_slice.58), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.77 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=25
  %dynamic_slice.59 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.77, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.67 = f32[1]{0} reshape(%dynamic_slice.59), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.78 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=26
  %dynamic_slice.60 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.78, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.68 = f32[1024]{0} reshape(%dynamic_slice.60), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.79 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=27
  %dynamic_slice.61 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.79, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.69 = f32[1]{0} reshape(%dynamic_slice.61), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.80 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=28
  %dynamic_slice.62 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.80, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.70 = f32[1024]{0} reshape(%dynamic_slice.62), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.81 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=29
  %dynamic_slice.63 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.81, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.71 = f32[1]{0} reshape(%dynamic_slice.63), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.82 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=30
  %dynamic_slice.64 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.82, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.72 = f32[1024]{0} reshape(%dynamic_slice.64), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.83 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=31
  %dynamic_slice.65 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.83, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.73 = f32[1]{0} reshape(%dynamic_slice.65), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.84 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=32
  %dynamic_slice.66 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.84, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.74 = f32[1024]{0} reshape(%dynamic_slice.66), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.85 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=33
  %dynamic_slice.67 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.85, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.75 = f32[1]{0} reshape(%dynamic_slice.67), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.86 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=34
  %dynamic_slice.68 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.86, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.76 = f32[1024]{0} reshape(%dynamic_slice.68), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.87 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=35
  %dynamic_slice.69 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.87, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.77 = f32[1024]{0} reshape(%dynamic_slice.69), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.88 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=36
  %dynamic_slice.70 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.88, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.78 = f32[1]{0} reshape(%dynamic_slice.70), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.89 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=37
  %dynamic_slice.71 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.89, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.79 = f32[1]{0} reshape(%dynamic_slice.71), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.90 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=38
  %dynamic_slice.72 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.90, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.80 = f32[1024]{0} reshape(%dynamic_slice.72), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.91 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=39
  %dynamic_slice.73 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.91, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.81 = f32[1]{0} reshape(%dynamic_slice.73), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.92 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=40
  %dynamic_slice.74 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.92, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.82 = f32[1024]{0} reshape(%dynamic_slice.74), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.93 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=41
  %dynamic_slice.75 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.93, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.83 = f32[1]{0} reshape(%dynamic_slice.75), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.94 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=42
  %dynamic_slice.76 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.94, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.84 = f32[1024]{0} reshape(%dynamic_slice.76), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.95 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=43
  %dynamic_slice.77 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.95, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.85 = f32[1]{0} reshape(%dynamic_slice.77), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.96 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=44
  %dynamic_slice.78 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.96, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.86 = f32[1024]{0} reshape(%dynamic_slice.78), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.97 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=45
  %dynamic_slice.79 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.97, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.87 = f32[1]{0} reshape(%dynamic_slice.79), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.98 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=46
  %dynamic_slice.80 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.98, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.88 = f32[1024]{0} reshape(%dynamic_slice.80), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.99 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=47
  %dynamic_slice.81 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.99, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.89 = f32[1]{0} reshape(%dynamic_slice.81), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.100 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.1), index=48
  %dynamic_slice.82 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.100, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.90 = f32[1024]{0} reshape(%dynamic_slice.82), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.101 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.1), index=49
  %dynamic_slice.83 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.101, %get-tuple-element.52, %constant.259), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.91 = f32[1]{0} reshape(%dynamic_slice.83), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.8 = (bf16[32,4096,7168]{2,1,0}, bf16[32,4096,7168]{2,1,0}, bf16[32,4096,1536]{2,1,0}, bf16[32,4096,576]{2,1,0}, bf16[32,4096,7168]{2,1,0}, /*index=5*/bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}) call(%constant.258, %constant.257, %constant.258, %constant.257, %constant.258, /*index=5*/%constant.257, %constant.258, %constant.257, %get-tuple-element.102, %constant.258, /*index=10*/%constant.257, %constant.258, %constant.257, %constant.258, %constant.257, /*index=15*/%get-tuple-element.103, %constant.256, %constant.258, %constant.257, %constant.258, /*index=20*/%constant.257, %constant.258, %constant.257, %constant.258, %constant.257, /*index=25*/%constant.258, %constant.257, %constant.258, %constant.257, %constant.258, /*index=30*/%constant.257, %constant.258, %constant.257, %get-tuple-element.53, %squeeze.50, /*index=35*/%squeeze.51, %squeeze.52, %squeeze.53, %squeeze.54, %squeeze.55, /*index=40*/%squeeze.56, %squeeze.57, %squeeze.58, %squeeze.59, %squeeze.60, /*index=45*/%squeeze.61, %squeeze.62, %squeeze.63, %squeeze.64, %squeeze.65, /*index=50*/%squeeze.66, %squeeze.67, %squeeze.68, %squeeze.69, %squeeze.70, /*index=55*/%squeeze.71, %squeeze.72, %squeeze.73, %squeeze.74, %squeeze.75, /*index=60*/%squeeze.76, %squeeze.77, %squeeze.78, %squeeze.79, %squeeze.80, /*index=65*/%squeeze.81, %squeeze.82, %squeeze.83, %squeeze.84, %squeeze.85, /*index=70*/%squeeze.86, %squeeze.87, %squeeze.88, %squeeze.89, %squeeze.90, /*index=75*/%squeeze.91), to_apply=%closed_call.39, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.9 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.8), index=0, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.54 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=2
  %closed_call.10 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.8), index=1, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.206 = bf16[1,32,4096,7168]{3,2,1,0} reshape(%closed_call.10), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.6 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.54, %broadcast_in_dim.206, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.55 = bf16[1,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=3
  %closed_call.11 = bf16[32,4096,1536]{2,1,0} get-tuple-element(%closed_call.8), index=2, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.207 = bf16[1,32,4096,1536]{3,2,1,0} reshape(%closed_call.11), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.7 = bf16[1,32,4096,1536]{3,2,1,0} dynamic-update-slice(%get-tuple-element.55, %broadcast_in_dim.207, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.56 = bf16[1,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=4
  %closed_call.12 = bf16[32,4096,576]{2,1,0} get-tuple-element(%closed_call.8), index=3, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.208 = bf16[1,32,4096,576]{3,2,1,0} reshape(%closed_call.12), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.8 = bf16[1,32,4096,576]{3,2,1,0} dynamic-update-slice(%get-tuple-element.56, %broadcast_in_dim.208, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.57 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=5
  %closed_call.13 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.8), index=4, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.209 = bf16[1,32,4096,7168]{3,2,1,0} reshape(%closed_call.13), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.9 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.57, %broadcast_in_dim.209, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.58 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=6
  %closed_call.14 = bf16[32,4096,18432]{2,1,0} get-tuple-element(%closed_call.8), index=5, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.210 = bf16[1,32,4096,18432]{3,2,1,0} reshape(%closed_call.14), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.10 = bf16[1,32,4096,18432]{3,2,1,0} dynamic-update-slice(%get-tuple-element.58, %broadcast_in_dim.210, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.59 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.1), index=7
  %closed_call.15 = bf16[32,4096,18432]{2,1,0} get-tuple-element(%closed_call.8), index=6, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.211 = bf16[1,32,4096,18432]{3,2,1,0} reshape(%closed_call.15), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.11 = bf16[1,32,4096,18432]{3,2,1,0} dynamic-update-slice(%get-tuple-element.59, %broadcast_in_dim.211, %get-tuple-element.52, %constant.259, %constant.259, /*index=5*/%constant.259), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  ROOT %tuple.3 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, /*index=5*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, /*index=10*/bf16[1,18432,7168]{2,1,0}, bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, /*index=15*/bf16[1,1536]{1,0}, bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=40*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/c64[32,4096,1,32]{3,2,1,0}, c64[32,4096,1,32]{3,2,1,0}) tuple(%add.50, %closed_call.9, %dynamic_update_slice.6, %dynamic_update_slice.7, %dynamic_update_slice.8, /*index=5*/%dynamic_update_slice.9, %dynamic_update_slice.10, %dynamic_update_slice.11, %get-tuple-element.60, %get-tuple-element.61, /*index=10*/%get-tuple-element.62, %get-tuple-element.63, %get-tuple-element.64, %get-tuple-element.65, %get-tuple-element.66, /*index=15*/%get-tuple-element.67, %get-tuple-element.68, %get-tuple-element.69, %get-tuple-element.70, %get-tuple-element.71, /*index=20*/%get-tuple-element.72, %get-tuple-element.73, %get-tuple-element.74, %get-tuple-element.75, %get-tuple-element.76, /*index=25*/%get-tuple-element.77, %get-tuple-element.78, %get-tuple-element.79, %get-tuple-element.80, %get-tuple-element.81, /*index=30*/%get-tuple-element.82, %get-tuple-element.83, %get-tuple-element.84, %get-tuple-element.85, %get-tuple-element.86, /*index=35*/%get-tuple-element.87, %get-tuple-element.88, %get-tuple-element.89, %get-tuple-element.90, %get-tuple-element.91, /*index=40*/%get-tuple-element.92, %get-tuple-element.93, %get-tuple-element.94, %get-tuple-element.95, %get-tuple-element.96, /*index=45*/%get-tuple-element.97, %get-tuple-element.98, %get-tuple-element.99, %get-tuple-element.100, %get-tuple-element.101, /*index=50*/%get-tuple-element.102, %get-tuple-element.103)
}

%region_21.41 (arg_tuple.3: (s32[], bf16[32,4096,7168], bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], /*index=5*/bf16[1,32,4096,7168], bf16[1,32,4096,18432], bf16[1,32,4096,18432], bf16[1,7168,18432], bf16[1,7168,18432], /*index=10*/bf16[1,18432,7168], bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], /*index=15*/bf16[1,1536], bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1], /*index=40*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/c64[32,4096,1,32], c64[32,4096,1,32])) -> pred[] {
  %arg_tuple.3 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, /*index=5*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, /*index=10*/bf16[1,18432,7168]{2,1,0}, bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, /*index=15*/bf16[1,1536]{1,0}, bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=40*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/c64[32,4096,1,32]{3,2,1,0}, c64[32,4096,1,32]{3,2,1,0}) parameter(0)
  %get-tuple-element.157 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.3), index=1
  %get-tuple-element.158 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=2
  %get-tuple-element.159 = bf16[1,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=3
  %get-tuple-element.160 = bf16[1,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=4
  %get-tuple-element.161 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=5
  %get-tuple-element.162 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=6
  %get-tuple-element.163 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=7
  %get-tuple-element.164 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.3), index=8
  %get-tuple-element.165 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.3), index=9
  %get-tuple-element.166 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.3), index=10
  %get-tuple-element.167 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.3), index=11
  %get-tuple-element.168 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.3), index=12
  %get-tuple-element.169 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.3), index=13
  %get-tuple-element.170 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=14
  %get-tuple-element.171 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.3), index=15
  %get-tuple-element.172 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.3), index=16
  %get-tuple-element.173 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=17
  %get-tuple-element.174 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.3), index=18
  %get-tuple-element.175 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=19
  %get-tuple-element.176 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=20
  %get-tuple-element.177 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=21
  %get-tuple-element.178 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=22
  %get-tuple-element.179 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=23
  %get-tuple-element.180 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=24
  %get-tuple-element.181 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=25
  %get-tuple-element.182 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=26
  %get-tuple-element.183 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=27
  %get-tuple-element.184 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=28
  %get-tuple-element.185 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=29
  %get-tuple-element.186 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=30
  %get-tuple-element.187 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=31
  %get-tuple-element.188 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=32
  %get-tuple-element.189 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=33
  %get-tuple-element.190 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=34
  %get-tuple-element.191 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=35
  %get-tuple-element.192 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=36
  %get-tuple-element.193 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=37
  %get-tuple-element.194 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=38
  %get-tuple-element.195 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=39
  %get-tuple-element.196 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=40
  %get-tuple-element.197 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=41
  %get-tuple-element.198 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=42
  %get-tuple-element.199 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=43
  %get-tuple-element.200 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=44
  %get-tuple-element.201 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=45
  %get-tuple-element.202 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=46
  %get-tuple-element.203 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=47
  %get-tuple-element.204 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.3), index=48
  %get-tuple-element.205 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.3), index=49
  %get-tuple-element.206 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=50
  %get-tuple-element.207 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.3), index=51
  %get-tuple-element.156 = s32[] get-tuple-element(%arg_tuple.3), index=0
  %constant.261 = s32[] constant(1)
  ROOT %lt.6 = pred[] compare(%get-tuple-element.156, %constant.261), direction=LT, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/cond/lt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
}

%_one_hot.42 () -> s32[1,1,1,513] {
  %iota.14 = s32[513]{0} iota(), iota_dimension=0, metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  ROOT %iota.15 = s32[1,1,1,513]{3,2,1,0} reshape(%iota.14), metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
}

%region_23.43 (reduce_sum.35: f32[], reduce_sum.36: f32[]) -> f32[] {
  %reduce_sum.35 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.36 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.37 = f32[] add(%reduce_sum.35, %reduce_sum.36), metadata={op_name="moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_24.44 (reduce_max.123: f32[], reduce_max.124: f32[]) -> f32[] {
  %reduce_max.123 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.124 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.125 = f32[] maximum(%reduce_max.123, %reduce_max.124), metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_25.45 (reduce_max.130: f32[], reduce_max.131: f32[]) -> f32[] {
  %reduce_max.130 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.131 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.132 = f32[] maximum(%reduce_max.130, %reduce_max.131), metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_27.47 (reduce_sum.42: f32[], reduce_sum.43: f32[]) -> f32[] {
  %reduce_sum.42 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.43 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.44 = f32[] add(%reduce_sum.42, %reduce_sum.43), metadata={op_name="moe_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_28.48 (reduce_max.144: f32[], reduce_max.145: f32[]) -> f32[] {
  %reduce_max.144 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.145 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.146 = f32[] maximum(%reduce_max.144, %reduce_max.145), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_29.49 (reduce_max.151: f32[], reduce_max.152: f32[]) -> f32[] {
  %reduce_max.151 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.152 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.153 = f32[] maximum(%reduce_max.151, %reduce_max.152), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_26.46 (reduce_max.137: f32[], reduce_max.138: f32[]) -> f32[] {
  %reduce_max.137 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.138 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.139 = f32[] maximum(%reduce_max.137, %reduce_max.138), metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_30.50 (reduce_sum.49: f32[], reduce_sum.50: f32[]) -> f32[] {
  %reduce_sum.49 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.50 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.51 = f32[] add(%reduce_sum.49, %reduce_sum.50), metadata={op_name="moe_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_31.51 (reduce_max.158: f32[], reduce_max.159: f32[]) -> f32[] {
  %reduce_max.158 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.159 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.160 = f32[] maximum(%reduce_max.158, %reduce_max.159), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_32.52 (reduce_max.165: f32[], reduce_max.166: f32[]) -> f32[] {
  %reduce_max.165 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.166 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.167 = f32[] maximum(%reduce_max.165, %reduce_max.166), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_33.53 (reduce_max.172: f32[], reduce_max.173: f32[]) -> f32[] {
  %reduce_max.172 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.173 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.174 = f32[] maximum(%reduce_max.172, %reduce_max.173), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_34.54 (reduce_max.179: f32[], reduce_max.180: f32[]) -> f32[] {
  %reduce_max.179 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.180 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.181 = f32[] maximum(%reduce_max.179, %reduce_max.180), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_35.55 (reduce_sum.56: f32[], reduce_sum.57: f32[]) -> f32[] {
  %reduce_sum.56 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.57 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.58 = f32[] add(%reduce_sum.56, %reduce_sum.57), metadata={op_name="moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_36.56 (reduce_max.186: f32[], reduce_max.187: f32[]) -> f32[] {
  %reduce_max.186 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.187 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.188 = f32[] maximum(%reduce_max.186, %reduce_max.187), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_37.57 (reduce_max.193: f32[], reduce_max.194: f32[]) -> f32[] {
  %reduce_max.193 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.194 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.195 = f32[] maximum(%reduce_max.193, %reduce_max.194), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_275.58 (Arg_0.40: bf16[7168,64], Arg_1.38: bf16[], Arg_2.36: bf16[]) -> bf16[7168,64] {
  %Arg_1.38 = bf16[] parameter(1)
  %min.54 = bf16[7168,64]{1,0} broadcast(%Arg_1.38), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.36 = bf16[] parameter(2)
  %max.54 = bf16[7168,64]{1,0} broadcast(%Arg_2.36), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.40 = bf16[7168,64]{1,0} parameter(0)
  %max.55 = bf16[7168,64]{1,0} maximum(%max.54, %Arg_0.40), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.55 = bf16[7168,64]{1,0} minimum(%min.54, %max.55), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_38.59 (reduce_window_sum.3: s32[], reduce_window_sum.4: s32[]) -> s32[] {
  %reduce_window_sum.3 = s32[] parameter(0), metadata={op_name="reduce_window_sum"}
  %reduce_window_sum.4 = s32[] parameter(1), metadata={op_name="reduce_window_sum"}
  ROOT %reduce_window_sum.5 = s32[] add(%reduce_window_sum.3, %reduce_window_sum.4), metadata={op_name="reduce_window_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1388 source_end_line=1388 source_column=25 source_end_column=56}
}

%cumsum_285.60 (RoutedMoE_generate_masks_from_expert_format.1: s32[32,4096,64]) -> s32[32,4096,64] {
  %RoutedMoE_generate_masks_from_expert_format.1 = s32[32,4096,64]{2,1,0} parameter(0), metadata={op_name="RoutedMoE.generate_masks_from_expert_format"}
  %constant.282 = s32[] constant(0)
  ROOT %reduce_window_sum.7 = s32[32,4096,64]{2,1,0} reduce-window(%RoutedMoE_generate_masks_from_expert_format.1, %constant.282), window={size=1x4096x1 pad=0_0x4095_0x0_0}, to_apply=%region_38.59, metadata={op_name="reduce_window_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1388 source_end_line=1388 source_column=25 source_end_column=56}
}

%cumsum.61 (Arg_0.42: s32[32,4096,64]) -> s32[32,4096,64] {
  %Arg_0.42 = s32[32,4096,64]{2,1,0} parameter(0)
  ROOT %RoutedMoE_generate_masks_from_expert_format.3 = s32[32,4096,64]{2,1,0} call(%Arg_0.42), to_apply=%cumsum_285.60, metadata={op_name="RoutedMoE.generate_masks_from_expert_format" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1388 source_end_line=1388 source_column=25 source_end_column=56}
}

%_one_hot_289.62 (Arg_0.44: s32[32,4096,64], Arg_1.40: s32[1,1,1,513]) -> s32[32,4096,64,513] {
  %Arg_0.44 = s32[32,4096,64]{2,1,0} parameter(0)
  %broadcast_in_dim.281 = s32[32,4096,64,1]{3,2,1,0} reshape(%Arg_0.44), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.7 = s32[32,4096,64,1]{3,2,1,0} broadcast(%broadcast_in_dim.281), dimensions={0,1,2,3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.8 = s32[32,4096,64]{2,1,0} reshape(%eq.7), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.9 = s32[32,4096,64,513]{3,2,1,0} broadcast(%eq.8), dimensions={0,1,2}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %Arg_1.40 = s32[1,1,1,513]{3,2,1,0} parameter(1)
  %eq.10 = s32[1,1,1,513]{3,2,1,0} broadcast(%Arg_1.40), dimensions={0,1,2,3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.11 = s32[513]{0} reshape(%eq.10), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.12 = s32[32,4096,64,513]{3,2,1,0} broadcast(%eq.11), dimensions={3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.13 = pred[32,4096,64,513]{3,2,1,0} compare(%eq.9, %eq.12), direction=EQ, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  ROOT %convert_element_type.159 = s32[32,4096,64,513]{3,2,1,0} convert(%eq.13), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
}

%region_46.76 (reduce_max.249: f32[], reduce_max.250: f32[]) -> f32[] {
  %reduce_max.249 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.250 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.251 = f32[] maximum(%reduce_max.249, %reduce_max.250), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%clip_302.64 (Arg_0.46: bf16[32,4096,64,512], Arg_1.42: bf16[], Arg_2.38: bf16[]) -> bf16[32,4096,64,512] {
  %Arg_1.42 = bf16[] parameter(1)
  %min.58 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%Arg_1.42), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_2.38 = bf16[] parameter(2)
  %max.58 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%Arg_2.38), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.46 = bf16[32,4096,64,512]{3,2,1,0} parameter(0)
  %max.59 = bf16[32,4096,64,512]{3,2,1,0} maximum(%max.58, %Arg_0.46), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.59 = bf16[32,4096,64,512]{3,2,1,0} minimum(%min.58, %max.59), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_39.63 (reduce_max.200: f32[], reduce_max.201: f32[]) -> f32[] {
  %reduce_max.200 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.201 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.202 = f32[] maximum(%reduce_max.200, %reduce_max.201), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_40.65 (reduce_max.207: f32[], reduce_max.208: f32[]) -> f32[] {
  %reduce_max.207 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.208 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.209 = f32[] maximum(%reduce_max.207, %reduce_max.208), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_41.66 (reduce_max.214: f32[], reduce_max.215: f32[]) -> f32[] {
  %reduce_max.214 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.215 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.216 = f32[] maximum(%reduce_max.214, %reduce_max.215), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%clip_315.67 (Arg_0.48: bf16[64,32,512,7168], Arg_1.44: bf16[], Arg_2.40: bf16[]) -> bf16[64,32,512,7168] {
  %Arg_1.44 = bf16[] parameter(1)
  %min.62 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_1.44), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_2.40 = bf16[] parameter(2)
  %max.62 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_2.40), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.48 = bf16[64,32,512,7168]{3,2,1,0} parameter(0)
  %max.63 = bf16[64,32,512,7168]{3,2,1,0} maximum(%max.62, %Arg_0.48), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.63 = bf16[64,32,512,7168]{3,2,1,0} minimum(%min.62, %max.63), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_42.68 (reduce_max.221: f32[], reduce_max.222: f32[]) -> f32[] {
  %reduce_max.221 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.222 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.223 = f32[] maximum(%reduce_max.221, %reduce_max.222), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%clip_321.69 (Arg_0.50: bf16[64,7168,2048], Arg_1.46: bf16[], Arg_2.42: bf16[]) -> bf16[64,7168,2048] {
  %Arg_1.46 = bf16[] parameter(1)
  %min.66 = bf16[64,7168,2048]{2,1,0} broadcast(%Arg_1.46), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_2.42 = bf16[] parameter(2)
  %max.66 = bf16[64,7168,2048]{2,1,0} broadcast(%Arg_2.42), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.50 = bf16[64,7168,2048]{2,1,0} parameter(0)
  %max.67 = bf16[64,7168,2048]{2,1,0} maximum(%max.66, %Arg_0.50), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.67 = bf16[64,7168,2048]{2,1,0} minimum(%min.66, %max.67), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%silu_332.71 (Arg_0.52: bf16[64,32,512,2048]) -> bf16[64,32,512,2048] {
  %Arg_0.52 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %constant.284 = bf16[] constant(1)
  %broadcast.88 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%constant.284), dimensions={}
  %neg.3 = bf16[64,32,512,2048]{3,2,1,0} negate(%Arg_0.52), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %exp.79 = bf16[64,32,512,2048]{3,2,1,0} exponential(%neg.3), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %add.61 = bf16[64,32,512,2048]{3,2,1,0} add(%exp.79, %broadcast.88), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %div.267 = bf16[64,32,512,2048]{3,2,1,0} divide(%broadcast.88, %add.61), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  ROOT %mul.301 = bf16[64,32,512,2048]{3,2,1,0} multiply(%Arg_0.52, %div.267), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
}

%region_43.70 (reduce_max.228: f32[], reduce_max.229: f32[]) -> f32[] {
  %reduce_max.228 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.229 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.230 = f32[] maximum(%reduce_max.228, %reduce_max.229), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_44.72 (reduce_max.235: f32[], reduce_max.236: f32[]) -> f32[] {
  %reduce_max.235 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.236 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.237 = f32[] maximum(%reduce_max.235, %reduce_max.236), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%clip_340.73 (Arg_0.54: bf16[64,32,512,2048], Arg_1.48: bf16[], Arg_2.44: bf16[]) -> bf16[64,32,512,2048] {
  %Arg_1.48 = bf16[] parameter(1)
  %min.70 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_1.48), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_2.44 = bf16[] parameter(2)
  %max.70 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_2.44), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.54 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %max.71 = bf16[64,32,512,2048]{3,2,1,0} maximum(%max.70, %Arg_0.54), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.71 = bf16[64,32,512,2048]{3,2,1,0} minimum(%min.70, %max.71), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_45.74 (reduce_max.242: f32[], reduce_max.243: f32[]) -> f32[] {
  %reduce_max.242 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.243 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.244 = f32[] maximum(%reduce_max.242, %reduce_max.243), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%clip_346.75 (Arg_0.56: bf16[64,2048,7168], Arg_1.50: bf16[], Arg_2.46: bf16[]) -> bf16[64,2048,7168] {
  %Arg_1.50 = bf16[] parameter(1)
  %min.74 = bf16[64,2048,7168]{2,1,0} broadcast(%Arg_1.50), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_2.46 = bf16[] parameter(2)
  %max.74 = bf16[64,2048,7168]{2,1,0} broadcast(%Arg_2.46), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.56 = bf16[64,2048,7168]{2,1,0} parameter(0)
  %max.75 = bf16[64,2048,7168]{2,1,0} maximum(%max.74, %Arg_0.56), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.75 = bf16[64,2048,7168]{2,1,0} minimum(%min.74, %max.75), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_47.77 (reduce_max.256: f32[], reduce_max.257: f32[]) -> f32[] {
  %reduce_max.256 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.257 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.258 = f32[] maximum(%reduce_max.256, %reduce_max.257), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_48.78 (reduce_max.263: f32[], reduce_max.264: f32[]) -> f32[] {
  %reduce_max.263 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.264 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.265 = f32[] maximum(%reduce_max.263, %reduce_max.264), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_49.79 (reduce_max.270: f32[], reduce_max.271: f32[]) -> f32[] {
  %reduce_max.270 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.271 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.272 = f32[] maximum(%reduce_max.270, %reduce_max.271), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_357.80 (Arg_0.58: bf16[7168,2048], Arg_1.52: bf16[], Arg_2.48: bf16[]) -> bf16[7168,2048] {
  %Arg_1.52 = bf16[] parameter(1)
  %min.78 = bf16[7168,2048]{1,0} broadcast(%Arg_1.52), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.48 = bf16[] parameter(2)
  %max.78 = bf16[7168,2048]{1,0} broadcast(%Arg_2.48), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.58 = bf16[7168,2048]{1,0} parameter(0)
  %max.79 = bf16[7168,2048]{1,0} maximum(%max.78, %Arg_0.58), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.79 = bf16[7168,2048]{1,0} minimum(%min.78, %max.79), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%silu_366.81 (Arg_0.60: bf16[32,4096,2048]) -> bf16[32,4096,2048] {
  %Arg_0.60 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %constant.286 = bf16[] constant(1)
  %broadcast.90 = bf16[32,4096,2048]{2,1,0} broadcast(%constant.286), dimensions={}
  %neg.5 = bf16[32,4096,2048]{2,1,0} negate(%Arg_0.60), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %exp.81 = bf16[32,4096,2048]{2,1,0} exponential(%neg.5), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %add.63 = bf16[32,4096,2048]{2,1,0} add(%exp.81, %broadcast.90), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %div.299 = bf16[32,4096,2048]{2,1,0} divide(%broadcast.90, %add.63), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %mul.310 = bf16[32,4096,2048]{2,1,0} multiply(%Arg_0.60, %div.299), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
}

%region_50.82 (reduce_max.277: f32[], reduce_max.278: f32[]) -> f32[] {
  %reduce_max.277 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.278 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.279 = f32[] maximum(%reduce_max.277, %reduce_max.278), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_51.83 (reduce_max.284: f32[], reduce_max.285: f32[]) -> f32[] {
  %reduce_max.284 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.285 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.286 = f32[] maximum(%reduce_max.284, %reduce_max.285), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_52.84 (reduce_max.291: f32[], reduce_max.292: f32[]) -> f32[] {
  %reduce_max.291 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.292 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.293 = f32[] maximum(%reduce_max.291, %reduce_max.292), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%clip_375.85 (Arg_0.62: bf16[32,4096,2048], Arg_1.54: bf16[], Arg_2.50: bf16[]) -> bf16[32,4096,2048] {
  %Arg_1.54 = bf16[] parameter(1)
  %min.82 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_1.54), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_2.50 = bf16[] parameter(2)
  %max.82 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_2.50), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.62 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %max.83 = bf16[32,4096,2048]{2,1,0} maximum(%max.82, %Arg_0.62), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.83 = bf16[32,4096,2048]{2,1,0} minimum(%min.82, %max.83), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_53.86 (reduce_max.298: f32[], reduce_max.299: f32[]) -> f32[] {
  %reduce_max.298 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.299 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.300 = f32[] maximum(%reduce_max.298, %reduce_max.299), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_381.87 (Arg_0.64: bf16[2048,7168], Arg_1.56: bf16[], Arg_2.52: bf16[]) -> bf16[2048,7168] {
  %Arg_1.56 = bf16[] parameter(1)
  %min.86 = bf16[2048,7168]{1,0} broadcast(%Arg_1.56), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_2.52 = bf16[] parameter(2)
  %max.86 = bf16[2048,7168]{1,0} broadcast(%Arg_2.52), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.64 = bf16[2048,7168]{1,0} parameter(0)
  %max.87 = bf16[2048,7168]{1,0} maximum(%max.86, %Arg_0.64), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.87 = bf16[2048,7168]{1,0} minimum(%min.86, %max.87), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%closed_call_272.88 (Arg_0.65: bf16[], Arg_1.57: bf16[], Arg_2.53: bf16[], Arg_3.3: bf16[], Arg_4.3: bf16[], Arg_5.3: bf16[], Arg_6.3: bf16[], Arg_7.3: bf16[], Arg_8.3: c64[32,4096,1,32], Arg_9.3: bf16[], Arg_10.3: bf16[], Arg_11.3: bf16[], Arg_12.3: bf16[], Arg_13.3: bf16[], Arg_14.3: bf16[], Arg_15.3: c64[32,4096,1,32], Arg_16.3: bf16[0], Arg_17.3: bf16[], Arg_18.3: bf16[], Arg_19.3: bf16[], Arg_20.3: bf16[], Arg_21.3: bf16[], Arg_22.3: bf16[], Arg_23.3: bf16[], Arg_24.3: bf16[], Arg_25.3: s32[1,1,1,513], Arg_26.3: bf16[], Arg_27.3: bf16[], Arg_28.3: bf16[], Arg_29.3: bf16[], Arg_30.3: bf16[], Arg_31.3: bf16[], Arg_32.3: bf16[], Arg_33.3: bf16[], Arg_34.3: bf16[], Arg_35.3: bf16[], Arg_36.3: bf16[], Arg_37.3: bf16[], Arg_38.3: bf16[], Arg_39.3: bf16[], Arg_40.3: bf16[], Arg_41.3: bf16[], Arg_42.3: bf16[], Arg_43.3: bf16[], Arg_44.3: bf16[], Arg_45.3: bf16[], Arg_46.3: bf16[], Arg_47.3: bf16[], Arg_48.3: bf16[], Arg_49.3: bf16[], Arg_50.3: bf16[], Arg_51.3: bf16[], Arg_52.3: bf16[], Arg_53.3: bf16[], Arg_54.3: bf16[], Arg_55.3: bf16[], Arg_56.3: bf16[32,4096,7168], Arg_57.3: bf16[7168,64], Arg_58.3: bf16[64], Arg_59.3: bf16[64,7168,2048], Arg_60.3: bf16[64,7168,2048], Arg_61.3: bf16[64,2048,7168], Arg_62.3: bf16[7168,2048], Arg_63.3: bf16[7168,2048], Arg_64.3: bf16[2048,7168], Arg_65.3: bf16[7168], Arg_66.3: bf16[7168], Arg_67.3: bf16[512], Arg_68.3: bf16[128,128,7168], Arg_69.3: bf16[1536], Arg_70.3: bf16[7168,576], Arg_71.3: bf16[512,128,256], Arg_72.3: bf16[7168,1536], Arg_73.3: bf16[1536,128,192], Arg_74.3: f32[1024], Arg_75.3: f32[1], Arg_76.1: f32[1024], Arg_77.1: f32[1], Arg_78.1: f32[1024], Arg_79.1: f32[1], Arg_80.1: f32[1024], Arg_81.1: f32[1], Arg_82.1: f32[1024], Arg_83.1: f32[1], Arg_84.1: f32[1024], Arg_85.1: f32[1024], Arg_86.1: f32[1], Arg_87.1: f32[1], Arg_88.1: f32[1024], Arg_89.1: f32[1], Arg_90.1: f32[1024], Arg_91.1: f32[1], Arg_92.1: f32[1024], Arg_93.1: f32[1], Arg_94.1: f32[1024], Arg_95.1: f32[1], Arg_96.1: f32[1024], Arg_97.1: f32[1], Arg_98.1: f32[1024], Arg_99.1: f32[1], Arg_100.1: f32[1024], Arg_101.1: f32[1], Arg_102.1: f32[1024], Arg_103.1: f32[1], Arg_104.1: f32[1024], Arg_105.1: f32[1], Arg_106.1: f32[1024], Arg_107.1: f32[1], Arg_108.1: f32[1024], Arg_109.1: f32[1], Arg_110.1: f32[1024], Arg_111.1: f32[1024], Arg_112.1: f32[1], Arg_113.1: f32[1], Arg_114.1: f32[1024], Arg_115.1: f32[1], Arg_116.1: f32[1024], Arg_117.1: f32[1], Arg_118.1: f32[1024], Arg_119.1: f32[1], Arg_120.1: f32[1024], Arg_121.1: f32[1], Arg_122.1: f32[1024], Arg_123.1: f32[1], Arg_124.1: f32[1024], Arg_125.1: f32[1]) -> (bf16[32,4096,7168], bf16[32,4096,7168], bf16[32,4096,1536], bf16[32,4096,576], bf16[32,4096,7168], /*index=5*/bf16[64,32,512,2048], bf16[64,32,512,2048], bf16[32,4096,2048], bf16[32,4096,2048]) {
  %Arg_56.3 = bf16[32,4096,7168]{2,1,0} parameter(56)
  %sharding_constraint.47 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_56.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %reduce_precision.6 = bf16[32,4096,7168]{2,1,0} reduce-precision(%sharding_constraint.47), exponent_bits=8, mantissa_bits=7, metadata={op_name="moe_layers/reduce_precision" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=239 source_end_line=239 source_column=13 source_end_column=59}
  %convert_element_type.202 = f32[32,4096,7168]{2,1,0} convert(%reduce_precision.6), metadata={op_name="moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.12 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.202, %convert_element_type.202), metadata={op_name="moe_layers/pre_self_attention_layer_norm/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %constant.300 = f32[] constant(0)
  %reduce_sum.60 = f32[32,4096]{1,0} reduce(%square.12, %constant.300), dimensions={2}, to_apply=%region_23.43, metadata={op_name="moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.352 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.60), metadata={op_name="moe_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.296 = f32[] constant(7168)
  %broadcast.92 = f32[32,4096,1]{2,1,0} broadcast(%constant.296), dimensions={}
  %div.322 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.352, %broadcast.92), metadata={op_name="moe_layers/pre_self_attention_layer_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.295 = f32[] constant(1e-06)
  %broadcast.91 = f32[32,4096,1]{2,1,0} broadcast(%constant.295), dimensions={}
  %add.66 = f32[32,4096,1]{2,1,0} add(%div.322, %broadcast.91), metadata={op_name="moe_layers/pre_self_attention_layer_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.12 = f32[32,4096,1]{2,1,0} rsqrt(%add.66), metadata={op_name="moe_layers/pre_self_attention_layer_norm/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.319 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.12), dimensions={0,1,2}, metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.320 = f32[32,4096]{1,0} reshape(%mul.319), metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.321 = f32[32,4096,7168]{2,1,0} broadcast(%mul.320), dimensions={0,1}, metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.322 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.202, %mul.321), metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.203 = bf16[32,4096,7168]{2,1,0} convert(%mul.322), metadata={op_name="moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_66.3 = bf16[7168]{0} parameter(66)
  %broadcast_in_dim.353 = bf16[1,1,7168]{2,1,0} reshape(%Arg_66.3), metadata={op_name="moe_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.323 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.353), dimensions={0,1,2}, metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.324 = bf16[7168]{0} reshape(%mul.323), metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.325 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.324), dimensions={2}, metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.326 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.203, %mul.325), metadata={op_name="moe_layers/pre_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %sharding_constraint.48 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.326), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %sharding_constraint.49 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.48), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %constant.294 = f32[1]{0} constant({1})
  %Arg_108.1 = f32[1024]{0} parameter(108)
  %constant.299 = f32[] constant(-inf)
  %reduce_max.302 = f32[] reduce(%Arg_108.1, %constant.299), dimensions={0}, to_apply=%region_24.44, metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %is_finite.56 = pred[] is-finite(%reduce_max.302), metadata={op_name="moe_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %gt.56 = pred[] compare(%reduce_max.302, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %constant.297 = f32[] constant(448)
  %div.324 = f32[] divide(%constant.297, %reduce_max.302), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %constant.298 = f32[] constant(1)
  %div.325 = f32[] divide(%div.324, %constant.298), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_109.1 = f32[1]{0} parameter(109)
  %div.323 = f32[1]{0} divide(%constant.294, %Arg_109.1), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.114 = f32[1]{0} call(%gt.56, %div.325, %div.323), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.115 = f32[1]{0} call(%is_finite.56, %jit__where_.114, %div.323), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.326 = f32[1]{0} divide(%constant.294, %jit__where_.115), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.204 = bf16[1]{0} convert(%div.326), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.354 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.204), dimensions={2}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.355 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.354), metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.356 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.355), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.327 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.49, %broadcast_in_dim.356), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.65 = bf16[] parameter(0)
  %Arg_1.57 = bf16[] parameter(1)
  %jit_clip_.60 = bf16[32,4096,7168]{2,1,0} call(%div.327, %Arg_0.65, %Arg_1.57), to_apply=%clip_75.9, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.205 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.60), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_72.3 = bf16[7168,1536]{1,0} parameter(72)
  %Arg_110.1 = f32[1024]{0} parameter(110)
  %reduce_max.303 = f32[] reduce(%Arg_110.1, %constant.299), dimensions={0}, to_apply=%region_25.45, metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.57 = pred[] is-finite(%reduce_max.303), metadata={op_name="moe_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.57 = pred[] compare(%reduce_max.303, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.329 = f32[] divide(%constant.297, %reduce_max.303), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.330 = f32[] divide(%div.329, %constant.298), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_112.1 = f32[1]{0} parameter(112)
  %div.328 = f32[1]{0} divide(%constant.294, %Arg_112.1), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.116 = f32[1]{0} call(%gt.57, %div.330, %div.328), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.117 = f32[1]{0} call(%is_finite.57, %jit__where_.116, %div.328), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.331 = f32[1]{0} divide(%constant.294, %jit__where_.117), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.206 = bf16[1]{0} convert(%div.331), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.357 = bf16[7168,1]{1,0} broadcast(%convert_element_type.206), dimensions={1}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.358 = bf16[7168]{0} reshape(%broadcast_in_dim.357), metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.359 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.358), dimensions={0}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.332 = bf16[7168,1536]{1,0} divide(%Arg_72.3, %broadcast_in_dim.359), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_2.53 = bf16[] parameter(2)
  %Arg_3.3 = bf16[] parameter(3)
  %jit_clip_.61 = bf16[7168,1536]{1,0} call(%div.332, %Arg_2.53, %Arg_3.3), to_apply=%clip_81.11, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.207 = f8e4m3fn[7168,1536]{1,0} convert(%jit_clip_.61), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.30 = bf16[32,4096,1536]{2,1,0} dot(%convert_element_type.205, %convert_element_type.207), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.327 = f32[1]{0} multiply(%div.326, %div.331), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.208 = bf16[1]{0} convert(%mul.327), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.360 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.208), dimensions={2}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.361 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.360), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.362 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.361), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.328 = bf16[32,4096,1536]{2,1,0} multiply(%dot_general.30, %broadcast_in_dim.362), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.212 = f32[32,4096,1536]{2,1,0} convert(%mul.328), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.13 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.212, %convert_element_type.212), metadata={op_name="moe_layers/self_attention/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.61 = f32[32,4096]{1,0} reduce(%square.13, %constant.300), dimensions={2}, to_apply=%region_27.47, metadata={op_name="moe_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.369 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.61), metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.293 = f32[] constant(1536)
  %div.321 = f32[32,4096,1]{2,1,0} broadcast(%constant.293), dimensions={}, metadata={op_name="moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.338 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.369, %div.321), metadata={op_name="moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.67 = f32[32,4096,1]{2,1,0} add(%div.338, %broadcast.91), metadata={op_name="moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.13 = f32[32,4096,1]{2,1,0} rsqrt(%add.67), metadata={op_name="moe_layers/self_attention/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.331 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.13), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.332 = f32[32,4096]{1,0} reshape(%mul.331), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.333 = f32[32,4096,1536]{2,1,0} broadcast(%mul.332), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.334 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.212, %mul.333), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.213 = bf16[32,4096,1536]{2,1,0} convert(%mul.334), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_69.3 = bf16[1536]{0} parameter(69)
  %broadcast_in_dim.370 = bf16[1,1,1536]{2,1,0} reshape(%Arg_69.3), metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.335 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.370), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.336 = bf16[1536]{0} reshape(%mul.335), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.337 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.336), dimensions={2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.338 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.213, %mul.337), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %Arg_122.1 = f32[1024]{0} parameter(122)
  %reduce_max.305 = f32[] reduce(%Arg_122.1, %constant.299), dimensions={0}, to_apply=%region_28.48, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.59 = pred[] is-finite(%reduce_max.305), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.59 = pred[] compare(%reduce_max.305, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.340 = f32[] divide(%constant.297, %reduce_max.305), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.341 = f32[] divide(%div.340, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_123.1 = f32[1]{0} parameter(123)
  %div.339 = f32[1]{0} divide(%constant.294, %Arg_123.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.120 = f32[1]{0} call(%gt.59, %div.341, %div.339), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.121 = f32[1]{0} call(%is_finite.59, %jit__where_.120, %div.339), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.342 = f32[1]{0} divide(%constant.294, %jit__where_.121), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.214 = bf16[1]{0} convert(%div.342), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.371 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.214), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.372 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.371), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.373 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.372), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.343 = bf16[32,4096,1536]{2,1,0} divide(%mul.338, %broadcast_in_dim.373), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_4.3 = bf16[] parameter(4)
  %Arg_5.3 = bf16[] parameter(5)
  %jit_clip_.63 = bf16[32,4096,1536]{2,1,0} call(%div.343, %Arg_4.3, %Arg_5.3), to_apply=%clip_106.16, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.215 = f8e4m3fn[32,4096,1536]{2,1,0} convert(%jit_clip_.63), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_73.3 = bf16[1536,128,192]{2,1,0} parameter(73)
  %Arg_124.1 = f32[1024]{0} parameter(124)
  %reduce_max.306 = f32[] reduce(%Arg_124.1, %constant.299), dimensions={0}, to_apply=%region_29.49, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.60 = pred[] is-finite(%reduce_max.306), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.60 = pred[] compare(%reduce_max.306, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.345 = f32[] divide(%constant.297, %reduce_max.306), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.346 = f32[] divide(%div.345, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_125.1 = f32[1]{0} parameter(125)
  %div.344 = f32[1]{0} divide(%constant.294, %Arg_125.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.122 = f32[1]{0} call(%gt.60, %div.346, %div.344), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.123 = f32[1]{0} call(%is_finite.60, %jit__where_.122, %div.344), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.347 = f32[1]{0} divide(%constant.294, %jit__where_.123), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.216 = bf16[1]{0} convert(%div.347), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.374 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.216), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.375 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.374), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.376 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.375), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.348 = bf16[1536,128,192]{2,1,0} divide(%Arg_73.3, %broadcast_in_dim.376), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_6.3 = bf16[] parameter(6)
  %Arg_7.3 = bf16[] parameter(7)
  %jit_clip_.64 = bf16[1536,128,192]{2,1,0} call(%div.348, %Arg_6.3, %Arg_7.3), to_apply=%clip_112.18, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.217 = f8e4m3fn[1536,128,192]{2,1,0} convert(%jit_clip_.64), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.32 = bf16[32,4096,128,192]{3,2,1,0} dot(%convert_element_type.215, %convert_element_type.217), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.339 = f32[1]{0} multiply(%div.342, %div.347), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.218 = bf16[1]{0} convert(%mul.339), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.377 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.218), dimensions={3}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.378 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.377), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.379 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.378), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.340 = bf16[32,4096,128,192]{3,2,1,0} multiply(%dot_general.32, %broadcast_in_dim.379), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %split.18 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.340), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=541 source_end_line=541 source_column=19 source_end_column=65}
  %split.19 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.340), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=541 source_end_line=541 source_column=19 source_end_column=65}
  %reshape.6 = bf16[32,4096,128,32,2]{4,3,2,1,0} reshape(%split.19), metadata={op_name="moe_layers/self_attention/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=702 source_end_line=702 source_column=24 source_end_column=60}
  %slice.13 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.6), slice={[0:32], [0:4096], [0:128], [0:32], [0:1]}, metadata={op_name="moe_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %squeeze.165 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.13), metadata={op_name="moe_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %convert_element_type.220 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.165), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %slice.14 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.6), slice={[0:32], [0:4096], [0:128], [0:32], [1:2]}, metadata={op_name="moe_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %squeeze.166 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.14), metadata={op_name="moe_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %convert_element_type.219 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.166), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %constant.292 = c64[] constant((0, 1))
  %mul.318 = c64[32,4096,128,32]{3,2,1,0} broadcast(%constant.292), dimensions={}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %mul.341 = c64[32,4096,128,32]{3,2,1,0} multiply(%convert_element_type.219, %mul.318), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %add.68 = c64[32,4096,128,32]{3,2,1,0} add(%convert_element_type.220, %mul.341), metadata={op_name="moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %Arg_8.3 = c64[32,4096,1,32]{3,2,1,0} parameter(8)
  %mul.342 = c64[32,4096,1,32]{3,2,1,0} broadcast(%Arg_8.3), dimensions={0,1,2,3}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.343 = c64[32,4096,32]{2,1,0} reshape(%mul.342), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.344 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.343), dimensions={0,1,3}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %mul.345 = c64[32,4096,128,32]{3,2,1,0} multiply(%add.68, %mul.344), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %real.6 = f32[32,4096,128,32]{3,2,1,0} real(%mul.345), metadata={op_name="moe_layers/self_attention/real" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=30 source_end_column=47}
  %imag.6 = f32[32,4096,128,32]{3,2,1,0} imag(%mul.345), metadata={op_name="moe_layers/self_attention/imag" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=49 source_end_column=66}
  %concatenate.12 = f32[32,4096,128,64]{3,2,1,0} concatenate(%real.6, %imag.6), dimensions={3}, metadata={op_name="moe_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=13 source_end_column=77}
  %convert_element_type.221 = bf16[32,4096,128,64]{3,2,1,0} convert(%concatenate.12), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=721 source_end_line=721 source_column=15 source_end_column=46}
  %concatenate.13 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.18, %convert_element_type.221), dimensions={3}, metadata={op_name="moe_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %constant.291 = bf16[] constant(0.1348)
  %mul.317 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%constant.291), dimensions={}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %mul.346 = bf16[32,4096,128,192]{3,2,1,0} multiply(%concatenate.13, %mul.317), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=545 source_end_line=545 source_column=12 source_end_column=73}
  %sharding_constraint.50 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%mul.346), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_70.3 = bf16[7168,576]{1,0} parameter(70)
  %Arg_111.1 = f32[1024]{0} parameter(111)
  %reduce_max.304 = f32[] reduce(%Arg_111.1, %constant.299), dimensions={0}, to_apply=%region_26.46, metadata={op_name="moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.58 = pred[] is-finite(%reduce_max.304), metadata={op_name="moe_layers/self_attention/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.58 = pred[] compare(%reduce_max.304, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.334 = f32[] divide(%constant.297, %reduce_max.304), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.335 = f32[] divide(%div.334, %constant.298), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_113.1 = f32[1]{0} parameter(113)
  %div.333 = f32[1]{0} divide(%constant.294, %Arg_113.1), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.118 = f32[1]{0} call(%gt.58, %div.335, %div.333), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.119 = f32[1]{0} call(%is_finite.58, %jit__where_.118, %div.333), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.336 = f32[1]{0} divide(%constant.294, %jit__where_.119), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.209 = bf16[1]{0} convert(%div.336), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.363 = bf16[7168,1]{1,0} broadcast(%convert_element_type.209), dimensions={1}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.364 = bf16[7168]{0} reshape(%broadcast_in_dim.363), metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.365 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.364), dimensions={0}, metadata={op_name="moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.337 = bf16[7168,576]{1,0} divide(%Arg_70.3, %broadcast_in_dim.365), metadata={op_name="moe_layers/self_attention/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_9.3 = bf16[] parameter(9)
  %Arg_10.3 = bf16[] parameter(10)
  %jit_clip_.62 = bf16[7168,576]{1,0} call(%div.337, %Arg_9.3, %Arg_10.3), to_apply=%clip_90.13, metadata={op_name="moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.210 = f8e4m3fn[7168,576]{1,0} convert(%jit_clip_.62), metadata={op_name="moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.31 = bf16[32,4096,576]{2,1,0} dot(%convert_element_type.205, %convert_element_type.210), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.329 = f32[1]{0} multiply(%div.326, %div.336), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.211 = bf16[1]{0} convert(%mul.329), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.366 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.211), dimensions={2}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.367 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.366), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.368 = bf16[32,4096,576]{2,1,0} broadcast(%broadcast_in_dim.367), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.330 = bf16[32,4096,576]{2,1,0} multiply(%dot_general.31, %broadcast_in_dim.368), metadata={op_name="moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %split.20 = bf16[32,4096,512]{2,1,0} slice(%mul.330), slice={[0:32], [0:4096], [0:512]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=667 source_end_line=667 source_column=35 source_end_column=84}
  %convert_element_type.222 = f32[32,4096,512]{2,1,0} convert(%split.20), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.14 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.222, %convert_element_type.222), metadata={op_name="moe_layers/self_attention/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.62 = f32[32,4096]{1,0} reduce(%square.14, %constant.300), dimensions={2}, to_apply=%region_30.50, metadata={op_name="moe_layers/self_attention/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.380 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.62), metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.290 = f32[] constant(512)
  %div.320 = f32[32,4096,1]{2,1,0} broadcast(%constant.290), dimensions={}, metadata={op_name="moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.349 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.380, %div.320), metadata={op_name="moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.69 = f32[32,4096,1]{2,1,0} add(%div.349, %broadcast.91), metadata={op_name="moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.14 = f32[32,4096,1]{2,1,0} rsqrt(%add.69), metadata={op_name="moe_layers/self_attention/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.347 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.14), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.348 = f32[32,4096]{1,0} reshape(%mul.347), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.349 = f32[32,4096,512]{2,1,0} broadcast(%mul.348), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.350 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.222, %mul.349), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.223 = bf16[32,4096,512]{2,1,0} convert(%mul.350), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_67.3 = bf16[512]{0} parameter(67)
  %broadcast_in_dim.381 = bf16[1,1,512]{2,1,0} reshape(%Arg_67.3), metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.351 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.381), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.352 = bf16[512]{0} reshape(%mul.351), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.353 = bf16[32,4096,512]{2,1,0} broadcast(%mul.352), dimensions={2}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.354 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.223, %mul.353), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %Arg_118.1 = f32[1024]{0} parameter(118)
  %reduce_max.307 = f32[] reduce(%Arg_118.1, %constant.299), dimensions={0}, to_apply=%region_31.51, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.61 = pred[] is-finite(%reduce_max.307), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.61 = pred[] compare(%reduce_max.307, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.351 = f32[] divide(%constant.297, %reduce_max.307), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.352 = f32[] divide(%div.351, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_119.1 = f32[1]{0} parameter(119)
  %div.350 = f32[1]{0} divide(%constant.294, %Arg_119.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.124 = f32[1]{0} call(%gt.61, %div.352, %div.350), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.125 = f32[1]{0} call(%is_finite.61, %jit__where_.124, %div.350), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.353 = f32[1]{0} divide(%constant.294, %jit__where_.125), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.227 = bf16[1]{0} convert(%div.353), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.382 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.227), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.383 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.382), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.384 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.383), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.354 = bf16[32,4096,512]{2,1,0} divide(%mul.354, %broadcast_in_dim.384), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_11.3 = bf16[] parameter(11)
  %Arg_12.3 = bf16[] parameter(12)
  %jit_clip_.65 = bf16[32,4096,512]{2,1,0} call(%div.354, %Arg_11.3, %Arg_12.3), to_apply=%clip_154.21, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.228 = f8e4m3fn[32,4096,512]{2,1,0} convert(%jit_clip_.65), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_71.3 = bf16[512,128,256]{2,1,0} parameter(71)
  %Arg_120.1 = f32[1024]{0} parameter(120)
  %reduce_max.308 = f32[] reduce(%Arg_120.1, %constant.299), dimensions={0}, to_apply=%region_32.52, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.62 = pred[] is-finite(%reduce_max.308), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.62 = pred[] compare(%reduce_max.308, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.356 = f32[] divide(%constant.297, %reduce_max.308), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.357 = f32[] divide(%div.356, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_121.1 = f32[1]{0} parameter(121)
  %div.355 = f32[1]{0} divide(%constant.294, %Arg_121.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.126 = f32[1]{0} call(%gt.62, %div.357, %div.355), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.127 = f32[1]{0} call(%is_finite.62, %jit__where_.126, %div.355), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.358 = f32[1]{0} divide(%constant.294, %jit__where_.127), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.229 = bf16[1]{0} convert(%div.358), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.385 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.229), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.386 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.385), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.387 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.386), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.359 = bf16[512,128,256]{2,1,0} divide(%Arg_71.3, %broadcast_in_dim.387), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_13.3 = bf16[] parameter(13)
  %Arg_14.3 = bf16[] parameter(14)
  %jit_clip_.66 = bf16[512,128,256]{2,1,0} call(%div.359, %Arg_13.3, %Arg_14.3), to_apply=%clip_160.23, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.230 = f8e4m3fn[512,128,256]{2,1,0} convert(%jit_clip_.66), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.33 = bf16[32,4096,128,256]{3,2,1,0} dot(%convert_element_type.228, %convert_element_type.230), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.357 = f32[1]{0} multiply(%div.353, %div.358), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.231 = bf16[1]{0} convert(%mul.357), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.388 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.231), dimensions={3}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.389 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.388), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.390 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.389), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.358 = bf16[32,4096,128,256]{3,2,1,0} multiply(%dot_general.33, %broadcast_in_dim.390), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %split.22 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.358), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=560 source_end_line=560 source_column=22 source_end_column=73}
  %split.21 = bf16[32,4096,64]{2,1,0} slice(%mul.330), slice={[0:32], [0:4096], [512:576]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=667 source_end_line=667 source_column=35 source_end_column=84}
  %reshape.7 = bf16[32,4096,1,32,2]{4,3,2,1,0} reshape(%split.21), metadata={op_name="moe_layers/self_attention/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=702 source_end_line=702 source_column=24 source_end_column=60}
  %slice.15 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.7), slice={[0:32], [0:4096], [0:1], [0:32], [0:1]}, metadata={op_name="moe_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %squeeze.167 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.15), metadata={op_name="moe_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=32 source_end_column=55}
  %convert_element_type.225 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.167), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %slice.16 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.7), slice={[0:32], [0:4096], [0:1], [0:32], [1:2]}, metadata={op_name="moe_layers/self_attention/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %squeeze.168 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.16), metadata={op_name="moe_layers/self_attention/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=703 source_end_line=703 source_column=57 source_end_column=80}
  %convert_element_type.224 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.168), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %constant.289 = c64[] constant((0, 1))
  %mul.316 = c64[32,4096,1,32]{3,2,1,0} broadcast(%constant.289), dimensions={}, metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %mul.355 = c64[32,4096,1,32]{3,2,1,0} multiply(%convert_element_type.224, %mul.316), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=34 source_end_column=50}
  %add.70 = c64[32,4096,1,32]{3,2,1,0} add(%convert_element_type.225, %mul.355), metadata={op_name="moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=708 source_end_line=708 source_column=21 source_end_column=50}
  %Arg_15.3 = c64[32,4096,1,32]{3,2,1,0} parameter(15)
  %mul.356 = c64[32,4096,1,32]{3,2,1,0} multiply(%add.70, %Arg_15.3), metadata={op_name="moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=710 source_end_line=710 source_column=14 source_end_column=36}
  %real.7 = f32[32,4096,1,32]{3,2,1,0} real(%mul.356), metadata={op_name="moe_layers/self_attention/real" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=30 source_end_column=47}
  %imag.7 = f32[32,4096,1,32]{3,2,1,0} imag(%mul.356), metadata={op_name="moe_layers/self_attention/imag" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=49 source_end_column=66}
  %concatenate.14 = f32[32,4096,1,64]{3,2,1,0} concatenate(%real.7, %imag.7), dimensions={3}, metadata={op_name="moe_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=714 source_end_line=714 source_column=13 source_end_column=77}
  %convert_element_type.226 = bf16[32,4096,1,64]{3,2,1,0} convert(%concatenate.14), metadata={op_name="moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=721 source_end_line=721 source_column=15 source_end_column=46}
  %broadcast_in_dim.391 = bf16[32,4096,1,64]{3,2,1,0} broadcast(%convert_element_type.226), dimensions={0,1,2,3}, metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %broadcast_in_dim.392 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.391), metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %broadcast_in_dim.393 = bf16[32,4096,128,64]{3,2,1,0} broadcast(%broadcast_in_dim.392), dimensions={0,1,3}, metadata={op_name="moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=561 source_end_line=561 source_column=15 source_end_column=122}
  %concatenate.15 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.22, %broadcast_in_dim.393), dimensions={3}, metadata={op_name="moe_layers/self_attention/concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=563 source_end_line=563 source_column=10 source_end_column=56}
  %sharding_constraint.51 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%concatenate.15), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %split.23 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.358), slice={[0:32], [0:4096], [0:128], [128:256]}, metadata={op_name="moe_layers/self_attention/split" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=560 source_end_line=560 source_column=22 source_end_column=73}
  %sharding_constraint.52 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%split.23), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_16.3 = bf16[0]{0} parameter(16)
  %custom_partitioning.13 = (bf16[32,4096,128,128]{3,2,1,0}, f32[32,128,4096]{2,1,0}) custom-call(%sharding_constraint.50, %sharding_constraint.51, %sharding_constraint.52, %Arg_16.3, %Arg_16.3, /*index=5*/%Arg_16.3, %Arg_16.3, %Arg_16.3, %Arg_16.3, %Arg_16.3), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="moe_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}, backend_config="281457329920656"
  %custom_partitioning.15 = f32[32,128,4096]{2,1,0} get-tuple-element(%custom_partitioning.13), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="moe_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}
  %custom_partitioning.14 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.13), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="moe_layers/self_attention/custom_partitioning" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_op.py" source_line=1199 source_end_line=1208 source_column=20 source_end_column=7}
  %sharding_constraint.53 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.14), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_114.1 = f32[1024]{0} parameter(114)
  %reduce_max.309 = f32[] reduce(%Arg_114.1, %constant.299), dimensions={0}, to_apply=%region_33.53, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.63 = pred[] is-finite(%reduce_max.309), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.63 = pred[] compare(%reduce_max.309, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.361 = f32[] divide(%constant.297, %reduce_max.309), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.362 = f32[] divide(%div.361, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_115.1 = f32[1]{0} parameter(115)
  %div.360 = f32[1]{0} divide(%constant.294, %Arg_115.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.128 = f32[1]{0} call(%gt.63, %div.362, %div.360), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.129 = f32[1]{0} call(%is_finite.63, %jit__where_.128, %div.360), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.363 = f32[1]{0} divide(%constant.294, %jit__where_.129), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.232 = bf16[1]{0} convert(%div.363), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.394 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.232), dimensions={3}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.395 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.394), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.396 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.395), dimensions={0,1,2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.364 = bf16[32,4096,128,128]{3,2,1,0} divide(%sharding_constraint.53, %broadcast_in_dim.396), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_17.3 = bf16[] parameter(17)
  %Arg_18.3 = bf16[] parameter(18)
  %jit_clip_.67 = bf16[32,4096,128,128]{3,2,1,0} call(%div.364, %Arg_17.3, %Arg_18.3), to_apply=%clip_177.25, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.233 = f8e4m3fn[32,4096,128,128]{3,2,1,0} convert(%jit_clip_.67), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_68.3 = bf16[128,128,7168]{2,1,0} parameter(68)
  %Arg_116.1 = f32[1024]{0} parameter(116)
  %reduce_max.310 = f32[] reduce(%Arg_116.1, %constant.299), dimensions={0}, to_apply=%region_34.54, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.64 = pred[] is-finite(%reduce_max.310), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.64 = pred[] compare(%reduce_max.310, %constant.300), direction=GT, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.366 = f32[] divide(%constant.297, %reduce_max.310), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.367 = f32[] divide(%div.366, %constant.298), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_117.1 = f32[1]{0} parameter(117)
  %div.365 = f32[1]{0} divide(%constant.294, %Arg_117.1), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.130 = f32[1]{0} call(%gt.64, %div.367, %div.365), to_apply=%_where_68.7, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.131 = f32[1]{0} call(%is_finite.64, %jit__where_.130, %div.365), to_apply=%_where_71.8, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.368 = f32[1]{0} divide(%constant.294, %jit__where_.131), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.234 = bf16[1]{0} convert(%div.368), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.397 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.234), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.398 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.397), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.399 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.398), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.369 = bf16[128,128,7168]{2,1,0} divide(%Arg_68.3, %broadcast_in_dim.399), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_19.3 = bf16[] parameter(19)
  %Arg_20.3 = bf16[] parameter(20)
  %jit_clip_.68 = bf16[128,128,7168]{2,1,0} call(%div.369, %Arg_19.3, %Arg_20.3), to_apply=%clip_183.27, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.235 = f8e4m3fn[128,128,7168]{2,1,0} convert(%jit_clip_.68), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.34 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.233, %convert_element_type.235), lhs_contracting_dims={2,3}, rhs_contracting_dims={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.359 = f32[1]{0} multiply(%div.363, %div.368), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.236 = bf16[1]{0} convert(%mul.359), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.400 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.236), dimensions={2}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.401 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.400), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.402 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.401), dimensions={0,1}, metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.360 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.34, %broadcast_in_dim.402), metadata={op_name="moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %reduce_precision.7 = bf16[32,4096,7168]{2,1,0} reduce-precision(%mul.360), exponent_bits=8, mantissa_bits=7, metadata={op_name="moe_layers/self_attention/reduce_precision" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/attention_mla.py" source_line=751 source_end_line=751 source_column=10 source_end_column=42}
  %sharding_constraint.54 = bf16[32,4096,7168]{2,1,0} custom-call(%reduce_precision.7), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %add.71 = bf16[32,4096,7168]{2,1,0} add(%reduce_precision.6, %sharding_constraint.54), metadata={op_name="moe_layers/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=115 source_end_line=115 source_column=24 source_end_column=46}
  %convert_element_type.237 = f32[32,4096,7168]{2,1,0} convert(%add.71), metadata={op_name="moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.15 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.237, %convert_element_type.237), metadata={op_name="moe_layers/post_self_attention_layer_norm/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %reduce_sum.63 = f32[32,4096]{1,0} reduce(%square.15, %constant.300), dimensions={2}, to_apply=%region_35.55, metadata={op_name="moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.403 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.63), metadata={op_name="moe_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %div.370 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.403, %broadcast.92), metadata={op_name="moe_layers/post_self_attention_layer_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %add.72 = f32[32,4096,1]{2,1,0} add(%div.370, %broadcast.91), metadata={op_name="moe_layers/post_self_attention_layer_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.15 = f32[32,4096,1]{2,1,0} rsqrt(%add.72), metadata={op_name="moe_layers/post_self_attention_layer_norm/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.361 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.15), dimensions={0,1,2}, metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.362 = f32[32,4096]{1,0} reshape(%mul.361), metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.363 = f32[32,4096,7168]{2,1,0} broadcast(%mul.362), dimensions={0,1}, metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.364 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.237, %mul.363), metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.238 = bf16[32,4096,7168]{2,1,0} convert(%mul.364), metadata={op_name="moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %Arg_65.3 = bf16[7168]{0} parameter(65)
  %broadcast_in_dim.404 = bf16[1,1,7168]{2,1,0} reshape(%Arg_65.3), metadata={op_name="moe_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.365 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.404), dimensions={0,1,2}, metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.366 = bf16[7168]{0} reshape(%mul.365), metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.367 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.366), dimensions={2}, metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.368 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.238, %mul.367), metadata={op_name="moe_layers/post_self_attention_layer_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %sharding_constraint.55 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.368), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_74.3 = f32[1024]{0} parameter(74)
  %reduce_max.311 = f32[] reduce(%Arg_74.3, %constant.299), dimensions={0}, to_apply=%region_36.56, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.65 = pred[] is-finite(%reduce_max.311), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.65 = pred[] compare(%reduce_max.311, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.372 = f32[] divide(%constant.297, %reduce_max.311), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.373 = f32[] divide(%div.372, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_75.3 = f32[1]{0} parameter(75)
  %div.371 = f32[1]{0} divide(%constant.294, %Arg_75.3), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.132 = f32[1]{0} call(%gt.65, %div.373, %div.371), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.133 = f32[1]{0} call(%is_finite.65, %jit__where_.132, %div.371), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.374 = f32[1]{0} divide(%constant.294, %jit__where_.133), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.239 = bf16[1]{0} convert(%div.374), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.405 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.239), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.406 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.405), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.407 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.406), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.375 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.55, %broadcast_in_dim.407), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_21.3 = bf16[] parameter(21)
  %Arg_22.3 = bf16[] parameter(22)
  %jit_clip_.69 = bf16[32,4096,7168]{2,1,0} call(%div.375, %Arg_21.3, %Arg_22.3), to_apply=%clip_75.9, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.240 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.69), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_57.3 = bf16[7168,64]{1,0} parameter(57)
  %Arg_76.1 = f32[1024]{0} parameter(76)
  %reduce_max.312 = f32[] reduce(%Arg_76.1, %constant.299), dimensions={0}, to_apply=%region_37.57, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.66 = pred[] is-finite(%reduce_max.312), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.66 = pred[] compare(%reduce_max.312, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.377 = f32[] divide(%constant.297, %reduce_max.312), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.378 = f32[] divide(%div.377, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_77.1 = f32[1]{0} parameter(77)
  %div.376 = f32[1]{0} divide(%constant.294, %Arg_77.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.134 = f32[1]{0} call(%gt.66, %div.378, %div.376), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.135 = f32[1]{0} call(%is_finite.66, %jit__where_.134, %div.376), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.379 = f32[1]{0} divide(%constant.294, %jit__where_.135), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.241 = bf16[1]{0} convert(%div.379), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.408 = bf16[7168,1]{1,0} broadcast(%convert_element_type.241), dimensions={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.409 = bf16[7168]{0} reshape(%broadcast_in_dim.408), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.410 = bf16[7168,64]{1,0} broadcast(%broadcast_in_dim.409), dimensions={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.380 = bf16[7168,64]{1,0} divide(%Arg_57.3, %broadcast_in_dim.410), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_23.3 = bf16[] parameter(23)
  %Arg_24.3 = bf16[] parameter(24)
  %jit_clip_.70 = bf16[7168,64]{1,0} call(%div.380, %Arg_23.3, %Arg_24.3), to_apply=%clip_275.58, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.242 = f8e4m3fn[7168,64]{1,0} convert(%jit_clip_.70), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.35 = bf16[32,4096,64]{2,1,0} dot(%convert_element_type.240, %convert_element_type.242), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.369 = f32[1]{0} multiply(%div.374, %div.379), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.243 = bf16[1]{0} convert(%mul.369), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.411 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.243), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.412 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.411), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.413 = bf16[32,4096,64]{2,1,0} broadcast(%broadcast_in_dim.412), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.370 = bf16[32,4096,64]{2,1,0} multiply(%dot_general.35, %broadcast_in_dim.413), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %sharding_constraint.56 = bf16[32,4096,64]{2,1,0} custom-call(%mul.370), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_58.3 = bf16[64]{0} parameter(58)
  %custom_partitioning.16 = (bf16[32,4096,64]{2,1,0}, pred[32,4096,64]{2,1,0}, bf16[32,4096,64]{2,1,0}) custom-call(%sharding_constraint.56, %Arg_58.3), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/usr/local/lib/python3.12/dist-packages/transformer_engine/jax/router.py" source_line=34 source_end_line=43 source_column=14 source_end_column=5}, backend_config="281456797909792"
  %custom_partitioning.19 = bf16[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.16), index=2, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/usr/local/lib/python3.12/dist-packages/transformer_engine/jax/router.py" source_line=34 source_end_line=43 source_column=14 source_end_column=5}
  %custom_partitioning.17 = bf16[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.16), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/usr/local/lib/python3.12/dist-packages/transformer_engine/jax/router.py" source_line=34 source_end_line=43 source_column=14 source_end_column=5}
  %custom_partitioning.18 = pred[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.16), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/usr/local/lib/python3.12/dist-packages/transformer_engine/jax/router.py" source_line=34 source_end_line=43 source_column=14 source_end_column=5}
  %convert_element_type.244 = s32[32,4096,64]{2,1,0} convert(%custom_partitioning.18), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1385 source_end_line=1385 source_column=18 source_end_column=49}
  %jit_cumsum_.1 = s32[32,4096,64]{2,1,0} call(%convert_element_type.244), to_apply=%cumsum.61, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/jit(cumsum)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1388 source_end_line=1388 source_column=25 source_end_column=56}
  %constant.288 = s32[] constant(512)
  %le.6 = s32[32,4096,64]{2,1,0} broadcast(%constant.288), dimensions={}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1391 source_end_line=1391 source_column=38 source_end_column=99}
  %le.7 = pred[32,4096,64]{2,1,0} compare(%jit_cumsum_.1, %le.6), direction=LE, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1391 source_end_line=1391 source_column=38 source_end_column=99}
  %convert_element_type.245 = s32[32,4096,64]{2,1,0} convert(%le.7), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1391 source_end_line=1391 source_column=24 source_end_column=99}
  %mul.371 = s32[32,4096,64]{2,1,0} multiply(%convert_element_type.244, %convert_element_type.245), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1391 source_end_line=1391 source_column=24 source_end_column=99}
  %convert_element_type.246 = bf16[32,4096,64]{2,1,0} convert(%mul.371), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1394 source_end_line=1394 source_column=4 source_end_column=41}
  %mul.372 = bf16[32,4096,64]{2,1,0} multiply(%custom_partitioning.17, %convert_element_type.246), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1394 source_end_line=1394 source_column=4 source_end_column=41}
  %broadcast_in_dim.414 = bf16[32,4096,64,1]{3,2,1,0} reshape(%mul.372), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %mul.375 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%broadcast_in_dim.414), dimensions={0,1,2,3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %mul.376 = bf16[32,4096,64]{2,1,0} reshape(%mul.375), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %mul.377 = bf16[32,4096,64,513]{3,2,1,0} broadcast(%mul.376), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %mul.373 = s32[32,4096,64]{2,1,0} multiply(%convert_element_type.244, %jit_cumsum_.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1397 source_end_line=1397 source_column=28 source_end_column=60}
  %mul.374 = s32[32,4096,64]{2,1,0} multiply(%mul.373, %mul.371), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1398 source_end_line=1398 source_column=34 source_end_column=78}
  %Arg_25.3 = s32[1,1,1,513]{3,2,1,0} parameter(25)
  %jit__one_hot_.2 = s32[32,4096,64,513]{3,2,1,0} call(%mul.374, %Arg_25.3), to_apply=%_one_hot_289.62, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/jit(_one_hot)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %convert_element_type.247 = bf16[32,4096,64,513]{3,2,1,0} convert(%jit__one_hot_.2), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %mul.378 = bf16[32,4096,64,513]{3,2,1,0} multiply(%mul.377, %convert_element_type.247), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1409 source_end_line=1409 source_column=19 source_end_column=43}
  %slice.17 = bf16[32,4096,64,512]{3,2,1,0} slice(%mul.378), slice={[0:32], [0:4096], [0:64], [1:513]}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1410 source_end_line=1410 source_column=19 source_end_column=40}
  %sharding_constraint.58 = bf16[32,4096,64,512]{3,2,1,0} custom-call(%slice.17), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}, {}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_92.1 = f32[1024]{0} parameter(92)
  %reduce_max.320 = f32[] reduce(%Arg_92.1, %constant.299), dimensions={0}, to_apply=%region_46.76, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.74 = pred[] is-finite(%reduce_max.320), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.74 = pred[] compare(%reduce_max.320, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.417 = f32[] divide(%constant.297, %reduce_max.320), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.418 = f32[] divide(%div.417, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_93.1 = f32[1]{0} parameter(93)
  %div.416 = f32[1]{0} divide(%constant.294, %Arg_93.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.150 = f32[1]{0} call(%gt.74, %div.418, %div.416), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.151 = f32[1]{0} call(%is_finite.74, %jit__where_.150, %div.416), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.419 = f32[1]{0} divide(%constant.294, %jit__where_.151), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.268 = bf16[1]{0} convert(%div.419), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.448 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%convert_element_type.268), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.449 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.448), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.450 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%broadcast_in_dim.449), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.420 = bf16[32,4096,64,512]{3,2,1,0} divide(%sharding_constraint.58, %broadcast_in_dim.450), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_26.3 = bf16[] parameter(26)
  %Arg_27.3 = bf16[] parameter(27)
  %jit_clip_.78 = bf16[32,4096,64,512]{3,2,1,0} call(%div.420, %Arg_26.3, %Arg_27.3), to_apply=%clip_302.64, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.269 = f8e4m3fn[32,4096,64,512]{3,2,1,0} convert(%jit_clip_.78), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %constant.287 = bf16[] constant(0)
  %convert_element_type.201 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%constant.287), dimensions={}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1411 source_end_line=1411 source_column=20 source_end_column=45}
  %convert_element_type.248 = pred[32,4096,64,512]{3,2,1,0} compare(%slice.17, %convert_element_type.201), direction=NE, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1411 source_end_line=1411 source_column=20 source_end_column=45}
  %sharding_constraint.57 = pred[32,4096,64,512]{3,2,1,0} custom-call(%convert_element_type.248), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}, {}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %convert_element_type.249 = bf16[32,4096,64,512]{3,2,1,0} convert(%sharding_constraint.57), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=222 source_end_line=222 source_column=12 source_end_column=42}
  %Arg_78.1 = f32[1024]{0} parameter(78)
  %reduce_max.313 = f32[] reduce(%Arg_78.1, %constant.299), dimensions={0}, to_apply=%region_39.63, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.67 = pred[] is-finite(%reduce_max.313), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.67 = pred[] compare(%reduce_max.313, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.382 = f32[] divide(%constant.297, %reduce_max.313), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.383 = f32[] divide(%div.382, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_79.1 = f32[1]{0} parameter(79)
  %div.381 = f32[1]{0} divide(%constant.294, %Arg_79.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.136 = f32[1]{0} call(%gt.67, %div.383, %div.381), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.137 = f32[1]{0} call(%is_finite.67, %jit__where_.136, %div.381), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.384 = f32[1]{0} divide(%constant.294, %jit__where_.137), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.250 = bf16[1]{0} convert(%div.384), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.415 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%convert_element_type.250), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.416 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.415), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.417 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%broadcast_in_dim.416), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.385 = bf16[32,4096,64,512]{3,2,1,0} divide(%convert_element_type.249, %broadcast_in_dim.417), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_28.3 = bf16[] parameter(28)
  %Arg_29.3 = bf16[] parameter(29)
  %jit_clip_.71 = bf16[32,4096,64,512]{3,2,1,0} call(%div.385, %Arg_28.3, %Arg_29.3), to_apply=%clip_302.64, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.251 = f8e4m3fn[32,4096,64,512]{3,2,1,0} convert(%jit_clip_.71), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_80.1 = f32[1024]{0} parameter(80)
  %reduce_max.314 = f32[] reduce(%Arg_80.1, %constant.299), dimensions={0}, to_apply=%region_40.65, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.68 = pred[] is-finite(%reduce_max.314), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.68 = pred[] compare(%reduce_max.314, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.387 = f32[] divide(%constant.297, %reduce_max.314), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.388 = f32[] divide(%div.387, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_81.1 = f32[1]{0} parameter(81)
  %div.386 = f32[1]{0} divide(%constant.294, %Arg_81.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.138 = f32[1]{0} call(%gt.68, %div.388, %div.386), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.139 = f32[1]{0} call(%is_finite.68, %jit__where_.138, %div.386), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.389 = f32[1]{0} divide(%constant.294, %jit__where_.139), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.252 = bf16[1]{0} convert(%div.389), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.418 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.252), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.419 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.418), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.420 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.419), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.390 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.55, %broadcast_in_dim.420), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_30.3 = bf16[] parameter(30)
  %Arg_31.3 = bf16[] parameter(31)
  %jit_clip_.72 = bf16[32,4096,7168]{2,1,0} call(%div.390, %Arg_30.3, %Arg_31.3), to_apply=%clip_75.9, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.253 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.72), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %dot_general.36 = bf16[32,64,512,7168]{3,2,1,0} dot(%convert_element_type.251, %convert_element_type.253), lhs_batch_dims={0}, lhs_contracting_dims={1}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.379 = f32[1]{0} multiply(%div.384, %div.389), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.254 = bf16[1]{0} convert(%mul.379), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.421 = bf16[32,64,512,1]{3,2,1,0} broadcast(%convert_element_type.254), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.422 = bf16[32,64,512]{2,1,0} reshape(%broadcast_in_dim.421), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.423 = bf16[32,64,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.422), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.380 = bf16[32,64,512,7168]{3,2,1,0} multiply(%dot_general.36, %broadcast_in_dim.423), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %transpose.30 = bf16[64,32,512,7168]{3,2,0,1} transpose(%mul.380), dimensions={1,0,2,3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/transpose" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %sharding_constraint.59 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%transpose.30), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/dispatch/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_82.1 = f32[1024]{0} parameter(82)
  %reduce_max.315 = f32[] reduce(%Arg_82.1, %constant.299), dimensions={0}, to_apply=%region_41.66, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %is_finite.69 = pred[] is-finite(%reduce_max.315), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %gt.69 = pred[] compare(%reduce_max.315, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.392 = f32[] divide(%constant.297, %reduce_max.315), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.393 = f32[] divide(%div.392, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_83.1 = f32[1]{0} parameter(83)
  %div.391 = f32[1]{0} divide(%constant.294, %Arg_83.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.140 = f32[1]{0} call(%gt.69, %div.393, %div.391), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %jit__where_.141 = f32[1]{0} call(%is_finite.69, %jit__where_.140, %div.391), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.394 = f32[1]{0} divide(%constant.294, %jit__where_.141), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.255 = bf16[1]{0} convert(%div.394), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.424 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.255), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.425 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.424), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %broadcast_in_dim.426 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.425), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %div.395 = bf16[64,32,512,7168]{3,2,1,0} divide(%sharding_constraint.59, %broadcast_in_dim.426), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_32.3 = bf16[] parameter(32)
  %Arg_33.3 = bf16[] parameter(33)
  %jit_clip_.73 = bf16[64,32,512,7168]{3,2,1,0} call(%div.395, %Arg_32.3, %Arg_33.3), to_apply=%clip_315.67, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %convert_element_type.256 = f8e4m3fn[64,32,512,7168]{3,2,1,0} convert(%jit_clip_.73), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_59.3 = bf16[64,7168,2048]{2,1,0} parameter(59)
  %sharding_constraint.60 = bf16[64,7168,2048]{2,1,0} custom-call(%Arg_59.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_84.1 = f32[1024]{0} parameter(84)
  %reduce_max.316 = f32[] reduce(%Arg_84.1, %constant.299), dimensions={0}, to_apply=%region_42.68, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.70 = pred[] is-finite(%reduce_max.316), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.70 = pred[] compare(%reduce_max.316, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.397 = f32[] divide(%constant.297, %reduce_max.316), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.398 = f32[] divide(%div.397, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_86.1 = f32[1]{0} parameter(86)
  %div.396 = f32[1]{0} divide(%constant.294, %Arg_86.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.142 = f32[1]{0} call(%gt.70, %div.398, %div.396), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.143 = f32[1]{0} call(%is_finite.70, %jit__where_.142, %div.396), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.399 = f32[1]{0} divide(%constant.294, %jit__where_.143), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.257 = bf16[1]{0} convert(%div.399), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.427 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.257), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.428 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.427), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.429 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.428), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.400 = bf16[64,7168,2048]{2,1,0} divide(%sharding_constraint.60, %broadcast_in_dim.429), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_34.3 = bf16[] parameter(34)
  %Arg_35.3 = bf16[] parameter(35)
  %jit_clip_.74 = bf16[64,7168,2048]{2,1,0} call(%div.400, %Arg_34.3, %Arg_35.3), to_apply=%clip_321.69, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.258 = f8e4m3fn[64,7168,2048]{2,1,0} convert(%jit_clip_.74), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.37 = bf16[64,32,512,2048]{3,2,1,0} dot(%convert_element_type.256, %convert_element_type.258), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.381 = f32[1]{0} multiply(%div.394, %div.399), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.259 = bf16[1]{0} convert(%mul.381), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.430 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.259), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.431 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.430), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.432 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.431), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.382 = bf16[64,32,512,2048]{3,2,1,0} multiply(%dot_general.37, %broadcast_in_dim.432), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %sharding_constraint.62 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%mul.382), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %jit_silu_.4 = bf16[64,32,512,2048]{3,2,1,0} call(%sharding_constraint.62), to_apply=%silu_332.71, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %Arg_60.3 = bf16[64,7168,2048]{2,1,0} parameter(60)
  %sharding_constraint.61 = bf16[64,7168,2048]{2,1,0} custom-call(%Arg_60.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_85.1 = f32[1024]{0} parameter(85)
  %reduce_max.317 = f32[] reduce(%Arg_85.1, %constant.299), dimensions={0}, to_apply=%region_43.70, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %is_finite.71 = pred[] is-finite(%reduce_max.317), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %gt.71 = pred[] compare(%reduce_max.317, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.402 = f32[] divide(%constant.297, %reduce_max.317), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.403 = f32[] divide(%div.402, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_87.1 = f32[1]{0} parameter(87)
  %div.401 = f32[1]{0} divide(%constant.294, %Arg_87.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.144 = f32[1]{0} call(%gt.71, %div.403, %div.401), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %jit__where_.145 = f32[1]{0} call(%is_finite.71, %jit__where_.144, %div.401), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.404 = f32[1]{0} divide(%constant.294, %jit__where_.145), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.260 = bf16[1]{0} convert(%div.404), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.433 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.260), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.434 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.433), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %broadcast_in_dim.435 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.434), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %div.405 = bf16[64,7168,2048]{2,1,0} divide(%sharding_constraint.61, %broadcast_in_dim.435), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_36.3 = bf16[] parameter(36)
  %Arg_37.3 = bf16[] parameter(37)
  %jit_clip_.75 = bf16[64,7168,2048]{2,1,0} call(%div.405, %Arg_36.3, %Arg_37.3), to_apply=%clip_321.69, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %convert_element_type.261 = f8e4m3fn[64,7168,2048]{2,1,0} convert(%jit_clip_.75), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %dot_general.38 = bf16[64,32,512,2048]{3,2,1,0} dot(%convert_element_type.256, %convert_element_type.261), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.383 = f32[1]{0} multiply(%div.394, %div.404), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %convert_element_type.262 = bf16[1]{0} convert(%mul.383), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.436 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.262), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.437 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.436), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %broadcast_in_dim.438 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.437), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %mul.384 = bf16[64,32,512,2048]{3,2,1,0} multiply(%dot_general.38, %broadcast_in_dim.438), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %sharding_constraint.63 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%mul.384), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %mul.385 = bf16[64,32,512,2048]{3,2,1,0} multiply(%jit_silu_.4, %sharding_constraint.63), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/ffn_act/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=547 source_end_line=547 source_column=29 source_end_column=62}
  %Arg_88.1 = f32[1024]{0} parameter(88)
  %reduce_max.318 = f32[] reduce(%Arg_88.1, %constant.299), dimensions={0}, to_apply=%region_44.72, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.72 = pred[] is-finite(%reduce_max.318), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.72 = pred[] compare(%reduce_max.318, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.407 = f32[] divide(%constant.297, %reduce_max.318), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.408 = f32[] divide(%div.407, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_89.1 = f32[1]{0} parameter(89)
  %div.406 = f32[1]{0} divide(%constant.294, %Arg_89.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.146 = f32[1]{0} call(%gt.72, %div.408, %div.406), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.147 = f32[1]{0} call(%is_finite.72, %jit__where_.146, %div.406), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.409 = f32[1]{0} divide(%constant.294, %jit__where_.147), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.263 = bf16[1]{0} convert(%div.409), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.439 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.263), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.440 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.439), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.441 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.440), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.410 = bf16[64,32,512,2048]{3,2,1,0} divide(%mul.385, %broadcast_in_dim.441), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_38.3 = bf16[] parameter(38)
  %Arg_39.3 = bf16[] parameter(39)
  %jit_clip_.76 = bf16[64,32,512,2048]{3,2,1,0} call(%div.410, %Arg_38.3, %Arg_39.3), to_apply=%clip_340.73, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.264 = f8e4m3fn[64,32,512,2048]{3,2,1,0} convert(%jit_clip_.76), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_61.3 = bf16[64,2048,7168]{2,1,0} parameter(61)
  %sharding_constraint.64 = bf16[64,2048,7168]{2,1,0} custom-call(%Arg_61.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_90.1 = f32[1024]{0} parameter(90)
  %reduce_max.319 = f32[] reduce(%Arg_90.1, %constant.299), dimensions={0}, to_apply=%region_45.74, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.73 = pred[] is-finite(%reduce_max.319), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.73 = pred[] compare(%reduce_max.319, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.412 = f32[] divide(%constant.297, %reduce_max.319), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.413 = f32[] divide(%div.412, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_91.1 = f32[1]{0} parameter(91)
  %div.411 = f32[1]{0} divide(%constant.294, %Arg_91.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.148 = f32[1]{0} call(%gt.73, %div.413, %div.411), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.149 = f32[1]{0} call(%is_finite.73, %jit__where_.148, %div.411), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.414 = f32[1]{0} divide(%constant.294, %jit__where_.149), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.265 = bf16[1]{0} convert(%div.414), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.442 = bf16[64,2048,1]{2,1,0} broadcast(%convert_element_type.265), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.443 = bf16[64,2048]{1,0} reshape(%broadcast_in_dim.442), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.444 = bf16[64,2048,7168]{2,1,0} broadcast(%broadcast_in_dim.443), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.415 = bf16[64,2048,7168]{2,1,0} divide(%sharding_constraint.64, %broadcast_in_dim.444), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_40.3 = bf16[] parameter(40)
  %Arg_41.3 = bf16[] parameter(41)
  %jit_clip_.77 = bf16[64,2048,7168]{2,1,0} call(%div.415, %Arg_40.3, %Arg_41.3), to_apply=%clip_346.75, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.266 = f8e4m3fn[64,2048,7168]{2,1,0} convert(%jit_clip_.77), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %dot_general.39 = bf16[64,32,512,7168]{3,2,1,0} dot(%convert_element_type.264, %convert_element_type.266), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.386 = f32[1]{0} multiply(%div.409, %div.414), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.267 = bf16[1]{0} convert(%mul.386), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.445 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.267), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.446 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.445), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.447 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.446), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.387 = bf16[64,32,512,7168]{3,2,1,0} multiply(%dot_general.39, %broadcast_in_dim.447), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %sharding_constraint.65 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%mul.387), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_94.1 = f32[1024]{0} parameter(94)
  %reduce_max.321 = f32[] reduce(%Arg_94.1, %constant.299), dimensions={0}, to_apply=%region_47.77, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %is_finite.75 = pred[] is-finite(%reduce_max.321), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %gt.75 = pred[] compare(%reduce_max.321, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.422 = f32[] divide(%constant.297, %reduce_max.321), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.423 = f32[] divide(%div.422, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_95.1 = f32[1]{0} parameter(95)
  %div.421 = f32[1]{0} divide(%constant.294, %Arg_95.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.152 = f32[1]{0} call(%gt.75, %div.423, %div.421), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %jit__where_.153 = f32[1]{0} call(%is_finite.75, %jit__where_.152, %div.421), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.424 = f32[1]{0} divide(%constant.294, %jit__where_.153), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.270 = bf16[1]{0} convert(%div.424), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.451 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.270), dimensions={3}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.452 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.451), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.453 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.452), dimensions={0,1,2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %div.425 = bf16[64,32,512,7168]{3,2,1,0} divide(%sharding_constraint.65, %broadcast_in_dim.453), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_42.3 = bf16[] parameter(42)
  %Arg_43.3 = bf16[] parameter(43)
  %jit_clip_.79 = bf16[64,32,512,7168]{3,2,1,0} call(%div.425, %Arg_42.3, %Arg_43.3), to_apply=%clip_315.67, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.271 = f8e4m3fn[64,32,512,7168]{3,2,1,0} convert(%jit_clip_.79), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %dot_general.40 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.269, %convert_element_type.271), lhs_batch_dims={0}, lhs_contracting_dims={3,2}, rhs_batch_dims={1}, rhs_contracting_dims={2,0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.388 = f32[1]{0} multiply(%div.419, %div.424), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %convert_element_type.272 = bf16[1]{0} convert(%mul.388), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.454 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.272), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.455 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.454), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %broadcast_in_dim.456 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.455), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %mul.389 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.40, %broadcast_in_dim.456), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_96.1 = f32[1024]{0} parameter(96)
  %reduce_max.322 = f32[] reduce(%Arg_96.1, %constant.299), dimensions={0}, to_apply=%region_48.78, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.76 = pred[] is-finite(%reduce_max.322), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.76 = pred[] compare(%reduce_max.322, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.427 = f32[] divide(%constant.297, %reduce_max.322), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.428 = f32[] divide(%div.427, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_97.1 = f32[1]{0} parameter(97)
  %div.426 = f32[1]{0} divide(%constant.294, %Arg_97.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.154 = f32[1]{0} call(%gt.76, %div.428, %div.426), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.155 = f32[1]{0} call(%is_finite.76, %jit__where_.154, %div.426), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.429 = f32[1]{0} divide(%constant.294, %jit__where_.155), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.273 = bf16[1]{0} convert(%div.429), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.457 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.273), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.458 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.457), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.459 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.458), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.430 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.55, %broadcast_in_dim.459), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_44.3 = bf16[] parameter(44)
  %Arg_45.3 = bf16[] parameter(45)
  %jit_clip_.80 = bf16[32,4096,7168]{2,1,0} call(%div.430, %Arg_44.3, %Arg_45.3), to_apply=%clip_75.9, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.274 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.80), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_62.3 = bf16[7168,2048]{1,0} parameter(62)
  %Arg_98.1 = f32[1024]{0} parameter(98)
  %reduce_max.323 = f32[] reduce(%Arg_98.1, %constant.299), dimensions={0}, to_apply=%region_49.79, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.77 = pred[] is-finite(%reduce_max.323), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.77 = pred[] compare(%reduce_max.323, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.432 = f32[] divide(%constant.297, %reduce_max.323), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.433 = f32[] divide(%div.432, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_99.1 = f32[1]{0} parameter(99)
  %div.431 = f32[1]{0} divide(%constant.294, %Arg_99.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.156 = f32[1]{0} call(%gt.77, %div.433, %div.431), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.157 = f32[1]{0} call(%is_finite.77, %jit__where_.156, %div.431), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.434 = f32[1]{0} divide(%constant.294, %jit__where_.157), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.275 = bf16[1]{0} convert(%div.434), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.460 = bf16[7168,1]{1,0} broadcast(%convert_element_type.275), dimensions={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.461 = bf16[7168]{0} reshape(%broadcast_in_dim.460), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.462 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.461), dimensions={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.435 = bf16[7168,2048]{1,0} divide(%Arg_62.3, %broadcast_in_dim.462), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_46.3 = bf16[] parameter(46)
  %Arg_47.3 = bf16[] parameter(47)
  %jit_clip_.81 = bf16[7168,2048]{1,0} call(%div.435, %Arg_46.3, %Arg_47.3), to_apply=%clip_357.80, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.276 = f8e4m3fn[7168,2048]{1,0} convert(%jit_clip_.81), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.41 = bf16[32,4096,2048]{2,1,0} dot(%convert_element_type.274, %convert_element_type.276), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.390 = f32[1]{0} multiply(%div.429, %div.434), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.277 = bf16[1]{0} convert(%mul.390), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.463 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.277), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.464 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.463), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.465 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.464), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.391 = bf16[32,4096,2048]{2,1,0} multiply(%dot_general.41, %broadcast_in_dim.465), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %jit_silu_.5 = bf16[32,4096,2048]{2,1,0} call(%mul.391), to_apply=%silu_366.81, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_100.1 = f32[1024]{0} parameter(100)
  %reduce_max.324 = f32[] reduce(%Arg_100.1, %constant.299), dimensions={0}, to_apply=%region_50.82, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.78 = pred[] is-finite(%reduce_max.324), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.78 = pred[] compare(%reduce_max.324, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.437 = f32[] divide(%constant.297, %reduce_max.324), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.438 = f32[] divide(%div.437, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_101.1 = f32[1]{0} parameter(101)
  %div.436 = f32[1]{0} divide(%constant.294, %Arg_101.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.158 = f32[1]{0} call(%gt.78, %div.438, %div.436), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.159 = f32[1]{0} call(%is_finite.78, %jit__where_.158, %div.436), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.439 = f32[1]{0} divide(%constant.294, %jit__where_.159), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.278 = bf16[1]{0} convert(%div.439), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.466 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.278), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.467 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.466), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.468 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.467), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.440 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.55, %broadcast_in_dim.468), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_48.3 = bf16[] parameter(48)
  %Arg_49.3 = bf16[] parameter(49)
  %jit_clip_.82 = bf16[32,4096,7168]{2,1,0} call(%div.440, %Arg_48.3, %Arg_49.3), to_apply=%clip_75.9, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.279 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.82), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_63.3 = bf16[7168,2048]{1,0} parameter(63)
  %Arg_102.1 = f32[1024]{0} parameter(102)
  %reduce_max.325 = f32[] reduce(%Arg_102.1, %constant.299), dimensions={0}, to_apply=%region_51.83, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.79 = pred[] is-finite(%reduce_max.325), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.79 = pred[] compare(%reduce_max.325, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.442 = f32[] divide(%constant.297, %reduce_max.325), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.443 = f32[] divide(%div.442, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_103.1 = f32[1]{0} parameter(103)
  %div.441 = f32[1]{0} divide(%constant.294, %Arg_103.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.160 = f32[1]{0} call(%gt.79, %div.443, %div.441), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.161 = f32[1]{0} call(%is_finite.79, %jit__where_.160, %div.441), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.444 = f32[1]{0} divide(%constant.294, %jit__where_.161), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.280 = bf16[1]{0} convert(%div.444), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.469 = bf16[7168,1]{1,0} broadcast(%convert_element_type.280), dimensions={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.470 = bf16[7168]{0} reshape(%broadcast_in_dim.469), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.471 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.470), dimensions={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.445 = bf16[7168,2048]{1,0} divide(%Arg_63.3, %broadcast_in_dim.471), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_50.3 = bf16[] parameter(50)
  %Arg_51.3 = bf16[] parameter(51)
  %jit_clip_.83 = bf16[7168,2048]{1,0} call(%div.445, %Arg_50.3, %Arg_51.3), to_apply=%clip_357.80, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.281 = f8e4m3fn[7168,2048]{1,0} convert(%jit_clip_.83), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.42 = bf16[32,4096,2048]{2,1,0} dot(%convert_element_type.279, %convert_element_type.281), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.392 = f32[1]{0} multiply(%div.439, %div.444), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.282 = bf16[1]{0} convert(%mul.392), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.472 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.282), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.473 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.472), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.474 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.473), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.393 = bf16[32,4096,2048]{2,1,0} multiply(%dot_general.42, %broadcast_in_dim.474), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.394 = bf16[32,4096,2048]{2,1,0} multiply(%jit_silu_.5, %mul.393), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=471 source_end_line=471 source_column=8 source_end_column=51}
  %sharding_constraint.66 = bf16[32,4096,2048]{2,1,0} custom-call(%mul.394), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %Arg_104.1 = f32[1024]{0} parameter(104)
  %reduce_max.326 = f32[] reduce(%Arg_104.1, %constant.299), dimensions={0}, to_apply=%region_52.84, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %is_finite.80 = pred[] is-finite(%reduce_max.326), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %gt.80 = pred[] compare(%reduce_max.326, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.447 = f32[] divide(%constant.297, %reduce_max.326), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.448 = f32[] divide(%div.447, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_105.1 = f32[1]{0} parameter(105)
  %div.446 = f32[1]{0} divide(%constant.294, %Arg_105.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.162 = f32[1]{0} call(%gt.80, %div.448, %div.446), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %jit__where_.163 = f32[1]{0} call(%is_finite.80, %jit__where_.162, %div.446), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.449 = f32[1]{0} divide(%constant.294, %jit__where_.163), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.283 = bf16[1]{0} convert(%div.449), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.475 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.283), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.476 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.475), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %broadcast_in_dim.477 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.476), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %div.450 = bf16[32,4096,2048]{2,1,0} divide(%sharding_constraint.66, %broadcast_in_dim.477), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_52.3 = bf16[] parameter(52)
  %Arg_53.3 = bf16[] parameter(53)
  %jit_clip_.84 = bf16[32,4096,2048]{2,1,0} call(%div.450, %Arg_52.3, %Arg_53.3), to_apply=%clip_375.85, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %convert_element_type.284 = f8e4m3fn[32,4096,2048]{2,1,0} convert(%jit_clip_.84), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_64.3 = bf16[2048,7168]{1,0} parameter(64)
  %Arg_106.1 = f32[1024]{0} parameter(106)
  %reduce_max.327 = f32[] reduce(%Arg_106.1, %constant.299), dimensions={0}, to_apply=%region_53.86, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %is_finite.81 = pred[] is-finite(%reduce_max.327), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/is_finite" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %gt.81 = pred[] compare(%reduce_max.327, %constant.300), direction=GT, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/gt" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.452 = f32[] divide(%constant.297, %reduce_max.327), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.453 = f32[] divide(%div.452, %constant.298), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_107.1 = f32[1]{0} parameter(107)
  %div.451 = f32[1]{0} divide(%constant.294, %Arg_107.1), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.164 = f32[1]{0} call(%gt.81, %div.453, %div.451), to_apply=%_where_68.7, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %jit__where_.165 = f32[1]{0} call(%is_finite.81, %jit__where_.164, %div.451), to_apply=%_where_71.8, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.454 = f32[1]{0} divide(%constant.294, %jit__where_.165), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.285 = bf16[1]{0} convert(%div.454), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.478 = bf16[2048,1]{1,0} broadcast(%convert_element_type.285), dimensions={1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.479 = bf16[2048]{0} reshape(%broadcast_in_dim.478), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %broadcast_in_dim.480 = bf16[2048,7168]{1,0} broadcast(%broadcast_in_dim.479), dimensions={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %div.455 = bf16[2048,7168]{1,0} divide(%Arg_64.3, %broadcast_in_dim.480), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_54.3 = bf16[] parameter(54)
  %Arg_55.3 = bf16[] parameter(55)
  %jit_clip_.85 = bf16[2048,7168]{1,0} call(%div.455, %Arg_54.3, %Arg_55.3), to_apply=%clip_381.87, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(clip)" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %convert_element_type.286 = f8e4m3fn[2048,7168]{1,0} convert(%jit_clip_.85), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %dot_general.43 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.284, %convert_element_type.286), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/dot_general" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %mul.395 = f32[1]{0} multiply(%div.449, %div.454), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %convert_element_type.287 = bf16[1]{0} convert(%mul.395), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.481 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.287), dimensions={2}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.482 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.481), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %broadcast_in_dim.483 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.482), dimensions={0,1}, metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %mul.396 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.43, %broadcast_in_dim.483), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=488 source_end_line=493 source_column=6 source_end_column=3}
  %add.73 = bf16[32,4096,7168]{2,1,0} add(%mul.389, %mul.396), metadata={op_name="moe_layers/DeepSeekMoeBlock_0/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=2002 source_end_line=2002 source_column=11 source_end_column=42}
  %sharding_constraint.67 = bf16[32,4096,7168]{2,1,0} custom-call(%add.73), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %add.74 = bf16[32,4096,7168]{2,1,0} add(%sharding_constraint.67, %add.71), metadata={op_name="moe_layers/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/deepseek.py" source_line=270 source_end_line=270 source_column=19 source_end_column=48}
  %sharding_constraint.68 = bf16[32,4096,7168]{2,1,0} custom-call(%add.74), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="moe_layers/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %device_put.14 = bf16[32,4096,1536]{2,1,0} custom-call(%mul.328), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.15 = bf16[32,4096,576]{2,1,0} custom-call(%mul.330), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.16 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%sharding_constraint.62), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.17 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%sharding_constraint.63), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.18 = bf16[32,4096,2048]{2,1,0} custom-call(%mul.391), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %device_put.19 = bf16[32,4096,2048]{2,1,0} custom-call(%mul.393), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="pinned_host"}, metadata={op_name="device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  ROOT %tuple.5 = (bf16[32,4096,7168]{2,1,0}, bf16[32,4096,7168]{2,1,0}, bf16[32,4096,1536]{2,1,0}, bf16[32,4096,576]{2,1,0}, bf16[32,4096,7168]{2,1,0}, /*index=5*/bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}, bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}) tuple(%sharding_constraint.68, %reduce_precision.6, %device_put.14, %device_put.15, %reduce_precision.7, /*index=5*/%device_put.16, %device_put.17, %device_put.18, %device_put.19)
}

%region_22.89 (arg_tuple.5: (s32[], bf16[32,4096,7168], bf16[2,32,4096,7168], bf16[2,32,4096,1536], bf16[2,32,4096,576], /*index=5*/bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], bf16[2,32,4096,2048], bf16[2,32,4096,2048], /*index=10*/bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], bf16[2,64,7168,2048], bf16[2,64,2048,7168], /*index=15*/bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], bf16[2,7168], bf16[2,7168], /*index=20*/bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], bf16[2,7168,576], bf16[2,512,128,256], /*index=25*/bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=35*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=65*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=75*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], c64[32,4096,1,32], /*index=80*/c64[32,4096,1,32], s32[1,1,1,513])) -> (s32[], bf16[32,4096,7168], bf16[2,32,4096,7168], bf16[2,32,4096,1536], bf16[2,32,4096,576], /*index=5*/bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], bf16[2,32,4096,2048], bf16[2,32,4096,2048], /*index=10*/bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], bf16[2,64,7168,2048], bf16[2,64,2048,7168], /*index=15*/bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], bf16[2,7168], bf16[2,7168], /*index=20*/bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], bf16[2,7168,576], bf16[2,512,128,256], /*index=25*/bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=35*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=65*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=75*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], c64[32,4096,1,32], /*index=80*/c64[32,4096,1,32], s32[1,1,1,513]) {
  %arg_tuple.5 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, /*index=5*/bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, /*index=10*/bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, /*index=15*/bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, /*index=20*/bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, /*index=25*/bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=35*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=65*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, c64[32,4096,1,32]{3,2,1,0}, /*index=80*/c64[32,4096,1,32]{3,2,1,0}, s32[1,1,1,513]{3,2,1,0}) parameter(0)
  %get-tuple-element.290 = s32[] get-tuple-element(%arg_tuple.5), index=0
  %constant.301 = s32[] constant(1)
  %add.76 = s32[] add(%get-tuple-element.290, %constant.301), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.304 = bf16[] constant(448)
  %constant.303 = bf16[] constant(-448)
  %get-tuple-element.369 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=79
  %get-tuple-element.370 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=80
  %constant.302 = bf16[0]{0} constant({})
  %get-tuple-element.371 = s32[1,1,1,513]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=81
  %get-tuple-element.291 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.5), index=1
  %get-tuple-element.300 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.5), index=10
  %constant.305 = s32[] constant(0)
  %dynamic_slice.153 = bf16[1,7168,64]{2,1,0} dynamic-slice(%get-tuple-element.300, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,7168,64}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.169 = bf16[7168,64]{1,0} reshape(%dynamic_slice.153), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.301 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.5), index=11
  %dynamic_slice.154 = bf16[1,64]{1,0} dynamic-slice(%get-tuple-element.301, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,64}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.170 = bf16[64]{0} reshape(%dynamic_slice.154), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.302 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=12
  %dynamic_slice.155 = bf16[1,64,7168,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.302, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,64,7168,2048}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.171 = bf16[64,7168,2048]{2,1,0} reshape(%dynamic_slice.155), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.303 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=13
  %dynamic_slice.156 = bf16[1,64,7168,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.303, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,64,7168,2048}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.172 = bf16[64,7168,2048]{2,1,0} reshape(%dynamic_slice.156), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.304 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=14
  %dynamic_slice.157 = bf16[1,64,2048,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.304, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,64,2048,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.173 = bf16[64,2048,7168]{2,1,0} reshape(%dynamic_slice.157), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.305 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.5), index=15
  %dynamic_slice.158 = bf16[1,7168,2048]{2,1,0} dynamic-slice(%get-tuple-element.305, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,7168,2048}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.174 = bf16[7168,2048]{1,0} reshape(%dynamic_slice.158), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.306 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.5), index=16
  %dynamic_slice.159 = bf16[1,7168,2048]{2,1,0} dynamic-slice(%get-tuple-element.306, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,7168,2048}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.175 = bf16[7168,2048]{1,0} reshape(%dynamic_slice.159), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.307 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.5), index=17
  %dynamic_slice.160 = bf16[1,2048,7168]{2,1,0} dynamic-slice(%get-tuple-element.307, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,2048,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.176 = bf16[2048,7168]{1,0} reshape(%dynamic_slice.160), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.308 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.5), index=18
  %dynamic_slice.161 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.308, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.177 = bf16[7168]{0} reshape(%dynamic_slice.161), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.309 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.5), index=19
  %dynamic_slice.162 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.309, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.178 = bf16[7168]{0} reshape(%dynamic_slice.162), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.310 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.5), index=20
  %dynamic_slice.163 = bf16[1,512]{1,0} dynamic-slice(%get-tuple-element.310, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,512}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.179 = bf16[512]{0} reshape(%dynamic_slice.163), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.311 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=21
  %dynamic_slice.164 = bf16[1,128,128,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.311, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,128,128,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.180 = bf16[128,128,7168]{2,1,0} reshape(%dynamic_slice.164), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.312 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.5), index=22
  %dynamic_slice.165 = bf16[1,1536]{1,0} dynamic-slice(%get-tuple-element.312, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1536}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.181 = bf16[1536]{0} reshape(%dynamic_slice.165), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.313 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.5), index=23
  %dynamic_slice.166 = bf16[1,7168,576]{2,1,0} dynamic-slice(%get-tuple-element.313, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,7168,576}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.182 = bf16[7168,576]{1,0} reshape(%dynamic_slice.166), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.314 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=24
  %dynamic_slice.167 = bf16[1,512,128,256]{3,2,1,0} dynamic-slice(%get-tuple-element.314, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,512,128,256}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.183 = bf16[512,128,256]{2,1,0} reshape(%dynamic_slice.167), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.315 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.5), index=25
  %dynamic_slice.168 = bf16[1,7168,1536]{2,1,0} dynamic-slice(%get-tuple-element.315, %get-tuple-element.290, %constant.305, %constant.305), dynamic_slice_sizes={1,7168,1536}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.184 = bf16[7168,1536]{1,0} reshape(%dynamic_slice.168), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.316 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=26
  %dynamic_slice.169 = bf16[1,1536,128,192]{3,2,1,0} dynamic-slice(%get-tuple-element.316, %get-tuple-element.290, %constant.305, %constant.305, %constant.305), dynamic_slice_sizes={1,1536,128,192}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.185 = bf16[1536,128,192]{2,1,0} reshape(%dynamic_slice.169), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.317 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=27
  %dynamic_slice.170 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.317, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.186 = f32[1024]{0} reshape(%dynamic_slice.170), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.318 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=28
  %dynamic_slice.171 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.318, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.187 = f32[1]{0} reshape(%dynamic_slice.171), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.319 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=29
  %dynamic_slice.172 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.319, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.188 = f32[1024]{0} reshape(%dynamic_slice.172), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.320 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=30
  %dynamic_slice.173 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.320, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.189 = f32[1]{0} reshape(%dynamic_slice.173), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.321 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=31
  %dynamic_slice.174 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.321, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.190 = f32[1024]{0} reshape(%dynamic_slice.174), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.322 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=32
  %dynamic_slice.175 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.322, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.191 = f32[1]{0} reshape(%dynamic_slice.175), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.323 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=33
  %dynamic_slice.176 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.323, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.192 = f32[1024]{0} reshape(%dynamic_slice.176), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.324 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=34
  %dynamic_slice.177 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.324, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.193 = f32[1]{0} reshape(%dynamic_slice.177), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.325 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=35
  %dynamic_slice.178 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.325, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.194 = f32[1024]{0} reshape(%dynamic_slice.178), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.326 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=36
  %dynamic_slice.179 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.326, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.195 = f32[1]{0} reshape(%dynamic_slice.179), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.327 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=37
  %dynamic_slice.180 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.327, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.196 = f32[1024]{0} reshape(%dynamic_slice.180), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.328 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=38
  %dynamic_slice.181 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.328, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.197 = f32[1024]{0} reshape(%dynamic_slice.181), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.329 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=39
  %dynamic_slice.182 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.329, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.198 = f32[1]{0} reshape(%dynamic_slice.182), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.330 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=40
  %dynamic_slice.183 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.330, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.199 = f32[1]{0} reshape(%dynamic_slice.183), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.331 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=41
  %dynamic_slice.184 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.331, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.200 = f32[1024]{0} reshape(%dynamic_slice.184), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.332 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=42
  %dynamic_slice.185 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.332, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.201 = f32[1]{0} reshape(%dynamic_slice.185), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.333 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=43
  %dynamic_slice.186 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.333, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.202 = f32[1024]{0} reshape(%dynamic_slice.186), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.334 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=44
  %dynamic_slice.187 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.334, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.203 = f32[1]{0} reshape(%dynamic_slice.187), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.335 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=45
  %dynamic_slice.188 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.335, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.204 = f32[1024]{0} reshape(%dynamic_slice.188), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.336 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=46
  %dynamic_slice.189 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.336, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.205 = f32[1]{0} reshape(%dynamic_slice.189), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.337 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=47
  %dynamic_slice.190 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.337, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.206 = f32[1024]{0} reshape(%dynamic_slice.190), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.338 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=48
  %dynamic_slice.191 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.338, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.207 = f32[1]{0} reshape(%dynamic_slice.191), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.339 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=49
  %dynamic_slice.192 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.339, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.208 = f32[1024]{0} reshape(%dynamic_slice.192), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.340 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=50
  %dynamic_slice.193 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.340, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.209 = f32[1]{0} reshape(%dynamic_slice.193), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.341 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=51
  %dynamic_slice.194 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.341, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.210 = f32[1024]{0} reshape(%dynamic_slice.194), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.342 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=52
  %dynamic_slice.195 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.342, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.211 = f32[1]{0} reshape(%dynamic_slice.195), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.343 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=53
  %dynamic_slice.196 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.343, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.212 = f32[1024]{0} reshape(%dynamic_slice.196), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.344 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=54
  %dynamic_slice.197 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.344, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.213 = f32[1]{0} reshape(%dynamic_slice.197), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.345 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=55
  %dynamic_slice.198 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.345, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.214 = f32[1024]{0} reshape(%dynamic_slice.198), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.346 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=56
  %dynamic_slice.199 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.346, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.215 = f32[1]{0} reshape(%dynamic_slice.199), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.347 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=57
  %dynamic_slice.200 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.347, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.216 = f32[1024]{0} reshape(%dynamic_slice.200), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.348 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=58
  %dynamic_slice.201 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.348, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.217 = f32[1]{0} reshape(%dynamic_slice.201), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.349 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=59
  %dynamic_slice.202 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.349, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.218 = f32[1024]{0} reshape(%dynamic_slice.202), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.350 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=60
  %dynamic_slice.203 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.350, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.219 = f32[1]{0} reshape(%dynamic_slice.203), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.351 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=61
  %dynamic_slice.204 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.351, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.220 = f32[1024]{0} reshape(%dynamic_slice.204), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.352 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=62
  %dynamic_slice.205 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.352, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.221 = f32[1]{0} reshape(%dynamic_slice.205), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.353 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=63
  %dynamic_slice.206 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.353, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.222 = f32[1024]{0} reshape(%dynamic_slice.206), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.354 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=64
  %dynamic_slice.207 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.354, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.223 = f32[1024]{0} reshape(%dynamic_slice.207), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.355 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=65
  %dynamic_slice.208 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.355, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.224 = f32[1]{0} reshape(%dynamic_slice.208), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.356 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=66
  %dynamic_slice.209 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.356, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.225 = f32[1]{0} reshape(%dynamic_slice.209), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.357 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=67
  %dynamic_slice.210 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.357, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.226 = f32[1024]{0} reshape(%dynamic_slice.210), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.358 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=68
  %dynamic_slice.211 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.358, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.227 = f32[1]{0} reshape(%dynamic_slice.211), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.359 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=69
  %dynamic_slice.212 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.359, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.228 = f32[1024]{0} reshape(%dynamic_slice.212), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.360 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=70
  %dynamic_slice.213 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.360, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.229 = f32[1]{0} reshape(%dynamic_slice.213), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.361 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=71
  %dynamic_slice.214 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.361, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.230 = f32[1024]{0} reshape(%dynamic_slice.214), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.362 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=72
  %dynamic_slice.215 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.362, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.231 = f32[1]{0} reshape(%dynamic_slice.215), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.363 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=73
  %dynamic_slice.216 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.363, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.232 = f32[1024]{0} reshape(%dynamic_slice.216), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.364 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=74
  %dynamic_slice.217 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.364, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.233 = f32[1]{0} reshape(%dynamic_slice.217), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.365 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=75
  %dynamic_slice.218 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.365, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.234 = f32[1024]{0} reshape(%dynamic_slice.218), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.366 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=76
  %dynamic_slice.219 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.366, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.235 = f32[1]{0} reshape(%dynamic_slice.219), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.367 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.5), index=77
  %dynamic_slice.220 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.367, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.236 = f32[1024]{0} reshape(%dynamic_slice.220), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.368 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.5), index=78
  %dynamic_slice.221 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.368, %get-tuple-element.290, %constant.305), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.237 = f32[1]{0} reshape(%dynamic_slice.221), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.26 = (bf16[32,4096,7168]{2,1,0}, bf16[32,4096,7168]{2,1,0}, bf16[32,4096,1536]{2,1,0}, bf16[32,4096,576]{2,1,0}, bf16[32,4096,7168]{2,1,0}, /*index=5*/bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}, bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}) call(%constant.304, %constant.303, %constant.304, %constant.303, %constant.304, /*index=5*/%constant.303, %constant.304, %constant.303, %get-tuple-element.369, %constant.304, /*index=10*/%constant.303, %constant.304, %constant.303, %constant.304, %constant.303, /*index=15*/%get-tuple-element.370, %constant.302, %constant.304, %constant.303, %constant.304, /*index=20*/%constant.303, %constant.304, %constant.303, %constant.304, %constant.303, /*index=25*/%get-tuple-element.371, %constant.304, %constant.303, %constant.304, %constant.303, /*index=30*/%constant.304, %constant.303, %constant.304, %constant.303, %constant.304, /*index=35*/%constant.303, %constant.304, %constant.303, %constant.304, %constant.303, /*index=40*/%constant.304, %constant.303, %constant.304, %constant.303, %constant.304, /*index=45*/%constant.303, %constant.304, %constant.303, %constant.304, %constant.303, /*index=50*/%constant.304, %constant.303, %constant.304, %constant.303, %constant.304, /*index=55*/%constant.303, %get-tuple-element.291, %squeeze.169, %squeeze.170, %squeeze.171, /*index=60*/%squeeze.172, %squeeze.173, %squeeze.174, %squeeze.175, %squeeze.176, /*index=65*/%squeeze.177, %squeeze.178, %squeeze.179, %squeeze.180, %squeeze.181, /*index=70*/%squeeze.182, %squeeze.183, %squeeze.184, %squeeze.185, %squeeze.186, /*index=75*/%squeeze.187, %squeeze.188, %squeeze.189, %squeeze.190, %squeeze.191, /*index=80*/%squeeze.192, %squeeze.193, %squeeze.194, %squeeze.195, %squeeze.196, /*index=85*/%squeeze.197, %squeeze.198, %squeeze.199, %squeeze.200, %squeeze.201, /*index=90*/%squeeze.202, %squeeze.203, %squeeze.204, %squeeze.205, %squeeze.206, /*index=95*/%squeeze.207, %squeeze.208, %squeeze.209, %squeeze.210, %squeeze.211, /*index=100*/%squeeze.212, %squeeze.213, %squeeze.214, %squeeze.215, %squeeze.216, /*index=105*/%squeeze.217, %squeeze.218, %squeeze.219, %squeeze.220, %squeeze.221, /*index=110*/%squeeze.222, %squeeze.223, %squeeze.224, %squeeze.225, %squeeze.226, /*index=115*/%squeeze.227, %squeeze.228, %squeeze.229, %squeeze.230, %squeeze.231, /*index=120*/%squeeze.232, %squeeze.233, %squeeze.234, %squeeze.235, %squeeze.236, /*index=125*/%squeeze.237), to_apply=%closed_call_272.88, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.27 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.26), index=0, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.292 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=2
  %closed_call.28 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.26), index=1, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.492 = bf16[1,32,4096,7168]{3,2,1,0} reshape(%closed_call.28), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.20 = bf16[2,32,4096,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.292, %broadcast_in_dim.492, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.293 = bf16[2,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=3
  %closed_call.29 = bf16[32,4096,1536]{2,1,0} get-tuple-element(%closed_call.26), index=2, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.493 = bf16[1,32,4096,1536]{3,2,1,0} reshape(%closed_call.29), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.21 = bf16[2,32,4096,1536]{3,2,1,0} dynamic-update-slice(%get-tuple-element.293, %broadcast_in_dim.493, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.294 = bf16[2,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=4
  %closed_call.30 = bf16[32,4096,576]{2,1,0} get-tuple-element(%closed_call.26), index=3, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.494 = bf16[1,32,4096,576]{3,2,1,0} reshape(%closed_call.30), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.22 = bf16[2,32,4096,576]{3,2,1,0} dynamic-update-slice(%get-tuple-element.294, %broadcast_in_dim.494, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.295 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=5
  %closed_call.31 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.26), index=4, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.495 = bf16[1,32,4096,7168]{3,2,1,0} reshape(%closed_call.31), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.23 = bf16[2,32,4096,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.295, %broadcast_in_dim.495, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.296 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.5), index=6
  %closed_call.32 = bf16[64,32,512,2048]{3,2,1,0} get-tuple-element(%closed_call.26), index=5, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.496 = bf16[1,64,32,512,2048]{4,3,2,1,0} reshape(%closed_call.32), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.24 = bf16[2,64,32,512,2048]{4,3,2,1,0} dynamic-update-slice(%get-tuple-element.296, %broadcast_in_dim.496, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305, %constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.297 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.5), index=7
  %closed_call.33 = bf16[64,32,512,2048]{3,2,1,0} get-tuple-element(%closed_call.26), index=6, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.497 = bf16[1,64,32,512,2048]{4,3,2,1,0} reshape(%closed_call.33), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.25 = bf16[2,64,32,512,2048]{4,3,2,1,0} dynamic-update-slice(%get-tuple-element.297, %broadcast_in_dim.497, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305, %constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.298 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=8
  %closed_call.34 = bf16[32,4096,2048]{2,1,0} get-tuple-element(%closed_call.26), index=7, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.498 = bf16[1,32,4096,2048]{3,2,1,0} reshape(%closed_call.34), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.26 = bf16[2,32,4096,2048]{3,2,1,0} dynamic-update-slice(%get-tuple-element.298, %broadcast_in_dim.498, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.299 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.5), index=9
  %closed_call.35 = bf16[32,4096,2048]{2,1,0} get-tuple-element(%closed_call.26), index=8, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.499 = bf16[1,32,4096,2048]{3,2,1,0} reshape(%closed_call.35), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.27 = bf16[2,32,4096,2048]{3,2,1,0} dynamic-update-slice(%get-tuple-element.299, %broadcast_in_dim.499, %get-tuple-element.290, %constant.305, %constant.305, /*index=5*/%constant.305), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  ROOT %tuple.7 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, /*index=5*/bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, /*index=10*/bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, /*index=15*/bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, /*index=20*/bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, /*index=25*/bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=35*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=65*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, c64[32,4096,1,32]{3,2,1,0}, /*index=80*/c64[32,4096,1,32]{3,2,1,0}, s32[1,1,1,513]{3,2,1,0}) tuple(%add.76, %closed_call.27, %dynamic_update_slice.20, %dynamic_update_slice.21, %dynamic_update_slice.22, /*index=5*/%dynamic_update_slice.23, %dynamic_update_slice.24, %dynamic_update_slice.25, %dynamic_update_slice.26, %dynamic_update_slice.27, /*index=10*/%get-tuple-element.300, %get-tuple-element.301, %get-tuple-element.302, %get-tuple-element.303, %get-tuple-element.304, /*index=15*/%get-tuple-element.305, %get-tuple-element.306, %get-tuple-element.307, %get-tuple-element.308, %get-tuple-element.309, /*index=20*/%get-tuple-element.310, %get-tuple-element.311, %get-tuple-element.312, %get-tuple-element.313, %get-tuple-element.314, /*index=25*/%get-tuple-element.315, %get-tuple-element.316, %get-tuple-element.317, %get-tuple-element.318, %get-tuple-element.319, /*index=30*/%get-tuple-element.320, %get-tuple-element.321, %get-tuple-element.322, %get-tuple-element.323, %get-tuple-element.324, /*index=35*/%get-tuple-element.325, %get-tuple-element.326, %get-tuple-element.327, %get-tuple-element.328, %get-tuple-element.329, /*index=40*/%get-tuple-element.330, %get-tuple-element.331, %get-tuple-element.332, %get-tuple-element.333, %get-tuple-element.334, /*index=45*/%get-tuple-element.335, %get-tuple-element.336, %get-tuple-element.337, %get-tuple-element.338, %get-tuple-element.339, /*index=50*/%get-tuple-element.340, %get-tuple-element.341, %get-tuple-element.342, %get-tuple-element.343, %get-tuple-element.344, /*index=55*/%get-tuple-element.345, %get-tuple-element.346, %get-tuple-element.347, %get-tuple-element.348, %get-tuple-element.349, /*index=60*/%get-tuple-element.350, %get-tuple-element.351, %get-tuple-element.352, %get-tuple-element.353, %get-tuple-element.354, /*index=65*/%get-tuple-element.355, %get-tuple-element.356, %get-tuple-element.357, %get-tuple-element.358, %get-tuple-element.359, /*index=70*/%get-tuple-element.360, %get-tuple-element.361, %get-tuple-element.362, %get-tuple-element.363, %get-tuple-element.364, /*index=75*/%get-tuple-element.365, %get-tuple-element.366, %get-tuple-element.367, %get-tuple-element.368, %get-tuple-element.369, /*index=80*/%get-tuple-element.370, %get-tuple-element.371)
}

%region_54.90 (arg_tuple.7: (s32[], bf16[32,4096,7168], bf16[2,32,4096,7168], bf16[2,32,4096,1536], bf16[2,32,4096,576], /*index=5*/bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], bf16[2,32,4096,2048], bf16[2,32,4096,2048], /*index=10*/bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], bf16[2,64,7168,2048], bf16[2,64,2048,7168], /*index=15*/bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], bf16[2,7168], bf16[2,7168], /*index=20*/bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], bf16[2,7168,576], bf16[2,512,128,256], /*index=25*/bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=35*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=65*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=75*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], c64[32,4096,1,32], /*index=80*/c64[32,4096,1,32], s32[1,1,1,513])) -> pred[] {
  %arg_tuple.7 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, /*index=5*/bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, /*index=10*/bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, /*index=15*/bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, /*index=20*/bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, /*index=25*/bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=35*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=65*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, c64[32,4096,1,32]{3,2,1,0}, /*index=80*/c64[32,4096,1,32]{3,2,1,0}, s32[1,1,1,513]{3,2,1,0}) parameter(0)
  %get-tuple-element.455 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.7), index=1
  %get-tuple-element.456 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=2
  %get-tuple-element.457 = bf16[2,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=3
  %get-tuple-element.458 = bf16[2,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=4
  %get-tuple-element.459 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=5
  %get-tuple-element.460 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.7), index=6
  %get-tuple-element.461 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.7), index=7
  %get-tuple-element.462 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=8
  %get-tuple-element.463 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=9
  %get-tuple-element.464 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.7), index=10
  %get-tuple-element.465 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.7), index=11
  %get-tuple-element.466 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=12
  %get-tuple-element.467 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=13
  %get-tuple-element.468 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=14
  %get-tuple-element.469 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.7), index=15
  %get-tuple-element.470 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.7), index=16
  %get-tuple-element.471 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.7), index=17
  %get-tuple-element.472 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.7), index=18
  %get-tuple-element.473 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.7), index=19
  %get-tuple-element.474 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.7), index=20
  %get-tuple-element.475 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=21
  %get-tuple-element.476 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.7), index=22
  %get-tuple-element.477 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.7), index=23
  %get-tuple-element.478 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=24
  %get-tuple-element.479 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.7), index=25
  %get-tuple-element.480 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=26
  %get-tuple-element.481 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=27
  %get-tuple-element.482 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=28
  %get-tuple-element.483 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=29
  %get-tuple-element.484 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=30
  %get-tuple-element.485 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=31
  %get-tuple-element.486 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=32
  %get-tuple-element.487 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=33
  %get-tuple-element.488 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=34
  %get-tuple-element.489 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=35
  %get-tuple-element.490 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=36
  %get-tuple-element.491 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=37
  %get-tuple-element.492 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=38
  %get-tuple-element.493 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=39
  %get-tuple-element.494 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=40
  %get-tuple-element.495 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=41
  %get-tuple-element.496 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=42
  %get-tuple-element.497 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=43
  %get-tuple-element.498 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=44
  %get-tuple-element.499 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=45
  %get-tuple-element.500 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=46
  %get-tuple-element.501 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=47
  %get-tuple-element.502 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=48
  %get-tuple-element.503 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=49
  %get-tuple-element.504 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=50
  %get-tuple-element.505 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=51
  %get-tuple-element.506 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=52
  %get-tuple-element.507 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=53
  %get-tuple-element.508 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=54
  %get-tuple-element.509 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=55
  %get-tuple-element.510 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=56
  %get-tuple-element.511 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=57
  %get-tuple-element.512 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=58
  %get-tuple-element.513 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=59
  %get-tuple-element.514 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=60
  %get-tuple-element.515 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=61
  %get-tuple-element.516 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=62
  %get-tuple-element.517 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=63
  %get-tuple-element.518 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=64
  %get-tuple-element.519 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=65
  %get-tuple-element.520 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=66
  %get-tuple-element.521 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=67
  %get-tuple-element.522 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=68
  %get-tuple-element.523 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=69
  %get-tuple-element.524 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=70
  %get-tuple-element.525 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=71
  %get-tuple-element.526 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=72
  %get-tuple-element.527 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=73
  %get-tuple-element.528 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=74
  %get-tuple-element.529 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=75
  %get-tuple-element.530 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=76
  %get-tuple-element.531 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.7), index=77
  %get-tuple-element.532 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.7), index=78
  %get-tuple-element.533 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=79
  %get-tuple-element.534 = c64[32,4096,1,32]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=80
  %get-tuple-element.535 = s32[1,1,1,513]{3,2,1,0} get-tuple-element(%arg_tuple.7), index=81
  %get-tuple-element.454 = s32[] get-tuple-element(%arg_tuple.7), index=0
  %constant.307 = s32[] constant(2)
  ROOT %lt.8 = pred[] compare(%get-tuple-element.454, %constant.307), direction=LT, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/cond/lt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
}

%region_60.97 (reduce_sum.95: s32[], reduce_sum.96: s32[]) -> s32[] {
  %reduce_sum.95 = s32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.96 = s32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.97 = s32[] add(%reduce_sum.95, %reduce_sum.96), metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=151 source_end_line=151 source_column=18 source_end_column=60}
}

%region_55.91 (reduce_sum.67: f32[], reduce_sum.68: f32[]) -> f32[] {
  %reduce_sum.67 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.68 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.69 = f32[] add(%reduce_sum.67, %reduce_sum.68), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%region_56.93 (reduce_max.331: f32[], reduce_max.332: f32[]) -> f32[] {
  %reduce_max.331 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.332 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.333 = f32[] maximum(%reduce_max.331, %reduce_max.332), metadata={op_name="jit(train_step)/jvp()/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=570 source_end_line=570 source_column=14 source_end_column=48}
}

%region_57.94 (reduce_sum.74: f32[], reduce_sum.75: f32[]) -> f32[] {
  %reduce_sum.74 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.75 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.76 = f32[] add(%reduce_sum.74, %reduce_sum.75), metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=573 source_end_line=573 source_column=12 source_end_column=56}
}

%_one_hot_399.92 (Arg_0.67: s32[32,4096]) -> f32[32,4096,129280] {
  %Arg_0.67 = s32[32,4096]{1,0} parameter(0)
  %broadcast_in_dim.503 = s32[32,4096,1]{2,1,0} reshape(%Arg_0.67), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.21 = s32[32,4096,1]{2,1,0} broadcast(%broadcast_in_dim.503), dimensions={0,1,2}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.22 = s32[32,4096]{1,0} reshape(%eq.21), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.23 = s32[32,4096,129280]{2,1,0} broadcast(%eq.22), dimensions={0,1}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %iota.18 = s32[129280]{0} iota(), iota_dimension=0, metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %iota.19 = s32[1,1,129280]{2,1,0} reshape(%iota.18), metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.24 = s32[1,1,129280]{2,1,0} broadcast(%iota.19), dimensions={0,1,2}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.25 = s32[129280]{0} reshape(%eq.24), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.26 = s32[32,4096,129280]{2,1,0} broadcast(%eq.25), dimensions={2}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %eq.27 = pred[32,4096,129280]{2,1,0} compare(%eq.23, %eq.26), direction=EQ, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  ROOT %convert_element_type.292 = f32[32,4096,129280]{2,1,0} convert(%eq.27), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
}

%region_63.100 (reduce_sum.116: f32[], reduce_sum.117: f32[]) -> f32[] {
  %reduce_sum.116 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.117 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.118 = f32[] add(%reduce_sum.116, %reduce_sum.117), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
}

%region_64.101 (reduce_sum.123: f32[], reduce_sum.124: f32[]) -> f32[] {
  %reduce_sum.123 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.124 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.125 = f32[] add(%reduce_sum.123, %reduce_sum.124), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
}

%silu_544.198 (Arg_0.120: bf16[32,4096,2048]) -> (bf16[32,4096,2048], bf16[32,4096,2048], bf16[32,4096,2048]) {
  %Arg_0.120 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %constant.369 = bf16[] constant(1)
  %broadcast.118 = bf16[32,4096,2048]{2,1,0} broadcast(%constant.369), dimensions={}
  %neg.10 = bf16[32,4096,2048]{2,1,0} negate(%Arg_0.120), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %exp.124 = bf16[32,4096,2048]{2,1,0} exponential(%neg.10), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %add.98 = bf16[32,4096,2048]{2,1,0} add(%exp.124, %broadcast.118), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %div.594 = bf16[32,4096,2048]{2,1,0} divide(%broadcast.118, %add.98), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %mul.530 = bf16[32,4096,2048]{2,1,0} multiply(%Arg_0.120, %div.594), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %sub.32 = bf16[32,4096,2048]{2,1,0} subtract(%broadcast.118, %div.594), metadata={op_name="sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %mul.529 = bf16[32,4096,2048]{2,1,0} multiply(%div.594, %sub.32), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %tuple.11 = (bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}) tuple(%mul.530, %div.594, %mul.529)
}

%region_149.213 (reduce_max.702: f32[], reduce_max.703: f32[]) -> f32[] {
  %reduce_max.702 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.703 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.704 = f32[] maximum(%reduce_max.702, %reduce_max.703), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%_where_552.214 (Arg_0.126: pred[], Arg_1.106: f32[], Arg_2.100: f32[1]) -> f32[1] {
  %Arg_0.126 = pred[] parameter(0)
  %select_n.27 = pred[1]{0} broadcast(%Arg_0.126), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.106 = f32[] parameter(1)
  %broadcast_in_dim.633 = f32[1]{0} reshape(%Arg_1.106), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_2.100 = f32[1]{0} parameter(2)
  ROOT %select_n.28 = f32[1]{0} select(%select_n.27, %broadcast_in_dim.633, %Arg_2.100), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%_where_553.215 (Arg_0.128: pred[], Arg_1.108: f32[1], Arg_2.102: f32[1]) -> f32[1] {
  %Arg_0.128 = pred[] parameter(0)
  %select_n.31 = pred[1]{0} broadcast(%Arg_0.128), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.108 = f32[1]{0} parameter(1)
  %Arg_2.102 = f32[1]{0} parameter(2)
  ROOT %select_n.32 = f32[1]{0} select(%select_n.31, %Arg_1.108, %Arg_2.102), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%clip_555.219 (Arg_0.132: bf16[32,4096,7168], Arg_1.110: bf16[], Arg_2.104: bf16[]) -> bf16[32,4096,7168] {
  %Arg_2.104 = bf16[] parameter(2)
  %min.166 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_2.104), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.110 = bf16[] parameter(1)
  %max.166 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_1.110), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.132 = bf16[32,4096,7168]{2,1,0} parameter(0)
  %max.167 = bf16[32,4096,7168]{2,1,0} maximum(%max.166, %Arg_0.132), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.167 = bf16[32,4096,7168]{2,1,0} minimum(%min.166, %max.167), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_146.209 (reduce_max.688: f32[], reduce_max.689: f32[]) -> f32[] {
  %reduce_max.688 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.689 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.690 = f32[] maximum(%reduce_max.688, %reduce_max.689), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%_where_476.104 (Arg_0.70: pred[], Arg_1.60: f32[], Arg_2.56: f32[1]) -> f32[1] {
  %Arg_0.70 = pred[] parameter(0)
  %select_n.15 = pred[1]{0} broadcast(%Arg_0.70), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.60 = f32[] parameter(1)
  %broadcast_in_dim.514 = f32[1]{0} reshape(%Arg_1.60), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_2.56 = f32[1]{0} parameter(2)
  ROOT %select_n.16 = f32[1]{0} select(%select_n.15, %broadcast_in_dim.514, %Arg_2.56), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%_where_477.105 (Arg_0.72: pred[], Arg_1.62: f32[1], Arg_2.58: f32[1]) -> f32[1] {
  %Arg_0.72 = pred[] parameter(0)
  %select_n.19 = pred[1]{0} broadcast(%Arg_0.72), dimensions={}, metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.62 = f32[1]{0} parameter(1)
  %Arg_2.58 = f32[1]{0} parameter(2)
  ROOT %select_n.20 = f32[1]{0} select(%select_n.19, %Arg_1.62, %Arg_2.58), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%clip_551.212 (Arg_0.124: bf16[2048,7168], Arg_1.104: bf16[], Arg_2.98: bf16[]) -> bf16[2048,7168] {
  %Arg_2.98 = bf16[] parameter(2)
  %min.162 = bf16[2048,7168]{1,0} broadcast(%Arg_2.98), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.104 = bf16[] parameter(1)
  %max.162 = bf16[2048,7168]{1,0} broadcast(%Arg_1.104), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.124 = bf16[2048,7168]{1,0} parameter(0)
  %max.163 = bf16[2048,7168]{1,0} maximum(%max.162, %Arg_0.124), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.163 = bf16[2048,7168]{1,0} minimum(%min.162, %max.163), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_152.220 (reduce_max.716: f32[], reduce_max.717: f32[]) -> f32[] {
  %reduce_max.716 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.717 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.718 = f32[] maximum(%reduce_max.716, %reduce_max.717), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_561.223 (Arg_0.134: bf16[32,4096,2048], Arg_1.112: bf16[], Arg_2.106: bf16[]) -> bf16[32,4096,2048] {
  %Arg_2.106 = bf16[] parameter(2)
  %min.170 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_2.106), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.112 = bf16[] parameter(1)
  %max.170 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_1.112), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.134 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %max.171 = bf16[32,4096,2048]{2,1,0} maximum(%max.170, %Arg_0.134), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.171 = bf16[32,4096,2048]{2,1,0} minimum(%min.170, %max.171), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_140.202 (reduce_max.660: f32[], reduce_max.661: f32[]) -> f32[] {
  %reduce_max.660 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.661 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.662 = f32[] maximum(%reduce_max.660, %reduce_max.661), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_542.197 (Arg_0.118: bf16[7168,2048], Arg_1.100: bf16[], Arg_2.94: bf16[]) -> bf16[7168,2048] {
  %Arg_2.94 = bf16[] parameter(2)
  %min.154 = bf16[7168,2048]{1,0} broadcast(%Arg_2.94), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.100 = bf16[] parameter(1)
  %max.154 = bf16[7168,2048]{1,0} broadcast(%Arg_1.100), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.118 = bf16[7168,2048]{1,0} parameter(0)
  %max.155 = bf16[7168,2048]{1,0} maximum(%max.154, %Arg_0.118), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.155 = bf16[7168,2048]{1,0} minimum(%min.154, %max.155), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%silu_567.224 (Arg_0.136: bf16[32,4096,2048], Arg_1.114: bf16[32,4096,2048], Arg_2.108: bf16[32,4096,2048], Arg_3.6: bf16[32,4096,2048]) -> bf16[32,4096,2048] {
  %Arg_3.6 = bf16[32,4096,2048]{2,1,0} parameter(3)
  %Arg_0.136 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %mul.546 = bf16[32,4096,2048]{2,1,0} multiply(%Arg_3.6, %Arg_0.136), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_1.114 = bf16[32,4096,2048]{2,1,0} parameter(1)
  %mul.545 = bf16[32,4096,2048]{2,1,0} multiply(%Arg_1.114, %Arg_3.6), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_2.108 = bf16[32,4096,2048]{2,1,0} parameter(2)
  %mul.547 = bf16[32,4096,2048]{2,1,0} multiply(%mul.545, %Arg_2.108), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %add_any.2 = bf16[32,4096,2048]{2,1,0} add(%mul.546, %mul.547), metadata={op_name="add_any" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
}

%region_155.225 (reduce_max.730: f32[], reduce_max.731: f32[]) -> f32[] {
  %reduce_max.730 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.731 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.732 = f32[] maximum(%reduce_max.730, %reduce_max.731), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_134.194 (reduce_max.632: f32[], reduce_max.633: f32[]) -> f32[] {
  %reduce_max.632 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.633 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.634 = f32[] maximum(%reduce_max.632, %reduce_max.633), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%silu_531.176 (Arg_0.112: bf16[64,32,512,2048]) -> (bf16[64,32,512,2048], bf16[64,32,512,2048], bf16[64,32,512,2048]) {
  %Arg_0.112 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %constant.367 = bf16[] constant(1)
  %broadcast.116 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%constant.367), dimensions={}
  %neg.8 = bf16[64,32,512,2048]{3,2,1,0} negate(%Arg_0.112), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %exp.122 = bf16[64,32,512,2048]{3,2,1,0} exponential(%neg.8), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %add.96 = bf16[64,32,512,2048]{3,2,1,0} add(%exp.122, %broadcast.116), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %div.562 = bf16[64,32,512,2048]{3,2,1,0} divide(%broadcast.116, %add.96), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %mul.523 = bf16[64,32,512,2048]{3,2,1,0} multiply(%Arg_0.112, %div.562), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %sub.30 = bf16[64,32,512,2048]{3,2,1,0} subtract(%broadcast.116, %div.562), metadata={op_name="sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %mul.522 = bf16[64,32,512,2048]{3,2,1,0} multiply(%div.562, %sub.30), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  ROOT %tuple.9 = (bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}) tuple(%mul.523, %div.562, %mul.522)
}

%region_158.228 (reduce_max.744: f32[], reduce_max.745: f32[]) -> f32[] {
  %reduce_max.744 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.745 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.746 = f32[] maximum(%reduce_max.744, %reduce_max.745), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_97.148 (reduce_sum.151: f32[], reduce_sum.152: f32[]) -> f32[] {
  %reduce_sum.151 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.152 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.153 = f32[] add(%reduce_sum.151, %reduce_sum.152), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_98.149 (reduce_max.464: f32[], reduce_max.465: f32[]) -> f32[] {
  %reduce_max.464 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.465 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.466 = f32[] maximum(%reduce_max.464, %reduce_max.465), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_484.109 (Arg_0.76: bf16[32,4096,7168], Arg_1.64: bf16[], Arg_2.60: bf16[]) -> bf16[32,4096,7168] {
  %Arg_2.60 = bf16[] parameter(2)
  %min.90 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_2.60), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.64 = bf16[] parameter(1)
  %max.90 = bf16[32,4096,7168]{2,1,0} broadcast(%Arg_1.64), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.76 = bf16[32,4096,7168]{2,1,0} parameter(0)
  %max.91 = bf16[32,4096,7168]{2,1,0} maximum(%max.90, %Arg_0.76), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.91 = bf16[32,4096,7168]{2,1,0} minimum(%min.90, %max.91), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_101.152 (reduce_max.478: f32[], reduce_max.479: f32[]) -> f32[] {
  %reduce_max.478 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.479 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.480 = f32[] maximum(%reduce_max.478, %reduce_max.479), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_518.155 (Arg_0.100: bf16[7168,64], Arg_1.88: bf16[], Arg_2.82: bf16[]) -> bf16[7168,64] {
  %Arg_2.82 = bf16[] parameter(2)
  %min.130 = bf16[7168,64]{1,0} broadcast(%Arg_2.82), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.88 = bf16[] parameter(1)
  %max.130 = bf16[7168,64]{1,0} broadcast(%Arg_1.88), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.100 = bf16[7168,64]{1,0} parameter(0)
  %max.131 = bf16[7168,64]{1,0} maximum(%max.130, %Arg_0.100), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.131 = bf16[7168,64]{1,0} minimum(%min.130, %max.131), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%cumsum_519.156 (Arg_0.102: s32[32,4096,64]) -> s32[32,4096,64] {
  %Arg_0.102 = s32[32,4096,64]{2,1,0} parameter(0)
  ROOT %RoutedMoE_generate_masks_from_expert_format.5 = s32[32,4096,64]{2,1,0} call(%Arg_0.102), to_apply=%cumsum_285.60, metadata={op_name="RoutedMoE.generate_masks_from_expert_format" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1388 source_end_line=1388 source_column=25 source_end_column=56}
}

%_one_hot_520.157 (Arg_0.104: s32[32,4096,64]) -> s32[32,4096,64,513] {
  %Arg_0.104 = s32[32,4096,64]{2,1,0} parameter(0)
  %broadcast_in_dim.579 = s32[32,4096,64,1]{3,2,1,0} reshape(%Arg_0.104), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.35 = s32[32,4096,64,1]{3,2,1,0} broadcast(%broadcast_in_dim.579), dimensions={0,1,2,3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.36 = s32[32,4096,64]{2,1,0} reshape(%eq.35), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.37 = s32[32,4096,64,513]{3,2,1,0} broadcast(%eq.36), dimensions={0,1,2}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %iota.28 = s32[513]{0} iota(), iota_dimension=0, metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %iota.29 = s32[1,1,1,513]{3,2,1,0} reshape(%iota.28), metadata={op_name="iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.38 = s32[1,1,1,513]{3,2,1,0} broadcast(%iota.29), dimensions={0,1,2,3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.39 = s32[513]{0} reshape(%eq.38), metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.40 = s32[32,4096,64,513]{3,2,1,0} broadcast(%eq.39), dimensions={3}, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %eq.41 = pred[32,4096,64,513]{3,2,1,0} compare(%eq.37, %eq.40), direction=EQ, metadata={op_name="eq" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  ROOT %convert_element_type.360 = s32[32,4096,64,513]{3,2,1,0} convert(%eq.41), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
}

%region_125.185 (reduce_max.590: f32[], reduce_max.591: f32[]) -> f32[] {
  %reduce_max.590 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.591 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.592 = f32[] maximum(%reduce_max.590, %reduce_max.591), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_523.161 (Arg_0.106: bf16[32,4096,64,512], Arg_1.90: bf16[], Arg_2.84: bf16[]) -> bf16[32,4096,64,512] {
  %Arg_2.84 = bf16[] parameter(2)
  %min.134 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%Arg_2.84), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_1.90 = bf16[] parameter(1)
  %max.134 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%Arg_1.90), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.106 = bf16[32,4096,64,512]{3,2,1,0} parameter(0)
  %max.135 = bf16[32,4096,64,512]{3,2,1,0} maximum(%max.134, %Arg_0.106), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.135 = bf16[32,4096,64,512]{3,2,1,0} minimum(%min.134, %max.135), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_161.231 (reduce_max.758: f32[], reduce_max.759: f32[]) -> f32[] {
  %reduce_max.758 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.759 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.760 = f32[] maximum(%reduce_max.758, %reduce_max.759), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_574.234 (Arg_0.138: bf16[64,32,512,7168], Arg_1.116: bf16[], Arg_2.110: bf16[]) -> bf16[64,32,512,7168] {
  %Arg_2.110 = bf16[] parameter(2)
  %min.174 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_2.110), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.116 = bf16[] parameter(1)
  %max.174 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_1.116), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.138 = bf16[64,32,512,7168]{3,2,1,0} parameter(0)
  %max.175 = bf16[64,32,512,7168]{3,2,1,0} maximum(%max.174, %Arg_0.138), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.175 = bf16[64,32,512,7168]{3,2,1,0} minimum(%min.174, %max.175), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_122.181 (reduce_max.576: f32[], reduce_max.577: f32[]) -> f32[] {
  %reduce_max.576 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.577 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.578 = f32[] maximum(%reduce_max.576, %reduce_max.577), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_539.184 (Arg_0.116: bf16[64,2048,7168], Arg_1.98: bf16[], Arg_2.92: bf16[]) -> bf16[64,2048,7168] {
  %Arg_2.92 = bf16[] parameter(2)
  %min.150 = bf16[64,2048,7168]{2,1,0} broadcast(%Arg_2.92), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_1.98 = bf16[] parameter(1)
  %max.150 = bf16[64,2048,7168]{2,1,0} broadcast(%Arg_1.98), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.116 = bf16[64,2048,7168]{2,1,0} parameter(0)
  %max.151 = bf16[64,2048,7168]{2,1,0} maximum(%max.150, %Arg_0.116), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.151 = bf16[64,2048,7168]{2,1,0} minimum(%min.150, %max.151), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_164.236 (reduce_max.772: f32[], reduce_max.773: f32[]) -> f32[] {
  %reduce_max.772 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.773 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.774 = f32[] maximum(%reduce_max.772, %reduce_max.773), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_582.239 (Arg_0.142: bf16[64,32,512,2048], Arg_1.120: bf16[], Arg_2.114: bf16[]) -> bf16[64,32,512,2048] {
  %Arg_2.114 = bf16[] parameter(2)
  %min.178 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_2.114), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_1.120 = bf16[] parameter(1)
  %max.178 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_1.120), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.142 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %max.179 = bf16[64,32,512,2048]{3,2,1,0} maximum(%max.178, %Arg_0.142), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.179 = bf16[64,32,512,2048]{3,2,1,0} minimum(%min.178, %max.179), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_116.173 (reduce_max.548: f32[], reduce_max.549: f32[]) -> f32[] {
  %reduce_max.548 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.549 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.550 = f32[] maximum(%reduce_max.548, %reduce_max.549), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_529.172 (Arg_0.110: bf16[64,7168,2048], Arg_1.94: bf16[], Arg_2.88: bf16[]) -> bf16[64,7168,2048] {
  %Arg_2.88 = bf16[] parameter(2)
  %min.142 = bf16[64,7168,2048]{2,1,0} broadcast(%Arg_2.88), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_1.94 = bf16[] parameter(1)
  %max.142 = bf16[64,7168,2048]{2,1,0} broadcast(%Arg_1.94), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.110 = bf16[64,7168,2048]{2,1,0} parameter(0)
  %max.143 = bf16[64,7168,2048]{2,1,0} maximum(%max.142, %Arg_0.110), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.143 = bf16[64,7168,2048]{2,1,0} minimum(%min.142, %max.143), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%silu_580.235 (Arg_0.140: bf16[64,32,512,2048], Arg_1.118: bf16[64,32,512,2048], Arg_2.112: bf16[64,32,512,2048], Arg_3.8: bf16[64,32,512,2048]) -> bf16[64,32,512,2048] {
  %Arg_3.8 = bf16[64,32,512,2048]{3,2,1,0} parameter(3)
  %Arg_0.140 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %mul.566 = bf16[64,32,512,2048]{3,2,1,0} multiply(%Arg_3.8, %Arg_0.140), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %Arg_1.118 = bf16[64,32,512,2048]{3,2,1,0} parameter(1)
  %mul.565 = bf16[64,32,512,2048]{3,2,1,0} multiply(%Arg_1.118, %Arg_3.8), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  %Arg_2.112 = bf16[64,32,512,2048]{3,2,1,0} parameter(2)
  %mul.567 = bf16[64,32,512,2048]{3,2,1,0} multiply(%mul.565, %Arg_2.112), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
  ROOT %add_any.5 = bf16[64,32,512,2048]{3,2,1,0} add(%mul.566, %mul.567), metadata={op_name="add_any" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=546 source_end_line=546 source_column=20 source_end_column=48}
}

%region_167.240 (reduce_max.786: f32[], reduce_max.787: f32[]) -> f32[] {
  %reduce_max.786 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.787 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.788 = f32[] maximum(%reduce_max.786, %reduce_max.787), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_113.169 (reduce_max.534: f32[], reduce_max.535: f32[]) -> f32[] {
  %reduce_max.534 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.535 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.536 = f32[] maximum(%reduce_max.534, %reduce_max.535), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_170.243 (reduce_max.800: f32[], reduce_max.801: f32[]) -> f32[] {
  %reduce_max.800 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.801 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.802 = f32[] maximum(%reduce_max.800, %reduce_max.801), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_593.246 (Arg_0.144: bf16[32,64,512,7168], Arg_1.122: bf16[], Arg_2.116: bf16[]) -> bf16[32,64,512,7168] {
  %Arg_2.116 = bf16[] parameter(2)
  %min.182 = bf16[32,64,512,7168]{3,2,1,0} broadcast(%Arg_2.116), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_1.122 = bf16[] parameter(1)
  %max.182 = bf16[32,64,512,7168]{3,2,1,0} broadcast(%Arg_1.122), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.144 = bf16[32,64,512,7168]{3,2,1,0} parameter(0)
  %max.183 = bf16[32,64,512,7168]{3,2,1,0} maximum(%max.182, %Arg_0.144), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.183 = bf16[32,64,512,7168]{3,2,1,0} minimum(%min.182, %max.183), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_104.158 (reduce_max.492: f32[], reduce_max.493: f32[]) -> f32[] {
  %reduce_max.492 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.493 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.494 = f32[] maximum(%reduce_max.492, %reduce_max.493), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_119.177 (reduce_max.562: f32[], reduce_max.563: f32[]) -> f32[] {
  %reduce_max.562 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.563 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.564 = f32[] maximum(%reduce_max.562, %reduce_max.563), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_536.180 (Arg_0.114: bf16[64,32,512,2048], Arg_1.96: bf16[], Arg_2.90: bf16[]) -> bf16[64,32,512,2048] {
  %Arg_2.90 = bf16[] parameter(2)
  %min.146 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_2.90), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_1.96 = bf16[] parameter(1)
  %max.146 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%Arg_1.96), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  %Arg_0.114 = bf16[64,32,512,2048]{3,2,1,0} parameter(0)
  %max.147 = bf16[64,32,512,2048]{3,2,1,0} maximum(%max.146, %Arg_0.114), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
  ROOT %min.147 = bf16[64,32,512,2048]{3,2,1,0} minimum(%min.146, %max.147), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=661 source_end_line=663 source_column=10 source_end_column=49}
}

%region_128.188 (reduce_max.604: f32[], reduce_max.605: f32[]) -> f32[] {
  %reduce_max.604 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.605 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.606 = f32[] maximum(%reduce_max.604, %reduce_max.605), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_526.168 (Arg_0.108: bf16[64,32,512,7168], Arg_1.92: bf16[], Arg_2.86: bf16[]) -> bf16[64,32,512,7168] {
  %Arg_2.86 = bf16[] parameter(2)
  %min.138 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_2.86), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_1.92 = bf16[] parameter(1)
  %max.138 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%Arg_1.92), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %Arg_0.108 = bf16[64,32,512,7168]{3,2,1,0} parameter(0)
  %max.139 = bf16[64,32,512,7168]{3,2,1,0} maximum(%max.138, %Arg_0.108), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %min.139 = bf16[64,32,512,7168]{3,2,1,0} minimum(%min.138, %max.139), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_173.247 (reduce_sum.158: bf16[], reduce_sum.159: bf16[]) -> bf16[] {
  %reduce_sum.158 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.159 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.160 = bf16[] add(%reduce_sum.158, %reduce_sum.159), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_174.248 (reduce_sum.165: bf16[], reduce_sum.166: bf16[]) -> bf16[] {
  %reduce_sum.165 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.166 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.167 = bf16[] add(%reduce_sum.165, %reduce_sum.166), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_175.249 (reduce_max.814: f32[], reduce_max.815: f32[]) -> f32[] {
  %reduce_max.814 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.815 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.816 = f32[] maximum(%reduce_max.814, %reduce_max.815), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_607.252 (Arg_0.146: bf16[32,4096,64], Arg_1.124: bf16[], Arg_2.118: bf16[]) -> bf16[32,4096,64] {
  %Arg_2.118 = bf16[] parameter(2)
  %min.186 = bf16[32,4096,64]{2,1,0} broadcast(%Arg_2.118), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_1.124 = bf16[] parameter(1)
  %max.186 = bf16[32,4096,64]{2,1,0} broadcast(%Arg_1.124), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_0.146 = bf16[32,4096,64]{2,1,0} parameter(0)
  %max.187 = bf16[32,4096,64]{2,1,0} maximum(%max.186, %Arg_0.146), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  ROOT %min.187 = bf16[32,4096,64]{2,1,0} minimum(%min.186, %max.187), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
}

%region_180.255 (reduce_sum.186: f32[], reduce_sum.187: f32[]) -> f32[] {
  %reduce_sum.186 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.187 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.188 = f32[] add(%reduce_sum.186, %reduce_sum.187), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_181.256 (reduce_sum.193: f32[], reduce_sum.194: f32[]) -> f32[] {
  %reduce_sum.193 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.194 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.195 = f32[] add(%reduce_sum.193, %reduce_sum.194), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_76.118 (reduce_sum.137: f32[], reduce_sum.138: f32[]) -> f32[] {
  %reduce_sum.137 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.138 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.139 = f32[] add(%reduce_sum.137, %reduce_sum.138), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_77.119 (reduce_max.380: f32[], reduce_max.381: f32[]) -> f32[] {
  %reduce_max.380 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.381 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.382 = f32[] maximum(%reduce_max.380, %reduce_max.381), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_495.122 (Arg_0.82: bf16[32,4096,1536], Arg_1.70: bf16[], Arg_2.66: bf16[]) -> bf16[32,4096,1536] {
  %Arg_2.66 = bf16[] parameter(2)
  %min.102 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_2.66), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.70 = bf16[] parameter(1)
  %max.102 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_1.70), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.82 = bf16[32,4096,1536]{2,1,0} parameter(0)
  %max.103 = bf16[32,4096,1536]{2,1,0} maximum(%max.102, %Arg_0.82), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.103 = bf16[32,4096,1536]{2,1,0} minimum(%min.102, %max.103), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_80.123 (reduce_max.394: f32[], reduce_max.395: f32[]) -> f32[] {
  %reduce_max.394 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.395 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.396 = f32[] maximum(%reduce_max.394, %reduce_max.395), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_498.126 (Arg_0.84: bf16[1536,128,192], Arg_1.72: bf16[], Arg_2.68: bf16[]) -> bf16[1536,128,192] {
  %Arg_2.68 = bf16[] parameter(2)
  %min.106 = bf16[1536,128,192]{2,1,0} broadcast(%Arg_2.68), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.72 = bf16[] parameter(1)
  %max.106 = bf16[1536,128,192]{2,1,0} broadcast(%Arg_1.72), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.84 = bf16[1536,128,192]{2,1,0} parameter(0)
  %max.107 = bf16[1536,128,192]{2,1,0} maximum(%max.106, %Arg_0.84), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.107 = bf16[1536,128,192]{2,1,0} minimum(%min.106, %max.107), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%clip_499.127 (Arg_0.86: f32[32], Arg_1.74: s32[], Arg_2.70: s32[]) -> f32[32] {
  %Arg_2.70 = s32[] parameter(2)
  %convert_element_type.323 = f32[] convert(%Arg_2.70), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %min.110 = f32[32]{0} broadcast(%convert_element_type.323), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %Arg_1.74 = s32[] parameter(1)
  %convert_element_type.322 = f32[] convert(%Arg_1.74), metadata={op_name="convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %max.110 = f32[32]{0} broadcast(%convert_element_type.322), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %Arg_0.86 = f32[32]{0} parameter(0)
  %max.111 = f32[32]{0} maximum(%max.110, %Arg_0.86), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  ROOT %min.111 = f32[32]{0} minimum(%min.110, %max.111), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
}

%_where_501.128 (Arg_0.89: pred[32,4096], Arg_1.77: s32[32,4096], Arg_2.72: s32[32,4096]) -> s32[32,4096] {
  %Arg_0.89 = pred[32,4096]{1,0} parameter(0)
  %Arg_1.77 = s32[32,4096]{1,0} parameter(1)
  %Arg_2.72 = s32[32,4096]{1,0} parameter(2)
  ROOT %select_n.22 = s32[32,4096]{1,0} select(%Arg_0.89, %Arg_1.77, %Arg_2.72), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%region_83.129 (reduce_and.11: pred[], reduce_and.12: pred[]) -> pred[] {
  %reduce_and.11 = pred[] parameter(0), metadata={op_name="reduce_and"}
  %reduce_and.12 = pred[] parameter(1), metadata={op_name="reduce_and"}
  ROOT %reduce_and.13 = pred[] and(%reduce_and.11, %reduce_and.12), metadata={op_name="reduce_and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%_take_500.130 (Arg_0.90: c64[163840,32], Arg_1.78: s32[32,4096]) -> c64[32,4096,32] {
  %Arg_1.78 = s32[32,4096]{1,0} parameter(1)
  %constant.365 = s32[] constant(0)
  %lt.11 = s32[32,4096]{1,0} broadcast(%constant.365), dimensions={}, metadata={op_name="lt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %lt.12 = pred[32,4096]{1,0} compare(%Arg_1.78, %lt.11), direction=LT, metadata={op_name="lt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.363 = s32[] constant(163840)
  %add.87 = s32[32,4096]{1,0} broadcast(%constant.363), dimensions={}, metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %add.88 = s32[32,4096]{1,0} add(%Arg_1.78, %add.87), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %jit__where_.177 = s32[32,4096]{1,0} call(%lt.12, %add.88, %Arg_1.78), to_apply=%_where_501.128, metadata={op_name="jit(_where)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.541 = s32[32,4096,1]{2,1,0} reshape(%jit__where_.177), metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.362 = s32[] constant(0)
  %ge.6 = s32[32,4096,1]{2,1,0} broadcast(%constant.362), dimensions={}, metadata={op_name="ge" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %ge.7 = pred[32,4096,1]{2,1,0} compare(%broadcast_in_dim.541, %ge.6), direction=GE, metadata={op_name="ge" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.361 = s32[] constant(163839)
  %le.11 = s32[32,4096,1]{2,1,0} broadcast(%constant.361), dimensions={}, metadata={op_name="le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %le.12 = pred[32,4096,1]{2,1,0} compare(%broadcast_in_dim.541, %le.11), direction=LE, metadata={op_name="le" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %and.3 = pred[32,4096,1]{2,1,0} and(%ge.7, %le.12), metadata={op_name="and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.364 = pred[] constant(true)
  %reduce_and.15 = pred[32,4096]{1,0} reduce(%and.3, %constant.364), dimensions={2}, to_apply=%region_83.129, metadata={op_name="reduce_and" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.542 = pred[32,4096,32]{2,1,0} broadcast(%reduce_and.15), dimensions={0,1}, metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %Arg_0.90 = c64[163840,32]{1,0} parameter(0)
  %gather.4 = c64[32,4096,32]{2,1,0} gather(%Arg_0.90, %broadcast_in_dim.541), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,32}, metadata={op_name="gather" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %constant.360 = c64[] constant((nan, 0))
  %broadcast_in_dim.540 = c64[32,4096,32]{2,1,0} broadcast(%constant.360), dimensions={}, metadata={op_name="broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  ROOT %select_n.24 = c64[32,4096,32]{2,1,0} select(%broadcast_in_dim.542, %gather.4, %broadcast_in_dim.540), metadata={op_name="select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
}

%region_84.131 (reduce_sum.144: f32[], reduce_sum.145: f32[]) -> f32[] {
  %reduce_sum.144 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.145 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.146 = f32[] add(%reduce_sum.144, %reduce_sum.145), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_85.132 (reduce_max.408: f32[], reduce_max.409: f32[]) -> f32[] {
  %reduce_max.408 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.409 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.410 = f32[] maximum(%reduce_max.408, %reduce_max.409), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_506.135 (Arg_0.92: bf16[32,4096,512], Arg_1.80: bf16[], Arg_2.74: bf16[]) -> bf16[32,4096,512] {
  %Arg_2.74 = bf16[] parameter(2)
  %min.114 = bf16[32,4096,512]{2,1,0} broadcast(%Arg_2.74), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.80 = bf16[] parameter(1)
  %max.114 = bf16[32,4096,512]{2,1,0} broadcast(%Arg_1.80), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.92 = bf16[32,4096,512]{2,1,0} parameter(0)
  %max.115 = bf16[32,4096,512]{2,1,0} maximum(%max.114, %Arg_0.92), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.115 = bf16[32,4096,512]{2,1,0} minimum(%min.114, %max.115), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_88.136 (reduce_max.422: f32[], reduce_max.423: f32[]) -> f32[] {
  %reduce_max.422 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.423 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.424 = f32[] maximum(%reduce_max.422, %reduce_max.423), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_509.139 (Arg_0.94: bf16[512,128,256], Arg_1.82: bf16[], Arg_2.76: bf16[]) -> bf16[512,128,256] {
  %Arg_2.76 = bf16[] parameter(2)
  %min.118 = bf16[512,128,256]{2,1,0} broadcast(%Arg_2.76), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.82 = bf16[] parameter(1)
  %max.118 = bf16[512,128,256]{2,1,0} broadcast(%Arg_1.82), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.94 = bf16[512,128,256]{2,1,0} parameter(0)
  %max.119 = bf16[512,128,256]{2,1,0} maximum(%max.118, %Arg_0.94), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.119 = bf16[512,128,256]{2,1,0} minimum(%min.118, %max.119), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_182.257 (reduce_max.828: f32[], reduce_max.829: f32[]) -> f32[] {
  %reduce_max.828 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.829 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.830 = f32[] maximum(%reduce_max.828, %reduce_max.829), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_94.144 (reduce_max.450: f32[], reduce_max.451: f32[]) -> f32[] {
  %reduce_max.450 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.451 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.452 = f32[] maximum(%reduce_max.450, %reduce_max.451), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_515.147 (Arg_0.98: bf16[128,128,7168], Arg_1.86: bf16[], Arg_2.80: bf16[]) -> bf16[128,128,7168] {
  %Arg_2.80 = bf16[] parameter(2)
  %min.126 = bf16[128,128,7168]{2,1,0} broadcast(%Arg_2.80), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.86 = bf16[] parameter(1)
  %max.126 = bf16[128,128,7168]{2,1,0} broadcast(%Arg_1.86), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.98 = bf16[128,128,7168]{2,1,0} parameter(0)
  %max.127 = bf16[128,128,7168]{2,1,0} maximum(%max.126, %Arg_0.98), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.127 = bf16[128,128,7168]{2,1,0} minimum(%min.126, %max.127), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_186.261 (reduce_max.842: f32[], reduce_max.843: f32[]) -> f32[] {
  %reduce_max.842 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.843 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.844 = f32[] maximum(%reduce_max.842, %reduce_max.843), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_629.264 (Arg_0.148: bf16[32,4096,128,256], Arg_1.126: bf16[], Arg_2.120: bf16[]) -> bf16[32,4096,128,256] {
  %Arg_2.120 = bf16[] parameter(2)
  %min.190 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%Arg_2.120), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_1.126 = bf16[] parameter(1)
  %max.190 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%Arg_1.126), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_0.148 = bf16[32,4096,128,256]{3,2,1,0} parameter(0)
  %max.191 = bf16[32,4096,128,256]{3,2,1,0} maximum(%max.190, %Arg_0.148), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  ROOT %min.191 = bf16[32,4096,128,256]{3,2,1,0} minimum(%min.190, %max.191), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
}

%region_192.268 (reduce_sum.228: f32[], reduce_sum.229: f32[]) -> f32[] {
  %reduce_sum.228 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.229 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.230 = f32[] add(%reduce_sum.228, %reduce_sum.229), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_193.269 (reduce_sum.235: f32[], reduce_sum.236: f32[]) -> f32[] {
  %reduce_sum.235 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.236 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.237 = f32[] add(%reduce_sum.235, %reduce_sum.236), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_185.260 (reduce_sum.200: bf16[], reduce_sum.201: bf16[]) -> bf16[] {
  %reduce_sum.200 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.201 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.202 = bf16[] add(%reduce_sum.200, %reduce_sum.201), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_189.265 (reduce_sum.207: bf16[], reduce_sum.208: bf16[]) -> bf16[] {
  %reduce_sum.207 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.208 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.209 = bf16[] add(%reduce_sum.207, %reduce_sum.208), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_201.278 (reduce_max.870: f32[], reduce_max.871: f32[]) -> f32[] {
  %reduce_max.870 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.871 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.872 = f32[] maximum(%reduce_max.870, %reduce_max.871), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_689.281 (Arg_0.152: bf16[32,4096,576], Arg_1.130: bf16[], Arg_2.124: bf16[]) -> bf16[32,4096,576] {
  %Arg_2.124 = bf16[] parameter(2)
  %min.198 = bf16[32,4096,576]{2,1,0} broadcast(%Arg_2.124), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %Arg_1.130 = bf16[] parameter(1)
  %max.198 = bf16[32,4096,576]{2,1,0} broadcast(%Arg_1.130), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  %Arg_0.152 = bf16[32,4096,576]{2,1,0} parameter(0)
  %max.199 = bf16[32,4096,576]{2,1,0} maximum(%max.198, %Arg_0.152), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
  ROOT %min.199 = bf16[32,4096,576]{2,1,0} minimum(%min.198, %max.199), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=304 source_end_line=306 source_column=10 source_end_column=49}
}

%region_73.114 (reduce_max.366: f32[], reduce_max.367: f32[]) -> f32[] {
  %reduce_max.366 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.367 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.368 = f32[] maximum(%reduce_max.366, %reduce_max.367), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_490.117 (Arg_0.80: bf16[7168,576], Arg_1.68: bf16[], Arg_2.64: bf16[]) -> bf16[7168,576] {
  %Arg_2.64 = bf16[] parameter(2)
  %min.98 = bf16[7168,576]{1,0} broadcast(%Arg_2.64), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_1.68 = bf16[] parameter(1)
  %max.98 = bf16[7168,576]{1,0} broadcast(%Arg_1.68), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.80 = bf16[7168,576]{1,0} parameter(0)
  %max.99 = bf16[7168,576]{1,0} maximum(%max.98, %Arg_0.80), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.99 = bf16[7168,576]{1,0} minimum(%min.98, %max.99), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_194.270 (reduce_max.856: f32[], reduce_max.857: f32[]) -> f32[] {
  %reduce_max.856 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.857 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.858 = f32[] maximum(%reduce_max.856, %reduce_max.857), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_672.273 (Arg_0.150: bf16[32,4096,128,192], Arg_1.128: bf16[], Arg_2.122: bf16[]) -> bf16[32,4096,128,192] {
  %Arg_2.122 = bf16[] parameter(2)
  %min.194 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%Arg_2.122), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_1.128 = bf16[] parameter(1)
  %max.194 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%Arg_1.128), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  %Arg_0.150 = bf16[32,4096,128,192]{3,2,1,0} parameter(0)
  %max.195 = bf16[32,4096,128,192]{3,2,1,0} maximum(%max.194, %Arg_0.150), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
  ROOT %min.195 = bf16[32,4096,128,192]{3,2,1,0} minimum(%min.194, %max.195), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=476 source_end_line=487 source_column=6 source_end_column=3}
}

%region_199.276 (reduce_sum.256: f32[], reduce_sum.257: f32[]) -> f32[] {
  %reduce_sum.256 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.257 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.258 = f32[] add(%reduce_sum.256, %reduce_sum.257), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_200.277 (reduce_sum.263: f32[], reduce_sum.264: f32[]) -> f32[] {
  %reduce_sum.263 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.264 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.265 = f32[] add(%reduce_sum.263, %reduce_sum.264), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_204.282 (reduce_max.884: f32[], reduce_max.885: f32[]) -> f32[] {
  %reduce_max.884 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.885 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.886 = f32[] maximum(%reduce_max.884, %reduce_max.885), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_697.285 (Arg_0.154: bf16[32,4096,1536], Arg_1.132: bf16[], Arg_2.126: bf16[]) -> bf16[32,4096,1536] {
  %Arg_2.126 = bf16[] parameter(2)
  %min.202 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_2.126), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.132 = bf16[] parameter(1)
  %max.202 = bf16[32,4096,1536]{2,1,0} broadcast(%Arg_1.132), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.154 = bf16[32,4096,1536]{2,1,0} parameter(0)
  %max.203 = bf16[32,4096,1536]{2,1,0} maximum(%max.202, %Arg_0.154), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.203 = bf16[32,4096,1536]{2,1,0} minimum(%min.202, %max.203), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_70.110 (reduce_max.352: f32[], reduce_max.353: f32[]) -> f32[] {
  %reduce_max.352 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.353 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.354 = f32[] maximum(%reduce_max.352, %reduce_max.353), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_487.113 (Arg_0.78: bf16[7168,1536], Arg_1.66: bf16[], Arg_2.62: bf16[]) -> bf16[7168,1536] {
  %Arg_2.62 = bf16[] parameter(2)
  %min.94 = bf16[7168,1536]{1,0} broadcast(%Arg_2.62), dimensions={}, metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_1.66 = bf16[] parameter(1)
  %max.94 = bf16[7168,1536]{1,0} broadcast(%Arg_1.66), dimensions={}, metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  %Arg_0.78 = bf16[7168,1536]{1,0} parameter(0)
  %max.95 = bf16[7168,1536]{1,0} maximum(%max.94, %Arg_0.78), metadata={op_name="max" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
  ROOT %min.95 = bf16[7168,1536]{1,0} minimum(%min.94, %max.95), metadata={op_name="min" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=293 source_end_line=293 source_column=25 source_end_column=132}
}

%region_66.102 (reduce_sum.130: f32[], reduce_sum.131: f32[]) -> f32[] {
  %reduce_sum.130 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.131 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.132 = f32[] add(%reduce_sum.130, %reduce_sum.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_209.288 (reduce_sum.284: f32[], reduce_sum.285: f32[]) -> f32[] {
  %reduce_sum.284 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.285 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.286 = f32[] add(%reduce_sum.284, %reduce_sum.285), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_210.289 (reduce_sum.291: f32[], reduce_sum.292: f32[]) -> f32[] {
  %reduce_sum.291 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.292 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.293 = f32[] add(%reduce_sum.291, %reduce_sum.292), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_107.162 (reduce_max.506: f32[], reduce_max.507: f32[]) -> f32[] {
  %reduce_max.506 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.507 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.508 = f32[] maximum(%reduce_max.506, %reduce_max.507), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_110.165 (reduce_max.520: f32[], reduce_max.521: f32[]) -> f32[] {
  %reduce_max.520 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.521 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.522 = f32[] maximum(%reduce_max.520, %reduce_max.521), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_131.191 (reduce_max.618: f32[], reduce_max.619: f32[]) -> f32[] {
  %reduce_max.618 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.619 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.620 = f32[] maximum(%reduce_max.618, %reduce_max.619), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_137.199 (reduce_max.646: f32[], reduce_max.647: f32[]) -> f32[] {
  %reduce_max.646 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.647 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.648 = f32[] maximum(%reduce_max.646, %reduce_max.647), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_143.205 (reduce_max.674: f32[], reduce_max.675: f32[]) -> f32[] {
  %reduce_max.674 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.675 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.676 = f32[] maximum(%reduce_max.674, %reduce_max.675), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_548.208 (Arg_0.122: bf16[32,4096,2048], Arg_1.102: bf16[], Arg_2.96: bf16[]) -> bf16[32,4096,2048] {
  %Arg_2.96 = bf16[] parameter(2)
  %min.158 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_2.96), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.102 = bf16[] parameter(1)
  %max.158 = bf16[32,4096,2048]{2,1,0} broadcast(%Arg_1.102), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.122 = bf16[32,4096,2048]{2,1,0} parameter(0)
  %max.159 = bf16[32,4096,2048]{2,1,0} maximum(%max.158, %Arg_0.122), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.159 = bf16[32,4096,2048]{2,1,0} minimum(%min.158, %max.159), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_178.253 (reduce_sum.172: bf16[], reduce_sum.173: bf16[]) -> bf16[] {
  %reduce_sum.172 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.173 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.174 = bf16[] add(%reduce_sum.172, %reduce_sum.173), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_179.254 (reduce_sum.179: bf16[], reduce_sum.180: bf16[]) -> bf16[] {
  %reduce_sum.179 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.180 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.181 = bf16[] add(%reduce_sum.179, %reduce_sum.180), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_207.286 (reduce_sum.270: bf16[], reduce_sum.271: bf16[]) -> bf16[] {
  %reduce_sum.270 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.271 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.272 = bf16[] add(%reduce_sum.270, %reduce_sum.271), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_208.287 (reduce_sum.277: bf16[], reduce_sum.278: bf16[]) -> bf16[] {
  %reduce_sum.277 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.278 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.279 = bf16[] add(%reduce_sum.277, %reduce_sum.278), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_190.266 (reduce_sum.214: bf16[], reduce_sum.215: bf16[]) -> bf16[] {
  %reduce_sum.214 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.215 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.216 = bf16[] add(%reduce_sum.214, %reduce_sum.215), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_191.267 (reduce_sum.221: bf16[], reduce_sum.222: bf16[]) -> bf16[] {
  %reduce_sum.221 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.222 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.223 = bf16[] add(%reduce_sum.221, %reduce_sum.222), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_91.140 (reduce_max.436: f32[], reduce_max.437: f32[]) -> f32[] {
  %reduce_max.436 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.437 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.438 = f32[] maximum(%reduce_max.436, %reduce_max.437), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_512.143 (Arg_0.96: bf16[32,4096,128,128], Arg_1.84: bf16[], Arg_2.78: bf16[]) -> bf16[32,4096,128,128] {
  %Arg_2.78 = bf16[] parameter(2)
  %min.122 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%Arg_2.78), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.84 = bf16[] parameter(1)
  %max.122 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%Arg_1.84), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.96 = bf16[32,4096,128,128]{3,2,1,0} parameter(0)
  %max.123 = bf16[32,4096,128,128]{3,2,1,0} maximum(%max.122, %Arg_0.96), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.123 = bf16[32,4096,128,128]{3,2,1,0} minimum(%min.122, %max.123), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_197.274 (reduce_sum.242: bf16[], reduce_sum.243: bf16[]) -> bf16[] {
  %reduce_sum.242 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.243 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.244 = bf16[] add(%reduce_sum.242, %reduce_sum.243), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_198.275 (reduce_sum.249: bf16[], reduce_sum.250: bf16[]) -> bf16[] {
  %reduce_sum.249 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.250 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.251 = bf16[] add(%reduce_sum.249, %reduce_sum.250), metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_67.103 (reduce_max.338: f32[], reduce_max.339: f32[]) -> f32[] {
  %reduce_max.338 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.339 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.340 = f32[] maximum(%reduce_max.338, %reduce_max.339), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%_roll_static.107 (Arg_0.74: f32[1024]) -> f32[1024] {
  %Arg_0.74 = f32[1024]{0} parameter(0)
  %slice.20 = f32[1023]{0} slice(%Arg_0.74), slice={[1:1024]}, metadata={op_name="slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %slice.21 = f32[1]{0} slice(%Arg_0.74), slice={[0:1]}, metadata={op_name="slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %concatenate.17 = f32[1024]{0} concatenate(%slice.20, %slice.21), dimensions={0}, metadata={op_name="concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_99.150 (reduce_max.471: bf16[], reduce_max.472: bf16[]) -> bf16[] {
  %reduce_max.471 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.472 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.473 = bf16[] maximum(%reduce_max.471, %reduce_max.472), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_100.151 (scatter.47: f32[], scatter.48: f32[]) -> f32[] {
  %scatter.47 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.48 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_102.153 (reduce_max.485: bf16[], reduce_max.486: bf16[]) -> bf16[] {
  %reduce_max.485 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.486 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.487 = bf16[] maximum(%reduce_max.485, %reduce_max.486), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_103.154 (scatter.52: f32[], scatter.53: f32[]) -> f32[] {
  %scatter.52 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.53 = f32[] parameter(1), metadata={op_name="scatter"}
}

%_roll_static_554.217 (Arg_0.130: f32[1024]) -> f32[1024] {
  %Arg_0.130 = f32[1024]{0} parameter(0)
  %slice.29 = f32[1023]{0} slice(%Arg_0.130), slice={[1:1024]}, metadata={op_name="slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  %slice.30 = f32[1]{0} slice(%Arg_0.130), slice={[0:1]}, metadata={op_name="slice" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
  ROOT %concatenate.23 = f32[1024]{0} concatenate(%slice.29, %slice.30), dimensions={0}, metadata={op_name="concatenate" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/quantizations.py" source_line=285 source_end_line=287 source_column=23 source_end_column=5}
}

%region_176.250 (reduce_max.821: bf16[], reduce_max.822: bf16[]) -> bf16[] {
  %reduce_max.821 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.822 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.823 = bf16[] maximum(%reduce_max.821, %reduce_max.822), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_177.251 (scatter.172: f32[], scatter.173: f32[]) -> f32[] {
  %scatter.172 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.173 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_105.159 (reduce_max.499: bf16[], reduce_max.500: bf16[]) -> bf16[] {
  %reduce_max.499 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.500 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.501 = bf16[] maximum(%reduce_max.499, %reduce_max.500), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_106.160 (scatter.57: f32[], scatter.58: f32[]) -> f32[] {
  %scatter.57 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.58 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_108.163 (reduce_max.513: bf16[], reduce_max.514: bf16[]) -> bf16[] {
  %reduce_max.513 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.514 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.515 = bf16[] maximum(%reduce_max.513, %reduce_max.514), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_109.164 (scatter.62: f32[], scatter.63: f32[]) -> f32[] {
  %scatter.62 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.63 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_171.244 (reduce_max.807: bf16[], reduce_max.808: bf16[]) -> bf16[] {
  %reduce_max.807 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.808 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.809 = bf16[] maximum(%reduce_max.807, %reduce_max.808), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_172.245 (scatter.167: f32[], scatter.168: f32[]) -> f32[] {
  %scatter.167 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.168 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_111.166 (reduce_max.527: bf16[], reduce_max.528: bf16[]) -> bf16[] {
  %reduce_max.527 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.528 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.529 = bf16[] maximum(%reduce_max.527, %reduce_max.528), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_112.167 (scatter.67: f32[], scatter.68: f32[]) -> f32[] {
  %scatter.67 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.68 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_114.170 (reduce_max.541: bf16[], reduce_max.542: bf16[]) -> bf16[] {
  %reduce_max.541 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.542 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.543 = bf16[] maximum(%reduce_max.541, %reduce_max.542), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_115.171 (scatter.72: f32[], scatter.73: f32[]) -> f32[] {
  %scatter.72 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.73 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_117.174 (reduce_max.555: bf16[], reduce_max.556: bf16[]) -> bf16[] {
  %reduce_max.555 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.556 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.557 = bf16[] maximum(%reduce_max.555, %reduce_max.556), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_118.175 (scatter.77: f32[], scatter.78: f32[]) -> f32[] {
  %scatter.77 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.78 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_168.241 (reduce_max.793: bf16[], reduce_max.794: bf16[]) -> bf16[] {
  %reduce_max.793 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.794 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.795 = bf16[] maximum(%reduce_max.793, %reduce_max.794), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_169.242 (scatter.162: f32[], scatter.163: f32[]) -> f32[] {
  %scatter.162 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.163 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_165.237 (reduce_max.779: bf16[], reduce_max.780: bf16[]) -> bf16[] {
  %reduce_max.779 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.780 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.781 = bf16[] maximum(%reduce_max.779, %reduce_max.780), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_166.238 (scatter.157: f32[], scatter.158: f32[]) -> f32[] {
  %scatter.157 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.158 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_120.178 (reduce_max.569: bf16[], reduce_max.570: bf16[]) -> bf16[] {
  %reduce_max.569 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.570 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.571 = bf16[] maximum(%reduce_max.569, %reduce_max.570), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_121.179 (scatter.82: f32[], scatter.83: f32[]) -> f32[] {
  %scatter.82 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.83 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_123.182 (reduce_max.583: bf16[], reduce_max.584: bf16[]) -> bf16[] {
  %reduce_max.583 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.584 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.585 = bf16[] maximum(%reduce_max.583, %reduce_max.584), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_124.183 (scatter.87: f32[], scatter.88: f32[]) -> f32[] {
  %scatter.87 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.88 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_162.232 (reduce_max.765: bf16[], reduce_max.766: bf16[]) -> bf16[] {
  %reduce_max.765 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.766 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.767 = bf16[] maximum(%reduce_max.765, %reduce_max.766), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_163.233 (scatter.152: f32[], scatter.153: f32[]) -> f32[] {
  %scatter.152 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.153 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_126.186 (reduce_max.597: bf16[], reduce_max.598: bf16[]) -> bf16[] {
  %reduce_max.597 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.598 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.599 = bf16[] maximum(%reduce_max.597, %reduce_max.598), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_127.187 (scatter.92: f32[], scatter.93: f32[]) -> f32[] {
  %scatter.92 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.93 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_129.189 (reduce_max.611: bf16[], reduce_max.612: bf16[]) -> bf16[] {
  %reduce_max.611 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.612 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.613 = bf16[] maximum(%reduce_max.611, %reduce_max.612), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_130.190 (scatter.97: f32[], scatter.98: f32[]) -> f32[] {
  %scatter.97 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.98 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_159.229 (reduce_max.751: bf16[], reduce_max.752: bf16[]) -> bf16[] {
  %reduce_max.751 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.752 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.753 = bf16[] maximum(%reduce_max.751, %reduce_max.752), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_160.230 (scatter.147: f32[], scatter.148: f32[]) -> f32[] {
  %scatter.147 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.148 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_132.192 (reduce_max.625: bf16[], reduce_max.626: bf16[]) -> bf16[] {
  %reduce_max.625 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.626 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.627 = bf16[] maximum(%reduce_max.625, %reduce_max.626), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_133.193 (scatter.102: f32[], scatter.103: f32[]) -> f32[] {
  %scatter.102 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.103 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_135.195 (reduce_max.639: bf16[], reduce_max.640: bf16[]) -> bf16[] {
  %reduce_max.639 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.640 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.641 = bf16[] maximum(%reduce_max.639, %reduce_max.640), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_136.196 (scatter.107: f32[], scatter.108: f32[]) -> f32[] {
  %scatter.107 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.108 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_156.226 (reduce_max.737: bf16[], reduce_max.738: bf16[]) -> bf16[] {
  %reduce_max.737 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.738 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.739 = bf16[] maximum(%reduce_max.737, %reduce_max.738), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_157.227 (scatter.142: f32[], scatter.143: f32[]) -> f32[] {
  %scatter.142 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.143 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_138.200 (reduce_max.653: bf16[], reduce_max.654: bf16[]) -> bf16[] {
  %reduce_max.653 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.654 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.655 = bf16[] maximum(%reduce_max.653, %reduce_max.654), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_139.201 (scatter.112: f32[], scatter.113: f32[]) -> f32[] {
  %scatter.112 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.113 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_141.203 (reduce_max.667: bf16[], reduce_max.668: bf16[]) -> bf16[] {
  %reduce_max.667 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.668 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.669 = bf16[] maximum(%reduce_max.667, %reduce_max.668), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_142.204 (scatter.117: f32[], scatter.118: f32[]) -> f32[] {
  %scatter.117 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.118 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_153.221 (reduce_max.723: bf16[], reduce_max.724: bf16[]) -> bf16[] {
  %reduce_max.723 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.724 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.725 = bf16[] maximum(%reduce_max.723, %reduce_max.724), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_154.222 (scatter.137: f32[], scatter.138: f32[]) -> f32[] {
  %scatter.137 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.138 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_144.206 (reduce_max.681: bf16[], reduce_max.682: bf16[]) -> bf16[] {
  %reduce_max.681 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.682 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.683 = bf16[] maximum(%reduce_max.681, %reduce_max.682), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_145.207 (scatter.122: f32[], scatter.123: f32[]) -> f32[] {
  %scatter.122 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.123 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_147.210 (reduce_max.695: bf16[], reduce_max.696: bf16[]) -> bf16[] {
  %reduce_max.695 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.696 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.697 = bf16[] maximum(%reduce_max.695, %reduce_max.696), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_148.211 (scatter.127: f32[], scatter.128: f32[]) -> f32[] {
  %scatter.127 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.128 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_150.216 (reduce_max.709: bf16[], reduce_max.710: bf16[]) -> bf16[] {
  %reduce_max.709 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.710 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.711 = bf16[] maximum(%reduce_max.709, %reduce_max.710), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_151.218 (scatter.132: f32[], scatter.133: f32[]) -> f32[] {
  %scatter.132 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.133 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_68.106 (reduce_max.345: bf16[], reduce_max.346: bf16[]) -> bf16[] {
  %reduce_max.345 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.346 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.347 = bf16[] maximum(%reduce_max.345, %reduce_max.346), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_69.108 (scatter.2: f32[], scatter.3: f32[]) -> f32[] {
  %scatter.2 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.3 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_71.111 (reduce_max.359: bf16[], reduce_max.360: bf16[]) -> bf16[] {
  %reduce_max.359 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.360 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.361 = bf16[] maximum(%reduce_max.359, %reduce_max.360), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_72.112 (scatter.7: f32[], scatter.8: f32[]) -> f32[] {
  %scatter.7 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.8 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_74.115 (reduce_max.373: bf16[], reduce_max.374: bf16[]) -> bf16[] {
  %reduce_max.373 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.374 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.375 = bf16[] maximum(%reduce_max.373, %reduce_max.374), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_75.116 (scatter.12: f32[], scatter.13: f32[]) -> f32[] {
  %scatter.12 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.13 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_205.283 (reduce_max.891: bf16[], reduce_max.892: bf16[]) -> bf16[] {
  %reduce_max.891 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.892 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.893 = bf16[] maximum(%reduce_max.891, %reduce_max.892), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_206.284 (scatter.197: f32[], scatter.198: f32[]) -> f32[] {
  %scatter.197 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.198 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_202.279 (reduce_max.877: bf16[], reduce_max.878: bf16[]) -> bf16[] {
  %reduce_max.877 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.878 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.879 = bf16[] maximum(%reduce_max.877, %reduce_max.878), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_203.280 (scatter.192: f32[], scatter.193: f32[]) -> f32[] {
  %scatter.192 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.193 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_92.141 (reduce_max.443: bf16[], reduce_max.444: bf16[]) -> bf16[] {
  %reduce_max.443 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.444 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.445 = bf16[] maximum(%reduce_max.443, %reduce_max.444), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_93.142 (scatter.37: f32[], scatter.38: f32[]) -> f32[] {
  %scatter.37 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.38 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_95.145 (reduce_max.457: bf16[], reduce_max.458: bf16[]) -> bf16[] {
  %reduce_max.457 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.458 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.459 = bf16[] maximum(%reduce_max.457, %reduce_max.458), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_96.146 (scatter.42: f32[], scatter.43: f32[]) -> f32[] {
  %scatter.42 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.43 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_183.258 (reduce_max.835: bf16[], reduce_max.836: bf16[]) -> bf16[] {
  %reduce_max.835 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.836 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.837 = bf16[] maximum(%reduce_max.835, %reduce_max.836), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_184.259 (scatter.177: f32[], scatter.178: f32[]) -> f32[] {
  %scatter.177 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.178 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_86.133 (reduce_max.415: bf16[], reduce_max.416: bf16[]) -> bf16[] {
  %reduce_max.415 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.416 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.417 = bf16[] maximum(%reduce_max.415, %reduce_max.416), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_87.134 (scatter.27: f32[], scatter.28: f32[]) -> f32[] {
  %scatter.27 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.28 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_89.137 (reduce_max.429: bf16[], reduce_max.430: bf16[]) -> bf16[] {
  %reduce_max.429 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.430 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.431 = bf16[] maximum(%reduce_max.429, %reduce_max.430), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_90.138 (scatter.32: f32[], scatter.33: f32[]) -> f32[] {
  %scatter.32 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.33 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_187.262 (reduce_max.849: bf16[], reduce_max.850: bf16[]) -> bf16[] {
  %reduce_max.849 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.850 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.851 = bf16[] maximum(%reduce_max.849, %reduce_max.850), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_188.263 (scatter.182: f32[], scatter.183: f32[]) -> f32[] {
  %scatter.182 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.183 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_78.120 (reduce_max.387: bf16[], reduce_max.388: bf16[]) -> bf16[] {
  %reduce_max.387 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.388 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.389 = bf16[] maximum(%reduce_max.387, %reduce_max.388), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_79.121 (scatter.17: f32[], scatter.18: f32[]) -> f32[] {
  %scatter.17 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.18 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_81.124 (reduce_max.401: bf16[], reduce_max.402: bf16[]) -> bf16[] {
  %reduce_max.401 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.402 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.403 = bf16[] maximum(%reduce_max.401, %reduce_max.402), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_82.125 (scatter.22: f32[], scatter.23: f32[]) -> f32[] {
  %scatter.22 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.23 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_195.271 (reduce_max.863: bf16[], reduce_max.864: bf16[]) -> bf16[] {
  %reduce_max.863 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.864 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.865 = bf16[] maximum(%reduce_max.863, %reduce_max.864), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_196.272 (scatter.187: f32[], scatter.188: f32[]) -> f32[] {
  %scatter.187 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.188 = f32[] parameter(1), metadata={op_name="scatter"}
}

%closed_call_475.290 (Arg_0.155: s32[32,4096], Arg_1.133: bf16[32,4096,7168], Arg_2.127: bf16[32,4096,7168], Arg_3.9: bf16[32,4096,1536], Arg_4.5: bf16[32,4096,576], Arg_5.5: bf16[32,4096,7168], Arg_6.5: bf16[64,32,512,2048], Arg_7.5: bf16[64,32,512,2048], Arg_8.5: bf16[32,4096,2048], Arg_9.5: bf16[32,4096,2048], Arg_10.5: f32[1024], Arg_11.5: f32[1], Arg_12.5: f32[1024], Arg_13.5: f32[1], Arg_14.5: f32[1024], Arg_15.5: f32[1], Arg_16.5: f32[1024], Arg_17.5: f32[1], Arg_18.5: f32[1024], Arg_19.5: f32[1], Arg_20.5: f32[1024], Arg_21.5: f32[1], Arg_22.5: f32[1024], Arg_23.5: f32[1], Arg_24.5: f32[1024], Arg_25.5: f32[1024], Arg_26.5: f32[1], Arg_27.5: f32[1], Arg_28.5: f32[1024], Arg_29.5: f32[1024], Arg_30.5: f32[1], Arg_31.5: f32[1], Arg_32.5: f32[1024], Arg_33.5: f32[1], Arg_34.5: f32[1024], Arg_35.5: f32[1], Arg_36.5: f32[1024], Arg_37.5: f32[1], Arg_38.5: f32[1024], Arg_39.5: f32[1], Arg_40.5: f32[1024], Arg_41.5: f32[1], Arg_42.5: f32[1024], Arg_43.5: f32[1], Arg_44.5: f32[1024], Arg_45.5: f32[1], Arg_46.5: f32[1024], Arg_47.5: f32[1], Arg_48.5: f32[1024], Arg_49.5: f32[1], Arg_50.5: f32[1024], Arg_51.5: f32[1], Arg_52.5: f32[1024], Arg_53.5: f32[1], Arg_54.5: f32[1024], Arg_55.5: f32[1], Arg_56.5: f32[1024], Arg_57.5: f32[1], Arg_58.5: f32[1024], Arg_59.5: f32[1], Arg_60.5: f32[1024], Arg_61.5: f32[1], Arg_62.5: f32[1024], Arg_63.5: f32[1], Arg_64.5: f32[1024], Arg_65.5: f32[1024], Arg_66.5: f32[1], Arg_67.5: f32[1], Arg_68.5: f32[1024], Arg_69.5: f32[1024], Arg_70.5: f32[1], Arg_71.5: f32[1], Arg_72.5: f32[1024], Arg_73.5: f32[1], Arg_74.5: f32[1024], Arg_75.5: f32[1], Arg_76.3: f32[1024], Arg_77.3: f32[1], Arg_78.3: f32[1024], Arg_79.3: f32[1], Arg_80.3: f32[1024], Arg_81.3: f32[1], Arg_82.3: f32[1024], Arg_83.3: f32[1], Arg_84.3: f32[1024], Arg_85.3: f32[1], Arg_86.3: f32[1024], Arg_87.3: f32[1], Arg_88.3: f32[1024], Arg_89.3: f32[1], Arg_90.3: bf16[7168,64], Arg_91.3: bf16[64], Arg_92.3: bf16[64,7168,2048], Arg_93.3: bf16[64,7168,2048], Arg_94.3: bf16[64,2048,7168], Arg_95.3: bf16[7168,2048], Arg_96.3: bf16[7168,2048], Arg_97.3: bf16[2048,7168], Arg_98.3: bf16[7168], Arg_99.3: bf16[7168], Arg_100.3: bf16[512], Arg_101.3: bf16[128,128,7168], Arg_102.3: bf16[1536], Arg_103.3: bf16[7168,576], Arg_104.3: bf16[512,128,256], Arg_105.3: bf16[7168,1536], Arg_106.3: bf16[1536,128,192]) -> (bf16[32,4096,7168], bf16[7168,64], bf16[64], bf16[64,7168,2048], bf16[64,7168,2048], /*index=5*/bf16[64,2048,7168], bf16[7168,2048], bf16[7168,2048], bf16[2048,7168], bf16[7168], /*index=10*/bf16[7168], bf16[512], bf16[128,128,7168], bf16[1536], bf16[7168,576], /*index=15*/bf16[512,128,256], bf16[7168,1536], bf16[1536,128,192], f32[1024], f32[1], /*index=20*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=25*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=30*/f32[1024], f32[1], f32[1024], f32[1024], f32[1], /*index=35*/f32[1], f32[1024], f32[1024], f32[1], f32[1], /*index=40*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=45*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=50*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=55*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=60*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=65*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=70*/f32[1024], f32[1], f32[1024], f32[1024], f32[1], /*index=75*/f32[1], f32[1024], f32[1024], f32[1], f32[1], /*index=80*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=85*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=90*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=95*/f32[1], f32[1024], f32[1]) {
  %Arg_1.133 = bf16[32,4096,7168]{2,1,0} parameter(1)
  %sharding_constraint.128 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_1.133), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_8.5 = bf16[32,4096,2048]{2,1,0} parameter(8)
  %device_put.30 = bf16[32,4096,2048]{2,1,0} custom-call(%Arg_8.5), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.20 = (bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}, bf16[32,4096,2048]{2,1,0}) call(%device_put.30), to_apply=%silu_544.198, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.21 = bf16[32,4096,2048]{2,1,0} get-tuple-element(%jit_silu_.20), index=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.129 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.128), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.392 = f32[1]{0} constant({1})
  %Arg_60.5 = f32[1024]{0} parameter(60)
  %constant.411 = f32[] constant(-inf)
  %reduce_max.947 = f32[] reduce(%Arg_60.5, %constant.411), dimensions={0}, to_apply=%region_149.213, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.148 = pred[] is-finite(%reduce_max.947), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.412 = f32[] constant(0)
  %gt.148 = pred[] compare(%reduce_max.947, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.402 = f32[] constant(57344)
  %div.836 = f32[] divide(%constant.402, %reduce_max.947), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.410 = f32[] constant(1)
  %div.837 = f32[] divide(%div.836, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_61.5 = f32[1]{0} parameter(61)
  %div.835 = f32[1]{0} divide(%constant.392, %Arg_61.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.300 = f32[1]{0} call(%gt.148, %div.837, %div.835), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.301 = f32[1]{0} call(%is_finite.148, %jit__where_.300, %div.835), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.838 = f32[1]{0} divide(%constant.392, %jit__where_.301), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.605 = bf16[1]{0} convert(%div.838), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.878 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.605), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.879 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.878), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.880 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.879), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.839 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.129, %broadcast_in_dim.880), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.401 = bf16[] constant(-5.734e+04)
  %constant.400 = bf16[] constant(5.734e+04)
  %jit_clip_.156 = bf16[32,4096,7168]{2,1,0} call(%div.839, %constant.401, %constant.400), to_apply=%clip_555.219, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.606 = f8e5m2[32,4096,7168]{2,1,0} convert(%jit_clip_.156), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_97.3 = bf16[2048,7168]{1,0} parameter(97)
  %Arg_58.5 = f32[1024]{0} parameter(58)
  %reduce_max.945 = f32[] reduce(%Arg_58.5, %constant.411), dimensions={0}, to_apply=%region_146.209, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.147 = pred[] is-finite(%reduce_max.945), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.147 = pred[] compare(%reduce_max.945, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.409 = f32[] constant(448)
  %div.831 = f32[] divide(%constant.409, %reduce_max.945), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.832 = f32[] divide(%div.831, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_59.5 = f32[1]{0} parameter(59)
  %div.830 = f32[1]{0} divide(%constant.392, %Arg_59.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.298 = f32[1]{0} call(%gt.147, %div.832, %div.830), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.299 = f32[1]{0} call(%is_finite.147, %jit__where_.298, %div.830), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.833 = f32[1]{0} divide(%constant.392, %jit__where_.299), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.602 = bf16[1]{0} convert(%div.833), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.875 = bf16[2048,1]{1,0} broadcast(%convert_element_type.602), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.876 = bf16[2048]{0} reshape(%broadcast_in_dim.875), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.877 = bf16[2048,7168]{1,0} broadcast(%broadcast_in_dim.876), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.834 = bf16[2048,7168]{1,0} divide(%Arg_97.3, %broadcast_in_dim.877), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.406 = bf16[] constant(-448)
  %constant.405 = bf16[] constant(448)
  %jit_clip_.155 = bf16[2048,7168]{1,0} call(%div.834, %constant.406, %constant.405), to_apply=%clip_551.212, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.603 = f8e4m3fn[2048,7168]{1,0} convert(%jit_clip_.155), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.84 = bf16[32,4096,2048]{2,1,0} dot(%convert_element_type.606, %convert_element_type.603), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.752 = f32[1]{0} multiply(%div.833, %div.838), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.607 = bf16[1]{0} convert(%mul.752), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.881 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.607), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.882 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.881), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.883 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.882), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.753 = bf16[32,4096,2048]{2,1,0} multiply(%dot_general.84, %broadcast_in_dim.883), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.130 = bf16[32,4096,2048]{2,1,0} custom-call(%mul.753), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.756 = bf16[32,4096,2048]{2,1,0} multiply(%jit_silu_.21, %sharding_constraint.130), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_54.5 = f32[1024]{0} parameter(54)
  %reduce_max.949 = f32[] reduce(%Arg_54.5, %constant.411), dimensions={0}, to_apply=%region_152.220, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.149 = pred[] is-finite(%reduce_max.949), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.149 = pred[] compare(%reduce_max.949, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.841 = f32[] divide(%constant.402, %reduce_max.949), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.842 = f32[] divide(%div.841, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_55.5 = f32[1]{0} parameter(55)
  %div.840 = f32[1]{0} divide(%constant.392, %Arg_55.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.302 = f32[1]{0} call(%gt.149, %div.842, %div.840), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.303 = f32[1]{0} call(%is_finite.149, %jit__where_.302, %div.840), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.843 = f32[1]{0} divide(%constant.392, %jit__where_.303), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.610 = bf16[1]{0} convert(%div.843), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.887 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.610), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.888 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.887), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.889 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.888), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.844 = bf16[32,4096,2048]{2,1,0} divide(%mul.756, %broadcast_in_dim.889), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.157 = bf16[32,4096,2048]{2,1,0} call(%div.844, %constant.401, %constant.400), to_apply=%clip_561.223, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.611 = f8e5m2[32,4096,2048]{2,1,0} convert(%jit_clip_.157), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_96.3 = bf16[7168,2048]{1,0} parameter(96)
  %Arg_52.5 = f32[1024]{0} parameter(52)
  %reduce_max.941 = f32[] reduce(%Arg_52.5, %constant.411), dimensions={0}, to_apply=%region_140.202, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.145 = pred[] is-finite(%reduce_max.941), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.145 = pred[] compare(%reduce_max.941, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.821 = f32[] divide(%constant.409, %reduce_max.941), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.822 = f32[] divide(%div.821, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_53.5 = f32[1]{0} parameter(53)
  %div.820 = f32[1]{0} divide(%constant.392, %Arg_53.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.294 = f32[1]{0} call(%gt.145, %div.822, %div.820), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.295 = f32[1]{0} call(%is_finite.145, %jit__where_.294, %div.820), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.823 = f32[1]{0} divide(%constant.392, %jit__where_.295), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.596 = bf16[1]{0} convert(%div.823), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.869 = bf16[7168,1]{1,0} broadcast(%convert_element_type.596), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.870 = bf16[7168]{0} reshape(%broadcast_in_dim.869), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.871 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.870), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.824 = bf16[7168,2048]{1,0} divide(%Arg_96.3, %broadcast_in_dim.871), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.153 = bf16[7168,2048]{1,0} call(%div.824, %constant.406, %constant.405), to_apply=%clip_542.197, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.597 = f8e4m3fn[7168,2048]{1,0} convert(%jit_clip_.153), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.86 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.611, %convert_element_type.597), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.758 = f32[1]{0} multiply(%div.823, %div.843), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.612 = bf16[1]{0} convert(%mul.758), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.890 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.612), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.891 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.890), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.892 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.891), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.759 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.86, %broadcast_in_dim.892), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.22 = bf16[32,4096,2048]{2,1,0} get-tuple-element(%jit_silu_.20), index=1, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.23 = bf16[32,4096,2048]{2,1,0} get-tuple-element(%jit_silu_.20), index=2, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_9.5 = bf16[32,4096,2048]{2,1,0} parameter(9)
  %device_put.31 = bf16[32,4096,2048]{2,1,0} custom-call(%Arg_9.5), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.757 = bf16[32,4096,2048]{2,1,0} multiply(%sharding_constraint.130, %device_put.31), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.24 = bf16[32,4096,2048]{2,1,0} call(%jit_silu_.22, %device_put.30, %jit_silu_.23, %mul.757), to_apply=%silu_567.224, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_48.5 = f32[1024]{0} parameter(48)
  %reduce_max.951 = f32[] reduce(%Arg_48.5, %constant.411), dimensions={0}, to_apply=%region_155.225, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.150 = pred[] is-finite(%reduce_max.951), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.150 = pred[] compare(%reduce_max.951, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.846 = f32[] divide(%constant.402, %reduce_max.951), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.847 = f32[] divide(%div.846, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_49.5 = f32[1]{0} parameter(49)
  %div.845 = f32[1]{0} divide(%constant.392, %Arg_49.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.304 = f32[1]{0} call(%gt.150, %div.847, %div.845), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.305 = f32[1]{0} call(%is_finite.150, %jit__where_.304, %div.845), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.848 = f32[1]{0} divide(%constant.392, %jit__where_.305), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.615 = bf16[1]{0} convert(%div.848), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.896 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.615), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.897 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.896), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.898 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.897), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.849 = bf16[32,4096,2048]{2,1,0} divide(%jit_silu_.24, %broadcast_in_dim.898), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.158 = bf16[32,4096,2048]{2,1,0} call(%div.849, %constant.401, %constant.400), to_apply=%clip_561.223, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.616 = f8e5m2[32,4096,2048]{2,1,0} convert(%jit_clip_.158), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_95.3 = bf16[7168,2048]{1,0} parameter(95)
  %Arg_46.5 = f32[1024]{0} parameter(46)
  %reduce_max.937 = f32[] reduce(%Arg_46.5, %constant.411), dimensions={0}, to_apply=%region_134.194, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.143 = pred[] is-finite(%reduce_max.937), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.143 = pred[] compare(%reduce_max.937, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.811 = f32[] divide(%constant.409, %reduce_max.937), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.812 = f32[] divide(%div.811, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_47.5 = f32[1]{0} parameter(47)
  %div.810 = f32[1]{0} divide(%constant.392, %Arg_47.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.290 = f32[1]{0} call(%gt.143, %div.812, %div.810), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.291 = f32[1]{0} call(%is_finite.143, %jit__where_.290, %div.810), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.813 = f32[1]{0} divide(%constant.392, %jit__where_.291), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.590 = bf16[1]{0} convert(%div.813), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.863 = bf16[7168,1]{1,0} broadcast(%convert_element_type.590), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.864 = bf16[7168]{0} reshape(%broadcast_in_dim.863), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.865 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.864), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.814 = bf16[7168,2048]{1,0} divide(%Arg_95.3, %broadcast_in_dim.865), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.151 = bf16[7168,2048]{1,0} call(%div.814, %constant.406, %constant.405), to_apply=%clip_542.197, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.591 = f8e4m3fn[7168,2048]{1,0} convert(%jit_clip_.151), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.88 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.616, %convert_element_type.591), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.762 = f32[1]{0} multiply(%div.813, %div.848), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.617 = bf16[1]{0} convert(%mul.762), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.899 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.617), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.900 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.899), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.901 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.900), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.763 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.88, %broadcast_in_dim.901), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.20 = bf16[32,4096,7168]{2,1,0} add(%mul.759, %mul.763), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_6.5 = bf16[64,32,512,2048]{3,2,1,0} parameter(6)
  %device_put.28 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%Arg_6.5), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.16 = (bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}, bf16[64,32,512,2048]{3,2,1,0}) call(%device_put.28), to_apply=%silu_531.176, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.17 = bf16[64,32,512,2048]{3,2,1,0} get-tuple-element(%jit_silu_.16), index=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_42.5 = f32[1024]{0} parameter(42)
  %reduce_max.953 = f32[] reduce(%Arg_42.5, %constant.411), dimensions={0}, to_apply=%region_158.228, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.151 = pred[] is-finite(%reduce_max.953), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.151 = pred[] compare(%reduce_max.953, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.851 = f32[] divide(%constant.402, %reduce_max.953), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.852 = f32[] divide(%div.851, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_43.5 = f32[1]{0} parameter(43)
  %div.850 = f32[1]{0} divide(%constant.392, %Arg_43.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.306 = f32[1]{0} call(%gt.151, %div.852, %div.850), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.307 = f32[1]{0} call(%is_finite.151, %jit__where_.306, %div.850), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.853 = f32[1]{0} divide(%constant.392, %jit__where_.307), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.620 = bf16[1]{0} convert(%div.853), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.905 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.620), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.906 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.905), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.907 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.906), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.854 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.129, %broadcast_in_dim.907), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.159 = bf16[32,4096,7168]{2,1,0} call(%div.854, %constant.401, %constant.400), to_apply=%clip_555.219, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.621 = f8e5m2[32,4096,7168]{2,1,0} convert(%jit_clip_.159), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_2.127 = bf16[32,4096,7168]{2,1,0} parameter(2)
  %Arg_5.5 = bf16[32,4096,7168]{2,1,0} parameter(5)
  %sharding_constraint.117 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_5.5), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.106 = bf16[32,4096,7168]{2,1,0} add(%Arg_2.127, %sharding_constraint.117), metadata={op_name="checkpoint/rematted_computation/moe_layers/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.542 = f32[32,4096,7168]{2,1,0} convert(%add.106), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.25 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.542, %convert_element_type.542), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.298 = f32[32,4096]{1,0} reduce(%square.25, %constant.412), dimensions={2}, to_apply=%region_97.148, metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.815 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.298), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.395 = f32[] constant(7168)
  %broadcast.136 = f32[32,4096,1]{2,1,0} broadcast(%constant.395), dimensions={}
  %div.748 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.815, %broadcast.136), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.394 = f32[] constant(1e-06)
  %broadcast.135 = f32[32,4096,1]{2,1,0} broadcast(%constant.394), dimensions={}
  %add.107 = f32[32,4096,1]{2,1,0} add(%div.748, %broadcast.135), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.24 = f32[32,4096,1]{2,1,0} rsqrt(%add.107), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.728 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.24), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.729 = f32[32,4096]{1,0} reshape(%mul.728), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.730 = f32[32,4096,7168]{2,1,0} broadcast(%mul.729), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.731 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.542, %mul.730), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.543 = bf16[32,4096,7168]{2,1,0} convert(%mul.731), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_98.3 = bf16[7168]{0} parameter(98)
  %broadcast_in_dim.816 = bf16[1,1,7168]{2,1,0} reshape(%Arg_98.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.732 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.816), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.733 = bf16[7168]{0} reshape(%mul.732), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.734 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.733), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.735 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.543, %mul.734), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.118 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.735), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_10.5 = f32[1024]{0} parameter(10)
  %reduce_max.913 = f32[] reduce(%Arg_10.5, %constant.411), dimensions={0}, to_apply=%region_98.149, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.131 = pred[] is-finite(%reduce_max.913), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.131 = pred[] compare(%reduce_max.913, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.751 = f32[] divide(%constant.409, %reduce_max.913), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.752 = f32[] divide(%div.751, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_11.5 = f32[1]{0} parameter(11)
  %div.750 = f32[1]{0} divide(%constant.392, %Arg_11.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.266 = f32[1]{0} call(%gt.131, %div.752, %div.750), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.267 = f32[1]{0} call(%is_finite.131, %jit__where_.266, %div.750), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.753 = f32[1]{0} divide(%constant.392, %jit__where_.267), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.545 = bf16[1]{0} convert(%div.753), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.817 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.545), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.818 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.817), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.819 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.818), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.754 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.118, %broadcast_in_dim.819), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.139 = bf16[32,4096,7168]{2,1,0} call(%div.754, %constant.406, %constant.405), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.546 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.139), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_90.3 = bf16[7168,64]{1,0} parameter(90)
  %Arg_12.5 = f32[1024]{0} parameter(12)
  %reduce_max.915 = f32[] reduce(%Arg_12.5, %constant.411), dimensions={0}, to_apply=%region_101.152, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.132 = pred[] is-finite(%reduce_max.915), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.132 = pred[] compare(%reduce_max.915, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.756 = f32[] divide(%constant.409, %reduce_max.915), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.757 = f32[] divide(%div.756, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_13.5 = f32[1]{0} parameter(13)
  %div.755 = f32[1]{0} divide(%constant.392, %Arg_13.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.268 = f32[1]{0} call(%gt.132, %div.757, %div.755), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.269 = f32[1]{0} call(%is_finite.132, %jit__where_.268, %div.755), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.758 = f32[1]{0} divide(%constant.392, %jit__where_.269), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.548 = bf16[1]{0} convert(%div.758), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.820 = bf16[7168,1]{1,0} broadcast(%convert_element_type.548), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.821 = bf16[7168]{0} reshape(%broadcast_in_dim.820), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.822 = bf16[7168,64]{1,0} broadcast(%broadcast_in_dim.821), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.759 = bf16[7168,64]{1,0} divide(%Arg_90.3, %broadcast_in_dim.822), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.140 = bf16[7168,64]{1,0} call(%div.759, %constant.406, %constant.405), to_apply=%clip_518.155, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.549 = f8e4m3fn[7168,64]{1,0} convert(%jit_clip_.140), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.81 = bf16[32,4096,64]{2,1,0} dot(%convert_element_type.546, %convert_element_type.549), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.736 = f32[1]{0} multiply(%div.753, %div.758), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.550 = bf16[1]{0} convert(%mul.736), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.823 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.550), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.824 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.823), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.825 = bf16[32,4096,64]{2,1,0} broadcast(%broadcast_in_dim.824), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.737 = bf16[32,4096,64]{2,1,0} multiply(%dot_general.81, %broadcast_in_dim.825), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.119 = bf16[32,4096,64]{2,1,0} custom-call(%mul.737), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_91.3 = bf16[64]{0} parameter(91)
  %custom_partitioning.35 = (bf16[32,4096,64]{2,1,0}, pred[32,4096,64]{2,1,0}, bf16[32,4096,64]{2,1,0}) custom-call(%sharding_constraint.119, %Arg_91.3), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281456797909792"
  %custom_partitioning.36 = bf16[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.35), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.37 = pred[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.35), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.551 = s32[32,4096,64]{2,1,0} convert(%custom_partitioning.37), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_cumsum_.3 = s32[32,4096,64]{2,1,0} call(%convert_element_type.551), to_apply=%cumsum_519.156, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(cumsum)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.374 = s32[] constant(512)
  %le.14 = s32[32,4096,64]{2,1,0} broadcast(%constant.374), dimensions={}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/le" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %le.15 = pred[32,4096,64]{2,1,0} compare(%jit_cumsum_.3, %le.14), direction=LE, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/le" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.552 = s32[32,4096,64]{2,1,0} convert(%le.15), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.738 = s32[32,4096,64]{2,1,0} multiply(%convert_element_type.551, %convert_element_type.552), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.553 = bf16[32,4096,64]{2,1,0} convert(%mul.738), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.739 = bf16[32,4096,64]{2,1,0} multiply(%custom_partitioning.36, %convert_element_type.553), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.826 = bf16[32,4096,64,1]{3,2,1,0} reshape(%mul.739), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.742 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%broadcast_in_dim.826), dimensions={0,1,2,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.743 = bf16[32,4096,64]{2,1,0} reshape(%mul.742), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.744 = bf16[32,4096,64,513]{3,2,1,0} broadcast(%mul.743), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.740 = s32[32,4096,64]{2,1,0} multiply(%convert_element_type.551, %jit_cumsum_.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.741 = s32[32,4096,64]{2,1,0} multiply(%mul.740, %mul.738), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__one_hot_.4 = s32[32,4096,64,513]{3,2,1,0} call(%mul.741), to_apply=%_one_hot_520.157, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/jit(_one_hot)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.554 = bf16[32,4096,64,513]{3,2,1,0} convert(%jit__one_hot_.4), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.745 = bf16[32,4096,64,513]{3,2,1,0} multiply(%mul.744, %convert_element_type.554), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.35 = bf16[32,4096,64,512]{3,2,1,0} slice(%mul.745), slice={[0:32], [0:4096], [0:64], [1:513]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.121 = bf16[32,4096,64,512]{3,2,1,0} custom-call(%slice.35), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_38.5 = f32[1024]{0} parameter(38)
  %reduce_max.931 = f32[] reduce(%Arg_38.5, %constant.411), dimensions={0}, to_apply=%region_125.185, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.140 = pred[] is-finite(%reduce_max.931), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.140 = pred[] compare(%reduce_max.931, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.796 = f32[] divide(%constant.409, %reduce_max.931), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.797 = f32[] divide(%div.796, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_39.5 = f32[1]{0} parameter(39)
  %div.795 = f32[1]{0} divide(%constant.392, %Arg_39.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.284 = f32[1]{0} call(%gt.140, %div.797, %div.795), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.285 = f32[1]{0} call(%is_finite.140, %jit__where_.284, %div.795), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.798 = f32[1]{0} divide(%constant.392, %jit__where_.285), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.581 = bf16[1]{0} convert(%div.798), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.854 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%convert_element_type.581), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.855 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.854), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.856 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%broadcast_in_dim.855), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.799 = bf16[32,4096,64,512]{3,2,1,0} divide(%sharding_constraint.121, %broadcast_in_dim.856), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.148 = bf16[32,4096,64,512]{3,2,1,0} call(%div.799, %constant.406, %constant.405), to_apply=%clip_523.161, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.582 = f8e4m3fn[32,4096,64,512]{3,2,1,0} convert(%jit_clip_.148), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.91 = bf16[32,7168,64,512]{3,2,1,0} dot(%convert_element_type.621, %convert_element_type.582), lhs_batch_dims={0}, lhs_contracting_dims={1}, rhs_batch_dims={0}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.52 = bf16[64,32,512,7168]{2,0,3,1} transpose(%dot_general.91), dimensions={2,0,3,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.768 = f32[1]{0} multiply(%div.798, %div.853), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.623 = bf16[1]{0} convert(%mul.768), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.911 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.623), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.912 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.911), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.913 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.912), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.769 = bf16[64,32,512,7168]{2,0,3,1} multiply(%transpose.52, %broadcast_in_dim.913), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.131 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%mul.769), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_36.5 = f32[1024]{0} parameter(36)
  %reduce_max.955 = f32[] reduce(%Arg_36.5, %constant.411), dimensions={0}, to_apply=%region_161.231, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.152 = pred[] is-finite(%reduce_max.955), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.152 = pred[] compare(%reduce_max.955, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.856 = f32[] divide(%constant.402, %reduce_max.955), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.857 = f32[] divide(%div.856, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_37.5 = f32[1]{0} parameter(37)
  %div.855 = f32[1]{0} divide(%constant.392, %Arg_37.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.308 = f32[1]{0} call(%gt.152, %div.857, %div.855), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.309 = f32[1]{0} call(%is_finite.152, %jit__where_.308, %div.855), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.858 = f32[1]{0} divide(%constant.392, %jit__where_.309), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.625 = bf16[1]{0} convert(%div.858), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.914 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.625), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.915 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.914), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.916 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.915), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.859 = bf16[64,32,512,7168]{3,2,1,0} divide(%sharding_constraint.131, %broadcast_in_dim.916), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.160 = bf16[64,32,512,7168]{3,2,1,0} call(%div.859, %constant.401, %constant.400), to_apply=%clip_574.234, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.626 = f8e5m2[64,32,512,7168]{3,2,1,0} convert(%jit_clip_.160), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_94.3 = bf16[64,2048,7168]{2,1,0} parameter(94)
  %sharding_constraint.125 = bf16[64,2048,7168]{2,1,0} custom-call(%Arg_94.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_34.5 = f32[1024]{0} parameter(34)
  %reduce_max.929 = f32[] reduce(%Arg_34.5, %constant.411), dimensions={0}, to_apply=%region_122.181, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.139 = pred[] is-finite(%reduce_max.929), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.139 = pred[] compare(%reduce_max.929, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.791 = f32[] divide(%constant.409, %reduce_max.929), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.792 = f32[] divide(%div.791, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_35.5 = f32[1]{0} parameter(35)
  %div.790 = f32[1]{0} divide(%constant.392, %Arg_35.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.282 = f32[1]{0} call(%gt.139, %div.792, %div.790), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.283 = f32[1]{0} call(%is_finite.139, %jit__where_.282, %div.790), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.793 = f32[1]{0} divide(%constant.392, %jit__where_.283), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.577 = bf16[1]{0} convert(%div.793), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.848 = bf16[64,2048,1]{2,1,0} broadcast(%convert_element_type.577), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.849 = bf16[64,2048]{1,0} reshape(%broadcast_in_dim.848), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.850 = bf16[64,2048,7168]{2,1,0} broadcast(%broadcast_in_dim.849), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.794 = bf16[64,2048,7168]{2,1,0} divide(%sharding_constraint.125, %broadcast_in_dim.850), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.147 = bf16[64,2048,7168]{2,1,0} call(%div.794, %constant.406, %constant.405), to_apply=%clip_539.184, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.578 = f8e4m3fn[64,2048,7168]{2,1,0} convert(%jit_clip_.147), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.92 = bf16[64,32,512,2048]{3,2,1,0} dot(%convert_element_type.626, %convert_element_type.578), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.770 = f32[1]{0} multiply(%div.793, %div.858), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.627 = bf16[1]{0} convert(%mul.770), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.917 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.627), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.918 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.917), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.919 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.918), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.771 = bf16[64,32,512,2048]{3,2,1,0} multiply(%dot_general.92, %broadcast_in_dim.919), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.774 = bf16[64,32,512,2048]{3,2,1,0} multiply(%jit_silu_.17, %mul.771), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/ffn_act/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.133 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%mul.774), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_29.5 = f32[1024]{0} parameter(29)
  %reduce_max.957 = f32[] reduce(%Arg_29.5, %constant.411), dimensions={0}, to_apply=%region_164.236, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.153 = pred[] is-finite(%reduce_max.957), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.153 = pred[] compare(%reduce_max.957, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.861 = f32[] divide(%constant.402, %reduce_max.957), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.862 = f32[] divide(%div.861, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_31.5 = f32[1]{0} parameter(31)
  %div.860 = f32[1]{0} divide(%constant.392, %Arg_31.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.310 = f32[1]{0} call(%gt.153, %div.862, %div.860), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.311 = f32[1]{0} call(%is_finite.153, %jit__where_.310, %div.860), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.863 = f32[1]{0} divide(%constant.392, %jit__where_.311), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.630 = bf16[1]{0} convert(%div.863), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.923 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.630), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.924 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.923), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.925 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.924), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.864 = bf16[64,32,512,2048]{3,2,1,0} divide(%sharding_constraint.133, %broadcast_in_dim.925), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.161 = bf16[64,32,512,2048]{3,2,1,0} call(%div.864, %constant.401, %constant.400), to_apply=%clip_582.239, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.631 = f8e5m2[64,32,512,2048]{3,2,1,0} convert(%jit_clip_.161), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_93.3 = bf16[64,7168,2048]{2,1,0} parameter(93)
  %sharding_constraint.124 = bf16[64,7168,2048]{2,1,0} custom-call(%Arg_93.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_25.5 = f32[1024]{0} parameter(25)
  %reduce_max.925 = f32[] reduce(%Arg_25.5, %constant.411), dimensions={0}, to_apply=%region_116.173, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.137 = pred[] is-finite(%reduce_max.925), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.137 = pred[] compare(%reduce_max.925, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.781 = f32[] divide(%constant.409, %reduce_max.925), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.782 = f32[] divide(%div.781, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_27.5 = f32[1]{0} parameter(27)
  %div.780 = f32[1]{0} divide(%constant.392, %Arg_27.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.278 = f32[1]{0} call(%gt.137, %div.782, %div.780), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.279 = f32[1]{0} call(%is_finite.137, %jit__where_.278, %div.780), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.783 = f32[1]{0} divide(%constant.392, %jit__where_.279), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.571 = bf16[1]{0} convert(%div.783), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.842 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.571), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.843 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.842), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.844 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.843), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.784 = bf16[64,7168,2048]{2,1,0} divide(%sharding_constraint.124, %broadcast_in_dim.844), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.145 = bf16[64,7168,2048]{2,1,0} call(%div.784, %constant.406, %constant.405), to_apply=%clip_529.172, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.572 = f8e4m3fn[64,7168,2048]{2,1,0} convert(%jit_clip_.145), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.94 = bf16[64,32,512,7168]{3,2,1,0} dot(%convert_element_type.631, %convert_element_type.572), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.776 = f32[1]{0} multiply(%div.783, %div.863), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.632 = bf16[1]{0} convert(%mul.776), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.926 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.632), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.927 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.926), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.928 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.927), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.777 = bf16[64,32,512,7168]{3,2,1,0} multiply(%dot_general.94, %broadcast_in_dim.928), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.18 = bf16[64,32,512,2048]{3,2,1,0} get-tuple-element(%jit_silu_.16), index=1, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.19 = bf16[64,32,512,2048]{3,2,1,0} get-tuple-element(%jit_silu_.16), index=2, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_7.5 = bf16[64,32,512,2048]{3,2,1,0} parameter(7)
  %device_put.29 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%Arg_7.5), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.775 = bf16[64,32,512,2048]{3,2,1,0} multiply(%mul.771, %device_put.29), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/ffn_act/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.25 = bf16[64,32,512,2048]{3,2,1,0} call(%jit_silu_.18, %device_put.28, %jit_silu_.19, %mul.775), to_apply=%silu_580.235, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/ffn_act/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.134 = bf16[64,32,512,2048]{3,2,1,0} custom-call(%jit_silu_.25), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_28.5 = f32[1024]{0} parameter(28)
  %reduce_max.959 = f32[] reduce(%Arg_28.5, %constant.411), dimensions={0}, to_apply=%region_167.240, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.154 = pred[] is-finite(%reduce_max.959), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.154 = pred[] compare(%reduce_max.959, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.866 = f32[] divide(%constant.402, %reduce_max.959), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.867 = f32[] divide(%div.866, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_30.5 = f32[1]{0} parameter(30)
  %div.865 = f32[1]{0} divide(%constant.392, %Arg_30.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.312 = f32[1]{0} call(%gt.154, %div.867, %div.865), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.313 = f32[1]{0} call(%is_finite.154, %jit__where_.312, %div.865), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.868 = f32[1]{0} divide(%constant.392, %jit__where_.313), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.635 = bf16[1]{0} convert(%div.868), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.932 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.635), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.933 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.932), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.934 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.933), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.869 = bf16[64,32,512,2048]{3,2,1,0} divide(%sharding_constraint.134, %broadcast_in_dim.934), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.162 = bf16[64,32,512,2048]{3,2,1,0} call(%div.869, %constant.401, %constant.400), to_apply=%clip_582.239, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.636 = f8e5m2[64,32,512,2048]{3,2,1,0} convert(%jit_clip_.162), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_92.3 = bf16[64,7168,2048]{2,1,0} parameter(92)
  %sharding_constraint.123 = bf16[64,7168,2048]{2,1,0} custom-call(%Arg_92.3), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_24.5 = f32[1024]{0} parameter(24)
  %reduce_max.923 = f32[] reduce(%Arg_24.5, %constant.411), dimensions={0}, to_apply=%region_113.169, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.136 = pred[] is-finite(%reduce_max.923), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.136 = pred[] compare(%reduce_max.923, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.776 = f32[] divide(%constant.409, %reduce_max.923), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.777 = f32[] divide(%div.776, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_26.5 = f32[1]{0} parameter(26)
  %div.775 = f32[1]{0} divide(%constant.392, %Arg_26.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.276 = f32[1]{0} call(%gt.136, %div.777, %div.775), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.277 = f32[1]{0} call(%is_finite.136, %jit__where_.276, %div.775), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.778 = f32[1]{0} divide(%constant.392, %jit__where_.277), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.568 = bf16[1]{0} convert(%div.778), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.839 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.568), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.840 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.839), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.841 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.840), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.779 = bf16[64,7168,2048]{2,1,0} divide(%sharding_constraint.123, %broadcast_in_dim.841), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.144 = bf16[64,7168,2048]{2,1,0} call(%div.779, %constant.406, %constant.405), to_apply=%clip_529.172, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.569 = f8e4m3fn[64,7168,2048]{2,1,0} convert(%jit_clip_.144), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.96 = bf16[64,32,512,7168]{3,2,1,0} dot(%convert_element_type.636, %convert_element_type.569), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.780 = f32[1]{0} multiply(%div.778, %div.868), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.637 = bf16[1]{0} convert(%mul.780), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.935 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.637), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.936 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.935), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.937 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.936), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.781 = bf16[64,32,512,7168]{3,2,1,0} multiply(%dot_general.96, %broadcast_in_dim.937), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.21 = bf16[64,32,512,7168]{3,2,1,0} add(%mul.777, %mul.781), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.137 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%add_any.21), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.56 = bf16[32,64,512,7168]{3,2,0,1} transpose(%sharding_constraint.137), dimensions={1,0,2,3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_20.5 = f32[1024]{0} parameter(20)
  %reduce_max.961 = f32[] reduce(%Arg_20.5, %constant.411), dimensions={0}, to_apply=%region_170.243, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.155 = pred[] is-finite(%reduce_max.961), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.155 = pred[] compare(%reduce_max.961, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.871 = f32[] divide(%constant.402, %reduce_max.961), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.872 = f32[] divide(%div.871, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_21.5 = f32[1]{0} parameter(21)
  %div.870 = f32[1]{0} divide(%constant.392, %Arg_21.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.314 = f32[1]{0} call(%gt.155, %div.872, %div.870), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.315 = f32[1]{0} call(%is_finite.155, %jit__where_.314, %div.870), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.873 = f32[1]{0} divide(%constant.392, %jit__where_.315), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.640 = bf16[1]{0} convert(%div.873), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.941 = bf16[32,64,512,1]{3,2,1,0} broadcast(%convert_element_type.640), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.942 = bf16[32,64,512]{2,1,0} reshape(%broadcast_in_dim.941), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.943 = bf16[32,64,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.942), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.874 = bf16[32,64,512,7168]{3,2,0,1} divide(%transpose.56, %broadcast_in_dim.943), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.163 = bf16[32,64,512,7168]{3,2,1,0} call(%div.874, %constant.401, %constant.400), to_apply=%clip_593.246, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.641 = f8e5m2[32,64,512,7168]{3,2,1,0} convert(%jit_clip_.163), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.373 = bf16[] constant(0)
  %convert_element_type.498 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%constant.373), dimensions={}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.555 = pred[32,4096,64,512]{3,2,1,0} compare(%slice.35, %convert_element_type.498), direction=NE, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.120 = pred[32,4096,64,512]{3,2,1,0} custom-call(%convert_element_type.555), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.556 = bf16[32,4096,64,512]{3,2,1,0} convert(%sharding_constraint.120), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_16.5 = f32[1024]{0} parameter(16)
  %reduce_max.917 = f32[] reduce(%Arg_16.5, %constant.411), dimensions={0}, to_apply=%region_104.158, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.133 = pred[] is-finite(%reduce_max.917), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.133 = pred[] compare(%reduce_max.917, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.761 = f32[] divide(%constant.409, %reduce_max.917), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.762 = f32[] divide(%div.761, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_17.5 = f32[1]{0} parameter(17)
  %div.760 = f32[1]{0} divide(%constant.392, %Arg_17.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.270 = f32[1]{0} call(%gt.133, %div.762, %div.760), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.271 = f32[1]{0} call(%is_finite.133, %jit__where_.270, %div.760), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.763 = f32[1]{0} divide(%constant.392, %jit__where_.271), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.558 = bf16[1]{0} convert(%div.763), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.827 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%convert_element_type.558), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.828 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.827), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.829 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%broadcast_in_dim.828), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.764 = bf16[32,4096,64,512]{3,2,1,0} divide(%convert_element_type.556, %broadcast_in_dim.829), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.141 = bf16[32,4096,64,512]{3,2,1,0} call(%div.764, %constant.406, %constant.405), to_apply=%clip_523.161, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.559 = f8e4m3fn[32,4096,64,512]{3,2,1,0} convert(%jit_clip_.141), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.98 = bf16[32,7168,4096]{2,1,0} dot(%convert_element_type.641, %convert_element_type.559), lhs_batch_dims={0}, lhs_contracting_dims={1,2}, rhs_batch_dims={0}, rhs_contracting_dims={2,3}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.57 = bf16[32,4096,7168]{1,2,0} transpose(%dot_general.98), dimensions={0,2,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.784 = f32[1]{0} multiply(%div.763, %div.873), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.642 = bf16[1]{0} convert(%mul.784), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.944 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.642), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.945 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.944), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.946 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.945), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.785 = bf16[32,4096,7168]{1,2,0} multiply(%transpose.57, %broadcast_in_dim.946), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.22 = bf16[32,4096,7168]{2,1,0} add(%add_any.20, %mul.785), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.38 = bf16[32,4096,64]{2,1,0} get-tuple-element(%custom_partitioning.35), index=2, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [k])->([i, j, k], [i, j, k], [i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.748 = bf16[64,32,512,2048]{3,2,1,0} multiply(%jit_silu_.17, %device_put.29), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/ffn_act/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_32.5 = f32[1024]{0} parameter(32)
  %reduce_max.927 = f32[] reduce(%Arg_32.5, %constant.411), dimensions={0}, to_apply=%region_119.177, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.138 = pred[] is-finite(%reduce_max.927), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.138 = pred[] compare(%reduce_max.927, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.786 = f32[] divide(%constant.409, %reduce_max.927), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.787 = f32[] divide(%div.786, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_33.5 = f32[1]{0} parameter(33)
  %div.785 = f32[1]{0} divide(%constant.392, %Arg_33.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.280 = f32[1]{0} call(%gt.138, %div.787, %div.785), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.281 = f32[1]{0} call(%is_finite.138, %jit__where_.280, %div.785), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.788 = f32[1]{0} divide(%constant.392, %jit__where_.281), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.574 = bf16[1]{0} convert(%div.788), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.845 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.574), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.846 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.845), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.847 = bf16[64,32,512,2048]{3,2,1,0} broadcast(%broadcast_in_dim.846), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.789 = bf16[64,32,512,2048]{3,2,1,0} divide(%mul.748, %broadcast_in_dim.847), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.146 = bf16[64,32,512,2048]{3,2,1,0} call(%div.789, %constant.406, %constant.405), to_apply=%clip_536.180, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.575 = f8e4m3fn[64,32,512,2048]{3,2,1,0} convert(%jit_clip_.146), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.83 = bf16[64,32,512,7168]{3,2,1,0} dot(%convert_element_type.575, %convert_element_type.578), lhs_batch_dims={0}, lhs_contracting_dims={3}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.749 = f32[1]{0} multiply(%div.788, %div.793), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.579 = bf16[1]{0} convert(%mul.749), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.851 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.579), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.852 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.851), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.853 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.852), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.750 = bf16[64,32,512,7168]{3,2,1,0} multiply(%dot_general.83, %broadcast_in_dim.853), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.126 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%mul.750), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_40.5 = f32[1024]{0} parameter(40)
  %reduce_max.933 = f32[] reduce(%Arg_40.5, %constant.411), dimensions={0}, to_apply=%region_128.188, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.141 = pred[] is-finite(%reduce_max.933), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.141 = pred[] compare(%reduce_max.933, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.801 = f32[] divide(%constant.409, %reduce_max.933), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.802 = f32[] divide(%div.801, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_41.5 = f32[1]{0} parameter(41)
  %div.800 = f32[1]{0} divide(%constant.392, %Arg_41.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.286 = f32[1]{0} call(%gt.141, %div.802, %div.800), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.287 = f32[1]{0} call(%is_finite.141, %jit__where_.286, %div.800), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.803 = f32[1]{0} divide(%constant.392, %jit__where_.287), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.584 = bf16[1]{0} convert(%div.803), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.857 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.584), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.858 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.857), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.859 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.858), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.804 = bf16[64,32,512,7168]{3,2,1,0} divide(%sharding_constraint.126, %broadcast_in_dim.859), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.149 = bf16[64,32,512,7168]{3,2,1,0} call(%div.804, %constant.406, %constant.405), to_apply=%clip_526.168, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.585 = f8e4m3fn[64,32,512,7168]{3,2,1,0} convert(%jit_clip_.149), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.90 = bf16[32,4096,64,512]{3,2,1,0} dot(%convert_element_type.621, %convert_element_type.585), lhs_batch_dims={0}, lhs_contracting_dims={2}, rhs_batch_dims={1}, rhs_contracting_dims={3}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.766 = f32[1]{0} multiply(%div.803, %div.853), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.622 = bf16[1]{0} convert(%mul.766), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.908 = bf16[32,4096,64,1]{3,2,1,0} broadcast(%convert_element_type.622), dimensions={3}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.909 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.908), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.910 = bf16[32,4096,64,512]{3,2,1,0} broadcast(%broadcast_in_dim.909), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.767 = bf16[32,4096,64,512]{3,2,1,0} multiply(%dot_general.90, %broadcast_in_dim.910), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.138 = bf16[32,4096,64,512]{3,2,1,0} custom-call(%mul.767), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.403 = bf16[] constant(0)
  %pad.5 = bf16[32,4096,64,513]{3,2,1,0} pad(%sharding_constraint.138, %constant.403), padding=0_0x0_0x0_0x1_0, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.786 = bf16[32,4096,64,513]{3,2,1,0} multiply(%pad.5, %convert_element_type.554), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.299 = bf16[32,4096,64]{2,1,0} reduce(%mul.786, %constant.403), dimensions={3}, to_apply=%region_173.247, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.25 = bf16[32,4096,64,1]{3,2,1,0} reshape(%reduce_sum.299), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.300 = bf16[32,4096,64]{2,1,0} reduce(%reshape.25, %constant.403), dimensions={3}, to_apply=%region_174.248, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.787 = bf16[32,4096,64]{2,1,0} multiply(%reduce_sum.300, %convert_element_type.553), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.39 = bf16[32,4096,64]{2,1,0} custom-call(%custom_partitioning.37, %custom_partitioning.38, %mul.787), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k], [i, j, k], [i, j, k])->([i, j, k]) {i=32, j=4096, k=64}, custom>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281458267806352"
  %sharding_constraint.139 = bf16[32,4096,64]{2,1,0} custom-call(%custom_partitioning.39), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_14.5 = f32[1024]{0} parameter(14)
  %reduce_max.963 = f32[] reduce(%Arg_14.5, %constant.411), dimensions={0}, to_apply=%region_175.249, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.156 = pred[] is-finite(%reduce_max.963), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.156 = pred[] compare(%reduce_max.963, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.876 = f32[] divide(%constant.402, %reduce_max.963), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.877 = f32[] divide(%div.876, %constant.410), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_15.5 = f32[1]{0} parameter(15)
  %div.875 = f32[1]{0} divide(%constant.392, %Arg_15.5), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.316 = f32[1]{0} call(%gt.156, %div.877, %div.875), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.317 = f32[1]{0} call(%is_finite.156, %jit__where_.316, %div.875), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.878 = f32[1]{0} divide(%constant.392, %jit__where_.317), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.644 = bf16[1]{0} convert(%div.878), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.947 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.644), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.948 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.947), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.949 = bf16[32,4096,64]{2,1,0} broadcast(%broadcast_in_dim.948), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.879 = bf16[32,4096,64]{2,1,0} divide(%sharding_constraint.139, %broadcast_in_dim.949), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.164 = bf16[32,4096,64]{2,1,0} call(%div.879, %constant.401, %constant.400), to_apply=%clip_607.252, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.645 = f8e5m2[32,4096,64]{2,1,0} convert(%jit_clip_.164), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.99 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.645, %convert_element_type.549), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.788 = f32[1]{0} multiply(%div.758, %div.878), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.646 = bf16[1]{0} convert(%mul.788), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.950 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.646), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.951 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.950), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.952 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.951), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.789 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.99, %broadcast_in_dim.952), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.23 = bf16[32,4096,7168]{2,1,0} add(%add_any.22, %mul.789), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.140 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.23), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.793 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.816), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.794 = bf16[7168]{0} reshape(%mul.793), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.795 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.794), dimensions={2}, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.796 = bf16[32,4096,7168]{2,1,0} multiply(%sharding_constraint.140, %mul.795), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.648 = f32[32,4096,7168]{2,1,0} convert(%mul.796), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.798 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.24), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.799 = f32[32,4096]{1,0} reshape(%mul.798), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.800 = f32[32,4096,7168]{2,1,0} broadcast(%mul.799), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.801 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.648, %mul.800), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.797 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.542, %convert_element_type.648), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.303 = f32[32,4096]{1,0} reduce(%mul.797, %constant.412), dimensions={2}, to_apply=%region_180.255, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.27 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.303), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.749 = f32[32,4096,1]{2,1,0} divide(%rsqrt.24, %add.107), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.393 = f32[] constant(-0.5)
  %broadcast.134 = f32[32,4096,1]{2,1,0} broadcast(%constant.393), dimensions={}
  %mul.727 = f32[32,4096,1]{2,1,0} multiply(%div.749, %broadcast.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.802 = f32[32,4096,1]{2,1,0} multiply(%reshape.27, %mul.727), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.880 = f32[32,4096,1]{2,1,0} divide(%mul.802, %broadcast.136), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.304 = f32[32,4096]{1,0} reduce(%div.880, %constant.412), dimensions={2}, to_apply=%region_181.256, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.956 = f32[32,4096,7168]{2,1,0} broadcast(%reduce_sum.304), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.396 = f32[] constant(2)
  %broadcast.137 = f32[32,4096,7168]{2,1,0} broadcast(%constant.396), dimensions={}
  %mul.726 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.542, %broadcast.137), metadata={op_name="checkpoint/rematted_computation/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.803 = f32[32,4096,7168]{2,1,0} multiply(%broadcast_in_dim.956, %mul.726), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.24 = f32[32,4096,7168]{2,1,0} add(%mul.801, %mul.803), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.649 = bf16[32,4096,7168]{2,1,0} convert(%add_any.24), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.25 = bf16[32,4096,7168]{2,1,0} add(%sharding_constraint.128, %convert_element_type.649), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_3.9 = bf16[32,4096,1536]{2,1,0} parameter(3)
  %device_put.26 = bf16[32,4096,1536]{2,1,0} custom-call(%Arg_3.9), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.510 = f32[32,4096,1536]{2,1,0} convert(%device_put.26), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.23 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.510, %convert_element_type.510), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.296 = f32[32,4096]{1,0} reduce(%square.23, %constant.412), dimensions={2}, to_apply=%region_76.118, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.778 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.296), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.389 = f32[] constant(1536)
  %broadcast.133 = f32[32,4096,1]{2,1,0} broadcast(%constant.389), dimensions={}
  %div.706 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.778, %broadcast.133), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.100 = f32[32,4096,1]{2,1,0} add(%div.706, %broadcast.135), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.22 = f32[32,4096,1]{2,1,0} rsqrt(%add.100), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.674 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.22), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.675 = f32[32,4096]{1,0} reshape(%mul.674), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.676 = f32[32,4096,1536]{2,1,0} broadcast(%mul.675), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.677 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.510, %mul.676), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.511 = bf16[32,4096,1536]{2,1,0} convert(%mul.677), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_102.3 = bf16[1536]{0} parameter(102)
  %broadcast_in_dim.779 = bf16[1,1,1536]{2,1,0} reshape(%Arg_102.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.678 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.779), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.679 = bf16[1536]{0} reshape(%mul.678), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.680 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.679), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.681 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.511, %mul.680), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_84.3 = f32[1024]{0} parameter(84)
  %reduce_max.901 = f32[] reduce(%Arg_84.3, %constant.411), dimensions={0}, to_apply=%region_77.119, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.125 = pred[] is-finite(%reduce_max.901), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.125 = pred[] compare(%reduce_max.901, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.709 = f32[] divide(%constant.409, %reduce_max.901), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.710 = f32[] divide(%div.709, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_85.3 = f32[1]{0} parameter(85)
  %div.708 = f32[1]{0} divide(%constant.392, %Arg_85.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.254 = f32[1]{0} call(%gt.125, %div.710, %div.708), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.255 = f32[1]{0} call(%is_finite.125, %jit__where_.254, %div.708), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.711 = f32[1]{0} divide(%constant.392, %jit__where_.255), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.513 = bf16[1]{0} convert(%div.711), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.780 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.513), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.781 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.780), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.782 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.781), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.712 = bf16[32,4096,1536]{2,1,0} divide(%mul.681, %broadcast_in_dim.782), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.131 = bf16[32,4096,1536]{2,1,0} call(%div.712, %constant.406, %constant.405), to_apply=%clip_495.122, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.514 = f8e4m3fn[32,4096,1536]{2,1,0} convert(%jit_clip_.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_106.3 = bf16[1536,128,192]{2,1,0} parameter(106)
  %Arg_86.3 = f32[1024]{0} parameter(86)
  %reduce_max.903 = f32[] reduce(%Arg_86.3, %constant.411), dimensions={0}, to_apply=%region_80.123, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.126 = pred[] is-finite(%reduce_max.903), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.126 = pred[] compare(%reduce_max.903, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.714 = f32[] divide(%constant.409, %reduce_max.903), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.715 = f32[] divide(%div.714, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_87.3 = f32[1]{0} parameter(87)
  %div.713 = f32[1]{0} divide(%constant.392, %Arg_87.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.256 = f32[1]{0} call(%gt.126, %div.715, %div.713), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.257 = f32[1]{0} call(%is_finite.126, %jit__where_.256, %div.713), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.716 = f32[1]{0} divide(%constant.392, %jit__where_.257), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.516 = bf16[1]{0} convert(%div.716), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.783 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.516), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.784 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.783), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.785 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.784), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.717 = bf16[1536,128,192]{2,1,0} divide(%Arg_106.3, %broadcast_in_dim.785), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.132 = bf16[1536,128,192]{2,1,0} call(%div.717, %constant.406, %constant.405), to_apply=%clip_498.126, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.517 = f8e4m3fn[1536,128,192]{2,1,0} convert(%jit_clip_.132), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.79 = bf16[32,4096,128,192]{3,2,1,0} dot(%convert_element_type.514, %convert_element_type.517), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.682 = f32[1]{0} multiply(%div.711, %div.716), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.518 = bf16[1]{0} convert(%mul.682), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.786 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.518), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.787 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.786), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.788 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.787), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.683 = bf16[32,4096,128,192]{3,2,1,0} multiply(%dot_general.79, %broadcast_in_dim.788), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.38 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.683), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.39 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.683), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.23 = bf16[32,4096,128,32,2]{4,3,2,1,0} reshape(%split.39), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.31 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.23), slice={[0:32], [0:4096], [0:128], [0:32], [0:1]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.348 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.31), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.521 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.348), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.32 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.23), slice={[0:32], [0:4096], [0:128], [0:32], [1:2]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.349 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.32), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.520 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.349), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.380 = c64[] constant((0, 1))
  %broadcast.124 = c64[32,4096,128,32]{3,2,1,0} broadcast(%constant.380), dimensions={}
  %mul.695 = c64[32,4096,128,32]{3,2,1,0} multiply(%convert_element_type.520, %broadcast.124), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.102 = c64[32,4096,128,32]{3,2,1,0} add(%convert_element_type.521, %mul.695), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.32 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.789 = f32[163840,1]{1,0} reshape(%iota.32), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.687 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.789), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.688 = f32[163840]{0} reshape(%mul.687), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.689 = f32[163840,32]{1,0} broadcast(%mul.688), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.385 = f32[] constant(1)
  %broadcast.129 = f32[32]{0} broadcast(%constant.385), dimensions={}
  %constant.386 = f32[] constant(10000)
  %broadcast.130 = f32[32]{0} broadcast(%constant.386), dimensions={}
  %iota.30 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.388 = f32[] constant(2)
  %broadcast.132 = f32[32]{0} broadcast(%constant.388), dimensions={}
  %mul.684 = f32[32]{0} multiply(%iota.30, %broadcast.132), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.387 = f32[] constant(64)
  %broadcast.131 = f32[32]{0} broadcast(%constant.387), dimensions={}
  %div.718 = f32[32]{0} divide(%mul.684, %broadcast.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pow.6 = f32[32]{0} power(%broadcast.130, %div.718), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/pow" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.719 = f32[32]{0} divide(%broadcast.129, %pow.6), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.382 = f32[] constant(40)
  %broadcast.126 = f32[32]{0} broadcast(%constant.382), dimensions={}
  %div.721 = f32[32]{0} divide(%div.719, %broadcast.126), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.31 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.384 = f32[] constant(10)
  %broadcast.128 = f32[32]{0} broadcast(%constant.384), dimensions={}
  %sub.33 = f32[32]{0} subtract(%iota.31, %broadcast.128), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.383 = f32[] constant(13)
  %broadcast.127 = f32[32]{0} broadcast(%constant.383), dimensions={}
  %div.720 = f32[32]{0} divide(%sub.33, %broadcast.127), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.407 = s32[] constant(0)
  %constant.404 = s32[] constant(1)
  %jit_clip_.133 = f32[32]{0} call(%div.720, %constant.407, %constant.404), to_apply=%clip_499.127, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.34 = f32[32]{0} subtract(%broadcast.129, %jit_clip_.133), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.35 = f32[32]{0} subtract(%broadcast.129, %sub.34), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.685 = f32[32]{0} multiply(%div.721, %sub.35), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.686 = f32[32]{0} multiply(%div.719, %sub.34), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.101 = f32[32]{0} add(%mul.685, %mul.686), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.790 = f32[1,32]{1,0} reshape(%add.101), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.690 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.790), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.691 = f32[32]{0} reshape(%mul.690), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.692 = f32[163840,32]{1,0} broadcast(%mul.691), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.693 = f32[163840,32]{1,0} multiply(%mul.689, %mul.692), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.519 = c64[163840,32]{1,0} convert(%mul.693), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.381 = c64[] constant((0, 1))
  %broadcast.125 = c64[163840,32]{1,0} broadcast(%constant.381), dimensions={}
  %mul.694 = c64[163840,32]{1,0} multiply(%convert_element_type.519, %broadcast.125), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.125 = f32[163840,32]{1,0} real(%mul.694), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.126 = f32[163840,32]{1,0} exponential(%exp.125), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.399 = f32[] constant(inf)
  %broadcast.140 = f32[163840,32]{1,0} broadcast(%constant.399), dimensions={}
  %exp.127 = pred[163840,32]{1,0} compare(%exp.126, %broadcast.140), direction=EQ, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.398 = f32[] constant(0.5)
  %broadcast.139 = f32[163840,32]{1,0} broadcast(%constant.398), dimensions={}
  %exp.128 = f32[163840,32]{1,0} multiply(%exp.125, %broadcast.139), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.129 = f32[163840,32]{1,0} exponential(%exp.128), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.130 = f32[163840,32]{1,0} imag(%mul.694), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.131 = f32[163840,32]{1,0} cosine(%exp.130), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.132 = f32[163840,32]{1,0} multiply(%exp.129, %exp.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.133 = f32[163840,32]{1,0} multiply(%exp.132, %exp.129), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.134 = f32[163840,32]{1,0} multiply(%exp.126, %exp.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.135 = f32[163840,32]{1,0} select(%exp.127, %exp.133, %exp.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.397 = f32[] constant(0)
  %broadcast.138 = f32[163840,32]{1,0} broadcast(%constant.397), dimensions={}
  %exp.136 = pred[163840,32]{1,0} compare(%exp.130, %broadcast.138), direction=EQ, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.137 = f32[163840,32]{1,0} sine(%exp.130), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.138 = f32[163840,32]{1,0} multiply(%exp.129, %exp.137), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.139 = f32[163840,32]{1,0} multiply(%exp.138, %exp.129), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.140 = f32[163840,32]{1,0} multiply(%exp.126, %exp.137), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.141 = f32[163840,32]{1,0} select(%exp.127, %exp.139, %exp.140), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.142 = f32[163840,32]{1,0} select(%exp.136, %broadcast.138, %exp.141), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.143 = c64[163840,32]{1,0} complex(%exp.135, %exp.142), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_0.155 = s32[32,4096]{1,0} parameter(0)
  %jit__take_.6 = c64[32,4096,32]{2,1,0} call(%exp.143, %Arg_0.155), to_apply=%_take_500.130, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/jit(_take)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.791 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.6), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.696 = c64[32,4096,1,32]{3,2,1,0} broadcast(%broadcast_in_dim.791), dimensions={0,1,2,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.697 = c64[32,4096,32]{2,1,0} reshape(%mul.696), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.698 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.697), dimensions={0,1,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.699 = c64[32,4096,128,32]{3,2,1,0} multiply(%add.102, %mul.698), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %real.10 = f32[32,4096,128,32]{3,2,1,0} real(%mul.699), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/real" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %imag.10 = f32[32,4096,128,32]{3,2,1,0} imag(%mul.699), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/imag" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.27 = f32[32,4096,128,64]{3,2,1,0} concatenate(%real.10, %imag.10), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.522 = bf16[32,4096,128,64]{3,2,1,0} convert(%concatenate.27), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.28 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.38, %convert_element_type.522), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.379 = bf16[] constant(0.1348)
  %broadcast.123 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%constant.379), dimensions={}
  %mul.700 = bf16[32,4096,128,192]{3,2,1,0} multiply(%concatenate.28, %broadcast.123), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.113 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%mul.700), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_4.5 = bf16[32,4096,576]{2,1,0} parameter(4)
  %device_put.27 = bf16[32,4096,576]{2,1,0} custom-call(%Arg_4.5), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.40 = bf16[32,4096,512]{2,1,0} slice(%device_put.27), slice={[0:32], [0:4096], [0:512]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.523 = f32[32,4096,512]{2,1,0} convert(%split.40), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.24 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.523, %convert_element_type.523), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.297 = f32[32,4096]{1,0} reduce(%square.24, %constant.412), dimensions={2}, to_apply=%region_84.131, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.792 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.297), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.377 = f32[] constant(512)
  %broadcast.122 = f32[32,4096,1]{2,1,0} broadcast(%constant.377), dimensions={}
  %div.722 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.792, %broadcast.122), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.103 = f32[32,4096,1]{2,1,0} add(%div.722, %broadcast.135), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.23 = f32[32,4096,1]{2,1,0} rsqrt(%add.103), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.703 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.23), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.704 = f32[32,4096]{1,0} reshape(%mul.703), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.705 = f32[32,4096,512]{2,1,0} broadcast(%mul.704), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.706 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.523, %mul.705), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.524 = bf16[32,4096,512]{2,1,0} convert(%mul.706), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_100.3 = bf16[512]{0} parameter(100)
  %broadcast_in_dim.793 = bf16[1,1,512]{2,1,0} reshape(%Arg_100.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.707 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.793), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.708 = bf16[512]{0} reshape(%mul.707), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.709 = bf16[32,4096,512]{2,1,0} broadcast(%mul.708), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.710 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.524, %mul.709), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_78.3 = f32[1024]{0} parameter(78)
  %reduce_max.905 = f32[] reduce(%Arg_78.3, %constant.411), dimensions={0}, to_apply=%region_85.132, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.127 = pred[] is-finite(%reduce_max.905), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.127 = pred[] compare(%reduce_max.905, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.729 = f32[] divide(%constant.409, %reduce_max.905), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.730 = f32[] divide(%div.729, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_79.3 = f32[1]{0} parameter(79)
  %div.728 = f32[1]{0} divide(%constant.392, %Arg_79.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.258 = f32[1]{0} call(%gt.127, %div.730, %div.728), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.259 = f32[1]{0} call(%is_finite.127, %jit__where_.258, %div.728), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.731 = f32[1]{0} divide(%constant.392, %jit__where_.259), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.530 = bf16[1]{0} convert(%div.731), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.797 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.530), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.798 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.797), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.799 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.798), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.732 = bf16[32,4096,512]{2,1,0} divide(%mul.710, %broadcast_in_dim.799), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.135 = bf16[32,4096,512]{2,1,0} call(%div.732, %constant.406, %constant.405), to_apply=%clip_506.135, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.531 = f8e4m3fn[32,4096,512]{2,1,0} convert(%jit_clip_.135), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_104.3 = bf16[512,128,256]{2,1,0} parameter(104)
  %Arg_80.3 = f32[1024]{0} parameter(80)
  %reduce_max.907 = f32[] reduce(%Arg_80.3, %constant.411), dimensions={0}, to_apply=%region_88.136, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.128 = pred[] is-finite(%reduce_max.907), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.128 = pred[] compare(%reduce_max.907, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.734 = f32[] divide(%constant.409, %reduce_max.907), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.735 = f32[] divide(%div.734, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_81.3 = f32[1]{0} parameter(81)
  %div.733 = f32[1]{0} divide(%constant.392, %Arg_81.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.260 = f32[1]{0} call(%gt.128, %div.735, %div.733), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.261 = f32[1]{0} call(%is_finite.128, %jit__where_.260, %div.733), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.736 = f32[1]{0} divide(%constant.392, %jit__where_.261), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.533 = bf16[1]{0} convert(%div.736), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.800 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.533), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.801 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.800), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.802 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.801), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.737 = bf16[512,128,256]{2,1,0} divide(%Arg_104.3, %broadcast_in_dim.802), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.136 = bf16[512,128,256]{2,1,0} call(%div.737, %constant.406, %constant.405), to_apply=%clip_509.139, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.534 = f8e4m3fn[512,128,256]{2,1,0} convert(%jit_clip_.136), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.80 = bf16[32,4096,128,256]{3,2,1,0} dot(%convert_element_type.531, %convert_element_type.534), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.724 = f32[1]{0} multiply(%div.731, %div.736), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.535 = bf16[1]{0} convert(%mul.724), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.803 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.535), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.804 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.803), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.805 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.804), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.725 = bf16[32,4096,128,256]{3,2,1,0} multiply(%dot_general.80, %broadcast_in_dim.805), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.42 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.725), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.41 = bf16[32,4096,64]{2,1,0} slice(%device_put.27), slice={[0:32], [0:4096], [512:576]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.24 = bf16[32,4096,1,32,2]{4,3,2,1,0} reshape(%split.41), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.33 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.24), slice={[0:32], [0:4096], [0:1], [0:32], [0:1]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.350 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.33), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.527 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.350), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.34 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.24), slice={[0:32], [0:4096], [0:1], [0:32], [1:2]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.351 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.34), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.526 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.351), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.376 = c64[] constant((0, 1))
  %broadcast.121 = c64[32,4096,1,32]{3,2,1,0} broadcast(%constant.376), dimensions={}
  %mul.722 = c64[32,4096,1,32]{3,2,1,0} multiply(%convert_element_type.526, %broadcast.121), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.105 = c64[32,4096,1,32]{3,2,1,0} add(%convert_element_type.527, %mul.722), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.35 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.794 = f32[163840,1]{1,0} reshape(%iota.35), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.714 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.794), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.715 = f32[163840]{0} reshape(%mul.714), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.716 = f32[163840,32]{1,0} broadcast(%mul.715), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.33 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.711 = f32[32]{0} multiply(%iota.33, %broadcast.132), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.724 = f32[32]{0} divide(%mul.711, %broadcast.131), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pow.7 = f32[32]{0} power(%broadcast.130, %div.724), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/pow" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.725 = f32[32]{0} divide(%broadcast.129, %pow.7), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.727 = f32[32]{0} divide(%div.725, %broadcast.126), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.34 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.36 = f32[32]{0} subtract(%iota.34, %broadcast.128), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.726 = f32[32]{0} divide(%sub.36, %broadcast.127), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.134 = f32[32]{0} call(%div.726, %constant.407, %constant.404), to_apply=%clip_499.127, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.37 = f32[32]{0} subtract(%broadcast.129, %jit_clip_.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.38 = f32[32]{0} subtract(%broadcast.129, %sub.37), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.712 = f32[32]{0} multiply(%div.727, %sub.38), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.713 = f32[32]{0} multiply(%div.725, %sub.37), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.104 = f32[32]{0} add(%mul.712, %mul.713), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.795 = f32[1,32]{1,0} reshape(%add.104), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.717 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.795), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.718 = f32[32]{0} reshape(%mul.717), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.719 = f32[163840,32]{1,0} broadcast(%mul.718), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.720 = f32[163840,32]{1,0} multiply(%mul.716, %mul.719), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.525 = c64[163840,32]{1,0} convert(%mul.720), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.721 = c64[163840,32]{1,0} multiply(%convert_element_type.525, %broadcast.125), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.144 = f32[163840,32]{1,0} real(%mul.721), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.145 = f32[163840,32]{1,0} exponential(%exp.144), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.146 = pred[163840,32]{1,0} compare(%exp.145, %broadcast.140), direction=EQ, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.147 = f32[163840,32]{1,0} multiply(%exp.144, %broadcast.139), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.148 = f32[163840,32]{1,0} exponential(%exp.147), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.149 = f32[163840,32]{1,0} imag(%mul.721), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.150 = f32[163840,32]{1,0} cosine(%exp.149), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.151 = f32[163840,32]{1,0} multiply(%exp.148, %exp.150), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.152 = f32[163840,32]{1,0} multiply(%exp.151, %exp.148), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.153 = f32[163840,32]{1,0} multiply(%exp.145, %exp.150), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.154 = f32[163840,32]{1,0} select(%exp.146, %exp.152, %exp.153), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.155 = pred[163840,32]{1,0} compare(%exp.149, %broadcast.138), direction=EQ, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.156 = f32[163840,32]{1,0} sine(%exp.149), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.157 = f32[163840,32]{1,0} multiply(%exp.148, %exp.156), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.158 = f32[163840,32]{1,0} multiply(%exp.157, %exp.148), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.159 = f32[163840,32]{1,0} multiply(%exp.145, %exp.156), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.160 = f32[163840,32]{1,0} select(%exp.146, %exp.158, %exp.159), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.161 = f32[163840,32]{1,0} select(%exp.155, %broadcast.138, %exp.160), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.162 = c64[163840,32]{1,0} complex(%exp.154, %exp.161), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__take_.7 = c64[32,4096,32]{2,1,0} call(%exp.162, %Arg_0.155), to_apply=%_take_500.130, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/jit(_take)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.796 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.7), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.723 = c64[32,4096,1,32]{3,2,1,0} multiply(%add.105, %broadcast_in_dim.796), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %real.11 = f32[32,4096,1,32]{3,2,1,0} real(%mul.723), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/real" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %imag.11 = f32[32,4096,1,32]{3,2,1,0} imag(%mul.723), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/imag" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.29 = f32[32,4096,1,64]{3,2,1,0} concatenate(%real.11, %imag.11), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.528 = bf16[32,4096,1,64]{3,2,1,0} convert(%concatenate.29), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.806 = bf16[32,4096,1,64]{3,2,1,0} broadcast(%convert_element_type.528), dimensions={0,1,2,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.807 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.806), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.808 = bf16[32,4096,128,64]{3,2,1,0} broadcast(%broadcast_in_dim.807), dimensions={0,1,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.30 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.42, %broadcast_in_dim.808), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.114 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%concatenate.30), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.43 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.725), slice={[0:32], [0:4096], [0:128], [128:256]}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.115 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%split.43), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.375 = bf16[0]{0} constant({})
  %custom_partitioning.32 = (bf16[32,4096,128,128]{3,2,1,0}, f32[32,128,4096]{2,1,0}) custom-call(%sharding_constraint.113, %sharding_constraint.114, %sharding_constraint.115, %constant.375, %constant.375, /*index=5*/%constant.375, %constant.375, %constant.375, %constant.375, %constant.375), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281457329920656"
  %custom_partitioning.34 = f32[32,128,4096]{2,1,0} get-tuple-element(%custom_partitioning.32), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.33 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.32), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.141 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.25), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_76.3 = f32[1024]{0} parameter(76)
  %reduce_max.965 = f32[] reduce(%Arg_76.3, %constant.411), dimensions={0}, to_apply=%region_182.257, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.157 = pred[] is-finite(%reduce_max.965), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.157 = pred[] compare(%reduce_max.965, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.882 = f32[] divide(%constant.402, %reduce_max.965), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.883 = f32[] divide(%div.882, %constant.410), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_77.3 = f32[1]{0} parameter(77)
  %div.881 = f32[1]{0} divide(%constant.392, %Arg_77.3), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.318 = f32[1]{0} call(%gt.157, %div.883, %div.881), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.319 = f32[1]{0} call(%is_finite.157, %jit__where_.318, %div.881), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.884 = f32[1]{0} divide(%constant.392, %jit__where_.319), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.651 = bf16[1]{0} convert(%div.884), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.957 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.651), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.958 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.957), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.959 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.958), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.885 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.141, %broadcast_in_dim.959), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.165 = bf16[32,4096,7168]{2,1,0} call(%div.885, %constant.401, %constant.400), to_apply=%clip_555.219, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.652 = f8e5m2[32,4096,7168]{2,1,0} convert(%jit_clip_.165), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_101.3 = bf16[128,128,7168]{2,1,0} parameter(101)
  %Arg_74.5 = f32[1024]{0} parameter(74)
  %reduce_max.911 = f32[] reduce(%Arg_74.5, %constant.411), dimensions={0}, to_apply=%region_94.144, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.130 = pred[] is-finite(%reduce_max.911), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.130 = pred[] compare(%reduce_max.911, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.744 = f32[] divide(%constant.409, %reduce_max.911), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.745 = f32[] divide(%div.744, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_75.5 = f32[1]{0} parameter(75)
  %div.743 = f32[1]{0} divide(%constant.392, %Arg_75.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.264 = f32[1]{0} call(%gt.130, %div.745, %div.743), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.265 = f32[1]{0} call(%is_finite.130, %jit__where_.264, %div.743), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.746 = f32[1]{0} divide(%constant.392, %jit__where_.265), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.540 = bf16[1]{0} convert(%div.746), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.812 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.540), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.813 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.812), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.814 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.813), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.747 = bf16[128,128,7168]{2,1,0} divide(%Arg_101.3, %broadcast_in_dim.814), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.138 = bf16[128,128,7168]{2,1,0} call(%div.747, %constant.406, %constant.405), to_apply=%clip_515.147, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.541 = f8e4m3fn[128,128,7168]{2,1,0} convert(%jit_clip_.138), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.101 = bf16[32,4096,128,128]{3,2,1,0} dot(%convert_element_type.652, %convert_element_type.541), lhs_contracting_dims={2}, rhs_contracting_dims={2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.804 = f32[1]{0} multiply(%div.746, %div.884), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.653 = bf16[1]{0} convert(%mul.804), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.960 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.653), dimensions={3}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.961 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.960), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.962 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.961), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.805 = bf16[32,4096,128,128]{3,2,1,0} multiply(%dot_general.101, %broadcast_in_dim.962), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.142 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%mul.805), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.40 = (bf16[32,4096,128,192]{3,2,1,0}, bf16[32,4096,128,192]{3,2,1,0}, bf16[32,4096,128,128]{3,2,1,0}) custom-call(%sharding_constraint.113, %sharding_constraint.114, %sharding_constraint.115, %constant.375, %constant.375, /*index=5*/%constant.375, %constant.375, %constant.375, %constant.375, %constant.375, /*index=10*/%custom_partitioning.34, %custom_partitioning.33, %sharding_constraint.142), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281457329392288"
  %custom_partitioning.42 = bf16[32,4096,128,192]{3,2,1,0} get-tuple-element(%custom_partitioning.40), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.144 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%custom_partitioning.42), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.44 = bf16[32,4096,128,128]{3,2,1,0} slice(%sharding_constraint.144), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.43 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.40), index=2, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.143 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.43), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.31 = bf16[32,4096,128,256]{3,2,1,0} concatenate(%split.44, %sharding_constraint.143), dimensions={3}, metadata={op_name="checkpoint/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_82.3 = f32[1024]{0} parameter(82)
  %reduce_max.967 = f32[] reduce(%Arg_82.3, %constant.411), dimensions={0}, to_apply=%region_186.261, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.158 = pred[] is-finite(%reduce_max.967), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.158 = pred[] compare(%reduce_max.967, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.887 = f32[] divide(%constant.402, %reduce_max.967), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.888 = f32[] divide(%div.887, %constant.410), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_83.3 = f32[1]{0} parameter(83)
  %div.886 = f32[1]{0} divide(%constant.392, %Arg_83.3), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.320 = f32[1]{0} call(%gt.158, %div.888, %div.886), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.321 = f32[1]{0} call(%is_finite.158, %jit__where_.320, %div.886), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.889 = f32[1]{0} divide(%constant.392, %jit__where_.321), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.656 = bf16[1]{0} convert(%div.889), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.967 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.656), dimensions={3}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.968 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.967), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.969 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.968), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.890 = bf16[32,4096,128,256]{3,2,1,0} divide(%concatenate.31, %broadcast_in_dim.969), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.166 = bf16[32,4096,128,256]{3,2,1,0} call(%div.890, %constant.401, %constant.400), to_apply=%clip_629.264, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.657 = f8e5m2[32,4096,128,256]{3,2,1,0} convert(%jit_clip_.166), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.103 = bf16[32,4096,512]{2,1,0} dot(%convert_element_type.657, %convert_element_type.534), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.808 = f32[1]{0} multiply(%div.736, %div.889), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.658 = bf16[1]{0} convert(%mul.808), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.970 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.658), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.971 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.970), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.972 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.971), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.809 = bf16[32,4096,512]{2,1,0} multiply(%dot_general.103, %broadcast_in_dim.972), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.815 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.793), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.816 = bf16[512]{0} reshape(%mul.815), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.817 = bf16[32,4096,512]{2,1,0} broadcast(%mul.816), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.818 = bf16[32,4096,512]{2,1,0} multiply(%mul.809, %mul.817), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.665 = f32[32,4096,512]{2,1,0} convert(%mul.818), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.820 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.23), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.821 = f32[32,4096]{1,0} reshape(%mul.820), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.822 = f32[32,4096,512]{2,1,0} broadcast(%mul.821), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.823 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.665, %mul.822), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.819 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.523, %convert_element_type.665), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.309 = f32[32,4096]{1,0} reduce(%mul.819, %constant.412), dimensions={2}, to_apply=%region_192.268, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.30 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.309), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.723 = f32[32,4096,1]{2,1,0} divide(%rsqrt.23, %add.103), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.702 = f32[32,4096,1]{2,1,0} multiply(%div.723, %broadcast.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.824 = f32[32,4096,1]{2,1,0} multiply(%reshape.30, %mul.702), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.891 = f32[32,4096,1]{2,1,0} divide(%mul.824, %broadcast.122), metadata={op_name="checkpoint/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.310 = f32[32,4096]{1,0} reduce(%div.891, %constant.412), dimensions={2}, to_apply=%region_193.269, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.978 = f32[32,4096,512]{2,1,0} broadcast(%reduce_sum.310), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.378 = f32[] constant(2)
  %mul.660 = f32[32,4096,512]{2,1,0} broadcast(%constant.378), dimensions={}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.701 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.523, %mul.660), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.825 = f32[32,4096,512]{2,1,0} multiply(%broadcast_in_dim.978, %mul.701), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.28 = f32[32,4096,512]{2,1,0} add(%mul.823, %mul.825), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.666 = bf16[32,4096,512]{2,1,0} convert(%add_any.28), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.372 = f32[] constant(0)
  %broadcast.120 = f32[32,4096,1,32]{3,2,1,0} broadcast(%constant.372), dimensions={}
  %split.45 = bf16[32,4096,128,64]{3,2,1,0} slice(%sharding_constraint.144), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.305 = bf16[32,4096,64]{2,1,0} reduce(%split.45, %constant.403), dimensions={2}, to_apply=%region_185.260, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.966 = bf16[32,4096,1,64]{3,2,1,0} reshape(%reduce_sum.305), metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.660 = f32[32,4096,1,64]{3,2,1,0} convert(%broadcast_in_dim.966), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.47 = f32[32,4096,1,32]{3,2,1,0} slice(%convert_element_type.660), slice={[0:32], [0:4096], [0:1], [32:64]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %neg.13 = f32[32,4096,1,32]{3,2,1,0} negate(%split.47), metadata={op_name="checkpoint/moe_layers/self_attention/neg" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.4 = c64[32,4096,1,32]{3,2,1,0} complex(%broadcast.120, %neg.13), metadata={op_name="checkpoint/moe_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.46 = f32[32,4096,1,32]{3,2,1,0} slice(%convert_element_type.660), slice={[0:32], [0:4096], [0:1], [0:32]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.5 = c64[32,4096,1,32]{3,2,1,0} complex(%split.46, %broadcast.120), metadata={op_name="checkpoint/moe_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.26 = c64[32,4096,1,32]{3,2,1,0} add(%complex.4, %complex.5), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.812 = c64[32,4096,1,32]{3,2,1,0} multiply(%add_any.26, %broadcast_in_dim.796), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.813 = c64[32,4096,1,32]{3,2,1,0} multiply(%mul.812, %broadcast.121), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.663 = f32[32,4096,1,32]{3,2,1,0} real(%mul.813), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.664 = bf16[32,4096,1,32]{3,2,1,0} convert(%convert_element_type.663), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.976 = bf16[32,4096,1,32,1]{4,3,2,1,0} reshape(%convert_element_type.664), metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.6 = bf16[32,4096,1,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.976, %constant.403), padding=0_0x0_0x0_0x0_0x1_0, metadata={op_name="checkpoint/moe_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.661 = f32[32,4096,1,32]{3,2,1,0} real(%mul.812), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.662 = bf16[32,4096,1,32]{3,2,1,0} convert(%convert_element_type.661), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.977 = bf16[32,4096,1,32,1]{4,3,2,1,0} reshape(%convert_element_type.662), metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.7 = bf16[32,4096,1,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.977, %constant.403), padding=0_0x0_0x0_0x0_0x0_1, metadata={op_name="checkpoint/moe_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.27 = bf16[32,4096,1,32,2]{4,3,2,1,0} add(%pad.6, %pad.7), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.28 = bf16[32,4096,1,64]{3,2,1,0} reshape(%add_any.27), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.306 = bf16[32,4096,64]{2,1,0} reduce(%reshape.28, %constant.403), dimensions={2}, to_apply=%region_189.265, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.32 = bf16[32,4096,576]{2,1,0} concatenate(%convert_element_type.666, %reduce_sum.306), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_69.5 = f32[1024]{0} parameter(69)
  %reduce_max.971 = f32[] reduce(%Arg_69.5, %constant.411), dimensions={0}, to_apply=%region_201.278, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.160 = pred[] is-finite(%reduce_max.971), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.160 = pred[] compare(%reduce_max.971, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.899 = f32[] divide(%constant.402, %reduce_max.971), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.900 = f32[] divide(%div.899, %constant.410), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_71.5 = f32[1]{0} parameter(71)
  %div.898 = f32[1]{0} divide(%constant.392, %Arg_71.5), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.324 = f32[1]{0} call(%gt.160, %div.900, %div.898), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.325 = f32[1]{0} call(%is_finite.160, %jit__where_.324, %div.898), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.901 = f32[1]{0} divide(%constant.392, %jit__where_.325), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.680 = bf16[1]{0} convert(%div.901), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.991 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.680), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.992 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.991), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.993 = bf16[32,4096,576]{2,1,0} broadcast(%broadcast_in_dim.992), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.902 = bf16[32,4096,576]{2,1,0} divide(%concatenate.32, %broadcast_in_dim.993), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.168 = bf16[32,4096,576]{2,1,0} call(%div.902, %constant.401, %constant.400), to_apply=%clip_689.281, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.681 = f8e5m2[32,4096,576]{2,1,0} convert(%jit_clip_.168), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_103.3 = bf16[7168,576]{1,0} parameter(103)
  %Arg_65.5 = f32[1024]{0} parameter(65)
  %reduce_max.899 = f32[] reduce(%Arg_65.5, %constant.411), dimensions={0}, to_apply=%region_73.114, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.124 = pred[] is-finite(%reduce_max.899), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.124 = pred[] compare(%reduce_max.899, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.702 = f32[] divide(%constant.409, %reduce_max.899), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.703 = f32[] divide(%div.702, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_67.5 = f32[1]{0} parameter(67)
  %div.701 = f32[1]{0} divide(%constant.392, %Arg_67.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.252 = f32[1]{0} call(%gt.124, %div.703, %div.701), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.253 = f32[1]{0} call(%is_finite.124, %jit__where_.252, %div.701), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.704 = f32[1]{0} divide(%constant.392, %jit__where_.253), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.508 = bf16[1]{0} convert(%div.704), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.775 = bf16[7168,1]{1,0} broadcast(%convert_element_type.508), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.776 = bf16[7168]{0} reshape(%broadcast_in_dim.775), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.777 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.776), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.705 = bf16[7168,576]{1,0} divide(%Arg_103.3, %broadcast_in_dim.777), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.130 = bf16[7168,576]{1,0} call(%div.705, %constant.406, %constant.405), to_apply=%clip_490.117, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.509 = f8e4m3fn[7168,576]{1,0} convert(%jit_clip_.130), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.107 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.681, %convert_element_type.509), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.848 = f32[1]{0} multiply(%div.704, %div.901), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.682 = bf16[1]{0} convert(%mul.848), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.994 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.682), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.995 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.994), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.996 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.995), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.849 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.107, %broadcast_in_dim.996), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.41 = bf16[32,4096,128,192]{3,2,1,0} get-tuple-element(%custom_partitioning.40), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/moe_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.145 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%custom_partitioning.41), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.826 = bf16[32,4096,128,192]{3,2,1,0} multiply(%sharding_constraint.145, %broadcast.123), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.48 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.826), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.371 = f32[] constant(0)
  %broadcast.119 = f32[32,4096,128,32]{3,2,1,0} broadcast(%constant.371), dimensions={}
  %split.49 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.826), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.667 = f32[32,4096,128,64]{3,2,1,0} convert(%split.49), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.51 = f32[32,4096,128,32]{3,2,1,0} slice(%convert_element_type.667), slice={[0:32], [0:4096], [0:128], [32:64]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %neg.14 = f32[32,4096,128,32]{3,2,1,0} negate(%split.51), metadata={op_name="checkpoint/moe_layers/self_attention/neg" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.6 = c64[32,4096,128,32]{3,2,1,0} complex(%broadcast.119, %neg.14), metadata={op_name="checkpoint/moe_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.50 = f32[32,4096,128,32]{3,2,1,0} slice(%convert_element_type.667), slice={[0:32], [0:4096], [0:128], [0:32]}, metadata={op_name="checkpoint/moe_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.7 = c64[32,4096,128,32]{3,2,1,0} complex(%split.50, %broadcast.119), metadata={op_name="checkpoint/moe_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.29 = c64[32,4096,128,32]{3,2,1,0} add(%complex.6, %complex.7), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.827 = c64[32,4096,1,32]{3,2,1,0} broadcast(%broadcast_in_dim.791), dimensions={0,1,2,3}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.828 = c64[32,4096,32]{2,1,0} reshape(%mul.827), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.829 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.828), dimensions={0,1,3}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.830 = c64[32,4096,128,32]{3,2,1,0} multiply(%add_any.29, %mul.829), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.831 = c64[32,4096,128,32]{3,2,1,0} multiply(%mul.830, %broadcast.124), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.670 = f32[32,4096,128,32]{3,2,1,0} real(%mul.831), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.671 = bf16[32,4096,128,32]{3,2,1,0} convert(%convert_element_type.670), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.979 = bf16[32,4096,128,32,1]{4,3,2,1,0} reshape(%convert_element_type.671), metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.8 = bf16[32,4096,128,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.979, %constant.403), padding=0_0x0_0x0_0x0_0x1_0, metadata={op_name="checkpoint/moe_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.668 = f32[32,4096,128,32]{3,2,1,0} real(%mul.830), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.669 = bf16[32,4096,128,32]{3,2,1,0} convert(%convert_element_type.668), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.980 = bf16[32,4096,128,32,1]{4,3,2,1,0} reshape(%convert_element_type.669), metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.9 = bf16[32,4096,128,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.980, %constant.403), padding=0_0x0_0x0_0x0_0x0_1, metadata={op_name="checkpoint/moe_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.30 = bf16[32,4096,128,32,2]{4,3,2,1,0} add(%pad.8, %pad.9), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.31 = bf16[32,4096,128,64]{3,2,1,0} reshape(%add_any.30), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.33 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.48, %reshape.31), dimensions={3}, metadata={op_name="checkpoint/moe_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_88.3 = f32[1024]{0} parameter(88)
  %reduce_max.969 = f32[] reduce(%Arg_88.3, %constant.411), dimensions={0}, to_apply=%region_194.270, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.159 = pred[] is-finite(%reduce_max.969), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.159 = pred[] compare(%reduce_max.969, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.893 = f32[] divide(%constant.402, %reduce_max.969), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.894 = f32[] divide(%div.893, %constant.410), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_89.3 = f32[1]{0} parameter(89)
  %div.892 = f32[1]{0} divide(%constant.392, %Arg_89.3), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.322 = f32[1]{0} call(%gt.159, %div.894, %div.892), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.323 = f32[1]{0} call(%is_finite.159, %jit__where_.322, %div.892), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.895 = f32[1]{0} divide(%constant.392, %jit__where_.323), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.673 = bf16[1]{0} convert(%div.895), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.981 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.673), dimensions={3}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.982 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.981), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.983 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.982), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.896 = bf16[32,4096,128,192]{3,2,1,0} divide(%concatenate.33, %broadcast_in_dim.983), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.167 = bf16[32,4096,128,192]{3,2,1,0} call(%div.896, %constant.401, %constant.400), to_apply=%clip_672.273, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.674 = f8e5m2[32,4096,128,192]{3,2,1,0} convert(%jit_clip_.167), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.105 = bf16[32,4096,1536]{2,1,0} dot(%convert_element_type.674, %convert_element_type.517), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.832 = f32[1]{0} multiply(%div.716, %div.895), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.675 = bf16[1]{0} convert(%mul.832), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.984 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.675), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.985 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.984), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.986 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.985), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.833 = bf16[32,4096,1536]{2,1,0} multiply(%dot_general.105, %broadcast_in_dim.986), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.837 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.779), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.838 = bf16[1536]{0} reshape(%mul.837), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.839 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.838), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.840 = bf16[32,4096,1536]{2,1,0} multiply(%mul.833, %mul.839), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.677 = f32[32,4096,1536]{2,1,0} convert(%mul.840), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.842 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.22), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.843 = f32[32,4096]{1,0} reshape(%mul.842), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.844 = f32[32,4096,1536]{2,1,0} broadcast(%mul.843), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.845 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.677, %mul.844), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.841 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.510, %convert_element_type.677), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.313 = f32[32,4096]{1,0} reduce(%mul.841, %constant.412), dimensions={2}, to_apply=%region_199.276, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.33 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.313), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.707 = f32[32,4096,1]{2,1,0} divide(%rsqrt.22, %add.100), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.673 = f32[32,4096,1]{2,1,0} multiply(%div.707, %broadcast.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.846 = f32[32,4096,1]{2,1,0} multiply(%reshape.33, %mul.673), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.897 = f32[32,4096,1]{2,1,0} divide(%mul.846, %broadcast.133), metadata={op_name="checkpoint/moe_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.314 = f32[32,4096]{1,0} reduce(%div.897, %constant.412), dimensions={2}, to_apply=%region_200.277, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.990 = f32[32,4096,1536]{2,1,0} broadcast(%reduce_sum.314), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.390 = f32[] constant(2)
  %mul.661 = f32[32,4096,1536]{2,1,0} broadcast(%constant.390), dimensions={}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.672 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.510, %mul.661), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.847 = f32[32,4096,1536]{2,1,0} multiply(%broadcast_in_dim.990, %mul.672), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.31 = f32[32,4096,1536]{2,1,0} add(%mul.845, %mul.847), metadata={op_name="checkpoint/moe_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.678 = bf16[32,4096,1536]{2,1,0} convert(%add_any.31), metadata={op_name="checkpoint/moe_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_68.5 = f32[1024]{0} parameter(68)
  %reduce_max.973 = f32[] reduce(%Arg_68.5, %constant.411), dimensions={0}, to_apply=%region_204.282, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.161 = pred[] is-finite(%reduce_max.973), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.161 = pred[] compare(%reduce_max.973, %constant.412), direction=GT, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.904 = f32[] divide(%constant.402, %reduce_max.973), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.905 = f32[] divide(%div.904, %constant.410), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_70.5 = f32[1]{0} parameter(70)
  %div.903 = f32[1]{0} divide(%constant.392, %Arg_70.5), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.326 = f32[1]{0} call(%gt.161, %div.905, %div.903), to_apply=%_where_552.214, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.327 = f32[1]{0} call(%is_finite.161, %jit__where_.326, %div.903), to_apply=%_where_553.215, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.906 = f32[1]{0} divide(%constant.392, %jit__where_.327), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.685 = bf16[1]{0} convert(%div.906), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1000 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.685), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1001 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1000), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1002 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.1001), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.907 = bf16[32,4096,1536]{2,1,0} divide(%convert_element_type.678, %broadcast_in_dim.1002), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.169 = bf16[32,4096,1536]{2,1,0} call(%div.907, %constant.401, %constant.400), to_apply=%clip_697.285, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.686 = f8e5m2[32,4096,1536]{2,1,0} convert(%jit_clip_.169), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_105.3 = bf16[7168,1536]{1,0} parameter(105)
  %Arg_64.5 = f32[1024]{0} parameter(64)
  %reduce_max.897 = f32[] reduce(%Arg_64.5, %constant.411), dimensions={0}, to_apply=%region_70.110, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.123 = pred[] is-finite(%reduce_max.897), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.123 = pred[] compare(%reduce_max.897, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.697 = f32[] divide(%constant.409, %reduce_max.897), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.698 = f32[] divide(%div.697, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_66.5 = f32[1]{0} parameter(66)
  %div.696 = f32[1]{0} divide(%constant.392, %Arg_66.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.250 = f32[1]{0} call(%gt.123, %div.698, %div.696), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.251 = f32[1]{0} call(%is_finite.123, %jit__where_.250, %div.696), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.699 = f32[1]{0} divide(%constant.392, %jit__where_.251), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.505 = bf16[1]{0} convert(%div.699), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.772 = bf16[7168,1]{1,0} broadcast(%convert_element_type.505), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.773 = bf16[7168]{0} reshape(%broadcast_in_dim.772), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.774 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.773), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.700 = bf16[7168,1536]{1,0} divide(%Arg_105.3, %broadcast_in_dim.774), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.129 = bf16[7168,1536]{1,0} call(%div.700, %constant.406, %constant.405), to_apply=%clip_487.113, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.506 = f8e4m3fn[7168,1536]{1,0} convert(%jit_clip_.129), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.109 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.686, %convert_element_type.506), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.852 = f32[1]{0} multiply(%div.699, %div.906), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.687 = bf16[1]{0} convert(%mul.852), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1003 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.687), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1004 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1003), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1005 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1004), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.853 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.109, %broadcast_in_dim.1005), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.32 = bf16[32,4096,7168]{2,1,0} add(%mul.849, %mul.853), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.146 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.32), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.147 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.146), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_99.3 = bf16[7168]{0} parameter(99)
  %broadcast_in_dim.768 = bf16[1,1,7168]{2,1,0} reshape(%Arg_99.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.857 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.768), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.858 = bf16[7168]{0} reshape(%mul.857), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.859 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.858), dimensions={2}, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.860 = bf16[32,4096,7168]{2,1,0} multiply(%sharding_constraint.147, %mul.859), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.689 = f32[32,4096,7168]{2,1,0} convert(%mul.860), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.499 = f32[32,4096,7168]{2,1,0} convert(%Arg_2.127), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.22 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.499, %convert_element_type.499), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.295 = f32[32,4096]{1,0} reduce(%square.22, %constant.412), dimensions={2}, to_apply=%region_66.102, metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.767 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.295), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.689 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.767, %broadcast.136), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.99 = f32[32,4096,1]{2,1,0} add(%div.689, %broadcast.135), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.21 = f32[32,4096,1]{2,1,0} rsqrt(%add.99), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.862 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.21), dimensions={0,1,2}, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.863 = f32[32,4096]{1,0} reshape(%mul.862), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.864 = f32[32,4096,7168]{2,1,0} broadcast(%mul.863), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.865 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.689, %mul.864), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.861 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.499, %convert_element_type.689), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.317 = f32[32,4096]{1,0} reduce(%mul.861, %constant.412), dimensions={2}, to_apply=%region_209.288, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.35 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.317), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.690 = f32[32,4096,1]{2,1,0} divide(%rsqrt.21, %add.99), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.663 = f32[32,4096,1]{2,1,0} multiply(%div.690, %broadcast.134), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.866 = f32[32,4096,1]{2,1,0} multiply(%reshape.35, %mul.663), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.908 = f32[32,4096,1]{2,1,0} divide(%mul.866, %broadcast.136), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.318 = f32[32,4096]{1,0} reduce(%div.908, %constant.412), dimensions={2}, to_apply=%region_210.289, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1009 = f32[32,4096,7168]{2,1,0} broadcast(%reduce_sum.318), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.662 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.499, %broadcast.137), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.867 = f32[32,4096,7168]{2,1,0} multiply(%broadcast_in_dim.1009, %mul.662), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.33 = f32[32,4096,7168]{2,1,0} add(%mul.865, %mul.867), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.690 = bf16[32,4096,7168]{2,1,0} convert(%add_any.33), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.34 = bf16[32,4096,7168]{2,1,0} add(%add_any.25, %convert_element_type.690), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.148 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.34), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.100 = bf16[64,7168]{1,0} dot(%convert_element_type.645, %convert_element_type.546), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.58 = bf16[7168,64]{0,1} transpose(%dot_general.100), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.790 = f32[1]{0} multiply(%div.753, %div.878), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.647 = bf16[1]{0} convert(%mul.790), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.953 = bf16[7168,1]{1,0} broadcast(%convert_element_type.647), dimensions={1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.954 = bf16[7168]{0} reshape(%broadcast_in_dim.953), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.955 = bf16[7168,64]{1,0} broadcast(%broadcast_in_dim.954), dimensions={0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.791 = bf16[7168,64]{0,1} multiply(%transpose.58, %broadcast_in_dim.955), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.370 = bf16[] constant(0)
  %broadcast_in_dim.766 = bf16[64]{0} broadcast(%constant.370), dimensions={}, metadata={op_name="broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %Arg_18.5 = f32[1024]{0} parameter(18)
  %reduce_max.919 = f32[] reduce(%Arg_18.5, %constant.411), dimensions={0}, to_apply=%region_107.162, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.134 = pred[] is-finite(%reduce_max.919), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.134 = pred[] compare(%reduce_max.919, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.766 = f32[] divide(%constant.409, %reduce_max.919), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.767 = f32[] divide(%div.766, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_19.5 = f32[1]{0} parameter(19)
  %div.765 = f32[1]{0} divide(%constant.392, %Arg_19.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.272 = f32[1]{0} call(%gt.134, %div.767, %div.765), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.273 = f32[1]{0} call(%is_finite.134, %jit__where_.272, %div.765), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.768 = f32[1]{0} divide(%constant.392, %jit__where_.273), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.561 = bf16[1]{0} convert(%div.768), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.830 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.561), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.831 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.830), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.832 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.831), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.769 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.118, %broadcast_in_dim.832), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.142 = bf16[32,4096,7168]{2,1,0} call(%div.769, %constant.406, %constant.405), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.562 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.142), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.82 = bf16[32,64,512,7168]{3,2,1,0} dot(%convert_element_type.559, %convert_element_type.562), lhs_batch_dims={0}, lhs_contracting_dims={1}, rhs_batch_dims={0}, rhs_contracting_dims={1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.746 = f32[1]{0} multiply(%div.763, %div.768), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.563 = bf16[1]{0} convert(%mul.746), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.833 = bf16[32,64,512,1]{3,2,1,0} broadcast(%convert_element_type.563), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.834 = bf16[32,64,512]{2,1,0} reshape(%broadcast_in_dim.833), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.835 = bf16[32,64,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.834), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.747 = bf16[32,64,512,7168]{3,2,1,0} multiply(%dot_general.82, %broadcast_in_dim.835), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.48 = bf16[64,32,512,7168]{3,2,0,1} transpose(%mul.747), dimensions={1,0,2,3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.122 = bf16[64,32,512,7168]{3,2,1,0} custom-call(%transpose.48), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"data\", \"fsdp\", \"fsdp_transpose\"}, {}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_22.5 = f32[1024]{0} parameter(22)
  %reduce_max.921 = f32[] reduce(%Arg_22.5, %constant.411), dimensions={0}, to_apply=%region_110.165, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.135 = pred[] is-finite(%reduce_max.921), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.135 = pred[] compare(%reduce_max.921, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.771 = f32[] divide(%constant.409, %reduce_max.921), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.772 = f32[] divide(%div.771, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_23.5 = f32[1]{0} parameter(23)
  %div.770 = f32[1]{0} divide(%constant.392, %Arg_23.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.274 = f32[1]{0} call(%gt.135, %div.772, %div.770), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.275 = f32[1]{0} call(%is_finite.135, %jit__where_.274, %div.770), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.773 = f32[1]{0} divide(%constant.392, %jit__where_.275), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.565 = bf16[1]{0} convert(%div.773), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.836 = bf16[64,32,512,1]{3,2,1,0} broadcast(%convert_element_type.565), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.837 = bf16[64,32,512]{2,1,0} reshape(%broadcast_in_dim.836), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.838 = bf16[64,32,512,7168]{3,2,1,0} broadcast(%broadcast_in_dim.837), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.774 = bf16[64,32,512,7168]{3,2,1,0} divide(%sharding_constraint.122, %broadcast_in_dim.838), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.143 = bf16[64,32,512,7168]{3,2,1,0} call(%div.774, %constant.406, %constant.405), to_apply=%clip_526.168, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.566 = f8e4m3fn[64,32,512,7168]{3,2,1,0} convert(%jit_clip_.143), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.97 = bf16[64,2048,7168]{2,1,0} dot(%convert_element_type.636, %convert_element_type.566), lhs_batch_dims={0}, lhs_contracting_dims={1,2}, rhs_batch_dims={0}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.55 = bf16[64,7168,2048]{1,2,0} transpose(%dot_general.97), dimensions={0,2,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.782 = f32[1]{0} multiply(%div.773, %div.868), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.638 = bf16[1]{0} convert(%mul.782), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.938 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.638), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.939 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.938), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.940 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.939), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.783 = bf16[64,7168,2048]{1,2,0} multiply(%transpose.55, %broadcast_in_dim.940), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.136 = bf16[64,7168,2048]{2,1,0} custom-call(%mul.783), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.95 = bf16[64,2048,7168]{2,1,0} dot(%convert_element_type.631, %convert_element_type.566), lhs_batch_dims={0}, lhs_contracting_dims={1,2}, rhs_batch_dims={0}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.54 = bf16[64,7168,2048]{1,2,0} transpose(%dot_general.95), dimensions={0,2,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.778 = f32[1]{0} multiply(%div.773, %div.863), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.633 = bf16[1]{0} convert(%mul.778), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.929 = bf16[64,7168,1]{2,1,0} broadcast(%convert_element_type.633), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.930 = bf16[64,7168]{1,0} reshape(%broadcast_in_dim.929), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.931 = bf16[64,7168,2048]{2,1,0} broadcast(%broadcast_in_dim.930), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.779 = bf16[64,7168,2048]{1,2,0} multiply(%transpose.54, %broadcast_in_dim.931), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.135 = bf16[64,7168,2048]{2,1,0} custom-call(%mul.779), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.93 = bf16[64,7168,2048]{2,1,0} dot(%convert_element_type.626, %convert_element_type.575), lhs_batch_dims={0}, lhs_contracting_dims={1,2}, rhs_batch_dims={0}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.53 = bf16[64,2048,7168]{1,2,0} transpose(%dot_general.93), dimensions={0,2,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.772 = f32[1]{0} multiply(%div.788, %div.858), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.628 = bf16[1]{0} convert(%mul.772), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.920 = bf16[64,2048,1]{2,1,0} broadcast(%convert_element_type.628), dimensions={2}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.921 = bf16[64,2048]{1,0} reshape(%broadcast_in_dim.920), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.922 = bf16[64,2048,7168]{2,1,0} broadcast(%broadcast_in_dim.921), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.773 = bf16[64,2048,7168]{1,2,0} multiply(%transpose.53, %broadcast_in_dim.922), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.132 = bf16[64,2048,7168]{2,1,0} custom-call(%mul.773), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_44.5 = f32[1024]{0} parameter(44)
  %reduce_max.935 = f32[] reduce(%Arg_44.5, %constant.411), dimensions={0}, to_apply=%region_131.191, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.142 = pred[] is-finite(%reduce_max.935), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.142 = pred[] compare(%reduce_max.935, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.806 = f32[] divide(%constant.409, %reduce_max.935), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.807 = f32[] divide(%div.806, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_45.5 = f32[1]{0} parameter(45)
  %div.805 = f32[1]{0} divide(%constant.392, %Arg_45.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.288 = f32[1]{0} call(%gt.142, %div.807, %div.805), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.289 = f32[1]{0} call(%is_finite.142, %jit__where_.288, %div.805), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.808 = f32[1]{0} divide(%constant.392, %jit__where_.289), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.587 = bf16[1]{0} convert(%div.808), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.860 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.587), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.861 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.860), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.862 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.861), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.809 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.118, %broadcast_in_dim.862), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.150 = bf16[32,4096,7168]{2,1,0} call(%div.809, %constant.406, %constant.405), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.588 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.150), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.89 = bf16[2048,7168]{1,0} dot(%convert_element_type.616, %convert_element_type.588), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.51 = bf16[7168,2048]{0,1} transpose(%dot_general.89), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.764 = f32[1]{0} multiply(%div.808, %div.848), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.618 = bf16[1]{0} convert(%mul.764), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.902 = bf16[7168,1]{1,0} broadcast(%convert_element_type.618), dimensions={1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.903 = bf16[7168]{0} reshape(%broadcast_in_dim.902), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.904 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.903), dimensions={0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.765 = bf16[7168,2048]{0,1} multiply(%transpose.51, %broadcast_in_dim.904), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_50.5 = f32[1024]{0} parameter(50)
  %reduce_max.939 = f32[] reduce(%Arg_50.5, %constant.411), dimensions={0}, to_apply=%region_137.199, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.144 = pred[] is-finite(%reduce_max.939), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.144 = pred[] compare(%reduce_max.939, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.816 = f32[] divide(%constant.409, %reduce_max.939), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.817 = f32[] divide(%div.816, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_51.5 = f32[1]{0} parameter(51)
  %div.815 = f32[1]{0} divide(%constant.392, %Arg_51.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.292 = f32[1]{0} call(%gt.144, %div.817, %div.815), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.293 = f32[1]{0} call(%is_finite.144, %jit__where_.292, %div.815), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.818 = f32[1]{0} divide(%constant.392, %jit__where_.293), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.593 = bf16[1]{0} convert(%div.818), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.866 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.593), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.867 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.866), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.868 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.867), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.819 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.118, %broadcast_in_dim.868), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.152 = bf16[32,4096,7168]{2,1,0} call(%div.819, %constant.406, %constant.405), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.594 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.152), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.87 = bf16[2048,7168]{1,0} dot(%convert_element_type.611, %convert_element_type.594), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.50 = bf16[7168,2048]{0,1} transpose(%dot_general.87), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.760 = f32[1]{0} multiply(%div.818, %div.843), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.613 = bf16[1]{0} convert(%mul.760), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.893 = bf16[7168,1]{1,0} broadcast(%convert_element_type.613), dimensions={1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.894 = bf16[7168]{0} reshape(%broadcast_in_dim.893), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.895 = bf16[7168,2048]{1,0} broadcast(%broadcast_in_dim.894), dimensions={0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.761 = bf16[7168,2048]{0,1} multiply(%transpose.50, %broadcast_in_dim.895), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.751 = bf16[32,4096,2048]{2,1,0} multiply(%jit_silu_.21, %device_put.31), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.127 = bf16[32,4096,2048]{2,1,0} custom-call(%mul.751), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_56.5 = f32[1024]{0} parameter(56)
  %reduce_max.943 = f32[] reduce(%Arg_56.5, %constant.411), dimensions={0}, to_apply=%region_143.205, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.146 = pred[] is-finite(%reduce_max.943), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.146 = pred[] compare(%reduce_max.943, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.826 = f32[] divide(%constant.409, %reduce_max.943), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.827 = f32[] divide(%div.826, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_57.5 = f32[1]{0} parameter(57)
  %div.825 = f32[1]{0} divide(%constant.392, %Arg_57.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.296 = f32[1]{0} call(%gt.146, %div.827, %div.825), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.297 = f32[1]{0} call(%is_finite.146, %jit__where_.296, %div.825), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.828 = f32[1]{0} divide(%constant.392, %jit__where_.297), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.599 = bf16[1]{0} convert(%div.828), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.872 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.599), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.873 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.872), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.874 = bf16[32,4096,2048]{2,1,0} broadcast(%broadcast_in_dim.873), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.829 = bf16[32,4096,2048]{2,1,0} divide(%sharding_constraint.127, %broadcast_in_dim.874), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.154 = bf16[32,4096,2048]{2,1,0} call(%div.829, %constant.406, %constant.405), to_apply=%clip_548.208, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.600 = f8e4m3fn[32,4096,2048]{2,1,0} convert(%jit_clip_.154), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.85 = bf16[7168,2048]{1,0} dot(%convert_element_type.606, %convert_element_type.600), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.49 = bf16[2048,7168]{0,1} transpose(%dot_general.85), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.754 = f32[1]{0} multiply(%div.828, %div.838), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.608 = bf16[1]{0} convert(%mul.754), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.884 = bf16[2048,1]{1,0} broadcast(%convert_element_type.608), dimensions={1}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.885 = bf16[2048]{0} reshape(%broadcast_in_dim.884), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.886 = bf16[2048,7168]{1,0} broadcast(%broadcast_in_dim.885), dimensions={0}, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.755 = bf16[2048,7168]{0,1} multiply(%transpose.49, %broadcast_in_dim.886), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.792 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.543, %sharding_constraint.140), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.301 = bf16[7168]{0} reduce(%mul.792, %constant.403), dimensions={0,1}, to_apply=%region_178.253, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.26 = bf16[1,1,7168]{2,1,0} reshape(%reduce_sum.301), metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.302 = bf16[7168]{0} reduce(%reshape.26, %constant.403), dimensions={0,1}, to_apply=%region_179.254, metadata={op_name="checkpoint/moe_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.664 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.21), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.665 = f32[32,4096]{1,0} reshape(%mul.664), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.666 = f32[32,4096,7168]{2,1,0} broadcast(%mul.665), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.667 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.499, %mul.666), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.500 = bf16[32,4096,7168]{2,1,0} convert(%mul.667), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.856 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.500, %sharding_constraint.147), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.315 = bf16[7168]{0} reduce(%mul.856, %constant.403), dimensions={0,1}, to_apply=%region_207.286, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.34 = bf16[1,1,7168]{2,1,0} reshape(%reduce_sum.315), metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.316 = bf16[7168]{0} reduce(%reshape.34, %constant.403), dimensions={0,1}, to_apply=%region_208.287, metadata={op_name="checkpoint/moe_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.814 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.524, %mul.809), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.307 = bf16[512]{0} reduce(%mul.814, %constant.403), dimensions={0,1}, to_apply=%region_190.266, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.29 = bf16[1,1,512]{2,1,0} reshape(%reduce_sum.307), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.308 = bf16[512]{0} reduce(%reshape.29, %constant.403), dimensions={0,1}, to_apply=%region_191.267, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.116 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.33), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_72.5 = f32[1024]{0} parameter(72)
  %reduce_max.909 = f32[] reduce(%Arg_72.5, %constant.411), dimensions={0}, to_apply=%region_91.140, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.129 = pred[] is-finite(%reduce_max.909), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.129 = pred[] compare(%reduce_max.909, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.739 = f32[] divide(%constant.409, %reduce_max.909), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.740 = f32[] divide(%div.739, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_73.5 = f32[1]{0} parameter(73)
  %div.738 = f32[1]{0} divide(%constant.392, %Arg_73.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.262 = f32[1]{0} call(%gt.129, %div.740, %div.738), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.263 = f32[1]{0} call(%is_finite.129, %jit__where_.262, %div.738), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.741 = f32[1]{0} divide(%constant.392, %jit__where_.263), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.537 = bf16[1]{0} convert(%div.741), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.809 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.537), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.810 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.809), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.811 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.810), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.742 = bf16[32,4096,128,128]{3,2,1,0} divide(%sharding_constraint.116, %broadcast_in_dim.811), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.137 = bf16[32,4096,128,128]{3,2,1,0} call(%div.742, %constant.406, %constant.405), to_apply=%clip_512.143, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.538 = f8e4m3fn[32,4096,128,128]{3,2,1,0} convert(%jit_clip_.137), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.102 = bf16[7168,128,128]{2,1,0} dot(%convert_element_type.652, %convert_element_type.538), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.59 = bf16[128,128,7168]{1,0,2} transpose(%dot_general.102), dimensions={1,2,0}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.806 = f32[1]{0} multiply(%div.741, %div.884), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.654 = bf16[1]{0} convert(%mul.806), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.963 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.654), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.964 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.963), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.965 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.964), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.807 = bf16[128,128,7168]{1,0,2} multiply(%transpose.59, %broadcast_in_dim.965), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.836 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.511, %mul.833), metadata={op_name="checkpoint/moe_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.311 = bf16[1536]{0} reduce(%mul.836, %constant.403), dimensions={0,1}, to_apply=%region_197.274, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.32 = bf16[1,1,1536]{2,1,0} reshape(%reduce_sum.311), metadata={op_name="checkpoint/moe_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.312 = bf16[1536]{0} reduce(%reshape.32, %constant.403), dimensions={0,1}, to_apply=%region_198.275, metadata={op_name="checkpoint/moe_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.668 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.768), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.669 = bf16[7168]{0} reshape(%mul.668), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.670 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.669), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.671 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.500, %mul.670), metadata={op_name="checkpoint/rematted_computation/moe_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.111 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.671), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.112 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.111), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_62.5 = f32[1024]{0} parameter(62)
  %reduce_max.895 = f32[] reduce(%Arg_62.5, %constant.411), dimensions={0}, to_apply=%region_67.103, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.122 = pred[] is-finite(%reduce_max.895), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.122 = pred[] compare(%reduce_max.895, %constant.412), direction=GT, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.692 = f32[] divide(%constant.409, %reduce_max.895), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.693 = f32[] divide(%div.692, %constant.410), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_63.5 = f32[1]{0} parameter(63)
  %div.691 = f32[1]{0} divide(%constant.392, %Arg_63.5), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.248 = f32[1]{0} call(%gt.122, %div.693, %div.691), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.249 = f32[1]{0} call(%is_finite.122, %jit__where_.248, %div.691), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.694 = f32[1]{0} divide(%constant.392, %jit__where_.249), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.502 = bf16[1]{0} convert(%div.694), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.769 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.502), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.770 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.769), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.771 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.770), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.695 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.112, %broadcast_in_dim.771), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.128 = bf16[32,4096,7168]{2,1,0} call(%div.695, %constant.406, %constant.405), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.503 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.128), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.108 = bf16[576,7168]{1,0} dot(%convert_element_type.681, %convert_element_type.503), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.62 = bf16[7168,576]{0,1} transpose(%dot_general.108), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.850 = f32[1]{0} multiply(%div.694, %div.901), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.683 = bf16[1]{0} convert(%mul.850), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.997 = bf16[7168,1]{1,0} broadcast(%convert_element_type.683), dimensions={1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.998 = bf16[7168]{0} reshape(%broadcast_in_dim.997), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.999 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.998), dimensions={0}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.851 = bf16[7168,576]{0,1} multiply(%transpose.62, %broadcast_in_dim.999), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.104 = bf16[128,256,512]{2,1,0} dot(%convert_element_type.657, %convert_element_type.531), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.60 = bf16[512,128,256]{0,2,1} transpose(%dot_general.104), dimensions={2,0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.810 = f32[1]{0} multiply(%div.731, %div.889), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.659 = bf16[1]{0} convert(%mul.810), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.973 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.659), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.974 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.973), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.975 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.974), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.811 = bf16[512,128,256]{0,2,1} multiply(%transpose.60, %broadcast_in_dim.975), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.110 = bf16[1536,7168]{1,0} dot(%convert_element_type.686, %convert_element_type.503), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.63 = bf16[7168,1536]{0,1} transpose(%dot_general.110), dimensions={1,0}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.854 = f32[1]{0} multiply(%div.694, %div.906), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.688 = bf16[1]{0} convert(%mul.854), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1006 = bf16[7168,1]{1,0} broadcast(%convert_element_type.688), dimensions={1}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1007 = bf16[7168]{0} reshape(%broadcast_in_dim.1006), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1008 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.1007), dimensions={0}, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.855 = bf16[7168,1536]{0,1} multiply(%transpose.63, %broadcast_in_dim.1008), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.106 = bf16[128,192,1536]{2,1,0} dot(%convert_element_type.674, %convert_element_type.514), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.61 = bf16[1536,128,192]{0,2,1} transpose(%dot_general.106), dimensions={2,0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.834 = f32[1]{0} multiply(%div.711, %div.895), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.676 = bf16[1]{0} convert(%mul.834), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.987 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.676), dimensions={2}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.988 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.987), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.989 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.988), dimensions={0,1}, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.835 = bf16[1536,128,192]{0,2,1} multiply(%transpose.61, %broadcast_in_dim.989), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.49 = f32[1024]{0} call(%Arg_10.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.391 = s32[1]{0} constant({0})
  %abs.49 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.118), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.408 = bf16[] constant(-inf)
  %reduce_max.914 = bf16[] reduce(%abs.49, %constant.408), dimensions={0,1,2}, to_apply=%region_99.150, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.544 = f32[] convert(%reduce_max.914), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.209 = f32[1024]{0} scatter(%jit__roll_static_.49, %constant.391, %convert_element_type.544), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_100.151, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.50 = f32[1024]{0} call(%Arg_12.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.50 = bf16[7168,64]{1,0} abs(%Arg_90.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.916 = bf16[] reduce(%abs.50, %constant.408), dimensions={0,1}, to_apply=%region_102.153, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.547 = f32[] convert(%reduce_max.916), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.210 = f32[1024]{0} scatter(%jit__roll_static_.50, %constant.391, %convert_element_type.547), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_103.154, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.74 = f32[1024]{0} call(%Arg_14.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.74 = bf16[32,4096,64]{2,1,0} abs(%sharding_constraint.139), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.964 = bf16[] reduce(%abs.74, %constant.408), dimensions={0,1,2}, to_apply=%region_176.250, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.643 = f32[] convert(%reduce_max.964), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.234 = f32[1024]{0} scatter(%jit__roll_static_.74, %constant.391, %convert_element_type.643), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_177.251, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.51 = f32[1024]{0} call(%Arg_16.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.51 = bf16[32,4096,64,512]{3,2,1,0} abs(%convert_element_type.556), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.918 = bf16[] reduce(%abs.51, %constant.408), dimensions={0,1,2,3}, to_apply=%region_105.159, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.557 = f32[] convert(%reduce_max.918), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.211 = f32[1024]{0} scatter(%jit__roll_static_.51, %constant.391, %convert_element_type.557), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_106.160, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.52 = f32[1024]{0} call(%Arg_18.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.52 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.118), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.920 = bf16[] reduce(%abs.52, %constant.408), dimensions={0,1,2}, to_apply=%region_108.163, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.560 = f32[] convert(%reduce_max.920), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.212 = f32[1024]{0} scatter(%jit__roll_static_.52, %constant.391, %convert_element_type.560), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_109.164, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.73 = f32[1024]{0} call(%Arg_20.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.73 = bf16[32,64,512,7168]{3,2,0,1} abs(%transpose.56), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.962 = bf16[] reduce(%abs.73, %constant.408), dimensions={0,1,2,3}, to_apply=%region_171.244, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.639 = f32[] convert(%reduce_max.962), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.233 = f32[1024]{0} scatter(%jit__roll_static_.73, %constant.391, %convert_element_type.639), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_172.245, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/dispatch/_Fp8EinsumWrapper_0/fp8_einsum/BSM,BSEC -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.53 = f32[1024]{0} call(%Arg_22.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.53 = bf16[64,32,512,7168]{3,2,1,0} abs(%sharding_constraint.122), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.922 = bf16[] reduce(%abs.53, %constant.408), dimensions={0,1,2,3}, to_apply=%region_111.166, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.564 = f32[] convert(%reduce_max.922), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.213 = f32[1024]{0} scatter(%jit__roll_static_.53, %constant.391, %convert_element_type.564), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_112.167, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.54 = f32[1024]{0} call(%Arg_24.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.54 = bf16[64,7168,2048]{2,1,0} abs(%sharding_constraint.123), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.924 = bf16[] reduce(%abs.54, %constant.408), dimensions={0,1,2}, to_apply=%region_114.170, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.567 = f32[] convert(%reduce_max.924), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.214 = f32[1024]{0} scatter(%jit__roll_static_.54, %constant.391, %convert_element_type.567), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_115.171, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.55 = f32[1024]{0} call(%Arg_25.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.55 = bf16[64,7168,2048]{2,1,0} abs(%sharding_constraint.124), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.926 = bf16[] reduce(%abs.55, %constant.408), dimensions={0,1,2}, to_apply=%region_117.174, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.570 = f32[] convert(%reduce_max.926), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.215 = f32[1024]{0} scatter(%jit__roll_static_.55, %constant.391, %convert_element_type.570), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_118.175, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.72 = f32[1024]{0} call(%Arg_28.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.72 = bf16[64,32,512,2048]{3,2,1,0} abs(%sharding_constraint.134), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.960 = bf16[] reduce(%abs.72, %constant.408), dimensions={0,1,2,3}, to_apply=%region_168.241, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.634 = f32[] convert(%reduce_max.960), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.232 = f32[1024]{0} scatter(%jit__roll_static_.72, %constant.391, %convert_element_type.634), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_169.242, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.71 = f32[1024]{0} call(%Arg_29.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.71 = bf16[64,32,512,2048]{3,2,1,0} abs(%sharding_constraint.133), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.958 = bf16[] reduce(%abs.71, %constant.408), dimensions={0,1,2,3}, to_apply=%region_165.237, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.629 = f32[] convert(%reduce_max.958), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.231 = f32[1024]{0} scatter(%jit__roll_static_.71, %constant.391, %convert_element_type.629), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_166.238, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wis/_Fp8EinsumWrapper_1/fp8_einsum/EBCM,EMH -> EBCH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.56 = f32[1024]{0} call(%Arg_32.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.56 = bf16[64,32,512,2048]{3,2,1,0} abs(%mul.748), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.928 = bf16[] reduce(%abs.56, %constant.408), dimensions={0,1,2,3}, to_apply=%region_120.178, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.573 = f32[] convert(%reduce_max.928), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.216 = f32[1024]{0} scatter(%jit__roll_static_.56, %constant.391, %convert_element_type.573), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_121.179, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.57 = f32[1024]{0} call(%Arg_34.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.57 = bf16[64,2048,7168]{2,1,0} abs(%sharding_constraint.125), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.930 = bf16[] reduce(%abs.57, %constant.408), dimensions={0,1,2}, to_apply=%region_123.182, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.576 = f32[] convert(%reduce_max.930), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.217 = f32[1024]{0} scatter(%jit__roll_static_.57, %constant.391, %convert_element_type.576), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_124.183, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.70 = f32[1024]{0} call(%Arg_36.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.70 = bf16[64,32,512,7168]{3,2,1,0} abs(%sharding_constraint.131), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.956 = bf16[] reduce(%abs.70, %constant.408), dimensions={0,1,2,3}, to_apply=%region_162.232, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.624 = f32[] convert(%reduce_max.956), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.230 = f32[1024]{0} scatter(%jit__roll_static_.70, %constant.391, %convert_element_type.624), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_163.233, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/wo/_Fp8EinsumWrapper_2/fp8_einsum/EBCH,EHM -> EBCM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.58 = f32[1024]{0} call(%Arg_38.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.58 = bf16[32,4096,64,512]{3,2,1,0} abs(%sharding_constraint.121), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.932 = bf16[] reduce(%abs.58, %constant.408), dimensions={0,1,2,3}, to_apply=%region_126.186, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.580 = f32[] convert(%reduce_max.932), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.218 = f32[1024]{0} scatter(%jit__roll_static_.58, %constant.391, %convert_element_type.580), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_127.187, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.59 = f32[1024]{0} call(%Arg_40.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.59 = bf16[64,32,512,7168]{3,2,1,0} abs(%sharding_constraint.126), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.934 = bf16[] reduce(%abs.59, %constant.408), dimensions={0,1,2,3}, to_apply=%region_129.189, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.583 = f32[] convert(%reduce_max.934), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.219 = f32[1024]{0} scatter(%jit__roll_static_.59, %constant.391, %convert_element_type.583), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_130.190, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.69 = f32[1024]{0} call(%Arg_42.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.69 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.129), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.954 = bf16[] reduce(%abs.69, %constant.408), dimensions={0,1,2}, to_apply=%region_159.229, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.619 = f32[] convert(%reduce_max.954), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.229 = f32[1024]{0} scatter(%jit__roll_static_.69, %constant.391, %convert_element_type.619), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_160.230, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/combine/_Fp8EinsumWrapper_3/fp8_einsum/EBCM,BSEC -> BSM/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.60 = f32[1024]{0} call(%Arg_44.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.60 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.118), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.936 = bf16[] reduce(%abs.60, %constant.408), dimensions={0,1,2}, to_apply=%region_132.192, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.586 = f32[] convert(%reduce_max.936), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.220 = f32[1024]{0} scatter(%jit__roll_static_.60, %constant.391, %convert_element_type.586), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_133.193, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.61 = f32[1024]{0} call(%Arg_46.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.61 = bf16[7168,2048]{1,0} abs(%Arg_95.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.938 = bf16[] reduce(%abs.61, %constant.408), dimensions={0,1}, to_apply=%region_135.195, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.589 = f32[] convert(%reduce_max.938), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.221 = f32[1024]{0} scatter(%jit__roll_static_.61, %constant.391, %convert_element_type.589), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_136.196, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.68 = f32[1024]{0} call(%Arg_48.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.68 = bf16[32,4096,2048]{2,1,0} abs(%jit_silu_.24), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.952 = bf16[] reduce(%abs.68, %constant.408), dimensions={0,1,2}, to_apply=%region_156.226, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.614 = f32[] convert(%reduce_max.952), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.228 = f32[1024]{0} scatter(%jit__roll_static_.68, %constant.391, %convert_element_type.614), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_157.227, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.62 = f32[1024]{0} call(%Arg_50.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.62 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.118), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.940 = bf16[] reduce(%abs.62, %constant.408), dimensions={0,1,2}, to_apply=%region_138.200, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.592 = f32[] convert(%reduce_max.940), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.222 = f32[1024]{0} scatter(%jit__roll_static_.62, %constant.391, %convert_element_type.592), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_139.201, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.63 = f32[1024]{0} call(%Arg_52.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.63 = bf16[7168,2048]{1,0} abs(%Arg_96.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.942 = bf16[] reduce(%abs.63, %constant.408), dimensions={0,1}, to_apply=%region_141.203, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.595 = f32[] convert(%reduce_max.942), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.223 = f32[1024]{0} scatter(%jit__roll_static_.63, %constant.391, %convert_element_type.595), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_142.204, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.67 = f32[1024]{0} call(%Arg_54.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.67 = bf16[32,4096,2048]{2,1,0} abs(%mul.756), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.950 = bf16[] reduce(%abs.67, %constant.408), dimensions={0,1,2}, to_apply=%region_153.221, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.609 = f32[] convert(%reduce_max.950), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.227 = f32[1024]{0} scatter(%jit__roll_static_.67, %constant.391, %convert_element_type.609), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_154.222, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.64 = f32[1024]{0} call(%Arg_56.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.64 = bf16[32,4096,2048]{2,1,0} abs(%sharding_constraint.127), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.944 = bf16[] reduce(%abs.64, %constant.408), dimensions={0,1,2}, to_apply=%region_144.206, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.598 = f32[] convert(%reduce_max.944), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.224 = f32[1024]{0} scatter(%jit__roll_static_.64, %constant.391, %convert_element_type.598), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_145.207, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.65 = f32[1024]{0} call(%Arg_58.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.65 = bf16[2048,7168]{1,0} abs(%Arg_97.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.946 = bf16[] reduce(%abs.65, %constant.408), dimensions={0,1}, to_apply=%region_147.210, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.601 = f32[] convert(%reduce_max.946), metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.225 = f32[1024]{0} scatter(%jit__roll_static_.65, %constant.391, %convert_element_type.601), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_148.211, metadata={op_name="checkpoint/rematted_computation/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.66 = f32[1024]{0} call(%Arg_60.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.66 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.129), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.948 = bf16[] reduce(%abs.66, %constant.408), dimensions={0,1,2}, to_apply=%region_150.216, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.604 = f32[] convert(%reduce_max.948), metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.226 = f32[1024]{0} scatter(%jit__roll_static_.66, %constant.391, %convert_element_type.604), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_151.218, metadata={op_name="checkpoint/moe_layers/DeepSeekMoeBlock_0/Fp8DirectDotGeneralOp_3/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.40 = f32[1024]{0} call(%Arg_62.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.40 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.112), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.896 = bf16[] reduce(%abs.40, %constant.408), dimensions={0,1,2}, to_apply=%region_68.106, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.501 = f32[] convert(%reduce_max.896), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.200 = f32[1024]{0} scatter(%jit__roll_static_.40, %constant.391, %convert_element_type.501), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_69.108, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.41 = f32[1024]{0} call(%Arg_64.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.41 = bf16[7168,1536]{1,0} abs(%Arg_105.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.898 = bf16[] reduce(%abs.41, %constant.408), dimensions={0,1}, to_apply=%region_71.111, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.504 = f32[] convert(%reduce_max.898), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.201 = f32[1024]{0} scatter(%jit__roll_static_.41, %constant.391, %convert_element_type.504), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_72.112, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.42 = f32[1024]{0} call(%Arg_65.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.42 = bf16[7168,576]{1,0} abs(%Arg_103.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.900 = bf16[] reduce(%abs.42, %constant.408), dimensions={0,1}, to_apply=%region_74.115, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.507 = f32[] convert(%reduce_max.900), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.202 = f32[1024]{0} scatter(%jit__roll_static_.42, %constant.391, %convert_element_type.507), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_75.116, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.79 = f32[1024]{0} call(%Arg_68.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.79 = bf16[32,4096,1536]{2,1,0} abs(%convert_element_type.678), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.974 = bf16[] reduce(%abs.79, %constant.408), dimensions={0,1,2}, to_apply=%region_205.283, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.684 = f32[] convert(%reduce_max.974), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.239 = f32[1024]{0} scatter(%jit__roll_static_.79, %constant.391, %convert_element_type.684), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_206.284, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.78 = f32[1024]{0} call(%Arg_69.5), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.78 = bf16[32,4096,576]{2,1,0} abs(%concatenate.32), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.972 = bf16[] reduce(%abs.78, %constant.408), dimensions={0,1,2}, to_apply=%region_202.279, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.679 = f32[] convert(%reduce_max.972), metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.238 = f32[1024]{0} scatter(%jit__roll_static_.78, %constant.391, %convert_element_type.679), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_203.280, metadata={op_name="checkpoint/moe_layers/self_attention/fp8_einsum/BSD,DH->BSH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.47 = f32[1024]{0} call(%Arg_72.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.47 = bf16[32,4096,128,128]{3,2,1,0} abs(%sharding_constraint.116), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.910 = bf16[] reduce(%abs.47, %constant.408), dimensions={0,1,2,3}, to_apply=%region_92.141, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.536 = f32[] convert(%reduce_max.910), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.207 = f32[1024]{0} scatter(%jit__roll_static_.47, %constant.391, %convert_element_type.536), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_93.142, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.48 = f32[1024]{0} call(%Arg_74.5), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.48 = bf16[128,128,7168]{2,1,0} abs(%Arg_101.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.912 = bf16[] reduce(%abs.48, %constant.408), dimensions={0,1,2}, to_apply=%region_95.145, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.539 = f32[] convert(%reduce_max.912), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.208 = f32[1024]{0} scatter(%jit__roll_static_.48, %constant.391, %convert_element_type.539), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_96.146, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.75 = f32[1024]{0} call(%Arg_76.3), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.75 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.141), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.966 = bf16[] reduce(%abs.75, %constant.408), dimensions={0,1,2}, to_apply=%region_183.258, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.650 = f32[] convert(%reduce_max.966), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.235 = f32[1024]{0} scatter(%jit__roll_static_.75, %constant.391, %convert_element_type.650), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_184.259, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.45 = f32[1024]{0} call(%Arg_78.3), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.45 = bf16[32,4096,512]{2,1,0} abs(%mul.710), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.906 = bf16[] reduce(%abs.45, %constant.408), dimensions={0,1,2}, to_apply=%region_86.133, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.529 = f32[] convert(%reduce_max.906), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.205 = f32[1024]{0} scatter(%jit__roll_static_.45, %constant.391, %convert_element_type.529), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_87.134, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.46 = f32[1024]{0} call(%Arg_80.3), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.46 = bf16[512,128,256]{2,1,0} abs(%Arg_104.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.908 = bf16[] reduce(%abs.46, %constant.408), dimensions={0,1,2}, to_apply=%region_89.137, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.532 = f32[] convert(%reduce_max.908), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.206 = f32[1024]{0} scatter(%jit__roll_static_.46, %constant.391, %convert_element_type.532), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_90.138, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.76 = f32[1024]{0} call(%Arg_82.3), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.76 = bf16[32,4096,128,256]{3,2,1,0} abs(%concatenate.31), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.968 = bf16[] reduce(%abs.76, %constant.408), dimensions={0,1,2,3}, to_apply=%region_187.262, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.655 = f32[] convert(%reduce_max.968), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.236 = f32[1024]{0} scatter(%jit__roll_static_.76, %constant.391, %convert_element_type.655), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_188.263, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.43 = f32[1024]{0} call(%Arg_84.3), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.43 = bf16[32,4096,1536]{2,1,0} abs(%mul.681), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.902 = bf16[] reduce(%abs.43, %constant.408), dimensions={0,1,2}, to_apply=%region_78.120, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.512 = f32[] convert(%reduce_max.902), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.203 = f32[1024]{0} scatter(%jit__roll_static_.43, %constant.391, %convert_element_type.512), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_79.121, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.44 = f32[1024]{0} call(%Arg_86.3), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.44 = bf16[1536,128,192]{2,1,0} abs(%Arg_106.3), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.904 = bf16[] reduce(%abs.44, %constant.408), dimensions={0,1,2}, to_apply=%region_81.124, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.515 = f32[] convert(%reduce_max.904), metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.204 = f32[1024]{0} scatter(%jit__roll_static_.44, %constant.391, %convert_element_type.515), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_82.125, metadata={op_name="checkpoint/rematted_computation/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.77 = f32[1024]{0} call(%Arg_88.3), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.77 = bf16[32,4096,128,192]{3,2,1,0} abs(%concatenate.33), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.970 = bf16[] reduce(%abs.77, %constant.408), dimensions={0,1,2,3}, to_apply=%region_195.271, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.672 = f32[] convert(%reduce_max.970), metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.237 = f32[1024]{0} scatter(%jit__roll_static_.77, %constant.391, %convert_element_type.672), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_196.272, metadata={op_name="checkpoint/moe_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  ROOT %tuple.13 = (bf16[32,4096,7168]{2,1,0}, bf16[7168,64]{0,1}, bf16[64]{0}, bf16[64,7168,2048]{2,1,0}, bf16[64,7168,2048]{2,1,0}, /*index=5*/bf16[64,2048,7168]{2,1,0}, bf16[7168,2048]{0,1}, bf16[7168,2048]{0,1}, bf16[2048,7168]{0,1}, bf16[7168]{0}, /*index=10*/bf16[7168]{0}, bf16[512]{0}, bf16[128,128,7168]{1,0,2}, bf16[1536]{0}, bf16[7168,576]{0,1}, /*index=15*/bf16[512,128,256]{0,2,1}, bf16[7168,1536]{0,1}, bf16[1536,128,192]{0,2,1}, f32[1024]{0}, f32[1]{0}, /*index=20*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=25*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=30*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=35*/f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, f32[1]{0}, /*index=40*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=45*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=50*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=55*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=60*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=65*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=70*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=75*/f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, f32[1]{0}, /*index=80*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=85*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=90*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=95*/f32[1]{0}, f32[1024]{0}, f32[1]{0}) tuple(%sharding_constraint.148, %mul.791, %broadcast_in_dim.766, %sharding_constraint.136, %sharding_constraint.135, /*index=5*/%sharding_constraint.132, %mul.765, %mul.761, %mul.755, %reduce_sum.302, /*index=10*/%reduce_sum.316, %reduce_sum.308, %mul.807, %reduce_sum.312, %mul.851, /*index=15*/%mul.811, %mul.855, %mul.835, %scatter.209, %div.753, /*index=20*/%scatter.210, %div.758, %scatter.234, %div.878, %scatter.211, /*index=25*/%div.763, %scatter.212, %div.768, %scatter.233, %div.873, /*index=30*/%scatter.213, %div.773, %scatter.214, %scatter.215, %div.778, /*index=35*/%div.783, %scatter.232, %scatter.231, %div.868, %div.863, /*index=40*/%scatter.216, %div.788, %scatter.217, %div.793, %scatter.230, /*index=45*/%div.858, %scatter.218, %div.798, %scatter.219, %div.803, /*index=50*/%scatter.229, %div.853, %scatter.220, %div.808, %scatter.221, /*index=55*/%div.813, %scatter.228, %div.848, %scatter.222, %div.818, /*index=60*/%scatter.223, %div.823, %scatter.227, %div.843, %scatter.224, /*index=65*/%div.828, %scatter.225, %div.833, %scatter.226, %div.838, /*index=70*/%scatter.200, %div.694, %scatter.201, %scatter.202, %div.699, /*index=75*/%div.704, %scatter.239, %scatter.238, %div.906, %div.901, /*index=80*/%scatter.207, %div.741, %scatter.208, %div.746, %scatter.235, /*index=85*/%div.884, %scatter.205, %div.731, %scatter.206, %div.736, /*index=90*/%scatter.236, %div.889, %scatter.203, %div.711, %scatter.204, /*index=95*/%div.716, %scatter.237, %div.895)
}

%region_65.291 (arg_tuple.9: (s32[], bf16[32,4096,7168], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=5*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=10*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=15*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], /*index=20*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=25*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=35*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=65*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=75*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=80*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=85*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=90*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=95*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], bf16[2,32,4096,7168], /*index=100*/bf16[2,32,4096,1536], bf16[2,32,4096,576], bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], /*index=105*/bf16[2,32,4096,2048], bf16[2,32,4096,2048], f32[2,1024], f32[2,1], f32[2,1024], /*index=110*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=115*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=120*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=125*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=130*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=135*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=140*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=145*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=150*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=155*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=160*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=165*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=170*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=175*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=180*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=185*/f32[2,1024], f32[2,1], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=190*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=195*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=200*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], s32[32,4096])) -> (s32[], bf16[32,4096,7168], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=5*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=10*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=15*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], /*index=20*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=25*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=35*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=65*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=75*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=80*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=85*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=90*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=95*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], bf16[2,32,4096,7168], /*index=100*/bf16[2,32,4096,1536], bf16[2,32,4096,576], bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], /*index=105*/bf16[2,32,4096,2048], bf16[2,32,4096,2048], f32[2,1024], f32[2,1], f32[2,1024], /*index=110*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=115*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=120*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=125*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=130*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=135*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=140*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=145*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=150*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=155*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=160*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=165*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=170*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=175*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=180*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=185*/f32[2,1024], f32[2,1], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=190*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=195*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=200*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], s32[32,4096]) {
  %arg_tuple.9 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=5*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=10*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=15*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, /*index=20*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=25*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=35*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=75*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,32,4096,7168]{3,2,1,0}, /*index=100*/bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, /*index=105*/bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=130*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=135*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=140*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=145*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=150*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=155*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=160*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=165*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=170*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=175*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=180*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=185*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=190*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=195*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=200*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) parameter(0)
  %get-tuple-element.741 = s32[] get-tuple-element(%arg_tuple.9), index=0
  %constant.414 = s32[] constant(1)
  %add.109 = s32[] add(%get-tuple-element.741, %constant.414), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.945 = s32[32,4096]{1,0} get-tuple-element(%arg_tuple.9), index=204
  %get-tuple-element.742 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.9), index=1
  %get-tuple-element.840 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=99
  %constant.415 = s32[] constant(2)
  %sub.39 = s32[] subtract(%constant.415, %get-tuple-element.741), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %sub.40 = s32[] subtract(%sub.39, %constant.414), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.413 = s32[] constant(0)
  %dynamic_slice.327 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.840, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.352 = bf16[32,4096,7168]{2,1,0} reshape(%dynamic_slice.327), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.841 = bf16[2,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=100
  %dynamic_slice.328 = bf16[1,32,4096,1536]{3,2,1,0} dynamic-slice(%get-tuple-element.841, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.353 = bf16[32,4096,1536]{2,1,0} reshape(%dynamic_slice.328), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.842 = bf16[2,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=101
  %dynamic_slice.329 = bf16[1,32,4096,576]{3,2,1,0} dynamic-slice(%get-tuple-element.842, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,576}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.354 = bf16[32,4096,576]{2,1,0} reshape(%dynamic_slice.329), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.843 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=102
  %dynamic_slice.330 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.843, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.355 = bf16[32,4096,7168]{2,1,0} reshape(%dynamic_slice.330), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.844 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.9), index=103
  %dynamic_slice.331 = bf16[1,64,32,512,2048]{4,3,2,1,0} dynamic-slice(%get-tuple-element.844, %sub.40, %constant.413, %constant.413, %constant.413, /*index=5*/%constant.413), dynamic_slice_sizes={1,64,32,512,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.356 = bf16[64,32,512,2048]{3,2,1,0} reshape(%dynamic_slice.331), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.845 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.9), index=104
  %dynamic_slice.332 = bf16[1,64,32,512,2048]{4,3,2,1,0} dynamic-slice(%get-tuple-element.845, %sub.40, %constant.413, %constant.413, %constant.413, /*index=5*/%constant.413), dynamic_slice_sizes={1,64,32,512,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.357 = bf16[64,32,512,2048]{3,2,1,0} reshape(%dynamic_slice.332), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.846 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=105
  %dynamic_slice.333 = bf16[1,32,4096,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.846, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.358 = bf16[32,4096,2048]{2,1,0} reshape(%dynamic_slice.333), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.847 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=106
  %dynamic_slice.334 = bf16[1,32,4096,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.847, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,32,4096,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.359 = bf16[32,4096,2048]{2,1,0} reshape(%dynamic_slice.334), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.848 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=107
  %dynamic_slice.335 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.848, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.360 = f32[1024]{0} reshape(%dynamic_slice.335), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.849 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=108
  %dynamic_slice.336 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.849, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.361 = f32[1]{0} reshape(%dynamic_slice.336), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.850 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=109
  %dynamic_slice.337 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.850, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.362 = f32[1024]{0} reshape(%dynamic_slice.337), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.851 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=110
  %dynamic_slice.338 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.851, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.363 = f32[1]{0} reshape(%dynamic_slice.338), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.852 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=111
  %dynamic_slice.339 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.852, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.364 = f32[1024]{0} reshape(%dynamic_slice.339), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.853 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=112
  %dynamic_slice.340 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.853, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.365 = f32[1]{0} reshape(%dynamic_slice.340), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.854 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=113
  %dynamic_slice.341 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.854, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.366 = f32[1024]{0} reshape(%dynamic_slice.341), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.855 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=114
  %dynamic_slice.342 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.855, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.367 = f32[1]{0} reshape(%dynamic_slice.342), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.856 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=115
  %dynamic_slice.343 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.856, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.368 = f32[1024]{0} reshape(%dynamic_slice.343), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.857 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=116
  %dynamic_slice.344 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.857, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.369 = f32[1]{0} reshape(%dynamic_slice.344), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.858 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=117
  %dynamic_slice.345 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.858, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.370 = f32[1024]{0} reshape(%dynamic_slice.345), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.859 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=118
  %dynamic_slice.346 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.859, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.371 = f32[1]{0} reshape(%dynamic_slice.346), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.860 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=119
  %dynamic_slice.347 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.860, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.372 = f32[1024]{0} reshape(%dynamic_slice.347), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.861 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=120
  %dynamic_slice.348 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.861, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.373 = f32[1]{0} reshape(%dynamic_slice.348), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.862 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=121
  %dynamic_slice.349 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.862, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.374 = f32[1024]{0} reshape(%dynamic_slice.349), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.863 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=122
  %dynamic_slice.350 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.863, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.375 = f32[1024]{0} reshape(%dynamic_slice.350), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.864 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=123
  %dynamic_slice.351 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.864, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.376 = f32[1]{0} reshape(%dynamic_slice.351), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.865 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=124
  %dynamic_slice.352 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.865, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.377 = f32[1]{0} reshape(%dynamic_slice.352), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.866 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=125
  %dynamic_slice.353 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.866, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.378 = f32[1024]{0} reshape(%dynamic_slice.353), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.867 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=126
  %dynamic_slice.354 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.867, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.379 = f32[1024]{0} reshape(%dynamic_slice.354), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.868 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=127
  %dynamic_slice.355 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.868, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.380 = f32[1]{0} reshape(%dynamic_slice.355), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.869 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=128
  %dynamic_slice.356 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.869, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.381 = f32[1]{0} reshape(%dynamic_slice.356), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.870 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=129
  %dynamic_slice.357 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.870, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.382 = f32[1024]{0} reshape(%dynamic_slice.357), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.871 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=130
  %dynamic_slice.358 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.871, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.383 = f32[1]{0} reshape(%dynamic_slice.358), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.872 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=131
  %dynamic_slice.359 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.872, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.384 = f32[1024]{0} reshape(%dynamic_slice.359), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.873 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=132
  %dynamic_slice.360 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.873, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.385 = f32[1]{0} reshape(%dynamic_slice.360), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.874 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=133
  %dynamic_slice.361 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.874, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.386 = f32[1024]{0} reshape(%dynamic_slice.361), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.875 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=134
  %dynamic_slice.362 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.875, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.387 = f32[1]{0} reshape(%dynamic_slice.362), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.876 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=135
  %dynamic_slice.363 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.876, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.388 = f32[1024]{0} reshape(%dynamic_slice.363), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.877 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=136
  %dynamic_slice.364 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.877, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.389 = f32[1]{0} reshape(%dynamic_slice.364), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.878 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=137
  %dynamic_slice.365 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.878, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.390 = f32[1024]{0} reshape(%dynamic_slice.365), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.879 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=138
  %dynamic_slice.366 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.879, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.391 = f32[1]{0} reshape(%dynamic_slice.366), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.880 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=139
  %dynamic_slice.367 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.880, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.392 = f32[1024]{0} reshape(%dynamic_slice.367), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.881 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=140
  %dynamic_slice.368 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.881, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.393 = f32[1]{0} reshape(%dynamic_slice.368), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.882 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=141
  %dynamic_slice.369 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.882, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.394 = f32[1024]{0} reshape(%dynamic_slice.369), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.883 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=142
  %dynamic_slice.370 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.883, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.395 = f32[1]{0} reshape(%dynamic_slice.370), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.884 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=143
  %dynamic_slice.371 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.884, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.396 = f32[1024]{0} reshape(%dynamic_slice.371), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.885 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=144
  %dynamic_slice.372 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.885, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.397 = f32[1]{0} reshape(%dynamic_slice.372), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.886 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=145
  %dynamic_slice.373 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.886, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.398 = f32[1024]{0} reshape(%dynamic_slice.373), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.887 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=146
  %dynamic_slice.374 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.887, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.399 = f32[1]{0} reshape(%dynamic_slice.374), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.888 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=147
  %dynamic_slice.375 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.888, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.400 = f32[1024]{0} reshape(%dynamic_slice.375), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.889 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=148
  %dynamic_slice.376 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.889, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.401 = f32[1]{0} reshape(%dynamic_slice.376), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.890 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=149
  %dynamic_slice.377 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.890, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.402 = f32[1024]{0} reshape(%dynamic_slice.377), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.891 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=150
  %dynamic_slice.378 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.891, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.403 = f32[1]{0} reshape(%dynamic_slice.378), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.892 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=151
  %dynamic_slice.379 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.892, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.404 = f32[1024]{0} reshape(%dynamic_slice.379), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.893 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=152
  %dynamic_slice.380 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.893, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.405 = f32[1]{0} reshape(%dynamic_slice.380), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.894 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=153
  %dynamic_slice.381 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.894, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.406 = f32[1024]{0} reshape(%dynamic_slice.381), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.895 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=154
  %dynamic_slice.382 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.895, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.407 = f32[1]{0} reshape(%dynamic_slice.382), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.896 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=155
  %dynamic_slice.383 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.896, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.408 = f32[1024]{0} reshape(%dynamic_slice.383), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.897 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=156
  %dynamic_slice.384 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.897, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.409 = f32[1]{0} reshape(%dynamic_slice.384), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.898 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=157
  %dynamic_slice.385 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.898, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.410 = f32[1024]{0} reshape(%dynamic_slice.385), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.899 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=158
  %dynamic_slice.386 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.899, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.411 = f32[1]{0} reshape(%dynamic_slice.386), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.900 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=159
  %dynamic_slice.387 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.900, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.412 = f32[1024]{0} reshape(%dynamic_slice.387), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.901 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=160
  %dynamic_slice.388 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.901, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.413 = f32[1]{0} reshape(%dynamic_slice.388), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.902 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=161
  %dynamic_slice.389 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.902, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.414 = f32[1024]{0} reshape(%dynamic_slice.389), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.903 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=162
  %dynamic_slice.390 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.903, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.415 = f32[1024]{0} reshape(%dynamic_slice.390), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.904 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=163
  %dynamic_slice.391 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.904, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.416 = f32[1]{0} reshape(%dynamic_slice.391), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.905 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=164
  %dynamic_slice.392 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.905, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.417 = f32[1]{0} reshape(%dynamic_slice.392), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.906 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=165
  %dynamic_slice.393 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.906, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.418 = f32[1024]{0} reshape(%dynamic_slice.393), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.907 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=166
  %dynamic_slice.394 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.907, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.419 = f32[1024]{0} reshape(%dynamic_slice.394), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.908 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=167
  %dynamic_slice.395 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.908, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.420 = f32[1]{0} reshape(%dynamic_slice.395), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.909 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=168
  %dynamic_slice.396 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.909, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.421 = f32[1]{0} reshape(%dynamic_slice.396), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.910 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=169
  %dynamic_slice.397 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.910, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.422 = f32[1024]{0} reshape(%dynamic_slice.397), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.911 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=170
  %dynamic_slice.398 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.911, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.423 = f32[1]{0} reshape(%dynamic_slice.398), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.912 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=171
  %dynamic_slice.399 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.912, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.424 = f32[1024]{0} reshape(%dynamic_slice.399), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.913 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=172
  %dynamic_slice.400 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.913, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.425 = f32[1]{0} reshape(%dynamic_slice.400), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.914 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=173
  %dynamic_slice.401 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.914, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.426 = f32[1024]{0} reshape(%dynamic_slice.401), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.915 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=174
  %dynamic_slice.402 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.915, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.427 = f32[1]{0} reshape(%dynamic_slice.402), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.916 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=175
  %dynamic_slice.403 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.916, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.428 = f32[1024]{0} reshape(%dynamic_slice.403), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.917 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=176
  %dynamic_slice.404 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.917, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.429 = f32[1]{0} reshape(%dynamic_slice.404), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.918 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=177
  %dynamic_slice.405 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.918, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.430 = f32[1024]{0} reshape(%dynamic_slice.405), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.919 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=178
  %dynamic_slice.406 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.919, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.431 = f32[1]{0} reshape(%dynamic_slice.406), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.920 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=179
  %dynamic_slice.407 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.920, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.432 = f32[1024]{0} reshape(%dynamic_slice.407), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.921 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=180
  %dynamic_slice.408 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.921, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.433 = f32[1]{0} reshape(%dynamic_slice.408), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.922 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=181
  %dynamic_slice.409 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.922, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.434 = f32[1024]{0} reshape(%dynamic_slice.409), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.923 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=182
  %dynamic_slice.410 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.923, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.435 = f32[1]{0} reshape(%dynamic_slice.410), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.924 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=183
  %dynamic_slice.411 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.924, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.436 = f32[1024]{0} reshape(%dynamic_slice.411), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.925 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=184
  %dynamic_slice.412 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.925, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.437 = f32[1]{0} reshape(%dynamic_slice.412), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.926 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=185
  %dynamic_slice.413 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.926, %sub.40, %constant.413), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.438 = f32[1024]{0} reshape(%dynamic_slice.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.927 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=186
  %dynamic_slice.414 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.927, %sub.40, %constant.413), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.439 = f32[1]{0} reshape(%dynamic_slice.414), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.928 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.9), index=187
  %dynamic_slice.415 = bf16[1,7168,64]{2,1,0} dynamic-slice(%get-tuple-element.928, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,7168,64}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.440 = bf16[7168,64]{1,0} reshape(%dynamic_slice.415), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.929 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.9), index=188
  %dynamic_slice.416 = bf16[1,64]{1,0} dynamic-slice(%get-tuple-element.929, %sub.40, %constant.413), dynamic_slice_sizes={1,64}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.441 = bf16[64]{0} reshape(%dynamic_slice.416), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.930 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=189
  %dynamic_slice.417 = bf16[1,64,7168,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.930, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,64,7168,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.442 = bf16[64,7168,2048]{2,1,0} reshape(%dynamic_slice.417), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.931 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=190
  %dynamic_slice.418 = bf16[1,64,7168,2048]{3,2,1,0} dynamic-slice(%get-tuple-element.931, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,64,7168,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.443 = bf16[64,7168,2048]{2,1,0} reshape(%dynamic_slice.418), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.932 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=191
  %dynamic_slice.419 = bf16[1,64,2048,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.932, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,64,2048,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.444 = bf16[64,2048,7168]{2,1,0} reshape(%dynamic_slice.419), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.933 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.9), index=192
  %dynamic_slice.420 = bf16[1,7168,2048]{2,1,0} dynamic-slice(%get-tuple-element.933, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,7168,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.445 = bf16[7168,2048]{1,0} reshape(%dynamic_slice.420), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.934 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.9), index=193
  %dynamic_slice.421 = bf16[1,7168,2048]{2,1,0} dynamic-slice(%get-tuple-element.934, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,7168,2048}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.446 = bf16[7168,2048]{1,0} reshape(%dynamic_slice.421), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.935 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.9), index=194
  %dynamic_slice.422 = bf16[1,2048,7168]{2,1,0} dynamic-slice(%get-tuple-element.935, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,2048,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.447 = bf16[2048,7168]{1,0} reshape(%dynamic_slice.422), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.936 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.9), index=195
  %dynamic_slice.423 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.936, %sub.40, %constant.413), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.448 = bf16[7168]{0} reshape(%dynamic_slice.423), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.937 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.9), index=196
  %dynamic_slice.424 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.937, %sub.40, %constant.413), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.449 = bf16[7168]{0} reshape(%dynamic_slice.424), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.938 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.9), index=197
  %dynamic_slice.425 = bf16[1,512]{1,0} dynamic-slice(%get-tuple-element.938, %sub.40, %constant.413), dynamic_slice_sizes={1,512}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.450 = bf16[512]{0} reshape(%dynamic_slice.425), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.939 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=198
  %dynamic_slice.426 = bf16[1,128,128,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.939, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,128,128,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.451 = bf16[128,128,7168]{2,1,0} reshape(%dynamic_slice.426), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.940 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.9), index=199
  %dynamic_slice.427 = bf16[1,1536]{1,0} dynamic-slice(%get-tuple-element.940, %sub.40, %constant.413), dynamic_slice_sizes={1,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.452 = bf16[1536]{0} reshape(%dynamic_slice.427), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.941 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.9), index=200
  %dynamic_slice.428 = bf16[1,7168,576]{2,1,0} dynamic-slice(%get-tuple-element.941, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,7168,576}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.453 = bf16[7168,576]{1,0} reshape(%dynamic_slice.428), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.942 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=201
  %dynamic_slice.429 = bf16[1,512,128,256]{3,2,1,0} dynamic-slice(%get-tuple-element.942, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,512,128,256}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.454 = bf16[512,128,256]{2,1,0} reshape(%dynamic_slice.429), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.943 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.9), index=202
  %dynamic_slice.430 = bf16[1,7168,1536]{2,1,0} dynamic-slice(%get-tuple-element.943, %sub.40, %constant.413, %constant.413), dynamic_slice_sizes={1,7168,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.455 = bf16[7168,1536]{1,0} reshape(%dynamic_slice.430), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.944 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=203
  %dynamic_slice.431 = bf16[1,1536,128,192]{3,2,1,0} dynamic-slice(%get-tuple-element.944, %sub.40, %constant.413, %constant.413, %constant.413), dynamic_slice_sizes={1,1536,128,192}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.456 = bf16[1536,128,192]{2,1,0} reshape(%dynamic_slice.431), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.135 = (bf16[32,4096,7168]{2,1,0}, bf16[7168,64]{0,1}, bf16[64]{0}, bf16[64,7168,2048]{2,1,0}, bf16[64,7168,2048]{2,1,0}, /*index=5*/bf16[64,2048,7168]{2,1,0}, bf16[7168,2048]{0,1}, bf16[7168,2048]{0,1}, bf16[2048,7168]{0,1}, bf16[7168]{0}, /*index=10*/bf16[7168]{0}, bf16[512]{0}, bf16[128,128,7168]{1,0,2}, bf16[1536]{0}, bf16[7168,576]{0,1}, /*index=15*/bf16[512,128,256]{0,2,1}, bf16[7168,1536]{0,1}, bf16[1536,128,192]{0,2,1}, f32[1024]{0}, f32[1]{0}, /*index=20*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=25*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=30*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=35*/f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, f32[1]{0}, /*index=40*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=45*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=50*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=55*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=60*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=65*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=70*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=75*/f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, f32[1]{0}, /*index=80*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=85*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=90*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=95*/f32[1]{0}, f32[1024]{0}, f32[1]{0}) call(%get-tuple-element.945, %get-tuple-element.742, %squeeze.352, %squeeze.353, %squeeze.354, /*index=5*/%squeeze.355, %squeeze.356, %squeeze.357, %squeeze.358, %squeeze.359, /*index=10*/%squeeze.360, %squeeze.361, %squeeze.362, %squeeze.363, %squeeze.364, /*index=15*/%squeeze.365, %squeeze.366, %squeeze.367, %squeeze.368, %squeeze.369, /*index=20*/%squeeze.370, %squeeze.371, %squeeze.372, %squeeze.373, %squeeze.374, /*index=25*/%squeeze.375, %squeeze.376, %squeeze.377, %squeeze.378, %squeeze.379, /*index=30*/%squeeze.380, %squeeze.381, %squeeze.382, %squeeze.383, %squeeze.384, /*index=35*/%squeeze.385, %squeeze.386, %squeeze.387, %squeeze.388, %squeeze.389, /*index=40*/%squeeze.390, %squeeze.391, %squeeze.392, %squeeze.393, %squeeze.394, /*index=45*/%squeeze.395, %squeeze.396, %squeeze.397, %squeeze.398, %squeeze.399, /*index=50*/%squeeze.400, %squeeze.401, %squeeze.402, %squeeze.403, %squeeze.404, /*index=55*/%squeeze.405, %squeeze.406, %squeeze.407, %squeeze.408, %squeeze.409, /*index=60*/%squeeze.410, %squeeze.411, %squeeze.412, %squeeze.413, %squeeze.414, /*index=65*/%squeeze.415, %squeeze.416, %squeeze.417, %squeeze.418, %squeeze.419, /*index=70*/%squeeze.420, %squeeze.421, %squeeze.422, %squeeze.423, %squeeze.424, /*index=75*/%squeeze.425, %squeeze.426, %squeeze.427, %squeeze.428, %squeeze.429, /*index=80*/%squeeze.430, %squeeze.431, %squeeze.432, %squeeze.433, %squeeze.434, /*index=85*/%squeeze.435, %squeeze.436, %squeeze.437, %squeeze.438, %squeeze.439, /*index=90*/%squeeze.440, %squeeze.441, %squeeze.442, %squeeze.443, %squeeze.444, /*index=95*/%squeeze.445, %squeeze.446, %squeeze.447, %squeeze.448, %squeeze.449, /*index=100*/%squeeze.450, %squeeze.451, %squeeze.452, %squeeze.453, %squeeze.454, /*index=105*/%squeeze.455, %squeeze.456), to_apply=%closed_call_475.290, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.136 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.135), index=0, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.743 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.9), index=2
  %closed_call.137 = bf16[7168,64]{0,1} get-tuple-element(%closed_call.135), index=1, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1107 = bf16[1,7168,64]{2,1,0} reshape(%closed_call.137), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.125 = bf16[2,7168,64]{2,1,0} dynamic-update-slice(%get-tuple-element.743, %broadcast_in_dim.1107, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.744 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.9), index=3
  %closed_call.138 = bf16[64]{0} get-tuple-element(%closed_call.135), index=2, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1108 = bf16[1,64]{1,0} reshape(%closed_call.138), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.126 = bf16[2,64]{1,0} dynamic-update-slice(%get-tuple-element.744, %broadcast_in_dim.1108, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.745 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=4
  %closed_call.139 = bf16[64,7168,2048]{2,1,0} get-tuple-element(%closed_call.135), index=3, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1109 = bf16[1,64,7168,2048]{3,2,1,0} reshape(%closed_call.139), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.127 = bf16[2,64,7168,2048]{3,2,1,0} dynamic-update-slice(%get-tuple-element.745, %broadcast_in_dim.1109, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.746 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=5
  %closed_call.140 = bf16[64,7168,2048]{2,1,0} get-tuple-element(%closed_call.135), index=4, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1110 = bf16[1,64,7168,2048]{3,2,1,0} reshape(%closed_call.140), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.128 = bf16[2,64,7168,2048]{3,2,1,0} dynamic-update-slice(%get-tuple-element.746, %broadcast_in_dim.1110, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.747 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=6
  %closed_call.141 = bf16[64,2048,7168]{2,1,0} get-tuple-element(%closed_call.135), index=5, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1111 = bf16[1,64,2048,7168]{3,2,1,0} reshape(%closed_call.141), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.129 = bf16[2,64,2048,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.747, %broadcast_in_dim.1111, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.748 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.9), index=7
  %closed_call.142 = bf16[7168,2048]{0,1} get-tuple-element(%closed_call.135), index=6, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1112 = bf16[1,7168,2048]{2,1,0} reshape(%closed_call.142), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.130 = bf16[2,7168,2048]{2,1,0} dynamic-update-slice(%get-tuple-element.748, %broadcast_in_dim.1112, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.749 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.9), index=8
  %closed_call.143 = bf16[7168,2048]{0,1} get-tuple-element(%closed_call.135), index=7, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1113 = bf16[1,7168,2048]{2,1,0} reshape(%closed_call.143), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.131 = bf16[2,7168,2048]{2,1,0} dynamic-update-slice(%get-tuple-element.749, %broadcast_in_dim.1113, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.750 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.9), index=9
  %closed_call.144 = bf16[2048,7168]{0,1} get-tuple-element(%closed_call.135), index=8, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1114 = bf16[1,2048,7168]{2,1,0} reshape(%closed_call.144), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.132 = bf16[2,2048,7168]{2,1,0} dynamic-update-slice(%get-tuple-element.750, %broadcast_in_dim.1114, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.751 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.9), index=10
  %closed_call.145 = bf16[7168]{0} get-tuple-element(%closed_call.135), index=9, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1115 = bf16[1,7168]{1,0} reshape(%closed_call.145), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.133 = bf16[2,7168]{1,0} dynamic-update-slice(%get-tuple-element.751, %broadcast_in_dim.1115, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.752 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.9), index=11
  %closed_call.146 = bf16[7168]{0} get-tuple-element(%closed_call.135), index=10, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1116 = bf16[1,7168]{1,0} reshape(%closed_call.146), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.134 = bf16[2,7168]{1,0} dynamic-update-slice(%get-tuple-element.752, %broadcast_in_dim.1116, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.753 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.9), index=12
  %closed_call.147 = bf16[512]{0} get-tuple-element(%closed_call.135), index=11, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1117 = bf16[1,512]{1,0} reshape(%closed_call.147), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.135 = bf16[2,512]{1,0} dynamic-update-slice(%get-tuple-element.753, %broadcast_in_dim.1117, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.754 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=13
  %closed_call.148 = bf16[128,128,7168]{1,0,2} get-tuple-element(%closed_call.135), index=12, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1118 = bf16[1,128,128,7168]{3,2,1,0} reshape(%closed_call.148), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.136 = bf16[2,128,128,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.754, %broadcast_in_dim.1118, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.755 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.9), index=14
  %closed_call.149 = bf16[1536]{0} get-tuple-element(%closed_call.135), index=13, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1119 = bf16[1,1536]{1,0} reshape(%closed_call.149), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.137 = bf16[2,1536]{1,0} dynamic-update-slice(%get-tuple-element.755, %broadcast_in_dim.1119, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.756 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.9), index=15
  %closed_call.150 = bf16[7168,576]{0,1} get-tuple-element(%closed_call.135), index=14, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1120 = bf16[1,7168,576]{2,1,0} reshape(%closed_call.150), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.138 = bf16[2,7168,576]{2,1,0} dynamic-update-slice(%get-tuple-element.756, %broadcast_in_dim.1120, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.757 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=16
  %closed_call.151 = bf16[512,128,256]{0,2,1} get-tuple-element(%closed_call.135), index=15, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1121 = bf16[1,512,128,256]{3,2,1,0} reshape(%closed_call.151), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.139 = bf16[2,512,128,256]{3,2,1,0} dynamic-update-slice(%get-tuple-element.757, %broadcast_in_dim.1121, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.758 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.9), index=17
  %closed_call.152 = bf16[7168,1536]{0,1} get-tuple-element(%closed_call.135), index=16, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1122 = bf16[1,7168,1536]{2,1,0} reshape(%closed_call.152), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.140 = bf16[2,7168,1536]{2,1,0} dynamic-update-slice(%get-tuple-element.758, %broadcast_in_dim.1122, %sub.40, %constant.413, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.759 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.9), index=18
  %closed_call.153 = bf16[1536,128,192]{0,2,1} get-tuple-element(%closed_call.135), index=17, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1123 = bf16[1,1536,128,192]{3,2,1,0} reshape(%closed_call.153), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.141 = bf16[2,1536,128,192]{3,2,1,0} dynamic-update-slice(%get-tuple-element.759, %broadcast_in_dim.1123, %sub.40, %constant.413, %constant.413, /*index=5*/%constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.760 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=19
  %closed_call.154 = f32[1024]{0} get-tuple-element(%closed_call.135), index=18, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1124 = f32[1,1024]{1,0} reshape(%closed_call.154), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.142 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.760, %broadcast_in_dim.1124, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.761 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=20
  %closed_call.155 = f32[1]{0} get-tuple-element(%closed_call.135), index=19, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1125 = f32[1,1]{1,0} reshape(%closed_call.155), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.143 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.761, %broadcast_in_dim.1125, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.762 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=21
  %closed_call.156 = f32[1024]{0} get-tuple-element(%closed_call.135), index=20, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1126 = f32[1,1024]{1,0} reshape(%closed_call.156), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.144 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.762, %broadcast_in_dim.1126, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.763 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=22
  %closed_call.157 = f32[1]{0} get-tuple-element(%closed_call.135), index=21, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1127 = f32[1,1]{1,0} reshape(%closed_call.157), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.145 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.763, %broadcast_in_dim.1127, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.764 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=23
  %closed_call.158 = f32[1024]{0} get-tuple-element(%closed_call.135), index=22, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1128 = f32[1,1024]{1,0} reshape(%closed_call.158), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.146 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.764, %broadcast_in_dim.1128, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.765 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=24
  %closed_call.159 = f32[1]{0} get-tuple-element(%closed_call.135), index=23, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1129 = f32[1,1]{1,0} reshape(%closed_call.159), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.147 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.765, %broadcast_in_dim.1129, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.766 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=25
  %closed_call.160 = f32[1024]{0} get-tuple-element(%closed_call.135), index=24, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1130 = f32[1,1024]{1,0} reshape(%closed_call.160), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.148 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.766, %broadcast_in_dim.1130, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.767 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=26
  %closed_call.161 = f32[1]{0} get-tuple-element(%closed_call.135), index=25, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1131 = f32[1,1]{1,0} reshape(%closed_call.161), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.149 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.767, %broadcast_in_dim.1131, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.768 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=27
  %closed_call.162 = f32[1024]{0} get-tuple-element(%closed_call.135), index=26, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1132 = f32[1,1024]{1,0} reshape(%closed_call.162), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.150 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.768, %broadcast_in_dim.1132, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.769 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=28
  %closed_call.163 = f32[1]{0} get-tuple-element(%closed_call.135), index=27, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1133 = f32[1,1]{1,0} reshape(%closed_call.163), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.151 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.769, %broadcast_in_dim.1133, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.770 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=29
  %closed_call.164 = f32[1024]{0} get-tuple-element(%closed_call.135), index=28, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1134 = f32[1,1024]{1,0} reshape(%closed_call.164), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.152 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.770, %broadcast_in_dim.1134, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.771 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=30
  %closed_call.165 = f32[1]{0} get-tuple-element(%closed_call.135), index=29, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1135 = f32[1,1]{1,0} reshape(%closed_call.165), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.153 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.771, %broadcast_in_dim.1135, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.772 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=31
  %closed_call.166 = f32[1024]{0} get-tuple-element(%closed_call.135), index=30, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1136 = f32[1,1024]{1,0} reshape(%closed_call.166), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.154 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.772, %broadcast_in_dim.1136, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.773 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=32
  %closed_call.167 = f32[1]{0} get-tuple-element(%closed_call.135), index=31, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1137 = f32[1,1]{1,0} reshape(%closed_call.167), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.155 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.773, %broadcast_in_dim.1137, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.774 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=33
  %closed_call.168 = f32[1024]{0} get-tuple-element(%closed_call.135), index=32, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1138 = f32[1,1024]{1,0} reshape(%closed_call.168), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.156 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.774, %broadcast_in_dim.1138, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.775 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=34
  %closed_call.169 = f32[1024]{0} get-tuple-element(%closed_call.135), index=33, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1139 = f32[1,1024]{1,0} reshape(%closed_call.169), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.157 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.775, %broadcast_in_dim.1139, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.776 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=35
  %closed_call.170 = f32[1]{0} get-tuple-element(%closed_call.135), index=34, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1140 = f32[1,1]{1,0} reshape(%closed_call.170), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.158 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.776, %broadcast_in_dim.1140, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.777 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=36
  %closed_call.171 = f32[1]{0} get-tuple-element(%closed_call.135), index=35, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1141 = f32[1,1]{1,0} reshape(%closed_call.171), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.159 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.777, %broadcast_in_dim.1141, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.778 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=37
  %closed_call.172 = f32[1024]{0} get-tuple-element(%closed_call.135), index=36, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1142 = f32[1,1024]{1,0} reshape(%closed_call.172), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.160 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.778, %broadcast_in_dim.1142, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.779 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=38
  %closed_call.173 = f32[1024]{0} get-tuple-element(%closed_call.135), index=37, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1143 = f32[1,1024]{1,0} reshape(%closed_call.173), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.161 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.779, %broadcast_in_dim.1143, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.780 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=39
  %closed_call.174 = f32[1]{0} get-tuple-element(%closed_call.135), index=38, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1144 = f32[1,1]{1,0} reshape(%closed_call.174), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.162 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.780, %broadcast_in_dim.1144, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.781 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=40
  %closed_call.175 = f32[1]{0} get-tuple-element(%closed_call.135), index=39, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1145 = f32[1,1]{1,0} reshape(%closed_call.175), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.163 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.781, %broadcast_in_dim.1145, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.782 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=41
  %closed_call.176 = f32[1024]{0} get-tuple-element(%closed_call.135), index=40, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1146 = f32[1,1024]{1,0} reshape(%closed_call.176), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.164 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.782, %broadcast_in_dim.1146, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.783 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=42
  %closed_call.177 = f32[1]{0} get-tuple-element(%closed_call.135), index=41, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1147 = f32[1,1]{1,0} reshape(%closed_call.177), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.165 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.783, %broadcast_in_dim.1147, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.784 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=43
  %closed_call.178 = f32[1024]{0} get-tuple-element(%closed_call.135), index=42, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1148 = f32[1,1024]{1,0} reshape(%closed_call.178), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.166 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.784, %broadcast_in_dim.1148, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.785 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=44
  %closed_call.179 = f32[1]{0} get-tuple-element(%closed_call.135), index=43, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1149 = f32[1,1]{1,0} reshape(%closed_call.179), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.167 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.785, %broadcast_in_dim.1149, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.786 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=45
  %closed_call.180 = f32[1024]{0} get-tuple-element(%closed_call.135), index=44, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1150 = f32[1,1024]{1,0} reshape(%closed_call.180), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.168 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.786, %broadcast_in_dim.1150, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.787 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=46
  %closed_call.181 = f32[1]{0} get-tuple-element(%closed_call.135), index=45, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1151 = f32[1,1]{1,0} reshape(%closed_call.181), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.169 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.787, %broadcast_in_dim.1151, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.788 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=47
  %closed_call.182 = f32[1024]{0} get-tuple-element(%closed_call.135), index=46, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1152 = f32[1,1024]{1,0} reshape(%closed_call.182), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.170 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.788, %broadcast_in_dim.1152, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.789 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=48
  %closed_call.183 = f32[1]{0} get-tuple-element(%closed_call.135), index=47, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1153 = f32[1,1]{1,0} reshape(%closed_call.183), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.171 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.789, %broadcast_in_dim.1153, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.790 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=49
  %closed_call.184 = f32[1024]{0} get-tuple-element(%closed_call.135), index=48, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1154 = f32[1,1024]{1,0} reshape(%closed_call.184), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.172 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.790, %broadcast_in_dim.1154, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.791 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=50
  %closed_call.185 = f32[1]{0} get-tuple-element(%closed_call.135), index=49, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1155 = f32[1,1]{1,0} reshape(%closed_call.185), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.173 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.791, %broadcast_in_dim.1155, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.792 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=51
  %closed_call.186 = f32[1024]{0} get-tuple-element(%closed_call.135), index=50, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1156 = f32[1,1024]{1,0} reshape(%closed_call.186), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.174 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.792, %broadcast_in_dim.1156, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.793 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=52
  %closed_call.187 = f32[1]{0} get-tuple-element(%closed_call.135), index=51, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1157 = f32[1,1]{1,0} reshape(%closed_call.187), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.175 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.793, %broadcast_in_dim.1157, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.794 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=53
  %closed_call.188 = f32[1024]{0} get-tuple-element(%closed_call.135), index=52, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1158 = f32[1,1024]{1,0} reshape(%closed_call.188), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.176 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.794, %broadcast_in_dim.1158, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.795 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=54
  %closed_call.189 = f32[1]{0} get-tuple-element(%closed_call.135), index=53, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1159 = f32[1,1]{1,0} reshape(%closed_call.189), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.177 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.795, %broadcast_in_dim.1159, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.796 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=55
  %closed_call.190 = f32[1024]{0} get-tuple-element(%closed_call.135), index=54, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1160 = f32[1,1024]{1,0} reshape(%closed_call.190), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.178 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.796, %broadcast_in_dim.1160, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.797 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=56
  %closed_call.191 = f32[1]{0} get-tuple-element(%closed_call.135), index=55, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1161 = f32[1,1]{1,0} reshape(%closed_call.191), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.179 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.797, %broadcast_in_dim.1161, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.798 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=57
  %closed_call.192 = f32[1024]{0} get-tuple-element(%closed_call.135), index=56, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1162 = f32[1,1024]{1,0} reshape(%closed_call.192), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.180 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.798, %broadcast_in_dim.1162, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.799 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=58
  %closed_call.193 = f32[1]{0} get-tuple-element(%closed_call.135), index=57, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1163 = f32[1,1]{1,0} reshape(%closed_call.193), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.181 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.799, %broadcast_in_dim.1163, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.800 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=59
  %closed_call.194 = f32[1024]{0} get-tuple-element(%closed_call.135), index=58, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1164 = f32[1,1024]{1,0} reshape(%closed_call.194), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.182 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.800, %broadcast_in_dim.1164, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.801 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=60
  %closed_call.195 = f32[1]{0} get-tuple-element(%closed_call.135), index=59, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1165 = f32[1,1]{1,0} reshape(%closed_call.195), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.183 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.801, %broadcast_in_dim.1165, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.802 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=61
  %closed_call.196 = f32[1024]{0} get-tuple-element(%closed_call.135), index=60, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1166 = f32[1,1024]{1,0} reshape(%closed_call.196), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.184 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.802, %broadcast_in_dim.1166, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.803 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=62
  %closed_call.197 = f32[1]{0} get-tuple-element(%closed_call.135), index=61, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1167 = f32[1,1]{1,0} reshape(%closed_call.197), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.185 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.803, %broadcast_in_dim.1167, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.804 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=63
  %closed_call.198 = f32[1024]{0} get-tuple-element(%closed_call.135), index=62, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1168 = f32[1,1024]{1,0} reshape(%closed_call.198), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.186 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.804, %broadcast_in_dim.1168, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.805 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=64
  %closed_call.199 = f32[1]{0} get-tuple-element(%closed_call.135), index=63, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1169 = f32[1,1]{1,0} reshape(%closed_call.199), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.187 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.805, %broadcast_in_dim.1169, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.806 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=65
  %closed_call.200 = f32[1024]{0} get-tuple-element(%closed_call.135), index=64, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1170 = f32[1,1024]{1,0} reshape(%closed_call.200), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.188 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.806, %broadcast_in_dim.1170, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.807 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=66
  %closed_call.201 = f32[1]{0} get-tuple-element(%closed_call.135), index=65, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1171 = f32[1,1]{1,0} reshape(%closed_call.201), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.189 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.807, %broadcast_in_dim.1171, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.808 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=67
  %closed_call.202 = f32[1024]{0} get-tuple-element(%closed_call.135), index=66, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1172 = f32[1,1024]{1,0} reshape(%closed_call.202), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.190 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.808, %broadcast_in_dim.1172, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.809 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=68
  %closed_call.203 = f32[1]{0} get-tuple-element(%closed_call.135), index=67, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1173 = f32[1,1]{1,0} reshape(%closed_call.203), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.191 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.809, %broadcast_in_dim.1173, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.810 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=69
  %closed_call.204 = f32[1024]{0} get-tuple-element(%closed_call.135), index=68, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1174 = f32[1,1024]{1,0} reshape(%closed_call.204), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.192 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.810, %broadcast_in_dim.1174, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.811 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=70
  %closed_call.205 = f32[1]{0} get-tuple-element(%closed_call.135), index=69, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1175 = f32[1,1]{1,0} reshape(%closed_call.205), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.193 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.811, %broadcast_in_dim.1175, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.812 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=71
  %closed_call.206 = f32[1024]{0} get-tuple-element(%closed_call.135), index=70, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1176 = f32[1,1024]{1,0} reshape(%closed_call.206), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.194 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.812, %broadcast_in_dim.1176, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.813 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=72
  %closed_call.207 = f32[1]{0} get-tuple-element(%closed_call.135), index=71, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1177 = f32[1,1]{1,0} reshape(%closed_call.207), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.195 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.813, %broadcast_in_dim.1177, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.814 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=73
  %closed_call.208 = f32[1024]{0} get-tuple-element(%closed_call.135), index=72, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1178 = f32[1,1024]{1,0} reshape(%closed_call.208), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.196 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.814, %broadcast_in_dim.1178, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.815 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=74
  %closed_call.209 = f32[1024]{0} get-tuple-element(%closed_call.135), index=73, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1179 = f32[1,1024]{1,0} reshape(%closed_call.209), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.197 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.815, %broadcast_in_dim.1179, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.816 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=75
  %closed_call.210 = f32[1]{0} get-tuple-element(%closed_call.135), index=74, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1180 = f32[1,1]{1,0} reshape(%closed_call.210), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.198 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.816, %broadcast_in_dim.1180, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.817 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=76
  %closed_call.211 = f32[1]{0} get-tuple-element(%closed_call.135), index=75, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1181 = f32[1,1]{1,0} reshape(%closed_call.211), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.199 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.817, %broadcast_in_dim.1181, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.818 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=77
  %closed_call.212 = f32[1024]{0} get-tuple-element(%closed_call.135), index=76, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1182 = f32[1,1024]{1,0} reshape(%closed_call.212), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.200 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.818, %broadcast_in_dim.1182, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.819 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=78
  %closed_call.213 = f32[1024]{0} get-tuple-element(%closed_call.135), index=77, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1183 = f32[1,1024]{1,0} reshape(%closed_call.213), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.201 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.819, %broadcast_in_dim.1183, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.820 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=79
  %closed_call.214 = f32[1]{0} get-tuple-element(%closed_call.135), index=78, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1184 = f32[1,1]{1,0} reshape(%closed_call.214), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.202 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.820, %broadcast_in_dim.1184, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.821 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=80
  %closed_call.215 = f32[1]{0} get-tuple-element(%closed_call.135), index=79, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1185 = f32[1,1]{1,0} reshape(%closed_call.215), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.203 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.821, %broadcast_in_dim.1185, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.822 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=81
  %closed_call.216 = f32[1024]{0} get-tuple-element(%closed_call.135), index=80, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1186 = f32[1,1024]{1,0} reshape(%closed_call.216), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.204 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.822, %broadcast_in_dim.1186, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.823 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=82
  %closed_call.217 = f32[1]{0} get-tuple-element(%closed_call.135), index=81, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1187 = f32[1,1]{1,0} reshape(%closed_call.217), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.205 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.823, %broadcast_in_dim.1187, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.824 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=83
  %closed_call.218 = f32[1024]{0} get-tuple-element(%closed_call.135), index=82, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1188 = f32[1,1024]{1,0} reshape(%closed_call.218), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.206 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.824, %broadcast_in_dim.1188, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.825 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=84
  %closed_call.219 = f32[1]{0} get-tuple-element(%closed_call.135), index=83, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1189 = f32[1,1]{1,0} reshape(%closed_call.219), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.207 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.825, %broadcast_in_dim.1189, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.826 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=85
  %closed_call.220 = f32[1024]{0} get-tuple-element(%closed_call.135), index=84, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1190 = f32[1,1024]{1,0} reshape(%closed_call.220), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.208 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.826, %broadcast_in_dim.1190, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.827 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=86
  %closed_call.221 = f32[1]{0} get-tuple-element(%closed_call.135), index=85, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1191 = f32[1,1]{1,0} reshape(%closed_call.221), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.209 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.827, %broadcast_in_dim.1191, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.828 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=87
  %closed_call.222 = f32[1024]{0} get-tuple-element(%closed_call.135), index=86, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1192 = f32[1,1024]{1,0} reshape(%closed_call.222), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.210 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.828, %broadcast_in_dim.1192, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.829 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=88
  %closed_call.223 = f32[1]{0} get-tuple-element(%closed_call.135), index=87, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1193 = f32[1,1]{1,0} reshape(%closed_call.223), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.211 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.829, %broadcast_in_dim.1193, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.830 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=89
  %closed_call.224 = f32[1024]{0} get-tuple-element(%closed_call.135), index=88, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1194 = f32[1,1024]{1,0} reshape(%closed_call.224), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.212 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.830, %broadcast_in_dim.1194, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.831 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=90
  %closed_call.225 = f32[1]{0} get-tuple-element(%closed_call.135), index=89, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1195 = f32[1,1]{1,0} reshape(%closed_call.225), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.213 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.831, %broadcast_in_dim.1195, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.832 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=91
  %closed_call.226 = f32[1024]{0} get-tuple-element(%closed_call.135), index=90, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1196 = f32[1,1024]{1,0} reshape(%closed_call.226), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.214 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.832, %broadcast_in_dim.1196, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.833 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=92
  %closed_call.227 = f32[1]{0} get-tuple-element(%closed_call.135), index=91, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1197 = f32[1,1]{1,0} reshape(%closed_call.227), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.215 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.833, %broadcast_in_dim.1197, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.834 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=93
  %closed_call.228 = f32[1024]{0} get-tuple-element(%closed_call.135), index=92, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1198 = f32[1,1024]{1,0} reshape(%closed_call.228), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.216 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.834, %broadcast_in_dim.1198, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.835 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=94
  %closed_call.229 = f32[1]{0} get-tuple-element(%closed_call.135), index=93, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1199 = f32[1,1]{1,0} reshape(%closed_call.229), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.217 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.835, %broadcast_in_dim.1199, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.836 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=95
  %closed_call.230 = f32[1024]{0} get-tuple-element(%closed_call.135), index=94, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1200 = f32[1,1024]{1,0} reshape(%closed_call.230), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.218 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.836, %broadcast_in_dim.1200, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.837 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=96
  %closed_call.231 = f32[1]{0} get-tuple-element(%closed_call.135), index=95, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1201 = f32[1,1]{1,0} reshape(%closed_call.231), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.219 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.837, %broadcast_in_dim.1201, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.838 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.9), index=97
  %closed_call.232 = f32[1024]{0} get-tuple-element(%closed_call.135), index=96, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1202 = f32[1,1024]{1,0} reshape(%closed_call.232), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.220 = f32[2,1024]{1,0} dynamic-update-slice(%get-tuple-element.838, %broadcast_in_dim.1202, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.839 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.9), index=98
  %closed_call.233 = f32[1]{0} get-tuple-element(%closed_call.135), index=97, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1203 = f32[1,1]{1,0} reshape(%closed_call.233), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.221 = f32[2,1]{1,0} dynamic-update-slice(%get-tuple-element.839, %broadcast_in_dim.1203, %sub.40, %constant.413), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  ROOT %tuple.15 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=5*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=10*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=15*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, /*index=20*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=25*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=35*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=75*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,32,4096,7168]{3,2,1,0}, /*index=100*/bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, /*index=105*/bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=130*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=135*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=140*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=145*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=150*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=155*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=160*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=165*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=170*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=175*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=180*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=185*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=190*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=195*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=200*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) tuple(%add.109, %closed_call.136, %dynamic_update_slice.125, %dynamic_update_slice.126, %dynamic_update_slice.127, /*index=5*/%dynamic_update_slice.128, %dynamic_update_slice.129, %dynamic_update_slice.130, %dynamic_update_slice.131, %dynamic_update_slice.132, /*index=10*/%dynamic_update_slice.133, %dynamic_update_slice.134, %dynamic_update_slice.135, %dynamic_update_slice.136, %dynamic_update_slice.137, /*index=15*/%dynamic_update_slice.138, %dynamic_update_slice.139, %dynamic_update_slice.140, %dynamic_update_slice.141, %dynamic_update_slice.142, /*index=20*/%dynamic_update_slice.143, %dynamic_update_slice.144, %dynamic_update_slice.145, %dynamic_update_slice.146, %dynamic_update_slice.147, /*index=25*/%dynamic_update_slice.148, %dynamic_update_slice.149, %dynamic_update_slice.150, %dynamic_update_slice.151, %dynamic_update_slice.152, /*index=30*/%dynamic_update_slice.153, %dynamic_update_slice.154, %dynamic_update_slice.155, %dynamic_update_slice.156, %dynamic_update_slice.157, /*index=35*/%dynamic_update_slice.158, %dynamic_update_slice.159, %dynamic_update_slice.160, %dynamic_update_slice.161, %dynamic_update_slice.162, /*index=40*/%dynamic_update_slice.163, %dynamic_update_slice.164, %dynamic_update_slice.165, %dynamic_update_slice.166, %dynamic_update_slice.167, /*index=45*/%dynamic_update_slice.168, %dynamic_update_slice.169, %dynamic_update_slice.170, %dynamic_update_slice.171, %dynamic_update_slice.172, /*index=50*/%dynamic_update_slice.173, %dynamic_update_slice.174, %dynamic_update_slice.175, %dynamic_update_slice.176, %dynamic_update_slice.177, /*index=55*/%dynamic_update_slice.178, %dynamic_update_slice.179, %dynamic_update_slice.180, %dynamic_update_slice.181, %dynamic_update_slice.182, /*index=60*/%dynamic_update_slice.183, %dynamic_update_slice.184, %dynamic_update_slice.185, %dynamic_update_slice.186, %dynamic_update_slice.187, /*index=65*/%dynamic_update_slice.188, %dynamic_update_slice.189, %dynamic_update_slice.190, %dynamic_update_slice.191, %dynamic_update_slice.192, /*index=70*/%dynamic_update_slice.193, %dynamic_update_slice.194, %dynamic_update_slice.195, %dynamic_update_slice.196, %dynamic_update_slice.197, /*index=75*/%dynamic_update_slice.198, %dynamic_update_slice.199, %dynamic_update_slice.200, %dynamic_update_slice.201, %dynamic_update_slice.202, /*index=80*/%dynamic_update_slice.203, %dynamic_update_slice.204, %dynamic_update_slice.205, %dynamic_update_slice.206, %dynamic_update_slice.207, /*index=85*/%dynamic_update_slice.208, %dynamic_update_slice.209, %dynamic_update_slice.210, %dynamic_update_slice.211, %dynamic_update_slice.212, /*index=90*/%dynamic_update_slice.213, %dynamic_update_slice.214, %dynamic_update_slice.215, %dynamic_update_slice.216, %dynamic_update_slice.217, /*index=95*/%dynamic_update_slice.218, %dynamic_update_slice.219, %dynamic_update_slice.220, %dynamic_update_slice.221, %get-tuple-element.840, /*index=100*/%get-tuple-element.841, %get-tuple-element.842, %get-tuple-element.843, %get-tuple-element.844, %get-tuple-element.845, /*index=105*/%get-tuple-element.846, %get-tuple-element.847, %get-tuple-element.848, %get-tuple-element.849, %get-tuple-element.850, /*index=110*/%get-tuple-element.851, %get-tuple-element.852, %get-tuple-element.853, %get-tuple-element.854, %get-tuple-element.855, /*index=115*/%get-tuple-element.856, %get-tuple-element.857, %get-tuple-element.858, %get-tuple-element.859, %get-tuple-element.860, /*index=120*/%get-tuple-element.861, %get-tuple-element.862, %get-tuple-element.863, %get-tuple-element.864, %get-tuple-element.865, /*index=125*/%get-tuple-element.866, %get-tuple-element.867, %get-tuple-element.868, %get-tuple-element.869, %get-tuple-element.870, /*index=130*/%get-tuple-element.871, %get-tuple-element.872, %get-tuple-element.873, %get-tuple-element.874, %get-tuple-element.875, /*index=135*/%get-tuple-element.876, %get-tuple-element.877, %get-tuple-element.878, %get-tuple-element.879, %get-tuple-element.880, /*index=140*/%get-tuple-element.881, %get-tuple-element.882, %get-tuple-element.883, %get-tuple-element.884, %get-tuple-element.885, /*index=145*/%get-tuple-element.886, %get-tuple-element.887, %get-tuple-element.888, %get-tuple-element.889, %get-tuple-element.890, /*index=150*/%get-tuple-element.891, %get-tuple-element.892, %get-tuple-element.893, %get-tuple-element.894, %get-tuple-element.895, /*index=155*/%get-tuple-element.896, %get-tuple-element.897, %get-tuple-element.898, %get-tuple-element.899, %get-tuple-element.900, /*index=160*/%get-tuple-element.901, %get-tuple-element.902, %get-tuple-element.903, %get-tuple-element.904, %get-tuple-element.905, /*index=165*/%get-tuple-element.906, %get-tuple-element.907, %get-tuple-element.908, %get-tuple-element.909, %get-tuple-element.910, /*index=170*/%get-tuple-element.911, %get-tuple-element.912, %get-tuple-element.913, %get-tuple-element.914, %get-tuple-element.915, /*index=175*/%get-tuple-element.916, %get-tuple-element.917, %get-tuple-element.918, %get-tuple-element.919, %get-tuple-element.920, /*index=180*/%get-tuple-element.921, %get-tuple-element.922, %get-tuple-element.923, %get-tuple-element.924, %get-tuple-element.925, /*index=185*/%get-tuple-element.926, %get-tuple-element.927, %get-tuple-element.928, %get-tuple-element.929, %get-tuple-element.930, /*index=190*/%get-tuple-element.931, %get-tuple-element.932, %get-tuple-element.933, %get-tuple-element.934, %get-tuple-element.935, /*index=195*/%get-tuple-element.936, %get-tuple-element.937, %get-tuple-element.938, %get-tuple-element.939, %get-tuple-element.940, /*index=200*/%get-tuple-element.941, %get-tuple-element.942, %get-tuple-element.943, %get-tuple-element.944, %get-tuple-element.945)
}

%region_211.292 (arg_tuple.11: (s32[], bf16[32,4096,7168], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=5*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=10*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=15*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], f32[2,1024], /*index=20*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=25*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=30*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=35*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=40*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=45*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=65*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1024], /*index=75*/f32[2,1], f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], /*index=80*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=85*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=90*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=95*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], bf16[2,32,4096,7168], /*index=100*/bf16[2,32,4096,1536], bf16[2,32,4096,576], bf16[2,32,4096,7168], bf16[2,64,32,512,2048], bf16[2,64,32,512,2048], /*index=105*/bf16[2,32,4096,2048], bf16[2,32,4096,2048], f32[2,1024], f32[2,1], f32[2,1024], /*index=110*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=115*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=120*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=125*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=130*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=135*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=140*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=145*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=150*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=155*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=160*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=165*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=170*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=175*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=180*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=185*/f32[2,1024], f32[2,1], bf16[2,7168,64], bf16[2,64], bf16[2,64,7168,2048], /*index=190*/bf16[2,64,7168,2048], bf16[2,64,2048,7168], bf16[2,7168,2048], bf16[2,7168,2048], bf16[2,2048,7168], /*index=195*/bf16[2,7168], bf16[2,7168], bf16[2,512], bf16[2,128,128,7168], bf16[2,1536], /*index=200*/bf16[2,7168,576], bf16[2,512,128,256], bf16[2,7168,1536], bf16[2,1536,128,192], s32[32,4096])) -> pred[] {
  %arg_tuple.11 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=5*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=10*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=15*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, /*index=20*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=25*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=35*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=75*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,32,4096,7168]{3,2,1,0}, /*index=100*/bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, /*index=105*/bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=130*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=135*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=140*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=145*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=150*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=155*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=160*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=165*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=170*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=175*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=180*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=185*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=190*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=195*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=200*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) parameter(0)
  %get-tuple-element.1152 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.11), index=1
  %get-tuple-element.1153 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.11), index=2
  %get-tuple-element.1154 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.11), index=3
  %get-tuple-element.1155 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=4
  %get-tuple-element.1156 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=5
  %get-tuple-element.1157 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=6
  %get-tuple-element.1158 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.11), index=7
  %get-tuple-element.1159 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.11), index=8
  %get-tuple-element.1160 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.11), index=9
  %get-tuple-element.1161 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.11), index=10
  %get-tuple-element.1162 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.11), index=11
  %get-tuple-element.1163 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.11), index=12
  %get-tuple-element.1164 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=13
  %get-tuple-element.1165 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.11), index=14
  %get-tuple-element.1166 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.11), index=15
  %get-tuple-element.1167 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=16
  %get-tuple-element.1168 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.11), index=17
  %get-tuple-element.1169 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=18
  %get-tuple-element.1170 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=19
  %get-tuple-element.1171 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=20
  %get-tuple-element.1172 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=21
  %get-tuple-element.1173 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=22
  %get-tuple-element.1174 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=23
  %get-tuple-element.1175 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=24
  %get-tuple-element.1176 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=25
  %get-tuple-element.1177 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=26
  %get-tuple-element.1178 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=27
  %get-tuple-element.1179 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=28
  %get-tuple-element.1180 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=29
  %get-tuple-element.1181 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=30
  %get-tuple-element.1182 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=31
  %get-tuple-element.1183 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=32
  %get-tuple-element.1184 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=33
  %get-tuple-element.1185 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=34
  %get-tuple-element.1186 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=35
  %get-tuple-element.1187 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=36
  %get-tuple-element.1188 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=37
  %get-tuple-element.1189 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=38
  %get-tuple-element.1190 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=39
  %get-tuple-element.1191 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=40
  %get-tuple-element.1192 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=41
  %get-tuple-element.1193 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=42
  %get-tuple-element.1194 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=43
  %get-tuple-element.1195 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=44
  %get-tuple-element.1196 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=45
  %get-tuple-element.1197 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=46
  %get-tuple-element.1198 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=47
  %get-tuple-element.1199 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=48
  %get-tuple-element.1200 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=49
  %get-tuple-element.1201 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=50
  %get-tuple-element.1202 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=51
  %get-tuple-element.1203 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=52
  %get-tuple-element.1204 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=53
  %get-tuple-element.1205 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=54
  %get-tuple-element.1206 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=55
  %get-tuple-element.1207 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=56
  %get-tuple-element.1208 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=57
  %get-tuple-element.1209 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=58
  %get-tuple-element.1210 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=59
  %get-tuple-element.1211 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=60
  %get-tuple-element.1212 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=61
  %get-tuple-element.1213 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=62
  %get-tuple-element.1214 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=63
  %get-tuple-element.1215 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=64
  %get-tuple-element.1216 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=65
  %get-tuple-element.1217 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=66
  %get-tuple-element.1218 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=67
  %get-tuple-element.1219 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=68
  %get-tuple-element.1220 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=69
  %get-tuple-element.1221 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=70
  %get-tuple-element.1222 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=71
  %get-tuple-element.1223 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=72
  %get-tuple-element.1224 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=73
  %get-tuple-element.1225 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=74
  %get-tuple-element.1226 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=75
  %get-tuple-element.1227 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=76
  %get-tuple-element.1228 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=77
  %get-tuple-element.1229 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=78
  %get-tuple-element.1230 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=79
  %get-tuple-element.1231 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=80
  %get-tuple-element.1232 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=81
  %get-tuple-element.1233 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=82
  %get-tuple-element.1234 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=83
  %get-tuple-element.1235 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=84
  %get-tuple-element.1236 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=85
  %get-tuple-element.1237 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=86
  %get-tuple-element.1238 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=87
  %get-tuple-element.1239 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=88
  %get-tuple-element.1240 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=89
  %get-tuple-element.1241 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=90
  %get-tuple-element.1242 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=91
  %get-tuple-element.1243 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=92
  %get-tuple-element.1244 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=93
  %get-tuple-element.1245 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=94
  %get-tuple-element.1246 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=95
  %get-tuple-element.1247 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=96
  %get-tuple-element.1248 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=97
  %get-tuple-element.1249 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=98
  %get-tuple-element.1250 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=99
  %get-tuple-element.1251 = bf16[2,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=100
  %get-tuple-element.1252 = bf16[2,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=101
  %get-tuple-element.1253 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=102
  %get-tuple-element.1254 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.11), index=103
  %get-tuple-element.1255 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%arg_tuple.11), index=104
  %get-tuple-element.1256 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=105
  %get-tuple-element.1257 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=106
  %get-tuple-element.1258 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=107
  %get-tuple-element.1259 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=108
  %get-tuple-element.1260 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=109
  %get-tuple-element.1261 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=110
  %get-tuple-element.1262 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=111
  %get-tuple-element.1263 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=112
  %get-tuple-element.1264 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=113
  %get-tuple-element.1265 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=114
  %get-tuple-element.1266 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=115
  %get-tuple-element.1267 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=116
  %get-tuple-element.1268 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=117
  %get-tuple-element.1269 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=118
  %get-tuple-element.1270 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=119
  %get-tuple-element.1271 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=120
  %get-tuple-element.1272 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=121
  %get-tuple-element.1273 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=122
  %get-tuple-element.1274 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=123
  %get-tuple-element.1275 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=124
  %get-tuple-element.1276 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=125
  %get-tuple-element.1277 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=126
  %get-tuple-element.1278 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=127
  %get-tuple-element.1279 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=128
  %get-tuple-element.1280 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=129
  %get-tuple-element.1281 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=130
  %get-tuple-element.1282 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=131
  %get-tuple-element.1283 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=132
  %get-tuple-element.1284 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=133
  %get-tuple-element.1285 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=134
  %get-tuple-element.1286 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=135
  %get-tuple-element.1287 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=136
  %get-tuple-element.1288 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=137
  %get-tuple-element.1289 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=138
  %get-tuple-element.1290 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=139
  %get-tuple-element.1291 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=140
  %get-tuple-element.1292 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=141
  %get-tuple-element.1293 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=142
  %get-tuple-element.1294 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=143
  %get-tuple-element.1295 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=144
  %get-tuple-element.1296 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=145
  %get-tuple-element.1297 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=146
  %get-tuple-element.1298 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=147
  %get-tuple-element.1299 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=148
  %get-tuple-element.1300 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=149
  %get-tuple-element.1301 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=150
  %get-tuple-element.1302 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=151
  %get-tuple-element.1303 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=152
  %get-tuple-element.1304 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=153
  %get-tuple-element.1305 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=154
  %get-tuple-element.1306 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=155
  %get-tuple-element.1307 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=156
  %get-tuple-element.1308 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=157
  %get-tuple-element.1309 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=158
  %get-tuple-element.1310 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=159
  %get-tuple-element.1311 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=160
  %get-tuple-element.1312 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=161
  %get-tuple-element.1313 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=162
  %get-tuple-element.1314 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=163
  %get-tuple-element.1315 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=164
  %get-tuple-element.1316 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=165
  %get-tuple-element.1317 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=166
  %get-tuple-element.1318 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=167
  %get-tuple-element.1319 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=168
  %get-tuple-element.1320 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=169
  %get-tuple-element.1321 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=170
  %get-tuple-element.1322 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=171
  %get-tuple-element.1323 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=172
  %get-tuple-element.1324 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=173
  %get-tuple-element.1325 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=174
  %get-tuple-element.1326 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=175
  %get-tuple-element.1327 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=176
  %get-tuple-element.1328 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=177
  %get-tuple-element.1329 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=178
  %get-tuple-element.1330 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=179
  %get-tuple-element.1331 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=180
  %get-tuple-element.1332 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=181
  %get-tuple-element.1333 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=182
  %get-tuple-element.1334 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=183
  %get-tuple-element.1335 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=184
  %get-tuple-element.1336 = f32[2,1024]{1,0} get-tuple-element(%arg_tuple.11), index=185
  %get-tuple-element.1337 = f32[2,1]{1,0} get-tuple-element(%arg_tuple.11), index=186
  %get-tuple-element.1338 = bf16[2,7168,64]{2,1,0} get-tuple-element(%arg_tuple.11), index=187
  %get-tuple-element.1339 = bf16[2,64]{1,0} get-tuple-element(%arg_tuple.11), index=188
  %get-tuple-element.1340 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=189
  %get-tuple-element.1341 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=190
  %get-tuple-element.1342 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=191
  %get-tuple-element.1343 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.11), index=192
  %get-tuple-element.1344 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%arg_tuple.11), index=193
  %get-tuple-element.1345 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%arg_tuple.11), index=194
  %get-tuple-element.1346 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.11), index=195
  %get-tuple-element.1347 = bf16[2,7168]{1,0} get-tuple-element(%arg_tuple.11), index=196
  %get-tuple-element.1348 = bf16[2,512]{1,0} get-tuple-element(%arg_tuple.11), index=197
  %get-tuple-element.1349 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=198
  %get-tuple-element.1350 = bf16[2,1536]{1,0} get-tuple-element(%arg_tuple.11), index=199
  %get-tuple-element.1351 = bf16[2,7168,576]{2,1,0} get-tuple-element(%arg_tuple.11), index=200
  %get-tuple-element.1352 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=201
  %get-tuple-element.1353 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.11), index=202
  %get-tuple-element.1354 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.11), index=203
  %get-tuple-element.1355 = s32[32,4096]{1,0} get-tuple-element(%arg_tuple.11), index=204
  %get-tuple-element.1151 = s32[] get-tuple-element(%arg_tuple.11), index=0
  %constant.417 = s32[] constant(2)
  ROOT %lt.14 = pred[] compare(%get-tuple-element.1151, %constant.417), direction=LT, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while/cond/lt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
}

%silu_775.331 (Arg_0.160: bf16[32,4096,18432]) -> (bf16[32,4096,18432], bf16[32,4096,18432], bf16[32,4096,18432]) {
  %Arg_0.160 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %constant.461 = bf16[] constant(1)
  %broadcast.164 = bf16[32,4096,18432]{2,1,0} broadcast(%constant.461), dimensions={}
  %neg.16 = bf16[32,4096,18432]{2,1,0} negate(%Arg_0.160), metadata={op_name="neg" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %exp.202 = bf16[32,4096,18432]{2,1,0} exponential(%neg.16), metadata={op_name="exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %add.120 = bf16[32,4096,18432]{2,1,0} add(%exp.202, %broadcast.164), metadata={op_name="add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %div.981 = bf16[32,4096,18432]{2,1,0} divide(%broadcast.164, %add.120), metadata={op_name="div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %mul.947 = bf16[32,4096,18432]{2,1,0} multiply(%Arg_0.160, %div.981), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %sub.50 = bf16[32,4096,18432]{2,1,0} subtract(%broadcast.164, %div.981), metadata={op_name="sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %mul.946 = bf16[32,4096,18432]{2,1,0} multiply(%div.981, %sub.50), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %tuple.17 = (bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}) tuple(%mul.947, %div.981, %mul.946)
}

%region_262.346 (reduce_max.1188: f32[], reduce_max.1189: f32[]) -> f32[] {
  %reduce_max.1188 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1189 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1190 = f32[] maximum(%reduce_max.1188, %reduce_max.1189), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_259.342 (reduce_max.1174: f32[], reduce_max.1175: f32[]) -> f32[] {
  %reduce_max.1174 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1175 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1176 = f32[] maximum(%reduce_max.1174, %reduce_max.1175), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_782.345 (Arg_0.164: bf16[18432,7168], Arg_1.140: bf16[], Arg_2.134: bf16[]) -> bf16[18432,7168] {
  %Arg_2.134 = bf16[] parameter(2)
  %min.214 = bf16[18432,7168]{1,0} broadcast(%Arg_2.134), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.140 = bf16[] parameter(1)
  %max.214 = bf16[18432,7168]{1,0} broadcast(%Arg_1.140), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.164 = bf16[18432,7168]{1,0} parameter(0)
  %max.215 = bf16[18432,7168]{1,0} maximum(%max.214, %Arg_0.164), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.215 = bf16[18432,7168]{1,0} minimum(%min.214, %max.215), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%region_265.349 (reduce_max.1202: f32[], reduce_max.1203: f32[]) -> f32[] {
  %reduce_max.1202 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1203 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1204 = f32[] maximum(%reduce_max.1202, %reduce_max.1203), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_787.352 (Arg_0.166: bf16[32,4096,18432], Arg_1.142: bf16[], Arg_2.136: bf16[]) -> bf16[32,4096,18432] {
  %Arg_2.136 = bf16[] parameter(2)
  %min.218 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_2.136), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.142 = bf16[] parameter(1)
  %max.218 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_1.142), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.166 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %max.219 = bf16[32,4096,18432]{2,1,0} maximum(%max.218, %Arg_0.166), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.219 = bf16[32,4096,18432]{2,1,0} minimum(%min.218, %max.219), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_253.335 (reduce_max.1146: f32[], reduce_max.1147: f32[]) -> f32[] {
  %reduce_max.1146 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1147 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1148 = f32[] maximum(%reduce_max.1146, %reduce_max.1147), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_773.330 (Arg_0.158: bf16[7168,18432], Arg_1.136: bf16[], Arg_2.130: bf16[]) -> bf16[7168,18432] {
  %Arg_2.130 = bf16[] parameter(2)
  %min.206 = bf16[7168,18432]{1,0} broadcast(%Arg_2.130), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_1.136 = bf16[] parameter(1)
  %max.206 = bf16[7168,18432]{1,0} broadcast(%Arg_1.136), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  %Arg_0.158 = bf16[7168,18432]{1,0} parameter(0)
  %max.207 = bf16[7168,18432]{1,0} maximum(%max.206, %Arg_0.158), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
  ROOT %min.207 = bf16[7168,18432]{1,0} minimum(%min.206, %max.207), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=473 source_end_line=475 source_column=25 source_end_column=3}
}

%silu_793.353 (Arg_0.168: bf16[32,4096,18432], Arg_1.144: bf16[32,4096,18432], Arg_2.138: bf16[32,4096,18432], Arg_3.12: bf16[32,4096,18432]) -> bf16[32,4096,18432] {
  %Arg_3.12 = bf16[32,4096,18432]{2,1,0} parameter(3)
  %Arg_0.168 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %mul.963 = bf16[32,4096,18432]{2,1,0} multiply(%Arg_3.12, %Arg_0.168), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_1.144 = bf16[32,4096,18432]{2,1,0} parameter(1)
  %mul.962 = bf16[32,4096,18432]{2,1,0} multiply(%Arg_1.144, %Arg_3.12), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  %Arg_2.138 = bf16[32,4096,18432]{2,1,0} parameter(2)
  %mul.964 = bf16[32,4096,18432]{2,1,0} multiply(%mul.962, %Arg_2.138), metadata={op_name="mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
  ROOT %add_any.36 = bf16[32,4096,18432]{2,1,0} add(%mul.963, %mul.964), metadata={op_name="add_any" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=467 source_end_line=467 source_column=12 source_end_column=54}
}

%region_268.354 (reduce_max.1216: f32[], reduce_max.1217: f32[]) -> f32[] {
  %reduce_max.1216 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1217 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1218 = f32[] maximum(%reduce_max.1216, %reduce_max.1217), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_247.327 (reduce_max.1118: f32[], reduce_max.1119: f32[]) -> f32[] {
  %reduce_max.1118 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1119 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1120 = f32[] maximum(%reduce_max.1118, %reduce_max.1119), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_243.323 (reduce_sum.343: f32[], reduce_sum.344: f32[]) -> f32[] {
  %reduce_sum.343 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.344 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.345 = f32[] add(%reduce_sum.343, %reduce_sum.344), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_273.359 (reduce_sum.364: f32[], reduce_sum.365: f32[]) -> f32[] {
  %reduce_sum.364 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.365 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.366 = f32[] add(%reduce_sum.364, %reduce_sum.365), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_274.360 (reduce_sum.371: f32[], reduce_sum.372: f32[]) -> f32[] {
  %reduce_sum.371 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.372 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.373 = f32[] add(%reduce_sum.371, %reduce_sum.372), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_223.303 (reduce_sum.329: f32[], reduce_sum.330: f32[]) -> f32[] {
  %reduce_sum.329 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.330 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.331 = f32[] add(%reduce_sum.329, %reduce_sum.330), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_224.304 (reduce_max.1020: f32[], reduce_max.1021: f32[]) -> f32[] {
  %reduce_max.1020 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1021 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1022 = f32[] maximum(%reduce_max.1020, %reduce_max.1021), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_227.307 (reduce_max.1034: f32[], reduce_max.1035: f32[]) -> f32[] {
  %reduce_max.1034 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1035 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1036 = f32[] maximum(%reduce_max.1034, %reduce_max.1035), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_230.310 (reduce_sum.336: f32[], reduce_sum.337: f32[]) -> f32[] {
  %reduce_sum.336 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.337 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.338 = f32[] add(%reduce_sum.336, %reduce_sum.337), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_231.311 (reduce_max.1048: f32[], reduce_max.1049: f32[]) -> f32[] {
  %reduce_max.1048 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1049 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1050 = f32[] maximum(%reduce_max.1048, %reduce_max.1049), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_234.314 (reduce_max.1062: f32[], reduce_max.1063: f32[]) -> f32[] {
  %reduce_max.1062 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1063 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1064 = f32[] maximum(%reduce_max.1062, %reduce_max.1063), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_275.361 (reduce_max.1230: f32[], reduce_max.1231: f32[]) -> f32[] {
  %reduce_max.1230 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1231 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1232 = f32[] maximum(%reduce_max.1230, %reduce_max.1231), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_240.320 (reduce_max.1090: f32[], reduce_max.1091: f32[]) -> f32[] {
  %reduce_max.1090 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1091 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1092 = f32[] maximum(%reduce_max.1090, %reduce_max.1091), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_279.365 (reduce_max.1244: f32[], reduce_max.1245: f32[]) -> f32[] {
  %reduce_max.1244 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1245 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1246 = f32[] maximum(%reduce_max.1244, %reduce_max.1245), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_285.371 (reduce_sum.406: f32[], reduce_sum.407: f32[]) -> f32[] {
  %reduce_sum.406 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.407 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.408 = f32[] add(%reduce_sum.406, %reduce_sum.407), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_286.372 (reduce_sum.413: f32[], reduce_sum.414: f32[]) -> f32[] {
  %reduce_sum.413 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.414 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.415 = f32[] add(%reduce_sum.413, %reduce_sum.414), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_278.364 (reduce_sum.378: bf16[], reduce_sum.379: bf16[]) -> bf16[] {
  %reduce_sum.378 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.379 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.380 = bf16[] add(%reduce_sum.378, %reduce_sum.379), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_282.368 (reduce_sum.385: bf16[], reduce_sum.386: bf16[]) -> bf16[] {
  %reduce_sum.385 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.386 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.387 = bf16[] add(%reduce_sum.385, %reduce_sum.386), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_294.380 (reduce_max.1272: f32[], reduce_max.1273: f32[]) -> f32[] {
  %reduce_max.1272 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1273 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1274 = f32[] maximum(%reduce_max.1272, %reduce_max.1273), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_220.300 (reduce_max.1006: f32[], reduce_max.1007: f32[]) -> f32[] {
  %reduce_max.1006 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1007 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1008 = f32[] maximum(%reduce_max.1006, %reduce_max.1007), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_287.373 (reduce_max.1258: f32[], reduce_max.1259: f32[]) -> f32[] {
  %reduce_max.1258 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1259 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1260 = f32[] maximum(%reduce_max.1258, %reduce_max.1259), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_292.378 (reduce_sum.434: f32[], reduce_sum.435: f32[]) -> f32[] {
  %reduce_sum.434 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.435 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.436 = f32[] add(%reduce_sum.434, %reduce_sum.435), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_293.379 (reduce_sum.441: f32[], reduce_sum.442: f32[]) -> f32[] {
  %reduce_sum.441 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.442 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.443 = f32[] add(%reduce_sum.441, %reduce_sum.442), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_297.383 (reduce_max.1286: f32[], reduce_max.1287: f32[]) -> f32[] {
  %reduce_max.1286 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1287 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1288 = f32[] maximum(%reduce_max.1286, %reduce_max.1287), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_217.297 (reduce_max.992: f32[], reduce_max.993: f32[]) -> f32[] {
  %reduce_max.992 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.993 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.994 = f32[] maximum(%reduce_max.992, %reduce_max.993), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_213.293 (reduce_sum.322: f32[], reduce_sum.323: f32[]) -> f32[] {
  %reduce_sum.322 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.323 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.324 = f32[] add(%reduce_sum.322, %reduce_sum.323), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_302.388 (reduce_sum.462: f32[], reduce_sum.463: f32[]) -> f32[] {
  %reduce_sum.462 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.463 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.464 = f32[] add(%reduce_sum.462, %reduce_sum.463), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_303.389 (reduce_sum.469: f32[], reduce_sum.470: f32[]) -> f32[] {
  %reduce_sum.469 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.470 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.471 = f32[] add(%reduce_sum.469, %reduce_sum.470), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_244.324 (reduce_max.1104: f32[], reduce_max.1105: f32[]) -> f32[] {
  %reduce_max.1104 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1105 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1106 = f32[] maximum(%reduce_max.1104, %reduce_max.1105), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_250.332 (reduce_max.1132: f32[], reduce_max.1133: f32[]) -> f32[] {
  %reduce_max.1132 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1133 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1134 = f32[] maximum(%reduce_max.1132, %reduce_max.1133), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_256.338 (reduce_max.1160: f32[], reduce_max.1161: f32[]) -> f32[] {
  %reduce_max.1160 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1161 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1162 = f32[] maximum(%reduce_max.1160, %reduce_max.1161), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%clip_779.341 (Arg_0.162: bf16[32,4096,18432], Arg_1.138: bf16[], Arg_2.132: bf16[]) -> bf16[32,4096,18432] {
  %Arg_2.132 = bf16[] parameter(2)
  %min.210 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_2.132), dimensions={}, metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_1.138 = bf16[] parameter(1)
  %max.210 = bf16[32,4096,18432]{2,1,0} broadcast(%Arg_1.138), dimensions={}, metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  %Arg_0.162 = bf16[32,4096,18432]{2,1,0} parameter(0)
  %max.211 = bf16[32,4096,18432]{2,1,0} maximum(%max.210, %Arg_0.162), metadata={op_name="max" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
  ROOT %min.211 = bf16[32,4096,18432]{2,1,0} minimum(%min.210, %max.211), metadata={op_name="min" source_file="/opt/flax/flax/linen/fp8_ops.py" source_line=470 source_end_line=472 source_column=25 source_end_column=3}
}

%region_271.357 (reduce_sum.350: bf16[], reduce_sum.351: bf16[]) -> bf16[] {
  %reduce_sum.350 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.351 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.352 = bf16[] add(%reduce_sum.350, %reduce_sum.351), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_272.358 (reduce_sum.357: bf16[], reduce_sum.358: bf16[]) -> bf16[] {
  %reduce_sum.357 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.358 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.359 = bf16[] add(%reduce_sum.357, %reduce_sum.358), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_300.386 (reduce_sum.448: bf16[], reduce_sum.449: bf16[]) -> bf16[] {
  %reduce_sum.448 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.449 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.450 = bf16[] add(%reduce_sum.448, %reduce_sum.449), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_301.387 (reduce_sum.455: bf16[], reduce_sum.456: bf16[]) -> bf16[] {
  %reduce_sum.455 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.456 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.457 = bf16[] add(%reduce_sum.455, %reduce_sum.456), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_283.369 (reduce_sum.392: bf16[], reduce_sum.393: bf16[]) -> bf16[] {
  %reduce_sum.392 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.393 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.394 = bf16[] add(%reduce_sum.392, %reduce_sum.393), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_284.370 (reduce_sum.399: bf16[], reduce_sum.400: bf16[]) -> bf16[] {
  %reduce_sum.399 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.400 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.401 = bf16[] add(%reduce_sum.399, %reduce_sum.400), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_237.317 (reduce_max.1076: f32[], reduce_max.1077: f32[]) -> f32[] {
  %reduce_max.1076 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1077 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1078 = f32[] maximum(%reduce_max.1076, %reduce_max.1077), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_290.376 (reduce_sum.420: bf16[], reduce_sum.421: bf16[]) -> bf16[] {
  %reduce_sum.420 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.421 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.422 = bf16[] add(%reduce_sum.420, %reduce_sum.421), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_291.377 (reduce_sum.427: bf16[], reduce_sum.428: bf16[]) -> bf16[] {
  %reduce_sum.427 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.428 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.429 = bf16[] add(%reduce_sum.427, %reduce_sum.428), metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_214.294 (reduce_max.978: f32[], reduce_max.979: f32[]) -> f32[] {
  %reduce_max.978 = f32[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.979 = f32[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.980 = f32[] maximum(%reduce_max.978, %reduce_max.979), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_245.325 (reduce_max.1111: bf16[], reduce_max.1112: bf16[]) -> bf16[] {
  %reduce_max.1111 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1112 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1113 = bf16[] maximum(%reduce_max.1111, %reduce_max.1112), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_246.326 (scatter.287: f32[], scatter.288: f32[]) -> f32[] {
  %scatter.287 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.288 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_248.328 (reduce_max.1125: bf16[], reduce_max.1126: bf16[]) -> bf16[] {
  %reduce_max.1125 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1126 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1127 = bf16[] maximum(%reduce_max.1125, %reduce_max.1126), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_249.329 (scatter.292: f32[], scatter.293: f32[]) -> f32[] {
  %scatter.292 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.293 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_269.355 (reduce_max.1223: bf16[], reduce_max.1224: bf16[]) -> bf16[] {
  %reduce_max.1223 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1224 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1225 = bf16[] maximum(%reduce_max.1223, %reduce_max.1224), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_270.356 (scatter.327: f32[], scatter.328: f32[]) -> f32[] {
  %scatter.327 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.328 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_251.333 (reduce_max.1139: bf16[], reduce_max.1140: bf16[]) -> bf16[] {
  %reduce_max.1139 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1140 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1141 = bf16[] maximum(%reduce_max.1139, %reduce_max.1140), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_252.334 (scatter.297: f32[], scatter.298: f32[]) -> f32[] {
  %scatter.297 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.298 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_254.336 (reduce_max.1153: bf16[], reduce_max.1154: bf16[]) -> bf16[] {
  %reduce_max.1153 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1154 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1155 = bf16[] maximum(%reduce_max.1153, %reduce_max.1154), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_255.337 (scatter.302: f32[], scatter.303: f32[]) -> f32[] {
  %scatter.302 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.303 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_266.350 (reduce_max.1209: bf16[], reduce_max.1210: bf16[]) -> bf16[] {
  %reduce_max.1209 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1210 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1211 = bf16[] maximum(%reduce_max.1209, %reduce_max.1210), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_267.351 (scatter.322: f32[], scatter.323: f32[]) -> f32[] {
  %scatter.322 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.323 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_257.339 (reduce_max.1167: bf16[], reduce_max.1168: bf16[]) -> bf16[] {
  %reduce_max.1167 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1168 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1169 = bf16[] maximum(%reduce_max.1167, %reduce_max.1168), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_258.340 (scatter.307: f32[], scatter.308: f32[]) -> f32[] {
  %scatter.307 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.308 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_260.343 (reduce_max.1181: bf16[], reduce_max.1182: bf16[]) -> bf16[] {
  %reduce_max.1181 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1182 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1183 = bf16[] maximum(%reduce_max.1181, %reduce_max.1182), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_261.344 (scatter.312: f32[], scatter.313: f32[]) -> f32[] {
  %scatter.312 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.313 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_263.347 (reduce_max.1195: bf16[], reduce_max.1196: bf16[]) -> bf16[] {
  %reduce_max.1195 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1196 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1197 = bf16[] maximum(%reduce_max.1195, %reduce_max.1196), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_264.348 (scatter.317: f32[], scatter.318: f32[]) -> f32[] {
  %scatter.317 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.318 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_215.295 (reduce_max.985: bf16[], reduce_max.986: bf16[]) -> bf16[] {
  %reduce_max.985 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.986 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.987 = bf16[] maximum(%reduce_max.985, %reduce_max.986), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_216.296 (scatter.242: f32[], scatter.243: f32[]) -> f32[] {
  %scatter.242 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.243 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_218.298 (reduce_max.999: bf16[], reduce_max.1000: bf16[]) -> bf16[] {
  %reduce_max.999 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1000 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1001 = bf16[] maximum(%reduce_max.999, %reduce_max.1000), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_219.299 (scatter.247: f32[], scatter.248: f32[]) -> f32[] {
  %scatter.247 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.248 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_221.301 (reduce_max.1013: bf16[], reduce_max.1014: bf16[]) -> bf16[] {
  %reduce_max.1013 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1014 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1015 = bf16[] maximum(%reduce_max.1013, %reduce_max.1014), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_222.302 (scatter.252: f32[], scatter.253: f32[]) -> f32[] {
  %scatter.252 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.253 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_298.384 (reduce_max.1293: bf16[], reduce_max.1294: bf16[]) -> bf16[] {
  %reduce_max.1293 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1294 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1295 = bf16[] maximum(%reduce_max.1293, %reduce_max.1294), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_299.385 (scatter.352: f32[], scatter.353: f32[]) -> f32[] {
  %scatter.352 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.353 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_295.381 (reduce_max.1279: bf16[], reduce_max.1280: bf16[]) -> bf16[] {
  %reduce_max.1279 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1280 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1281 = bf16[] maximum(%reduce_max.1279, %reduce_max.1280), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_296.382 (scatter.347: f32[], scatter.348: f32[]) -> f32[] {
  %scatter.347 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.348 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_238.318 (reduce_max.1083: bf16[], reduce_max.1084: bf16[]) -> bf16[] {
  %reduce_max.1083 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1084 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1085 = bf16[] maximum(%reduce_max.1083, %reduce_max.1084), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_239.319 (scatter.277: f32[], scatter.278: f32[]) -> f32[] {
  %scatter.277 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.278 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_241.321 (reduce_max.1097: bf16[], reduce_max.1098: bf16[]) -> bf16[] {
  %reduce_max.1097 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1098 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1099 = bf16[] maximum(%reduce_max.1097, %reduce_max.1098), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_242.322 (scatter.282: f32[], scatter.283: f32[]) -> f32[] {
  %scatter.282 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.283 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_276.362 (reduce_max.1237: bf16[], reduce_max.1238: bf16[]) -> bf16[] {
  %reduce_max.1237 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1238 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1239 = bf16[] maximum(%reduce_max.1237, %reduce_max.1238), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_277.363 (scatter.332: f32[], scatter.333: f32[]) -> f32[] {
  %scatter.332 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.333 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_232.312 (reduce_max.1055: bf16[], reduce_max.1056: bf16[]) -> bf16[] {
  %reduce_max.1055 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1056 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1057 = bf16[] maximum(%reduce_max.1055, %reduce_max.1056), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_233.313 (scatter.267: f32[], scatter.268: f32[]) -> f32[] {
  %scatter.267 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.268 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_235.315 (reduce_max.1069: bf16[], reduce_max.1070: bf16[]) -> bf16[] {
  %reduce_max.1069 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1070 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1071 = bf16[] maximum(%reduce_max.1069, %reduce_max.1070), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_236.316 (scatter.272: f32[], scatter.273: f32[]) -> f32[] {
  %scatter.272 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.273 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_280.366 (reduce_max.1251: bf16[], reduce_max.1252: bf16[]) -> bf16[] {
  %reduce_max.1251 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1252 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1253 = bf16[] maximum(%reduce_max.1251, %reduce_max.1252), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_281.367 (scatter.337: f32[], scatter.338: f32[]) -> f32[] {
  %scatter.337 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.338 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_225.305 (reduce_max.1027: bf16[], reduce_max.1028: bf16[]) -> bf16[] {
  %reduce_max.1027 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1028 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1029 = bf16[] maximum(%reduce_max.1027, %reduce_max.1028), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_226.306 (scatter.257: f32[], scatter.258: f32[]) -> f32[] {
  %scatter.257 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.258 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_228.308 (reduce_max.1041: bf16[], reduce_max.1042: bf16[]) -> bf16[] {
  %reduce_max.1041 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1042 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1043 = bf16[] maximum(%reduce_max.1041, %reduce_max.1042), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_229.309 (scatter.262: f32[], scatter.263: f32[]) -> f32[] {
  %scatter.262 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.263 = f32[] parameter(1), metadata={op_name="scatter"}
}

%region_288.374 (reduce_max.1265: bf16[], reduce_max.1266: bf16[]) -> bf16[] {
  %reduce_max.1265 = bf16[] parameter(0), metadata={op_name="reduce_max"}
  %reduce_max.1266 = bf16[] parameter(1), metadata={op_name="reduce_max"}
  ROOT %reduce_max.1267 = bf16[] maximum(%reduce_max.1265, %reduce_max.1266), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
}

%region_289.375 (scatter.342: f32[], scatter.343: f32[]) -> f32[] {
  %scatter.342 = f32[] parameter(0), metadata={op_name="scatter"}
  ROOT %scatter.343 = f32[] parameter(1), metadata={op_name="scatter"}
}

%closed_call_769.390 (Arg_0.169: s32[32,4096], Arg_1.145: bf16[32,4096,7168], Arg_2.139: bf16[32,4096,7168], Arg_3.13: bf16[32,4096,1536], Arg_4.7: bf16[32,4096,576], Arg_5.7: bf16[32,4096,7168], Arg_6.7: bf16[32,4096,18432], Arg_7.7: bf16[32,4096,18432], Arg_8.7: f32[1024], Arg_9.7: f32[1], Arg_10.7: f32[1024], Arg_11.7: f32[1], Arg_12.7: f32[1024], Arg_13.7: f32[1], Arg_14.7: f32[1024], Arg_15.7: f32[1], Arg_16.7: f32[1024], Arg_17.7: f32[1], Arg_18.7: f32[1024], Arg_19.7: f32[1], Arg_20.7: f32[1024], Arg_21.7: f32[1], Arg_22.7: f32[1024], Arg_23.7: f32[1], Arg_24.7: f32[1024], Arg_25.7: f32[1], Arg_26.7: f32[1024], Arg_27.7: f32[1], Arg_28.7: f32[1024], Arg_29.7: f32[1024], Arg_30.7: f32[1], Arg_31.7: f32[1], Arg_32.7: f32[1024], Arg_33.7: f32[1024], Arg_34.7: f32[1], Arg_35.7: f32[1], Arg_36.7: f32[1024], Arg_37.7: f32[1], Arg_38.7: f32[1024], Arg_39.7: f32[1], Arg_40.7: f32[1024], Arg_41.7: f32[1], Arg_42.7: f32[1024], Arg_43.7: f32[1], Arg_44.7: f32[1024], Arg_45.7: f32[1], Arg_46.7: f32[1024], Arg_47.7: f32[1], Arg_48.7: f32[1024], Arg_49.7: f32[1], Arg_50.7: f32[1024], Arg_51.7: f32[1], Arg_52.7: f32[1024], Arg_53.7: f32[1], Arg_54.7: bf16[7168,18432], Arg_55.7: bf16[7168,18432], Arg_56.7: bf16[18432,7168], Arg_57.7: bf16[7168], Arg_58.7: bf16[7168], Arg_59.7: bf16[512], Arg_60.7: bf16[128,128,7168], Arg_61.7: bf16[1536], Arg_62.7: bf16[7168,576], Arg_63.7: bf16[512,128,256], Arg_64.7: bf16[7168,1536], Arg_65.7: bf16[1536,128,192]) -> (bf16[32,4096,7168], bf16[7168,18432], bf16[7168,18432], bf16[18432,7168], bf16[7168], /*index=5*/bf16[7168], bf16[512], bf16[128,128,7168], bf16[1536], bf16[7168,576], /*index=10*/bf16[512,128,256], bf16[7168,1536], bf16[1536,128,192], f32[1024], f32[1], /*index=15*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=20*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=25*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=30*/f32[1], f32[1024], f32[1], f32[1024], f32[1024], /*index=35*/f32[1], f32[1], f32[1024], f32[1024], f32[1], /*index=40*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=45*/f32[1024], f32[1], f32[1024], f32[1], f32[1024], /*index=50*/f32[1], f32[1024], f32[1], f32[1024], f32[1], /*index=55*/f32[1024], f32[1], f32[1024], f32[1]) {
  %Arg_1.145 = bf16[32,4096,7168]{2,1,0} parameter(1)
  %sharding_constraint.179 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_1.145), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_6.7 = bf16[32,4096,18432]{2,1,0} parameter(6)
  %device_put.38 = bf16[32,4096,18432]{2,1,0} custom-call(%Arg_6.7), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.31 = (bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}, bf16[32,4096,18432]{2,1,0}) call(%device_put.38), to_apply=%silu_775.331, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.32 = bf16[32,4096,18432]{2,1,0} get-tuple-element(%jit_silu_.31), index=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.180 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.179), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.481 = f32[1]{0} constant({1})
  %Arg_24.7 = f32[1024]{0} parameter(24)
  %constant.500 = f32[] constant(-inf)
  %reduce_max.1327 = f32[] reduce(%Arg_24.7, %constant.500), dimensions={0}, to_apply=%region_262.346, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.200 = pred[] is-finite(%reduce_max.1327), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.501 = f32[] constant(0)
  %gt.200 = pred[] compare(%reduce_max.1327, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.491 = f32[] constant(57344)
  %div.1138 = f32[] divide(%constant.491, %reduce_max.1327), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.499 = f32[] constant(1)
  %div.1139 = f32[] divide(%div.1138, %constant.499), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_25.7 = f32[1]{0} parameter(25)
  %div.1137 = f32[1]{0} divide(%constant.481, %Arg_25.7), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.404 = f32[1]{0} call(%gt.200, %div.1139, %div.1137), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.405 = f32[1]{0} call(%is_finite.200, %jit__where_.404, %div.1137), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1140 = f32[1]{0} divide(%constant.481, %jit__where_.405), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.876 = bf16[1]{0} convert(%div.1140), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1421 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.876), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1422 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1421), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1423 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1422), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1141 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.180, %broadcast_in_dim.1423), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.490 = bf16[] constant(-5.734e+04)
  %constant.489 = bf16[] constant(5.734e+04)
  %jit_clip_.212 = bf16[32,4096,7168]{2,1,0} call(%div.1141, %constant.490, %constant.489), to_apply=%clip_555.219, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.877 = f8e5m2[32,4096,7168]{2,1,0} convert(%jit_clip_.212), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_56.7 = bf16[18432,7168]{1,0} parameter(56)
  %Arg_22.7 = f32[1024]{0} parameter(22)
  %reduce_max.1325 = f32[] reduce(%Arg_22.7, %constant.500), dimensions={0}, to_apply=%region_259.342, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.199 = pred[] is-finite(%reduce_max.1325), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.199 = pred[] compare(%reduce_max.1325, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.498 = f32[] constant(448)
  %div.1133 = f32[] divide(%constant.498, %reduce_max.1325), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1134 = f32[] divide(%div.1133, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_23.7 = f32[1]{0} parameter(23)
  %div.1132 = f32[1]{0} divide(%constant.481, %Arg_23.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.402 = f32[1]{0} call(%gt.199, %div.1134, %div.1132), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.403 = f32[1]{0} call(%is_finite.199, %jit__where_.402, %div.1132), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1135 = f32[1]{0} divide(%constant.481, %jit__where_.403), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.873 = bf16[1]{0} convert(%div.1135), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1418 = bf16[18432,1]{1,0} broadcast(%convert_element_type.873), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1419 = bf16[18432]{0} reshape(%broadcast_in_dim.1418), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1420 = bf16[18432,7168]{1,0} broadcast(%broadcast_in_dim.1419), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1136 = bf16[18432,7168]{1,0} divide(%Arg_56.7, %broadcast_in_dim.1420), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.495 = bf16[] constant(-448)
  %constant.494 = bf16[] constant(448)
  %jit_clip_.211 = bf16[18432,7168]{1,0} call(%div.1136, %constant.495, %constant.494), to_apply=%clip_782.345, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.874 = f8e4m3fn[18432,7168]{1,0} convert(%jit_clip_.211), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.131 = bf16[32,4096,18432]{2,1,0} dot(%convert_element_type.877, %convert_element_type.874), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1122 = f32[1]{0} multiply(%div.1135, %div.1140), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.878 = bf16[1]{0} convert(%mul.1122), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1424 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.878), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1425 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1424), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1426 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.1425), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1123 = bf16[32,4096,18432]{2,1,0} multiply(%dot_general.131, %broadcast_in_dim.1426), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.181 = bf16[32,4096,18432]{2,1,0} custom-call(%mul.1123), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/mlp/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1126 = bf16[32,4096,18432]{2,1,0} multiply(%jit_silu_.32, %sharding_constraint.181), metadata={op_name="checkpoint/dense_layers/mlp/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_18.7 = f32[1024]{0} parameter(18)
  %reduce_max.1329 = f32[] reduce(%Arg_18.7, %constant.500), dimensions={0}, to_apply=%region_265.349, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.201 = pred[] is-finite(%reduce_max.1329), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.201 = pred[] compare(%reduce_max.1329, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1143 = f32[] divide(%constant.491, %reduce_max.1329), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1144 = f32[] divide(%div.1143, %constant.499), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_19.7 = f32[1]{0} parameter(19)
  %div.1142 = f32[1]{0} divide(%constant.481, %Arg_19.7), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.406 = f32[1]{0} call(%gt.201, %div.1144, %div.1142), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.407 = f32[1]{0} call(%is_finite.201, %jit__where_.406, %div.1142), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1145 = f32[1]{0} divide(%constant.481, %jit__where_.407), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.881 = bf16[1]{0} convert(%div.1145), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1430 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.881), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1431 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1430), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1432 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.1431), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1146 = bf16[32,4096,18432]{2,1,0} divide(%mul.1126, %broadcast_in_dim.1432), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.213 = bf16[32,4096,18432]{2,1,0} call(%div.1146, %constant.490, %constant.489), to_apply=%clip_787.352, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.882 = f8e5m2[32,4096,18432]{2,1,0} convert(%jit_clip_.213), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_55.7 = bf16[7168,18432]{1,0} parameter(55)
  %Arg_16.7 = f32[1024]{0} parameter(16)
  %reduce_max.1321 = f32[] reduce(%Arg_16.7, %constant.500), dimensions={0}, to_apply=%region_253.335, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.197 = pred[] is-finite(%reduce_max.1321), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.197 = pred[] compare(%reduce_max.1321, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1123 = f32[] divide(%constant.498, %reduce_max.1321), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1124 = f32[] divide(%div.1123, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_17.7 = f32[1]{0} parameter(17)
  %div.1122 = f32[1]{0} divide(%constant.481, %Arg_17.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.398 = f32[1]{0} call(%gt.197, %div.1124, %div.1122), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.399 = f32[1]{0} call(%is_finite.197, %jit__where_.398, %div.1122), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1125 = f32[1]{0} divide(%constant.481, %jit__where_.399), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.867 = bf16[1]{0} convert(%div.1125), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1412 = bf16[7168,1]{1,0} broadcast(%convert_element_type.867), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1413 = bf16[7168]{0} reshape(%broadcast_in_dim.1412), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1414 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.1413), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1126 = bf16[7168,18432]{1,0} divide(%Arg_55.7, %broadcast_in_dim.1414), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.209 = bf16[7168,18432]{1,0} call(%div.1126, %constant.495, %constant.494), to_apply=%clip_773.330, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.868 = f8e4m3fn[7168,18432]{1,0} convert(%jit_clip_.209), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.133 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.882, %convert_element_type.868), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1128 = f32[1]{0} multiply(%div.1125, %div.1145), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.883 = bf16[1]{0} convert(%mul.1128), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1433 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.883), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1434 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1433), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1435 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1434), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1129 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.133, %broadcast_in_dim.1435), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.33 = bf16[32,4096,18432]{2,1,0} get-tuple-element(%jit_silu_.31), index=1, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.34 = bf16[32,4096,18432]{2,1,0} get-tuple-element(%jit_silu_.31), index=2, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_7.7 = bf16[32,4096,18432]{2,1,0} parameter(7)
  %device_put.39 = bf16[32,4096,18432]{2,1,0} custom-call(%Arg_7.7), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1127 = bf16[32,4096,18432]{2,1,0} multiply(%sharding_constraint.181, %device_put.39), metadata={op_name="checkpoint/dense_layers/mlp/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_silu_.35 = bf16[32,4096,18432]{2,1,0} call(%jit_silu_.33, %device_put.38, %jit_silu_.34, %mul.1127), to_apply=%silu_793.353, metadata={op_name="checkpoint/dense_layers/mlp/jit(silu)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_12.7 = f32[1024]{0} parameter(12)
  %reduce_max.1331 = f32[] reduce(%Arg_12.7, %constant.500), dimensions={0}, to_apply=%region_268.354, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.202 = pred[] is-finite(%reduce_max.1331), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.202 = pred[] compare(%reduce_max.1331, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1148 = f32[] divide(%constant.491, %reduce_max.1331), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1149 = f32[] divide(%div.1148, %constant.499), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_13.7 = f32[1]{0} parameter(13)
  %div.1147 = f32[1]{0} divide(%constant.481, %Arg_13.7), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.408 = f32[1]{0} call(%gt.202, %div.1149, %div.1147), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.409 = f32[1]{0} call(%is_finite.202, %jit__where_.408, %div.1147), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1150 = f32[1]{0} divide(%constant.481, %jit__where_.409), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.886 = bf16[1]{0} convert(%div.1150), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1439 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.886), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1440 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1439), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1441 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.1440), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1151 = bf16[32,4096,18432]{2,1,0} divide(%jit_silu_.35, %broadcast_in_dim.1441), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.214 = bf16[32,4096,18432]{2,1,0} call(%div.1151, %constant.490, %constant.489), to_apply=%clip_787.352, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.887 = f8e5m2[32,4096,18432]{2,1,0} convert(%jit_clip_.214), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_54.7 = bf16[7168,18432]{1,0} parameter(54)
  %Arg_10.7 = f32[1024]{0} parameter(10)
  %reduce_max.1317 = f32[] reduce(%Arg_10.7, %constant.500), dimensions={0}, to_apply=%region_247.327, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.195 = pred[] is-finite(%reduce_max.1317), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.195 = pred[] compare(%reduce_max.1317, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1113 = f32[] divide(%constant.498, %reduce_max.1317), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1114 = f32[] divide(%div.1113, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_11.7 = f32[1]{0} parameter(11)
  %div.1112 = f32[1]{0} divide(%constant.481, %Arg_11.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.394 = f32[1]{0} call(%gt.195, %div.1114, %div.1112), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.395 = f32[1]{0} call(%is_finite.195, %jit__where_.394, %div.1112), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1115 = f32[1]{0} divide(%constant.481, %jit__where_.395), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.861 = bf16[1]{0} convert(%div.1115), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1406 = bf16[7168,1]{1,0} broadcast(%convert_element_type.861), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1407 = bf16[7168]{0} reshape(%broadcast_in_dim.1406), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1408 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.1407), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1116 = bf16[7168,18432]{1,0} divide(%Arg_54.7, %broadcast_in_dim.1408), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.207 = bf16[7168,18432]{1,0} call(%div.1116, %constant.495, %constant.494), to_apply=%clip_773.330, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.862 = f8e4m3fn[7168,18432]{1,0} convert(%jit_clip_.207), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.135 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.887, %convert_element_type.862), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1132 = f32[1]{0} multiply(%div.1115, %div.1150), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.888 = bf16[1]{0} convert(%mul.1132), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1442 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.888), dimensions={2}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1443 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1442), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1444 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1443), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1133 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.135, %broadcast_in_dim.1444), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.49 = bf16[32,4096,7168]{2,1,0} add(%mul.1129, %mul.1133), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.182 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.49), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_57.7 = bf16[7168]{0} parameter(57)
  %broadcast_in_dim.1402 = bf16[1,1,7168]{2,1,0} reshape(%Arg_57.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1137 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1402), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1138 = bf16[7168]{0} reshape(%mul.1137), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1139 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1138), dimensions={2}, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1140 = bf16[32,4096,7168]{2,1,0} multiply(%sharding_constraint.182, %mul.1139), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.890 = f32[32,4096,7168]{2,1,0} convert(%mul.1140), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_2.139 = bf16[32,4096,7168]{2,1,0} parameter(2)
  %Arg_5.7 = bf16[32,4096,7168]{2,1,0} parameter(5)
  %sharding_constraint.176 = bf16[32,4096,7168]{2,1,0} custom-call(%Arg_5.7), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.128 = bf16[32,4096,7168]{2,1,0} add(%Arg_2.139, %sharding_constraint.176), metadata={op_name="checkpoint/rematted_computation/dense_layers/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.855 = f32[32,4096,7168]{2,1,0} convert(%add.128), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.33 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.855, %convert_element_type.855), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.476 = f32[32,4096]{1,0} reduce(%square.33, %constant.501), dimensions={2}, to_apply=%region_243.323, metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1401 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.476), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.484 = f32[] constant(7168)
  %broadcast.182 = f32[32,4096,1]{2,1,0} broadcast(%constant.484), dimensions={}
  %div.1105 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.1401, %broadcast.182), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.483 = f32[] constant(1e-06)
  %broadcast.181 = f32[32,4096,1]{2,1,0} broadcast(%constant.483), dimensions={}
  %add.129 = f32[32,4096,1]{2,1,0} add(%div.1105, %broadcast.181), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.32 = f32[32,4096,1]{2,1,0} rsqrt(%add.129), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1142 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.32), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1143 = f32[32,4096]{1,0} reshape(%mul.1142), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1144 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1143), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1145 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.890, %mul.1144), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1141 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.855, %convert_element_type.890), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.479 = f32[32,4096]{1,0} reduce(%mul.1141, %constant.501), dimensions={2}, to_apply=%region_273.359, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.51 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.479), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1106 = f32[32,4096,1]{2,1,0} divide(%rsqrt.32, %add.129), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.482 = f32[] constant(-0.5)
  %broadcast.180 = f32[32,4096,1]{2,1,0} broadcast(%constant.482), dimensions={}
  %mul.1112 = f32[32,4096,1]{2,1,0} multiply(%div.1106, %broadcast.180), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1146 = f32[32,4096,1]{2,1,0} multiply(%reshape.51, %mul.1112), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1152 = f32[32,4096,1]{2,1,0} divide(%mul.1146, %broadcast.182), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.480 = f32[32,4096]{1,0} reduce(%div.1152, %constant.501), dimensions={2}, to_apply=%region_274.360, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1448 = f32[32,4096,7168]{2,1,0} broadcast(%reduce_sum.480), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.485 = f32[] constant(2)
  %broadcast.183 = f32[32,4096,7168]{2,1,0} broadcast(%constant.485), dimensions={}
  %mul.1111 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.855, %broadcast.183), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1147 = f32[32,4096,7168]{2,1,0} multiply(%broadcast_in_dim.1448, %mul.1111), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.50 = f32[32,4096,7168]{2,1,0} add(%mul.1145, %mul.1147), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.891 = bf16[32,4096,7168]{2,1,0} convert(%add_any.50), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.51 = bf16[32,4096,7168]{2,1,0} add(%sharding_constraint.179, %convert_element_type.891), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_3.13 = bf16[32,4096,1536]{2,1,0} parameter(3)
  %device_put.36 = bf16[32,4096,1536]{2,1,0} custom-call(%Arg_3.13), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.823 = f32[32,4096,1536]{2,1,0} convert(%device_put.36), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.31 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.823, %convert_element_type.823), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.474 = f32[32,4096]{1,0} reduce(%square.31, %constant.501), dimensions={2}, to_apply=%region_223.303, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1364 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.474), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.478 = f32[] constant(1536)
  %broadcast.179 = f32[32,4096,1]{2,1,0} broadcast(%constant.478), dimensions={}
  %div.1063 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.1364, %broadcast.179), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.122 = f32[32,4096,1]{2,1,0} add(%div.1063, %broadcast.181), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.30 = f32[32,4096,1]{2,1,0} rsqrt(%add.122), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1059 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.30), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1060 = f32[32,4096]{1,0} reshape(%mul.1059), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1061 = f32[32,4096,1536]{2,1,0} broadcast(%mul.1060), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1062 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.823, %mul.1061), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.824 = bf16[32,4096,1536]{2,1,0} convert(%mul.1062), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_61.7 = bf16[1536]{0} parameter(61)
  %broadcast_in_dim.1365 = bf16[1,1,1536]{2,1,0} reshape(%Arg_61.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1063 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.1365), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1064 = bf16[1536]{0} reshape(%mul.1063), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1065 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.1064), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1066 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.824, %mul.1065), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_48.7 = f32[1024]{0} parameter(48)
  %reduce_max.1303 = f32[] reduce(%Arg_48.7, %constant.500), dimensions={0}, to_apply=%region_224.304, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.188 = pred[] is-finite(%reduce_max.1303), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.188 = pred[] compare(%reduce_max.1303, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1066 = f32[] divide(%constant.498, %reduce_max.1303), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1067 = f32[] divide(%div.1066, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_49.7 = f32[1]{0} parameter(49)
  %div.1065 = f32[1]{0} divide(%constant.481, %Arg_49.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.380 = f32[1]{0} call(%gt.188, %div.1067, %div.1065), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.381 = f32[1]{0} call(%is_finite.188, %jit__where_.380, %div.1065), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1068 = f32[1]{0} divide(%constant.481, %jit__where_.381), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.826 = bf16[1]{0} convert(%div.1068), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1366 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.826), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1367 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1366), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1368 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.1367), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1069 = bf16[32,4096,1536]{2,1,0} divide(%mul.1066, %broadcast_in_dim.1368), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.198 = bf16[32,4096,1536]{2,1,0} call(%div.1069, %constant.495, %constant.494), to_apply=%clip_495.122, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.827 = f8e4m3fn[32,4096,1536]{2,1,0} convert(%jit_clip_.198), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_65.7 = bf16[1536,128,192]{2,1,0} parameter(65)
  %Arg_50.7 = f32[1024]{0} parameter(50)
  %reduce_max.1305 = f32[] reduce(%Arg_50.7, %constant.500), dimensions={0}, to_apply=%region_227.307, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.189 = pred[] is-finite(%reduce_max.1305), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.189 = pred[] compare(%reduce_max.1305, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1071 = f32[] divide(%constant.498, %reduce_max.1305), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1072 = f32[] divide(%div.1071, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_51.7 = f32[1]{0} parameter(51)
  %div.1070 = f32[1]{0} divide(%constant.481, %Arg_51.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.382 = f32[1]{0} call(%gt.189, %div.1072, %div.1070), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.383 = f32[1]{0} call(%is_finite.189, %jit__where_.382, %div.1070), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1073 = f32[1]{0} divide(%constant.481, %jit__where_.383), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.829 = bf16[1]{0} convert(%div.1073), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1369 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.829), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1370 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.1369), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1371 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.1370), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1074 = bf16[1536,128,192]{2,1,0} divide(%Arg_65.7, %broadcast_in_dim.1371), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.199 = bf16[1536,128,192]{2,1,0} call(%div.1074, %constant.495, %constant.494), to_apply=%clip_498.126, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.830 = f8e4m3fn[1536,128,192]{2,1,0} convert(%jit_clip_.199), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.129 = bf16[32,4096,128,192]{3,2,1,0} dot(%convert_element_type.827, %convert_element_type.830), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1067 = f32[1]{0} multiply(%div.1068, %div.1073), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.831 = bf16[1]{0} convert(%mul.1067), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1372 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.831), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1373 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1372), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1374 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.1373), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1068 = bf16[32,4096,128,192]{3,2,1,0} multiply(%dot_general.129, %broadcast_in_dim.1374), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.66 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.1068), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.67 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.1068), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.48 = bf16[32,4096,128,32,2]{4,3,2,1,0} reshape(%split.67), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.40 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.48), slice={[0:32], [0:4096], [0:128], [0:32], [0:1]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.525 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.40), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.834 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.525), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.41 = bf16[32,4096,128,32,1]{4,3,2,1,0} slice(%reshape.48), slice={[0:32], [0:4096], [0:128], [0:32], [1:2]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.526 = bf16[32,4096,128,32]{3,2,1,0} reshape(%slice.41), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.833 = c64[32,4096,128,32]{3,2,1,0} convert(%squeeze.526), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.469 = c64[] constant((0, 1))
  %broadcast.170 = c64[32,4096,128,32]{3,2,1,0} broadcast(%constant.469), dimensions={}
  %mul.1080 = c64[32,4096,128,32]{3,2,1,0} multiply(%convert_element_type.833, %broadcast.170), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.124 = c64[32,4096,128,32]{3,2,1,0} add(%convert_element_type.834, %mul.1080), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.44 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1375 = f32[163840,1]{1,0} reshape(%iota.44), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1072 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1375), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1073 = f32[163840]{0} reshape(%mul.1072), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1074 = f32[163840,32]{1,0} broadcast(%mul.1073), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.474 = f32[] constant(1)
  %broadcast.175 = f32[32]{0} broadcast(%constant.474), dimensions={}
  %constant.475 = f32[] constant(10000)
  %broadcast.176 = f32[32]{0} broadcast(%constant.475), dimensions={}
  %iota.42 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.477 = f32[] constant(2)
  %broadcast.178 = f32[32]{0} broadcast(%constant.477), dimensions={}
  %mul.1069 = f32[32]{0} multiply(%iota.42, %broadcast.178), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.476 = f32[] constant(64)
  %broadcast.177 = f32[32]{0} broadcast(%constant.476), dimensions={}
  %div.1075 = f32[32]{0} divide(%mul.1069, %broadcast.177), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pow.10 = f32[32]{0} power(%broadcast.176, %div.1075), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/pow" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1076 = f32[32]{0} divide(%broadcast.175, %pow.10), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.471 = f32[] constant(40)
  %broadcast.172 = f32[32]{0} broadcast(%constant.471), dimensions={}
  %div.1078 = f32[32]{0} divide(%div.1076, %broadcast.172), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.43 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.473 = f32[] constant(10)
  %broadcast.174 = f32[32]{0} broadcast(%constant.473), dimensions={}
  %sub.51 = f32[32]{0} subtract(%iota.43, %broadcast.174), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.472 = f32[] constant(13)
  %broadcast.173 = f32[32]{0} broadcast(%constant.472), dimensions={}
  %div.1077 = f32[32]{0} divide(%sub.51, %broadcast.173), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.496 = s32[] constant(0)
  %constant.493 = s32[] constant(1)
  %jit_clip_.200 = f32[32]{0} call(%div.1077, %constant.496, %constant.493), to_apply=%clip_499.127, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.52 = f32[32]{0} subtract(%broadcast.175, %jit_clip_.200), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.53 = f32[32]{0} subtract(%broadcast.175, %sub.52), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1070 = f32[32]{0} multiply(%div.1078, %sub.53), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1071 = f32[32]{0} multiply(%div.1076, %sub.52), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.123 = f32[32]{0} add(%mul.1070, %mul.1071), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1376 = f32[1,32]{1,0} reshape(%add.123), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1075 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1376), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1076 = f32[32]{0} reshape(%mul.1075), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1077 = f32[163840,32]{1,0} broadcast(%mul.1076), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1078 = f32[163840,32]{1,0} multiply(%mul.1074, %mul.1077), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.832 = c64[163840,32]{1,0} convert(%mul.1078), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.470 = c64[] constant((0, 1))
  %broadcast.171 = c64[163840,32]{1,0} broadcast(%constant.470), dimensions={}
  %mul.1079 = c64[163840,32]{1,0} multiply(%convert_element_type.832, %broadcast.171), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.203 = f32[163840,32]{1,0} real(%mul.1079), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.204 = f32[163840,32]{1,0} exponential(%exp.203), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.488 = f32[] constant(inf)
  %broadcast.186 = f32[163840,32]{1,0} broadcast(%constant.488), dimensions={}
  %exp.205 = pred[163840,32]{1,0} compare(%exp.204, %broadcast.186), direction=EQ, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.487 = f32[] constant(0.5)
  %broadcast.185 = f32[163840,32]{1,0} broadcast(%constant.487), dimensions={}
  %exp.206 = f32[163840,32]{1,0} multiply(%exp.203, %broadcast.185), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.207 = f32[163840,32]{1,0} exponential(%exp.206), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.208 = f32[163840,32]{1,0} imag(%mul.1079), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.209 = f32[163840,32]{1,0} cosine(%exp.208), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.210 = f32[163840,32]{1,0} multiply(%exp.207, %exp.209), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.211 = f32[163840,32]{1,0} multiply(%exp.210, %exp.207), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.212 = f32[163840,32]{1,0} multiply(%exp.204, %exp.209), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.213 = f32[163840,32]{1,0} select(%exp.205, %exp.211, %exp.212), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.486 = f32[] constant(0)
  %broadcast.184 = f32[163840,32]{1,0} broadcast(%constant.486), dimensions={}
  %exp.214 = pred[163840,32]{1,0} compare(%exp.208, %broadcast.184), direction=EQ, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.215 = f32[163840,32]{1,0} sine(%exp.208), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.216 = f32[163840,32]{1,0} multiply(%exp.207, %exp.215), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.217 = f32[163840,32]{1,0} multiply(%exp.216, %exp.207), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.218 = f32[163840,32]{1,0} multiply(%exp.204, %exp.215), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.219 = f32[163840,32]{1,0} select(%exp.205, %exp.217, %exp.218), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.220 = f32[163840,32]{1,0} select(%exp.214, %broadcast.184, %exp.219), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.221 = c64[163840,32]{1,0} complex(%exp.213, %exp.220), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_0.169 = s32[32,4096]{1,0} parameter(0)
  %jit__take_.10 = c64[32,4096,32]{2,1,0} call(%exp.221, %Arg_0.169), to_apply=%_take_500.130, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/jit(_take)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1377 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.10), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1081 = c64[32,4096,1,32]{3,2,1,0} broadcast(%broadcast_in_dim.1377), dimensions={0,1,2,3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1082 = c64[32,4096,32]{2,1,0} reshape(%mul.1081), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1083 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.1082), dimensions={0,1,3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1084 = c64[32,4096,128,32]{3,2,1,0} multiply(%add.124, %mul.1083), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %real.14 = f32[32,4096,128,32]{3,2,1,0} real(%mul.1084), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/real" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %imag.14 = f32[32,4096,128,32]{3,2,1,0} imag(%mul.1084), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/imag" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.41 = f32[32,4096,128,64]{3,2,1,0} concatenate(%real.14, %imag.14), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.835 = bf16[32,4096,128,64]{3,2,1,0} convert(%concatenate.41), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.42 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.66, %convert_element_type.835), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.468 = bf16[] constant(0.1348)
  %broadcast.169 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%constant.468), dimensions={}
  %mul.1085 = bf16[32,4096,128,192]{3,2,1,0} multiply(%concatenate.42, %broadcast.169), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.172 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%mul.1085), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_4.7 = bf16[32,4096,576]{2,1,0} parameter(4)
  %device_put.37 = bf16[32,4096,576]{2,1,0} custom-call(%Arg_4.7), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}, metadata={op_name="checkpoint/rematted_computation/device_put" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.68 = bf16[32,4096,512]{2,1,0} slice(%device_put.37), slice={[0:32], [0:4096], [0:512]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.836 = f32[32,4096,512]{2,1,0} convert(%split.68), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.32 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.836, %convert_element_type.836), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.475 = f32[32,4096]{1,0} reduce(%square.32, %constant.501), dimensions={2}, to_apply=%region_230.310, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1378 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.475), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.466 = f32[] constant(512)
  %broadcast.168 = f32[32,4096,1]{2,1,0} broadcast(%constant.466), dimensions={}
  %div.1079 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.1378, %broadcast.168), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.125 = f32[32,4096,1]{2,1,0} add(%div.1079, %broadcast.181), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.31 = f32[32,4096,1]{2,1,0} rsqrt(%add.125), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1088 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.31), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1089 = f32[32,4096]{1,0} reshape(%mul.1088), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1090 = f32[32,4096,512]{2,1,0} broadcast(%mul.1089), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1091 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.836, %mul.1090), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.837 = bf16[32,4096,512]{2,1,0} convert(%mul.1091), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_59.7 = bf16[512]{0} parameter(59)
  %broadcast_in_dim.1379 = bf16[1,1,512]{2,1,0} reshape(%Arg_59.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1092 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.1379), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1093 = bf16[512]{0} reshape(%mul.1092), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1094 = bf16[32,4096,512]{2,1,0} broadcast(%mul.1093), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1095 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.837, %mul.1094), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_42.7 = f32[1024]{0} parameter(42)
  %reduce_max.1307 = f32[] reduce(%Arg_42.7, %constant.500), dimensions={0}, to_apply=%region_231.311, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.190 = pred[] is-finite(%reduce_max.1307), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.190 = pred[] compare(%reduce_max.1307, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1086 = f32[] divide(%constant.498, %reduce_max.1307), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1087 = f32[] divide(%div.1086, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_43.7 = f32[1]{0} parameter(43)
  %div.1085 = f32[1]{0} divide(%constant.481, %Arg_43.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.384 = f32[1]{0} call(%gt.190, %div.1087, %div.1085), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.385 = f32[1]{0} call(%is_finite.190, %jit__where_.384, %div.1085), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1088 = f32[1]{0} divide(%constant.481, %jit__where_.385), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.843 = bf16[1]{0} convert(%div.1088), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1383 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.843), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1384 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1383), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1385 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.1384), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1089 = bf16[32,4096,512]{2,1,0} divide(%mul.1095, %broadcast_in_dim.1385), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.202 = bf16[32,4096,512]{2,1,0} call(%div.1089, %constant.495, %constant.494), to_apply=%clip_506.135, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.844 = f8e4m3fn[32,4096,512]{2,1,0} convert(%jit_clip_.202), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_63.7 = bf16[512,128,256]{2,1,0} parameter(63)
  %Arg_44.7 = f32[1024]{0} parameter(44)
  %reduce_max.1309 = f32[] reduce(%Arg_44.7, %constant.500), dimensions={0}, to_apply=%region_234.314, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.191 = pred[] is-finite(%reduce_max.1309), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.191 = pred[] compare(%reduce_max.1309, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1091 = f32[] divide(%constant.498, %reduce_max.1309), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1092 = f32[] divide(%div.1091, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_45.7 = f32[1]{0} parameter(45)
  %div.1090 = f32[1]{0} divide(%constant.481, %Arg_45.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.386 = f32[1]{0} call(%gt.191, %div.1092, %div.1090), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.387 = f32[1]{0} call(%is_finite.191, %jit__where_.386, %div.1090), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1093 = f32[1]{0} divide(%constant.481, %jit__where_.387), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.846 = bf16[1]{0} convert(%div.1093), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1386 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.846), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1387 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.1386), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1388 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.1387), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1094 = bf16[512,128,256]{2,1,0} divide(%Arg_63.7, %broadcast_in_dim.1388), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.203 = bf16[512,128,256]{2,1,0} call(%div.1094, %constant.495, %constant.494), to_apply=%clip_509.139, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.847 = f8e4m3fn[512,128,256]{2,1,0} convert(%jit_clip_.203), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.130 = bf16[32,4096,128,256]{3,2,1,0} dot(%convert_element_type.844, %convert_element_type.847), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1109 = f32[1]{0} multiply(%div.1088, %div.1093), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.848 = bf16[1]{0} convert(%mul.1109), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1389 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.848), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1390 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1389), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1391 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.1390), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1110 = bf16[32,4096,128,256]{3,2,1,0} multiply(%dot_general.130, %broadcast_in_dim.1391), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.70 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.1110), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.69 = bf16[32,4096,64]{2,1,0} slice(%device_put.37), slice={[0:32], [0:4096], [512:576]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.49 = bf16[32,4096,1,32,2]{4,3,2,1,0} reshape(%split.69), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.42 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.49), slice={[0:32], [0:4096], [0:1], [0:32], [0:1]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.527 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.42), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.840 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.527), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %slice.43 = bf16[32,4096,1,32,1]{4,3,2,1,0} slice(%reshape.49), slice={[0:32], [0:4096], [0:1], [0:32], [1:2]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %squeeze.528 = bf16[32,4096,1,32]{3,2,1,0} reshape(%slice.43), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.839 = c64[32,4096,1,32]{3,2,1,0} convert(%squeeze.528), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.465 = c64[] constant((0, 1))
  %broadcast.167 = c64[32,4096,1,32]{3,2,1,0} broadcast(%constant.465), dimensions={}
  %mul.1107 = c64[32,4096,1,32]{3,2,1,0} multiply(%convert_element_type.839, %broadcast.167), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.127 = c64[32,4096,1,32]{3,2,1,0} add(%convert_element_type.840, %mul.1107), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.47 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1380 = f32[163840,1]{1,0} reshape(%iota.47), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1099 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1380), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1100 = f32[163840]{0} reshape(%mul.1099), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1101 = f32[163840,32]{1,0} broadcast(%mul.1100), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.45 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1096 = f32[32]{0} multiply(%iota.45, %broadcast.178), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1081 = f32[32]{0} divide(%mul.1096, %broadcast.177), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pow.11 = f32[32]{0} power(%broadcast.176, %div.1081), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/pow" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1082 = f32[32]{0} divide(%broadcast.175, %pow.11), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1084 = f32[32]{0} divide(%div.1082, %broadcast.172), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %iota.46 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/iota" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.54 = f32[32]{0} subtract(%iota.46, %broadcast.174), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1083 = f32[32]{0} divide(%sub.54, %broadcast.173), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.201 = f32[32]{0} call(%div.1083, %constant.496, %constant.493), to_apply=%clip_499.127, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.55 = f32[32]{0} subtract(%broadcast.175, %jit_clip_.201), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sub.56 = f32[32]{0} subtract(%broadcast.175, %sub.55), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1097 = f32[32]{0} multiply(%div.1084, %sub.56), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1098 = f32[32]{0} multiply(%div.1082, %sub.55), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.126 = f32[32]{0} add(%mul.1097, %mul.1098), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1381 = f32[1,32]{1,0} reshape(%add.126), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1102 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1381), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1103 = f32[32]{0} reshape(%mul.1102), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1104 = f32[163840,32]{1,0} broadcast(%mul.1103), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1105 = f32[163840,32]{1,0} multiply(%mul.1101, %mul.1104), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.838 = c64[163840,32]{1,0} convert(%mul.1105), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1106 = c64[163840,32]{1,0} multiply(%convert_element_type.838, %broadcast.171), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.222 = f32[163840,32]{1,0} real(%mul.1106), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.223 = f32[163840,32]{1,0} exponential(%exp.222), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.224 = pred[163840,32]{1,0} compare(%exp.223, %broadcast.186), direction=EQ, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.225 = f32[163840,32]{1,0} multiply(%exp.222, %broadcast.185), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.226 = f32[163840,32]{1,0} exponential(%exp.225), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.227 = f32[163840,32]{1,0} imag(%mul.1106), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.228 = f32[163840,32]{1,0} cosine(%exp.227), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.229 = f32[163840,32]{1,0} multiply(%exp.226, %exp.228), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.230 = f32[163840,32]{1,0} multiply(%exp.229, %exp.226), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.231 = f32[163840,32]{1,0} multiply(%exp.223, %exp.228), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.232 = f32[163840,32]{1,0} select(%exp.224, %exp.230, %exp.231), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.233 = pred[163840,32]{1,0} compare(%exp.227, %broadcast.184), direction=EQ, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.234 = f32[163840,32]{1,0} sine(%exp.227), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.235 = f32[163840,32]{1,0} multiply(%exp.226, %exp.234), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.236 = f32[163840,32]{1,0} multiply(%exp.235, %exp.226), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.237 = f32[163840,32]{1,0} multiply(%exp.223, %exp.234), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.238 = f32[163840,32]{1,0} select(%exp.224, %exp.236, %exp.237), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.239 = f32[163840,32]{1,0} select(%exp.233, %broadcast.184, %exp.238), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %exp.240 = c64[163840,32]{1,0} complex(%exp.232, %exp.239), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/exp" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__take_.11 = c64[32,4096,32]{2,1,0} call(%exp.240, %Arg_0.169), to_apply=%_take_500.130, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/jit(_take)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1382 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.11), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1108 = c64[32,4096,1,32]{3,2,1,0} multiply(%add.127, %broadcast_in_dim.1382), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %real.15 = f32[32,4096,1,32]{3,2,1,0} real(%mul.1108), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/real" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %imag.15 = f32[32,4096,1,32]{3,2,1,0} imag(%mul.1108), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/imag" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.43 = f32[32,4096,1,64]{3,2,1,0} concatenate(%real.15, %imag.15), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.841 = bf16[32,4096,1,64]{3,2,1,0} convert(%concatenate.43), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1392 = bf16[32,4096,1,64]{3,2,1,0} broadcast(%convert_element_type.841), dimensions={0,1,2,3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1393 = bf16[32,4096,64]{2,1,0} reshape(%broadcast_in_dim.1392), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1394 = bf16[32,4096,128,64]{3,2,1,0} broadcast(%broadcast_in_dim.1393), dimensions={0,1,3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.44 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.70, %broadcast_in_dim.1394), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.173 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%concatenate.44), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.71 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.1110), slice={[0:32], [0:4096], [0:128], [128:256]}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.174 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%split.71), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.464 = bf16[0]{0} constant({})
  %custom_partitioning.51 = (bf16[32,4096,128,128]{3,2,1,0}, f32[32,128,4096]{2,1,0}) custom-call(%sharding_constraint.172, %sharding_constraint.173, %sharding_constraint.174, %constant.464, %constant.464, /*index=5*/%constant.464, %constant.464, %constant.464, %constant.464, %constant.464), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281457329920656"
  %custom_partitioning.53 = f32[32,128,4096]{2,1,0} get-tuple-element(%custom_partitioning.51), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.52 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.51), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1])->([i, j, k, t], [i, k, j]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0}, custom>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.183 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.51), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_40.7 = f32[1024]{0} parameter(40)
  %reduce_max.1333 = f32[] reduce(%Arg_40.7, %constant.500), dimensions={0}, to_apply=%region_275.361, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.203 = pred[] is-finite(%reduce_max.1333), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.203 = pred[] compare(%reduce_max.1333, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1154 = f32[] divide(%constant.491, %reduce_max.1333), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1155 = f32[] divide(%div.1154, %constant.499), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_41.7 = f32[1]{0} parameter(41)
  %div.1153 = f32[1]{0} divide(%constant.481, %Arg_41.7), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.410 = f32[1]{0} call(%gt.203, %div.1155, %div.1153), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.411 = f32[1]{0} call(%is_finite.203, %jit__where_.410, %div.1153), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1156 = f32[1]{0} divide(%constant.481, %jit__where_.411), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.893 = bf16[1]{0} convert(%div.1156), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1449 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.893), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1450 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1449), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1451 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1450), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1157 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.183, %broadcast_in_dim.1451), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.215 = bf16[32,4096,7168]{2,1,0} call(%div.1157, %constant.490, %constant.489), to_apply=%clip_555.219, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.894 = f8e5m2[32,4096,7168]{2,1,0} convert(%jit_clip_.215), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_60.7 = bf16[128,128,7168]{2,1,0} parameter(60)
  %Arg_38.7 = f32[1024]{0} parameter(38)
  %reduce_max.1313 = f32[] reduce(%Arg_38.7, %constant.500), dimensions={0}, to_apply=%region_240.320, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.193 = pred[] is-finite(%reduce_max.1313), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.193 = pred[] compare(%reduce_max.1313, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1101 = f32[] divide(%constant.498, %reduce_max.1313), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1102 = f32[] divide(%div.1101, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_39.7 = f32[1]{0} parameter(39)
  %div.1100 = f32[1]{0} divide(%constant.481, %Arg_39.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.390 = f32[1]{0} call(%gt.193, %div.1102, %div.1100), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.391 = f32[1]{0} call(%is_finite.193, %jit__where_.390, %div.1100), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1103 = f32[1]{0} divide(%constant.481, %jit__where_.391), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.853 = bf16[1]{0} convert(%div.1103), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1398 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.853), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1399 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.1398), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1400 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.1399), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1104 = bf16[128,128,7168]{2,1,0} divide(%Arg_60.7, %broadcast_in_dim.1400), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.205 = bf16[128,128,7168]{2,1,0} call(%div.1104, %constant.495, %constant.494), to_apply=%clip_515.147, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.854 = f8e4m3fn[128,128,7168]{2,1,0} convert(%jit_clip_.205), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.137 = bf16[32,4096,128,128]{3,2,1,0} dot(%convert_element_type.894, %convert_element_type.854), lhs_contracting_dims={2}, rhs_contracting_dims={2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1148 = f32[1]{0} multiply(%div.1103, %div.1156), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.895 = bf16[1]{0} convert(%mul.1148), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1452 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.895), dimensions={3}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1453 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1452), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1454 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.1453), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1149 = bf16[32,4096,128,128]{3,2,1,0} multiply(%dot_general.137, %broadcast_in_dim.1454), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.184 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%mul.1149), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.54 = (bf16[32,4096,128,192]{3,2,1,0}, bf16[32,4096,128,192]{3,2,1,0}, bf16[32,4096,128,128]{3,2,1,0}) custom-call(%sharding_constraint.172, %sharding_constraint.173, %sharding_constraint.174, %constant.464, %constant.464, /*index=5*/%constant.464, %constant.464, %constant.464, %constant.464, %constant.464, /*index=10*/%custom_partitioning.53, %custom_partitioning.52, %sharding_constraint.184), custom_call_target="CustomSPMDPartitioning", api_version=API_VERSION_STATUS_RETURNING, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}, backend_config="281457329392288"
  %custom_partitioning.56 = bf16[32,4096,128,192]{3,2,1,0} get-tuple-element(%custom_partitioning.54), index=1, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.186 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%custom_partitioning.56), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.72 = bf16[32,4096,128,128]{3,2,1,0} slice(%sharding_constraint.186), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.57 = bf16[32,4096,128,128]{3,2,1,0} get-tuple-element(%custom_partitioning.54), index=2, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.185 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.57), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.45 = bf16[32,4096,128,256]{3,2,1,0} concatenate(%split.72, %sharding_constraint.185), dimensions={3}, metadata={op_name="checkpoint/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_46.7 = f32[1024]{0} parameter(46)
  %reduce_max.1335 = f32[] reduce(%Arg_46.7, %constant.500), dimensions={0}, to_apply=%region_279.365, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.204 = pred[] is-finite(%reduce_max.1335), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.204 = pred[] compare(%reduce_max.1335, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1159 = f32[] divide(%constant.491, %reduce_max.1335), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1160 = f32[] divide(%div.1159, %constant.499), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_47.7 = f32[1]{0} parameter(47)
  %div.1158 = f32[1]{0} divide(%constant.481, %Arg_47.7), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.412 = f32[1]{0} call(%gt.204, %div.1160, %div.1158), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.413 = f32[1]{0} call(%is_finite.204, %jit__where_.412, %div.1158), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1161 = f32[1]{0} divide(%constant.481, %jit__where_.413), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.898 = bf16[1]{0} convert(%div.1161), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1459 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.898), dimensions={3}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1460 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1459), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1461 = bf16[32,4096,128,256]{3,2,1,0} broadcast(%broadcast_in_dim.1460), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1162 = bf16[32,4096,128,256]{3,2,1,0} divide(%concatenate.45, %broadcast_in_dim.1461), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.216 = bf16[32,4096,128,256]{3,2,1,0} call(%div.1162, %constant.490, %constant.489), to_apply=%clip_629.264, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.899 = f8e5m2[32,4096,128,256]{3,2,1,0} convert(%jit_clip_.216), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.139 = bf16[32,4096,512]{2,1,0} dot(%convert_element_type.899, %convert_element_type.847), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1152 = f32[1]{0} multiply(%div.1093, %div.1161), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.900 = bf16[1]{0} convert(%mul.1152), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1462 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.900), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1463 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1462), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1464 = bf16[32,4096,512]{2,1,0} broadcast(%broadcast_in_dim.1463), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1153 = bf16[32,4096,512]{2,1,0} multiply(%dot_general.139, %broadcast_in_dim.1464), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1159 = bf16[1,1,512]{2,1,0} broadcast(%broadcast_in_dim.1379), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1160 = bf16[512]{0} reshape(%mul.1159), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1161 = bf16[32,4096,512]{2,1,0} broadcast(%mul.1160), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1162 = bf16[32,4096,512]{2,1,0} multiply(%mul.1153, %mul.1161), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.907 = f32[32,4096,512]{2,1,0} convert(%mul.1162), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1164 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.31), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1165 = f32[32,4096]{1,0} reshape(%mul.1164), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1166 = f32[32,4096,512]{2,1,0} broadcast(%mul.1165), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1167 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.907, %mul.1166), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1163 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.836, %convert_element_type.907), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.485 = f32[32,4096]{1,0} reduce(%mul.1163, %constant.501), dimensions={2}, to_apply=%region_285.371, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.54 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.485), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1080 = f32[32,4096,1]{2,1,0} divide(%rsqrt.31, %add.125), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1087 = f32[32,4096,1]{2,1,0} multiply(%div.1080, %broadcast.180), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1168 = f32[32,4096,1]{2,1,0} multiply(%reshape.54, %mul.1087), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1163 = f32[32,4096,1]{2,1,0} divide(%mul.1168, %broadcast.168), metadata={op_name="checkpoint/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.486 = f32[32,4096]{1,0} reduce(%div.1163, %constant.501), dimensions={2}, to_apply=%region_286.372, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1470 = f32[32,4096,512]{2,1,0} broadcast(%reduce_sum.486), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.467 = f32[] constant(2)
  %mul.1045 = f32[32,4096,512]{2,1,0} broadcast(%constant.467), dimensions={}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1086 = f32[32,4096,512]{2,1,0} multiply(%convert_element_type.836, %mul.1045), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1169 = f32[32,4096,512]{2,1,0} multiply(%broadcast_in_dim.1470, %mul.1086), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.54 = f32[32,4096,512]{2,1,0} add(%mul.1167, %mul.1169), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.908 = bf16[32,4096,512]{2,1,0} convert(%add_any.54), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.463 = f32[] constant(0)
  %broadcast.166 = f32[32,4096,1,32]{3,2,1,0} broadcast(%constant.463), dimensions={}
  %split.73 = bf16[32,4096,128,64]{3,2,1,0} slice(%sharding_constraint.186), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.492 = bf16[] constant(0)
  %reduce_sum.481 = bf16[32,4096,64]{2,1,0} reduce(%split.73, %constant.492), dimensions={2}, to_apply=%region_278.364, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1458 = bf16[32,4096,1,64]{3,2,1,0} reshape(%reduce_sum.481), metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.902 = f32[32,4096,1,64]{3,2,1,0} convert(%broadcast_in_dim.1458), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.75 = f32[32,4096,1,32]{3,2,1,0} slice(%convert_element_type.902), slice={[0:32], [0:4096], [0:1], [32:64]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %neg.19 = f32[32,4096,1,32]{3,2,1,0} negate(%split.75), metadata={op_name="checkpoint/dense_layers/self_attention/neg" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.12 = c64[32,4096,1,32]{3,2,1,0} complex(%broadcast.166, %neg.19), metadata={op_name="checkpoint/dense_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.74 = f32[32,4096,1,32]{3,2,1,0} slice(%convert_element_type.902), slice={[0:32], [0:4096], [0:1], [0:32]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.13 = c64[32,4096,1,32]{3,2,1,0} complex(%split.74, %broadcast.166), metadata={op_name="checkpoint/dense_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.52 = c64[32,4096,1,32]{3,2,1,0} add(%complex.12, %complex.13), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1156 = c64[32,4096,1,32]{3,2,1,0} multiply(%add_any.52, %broadcast_in_dim.1382), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1157 = c64[32,4096,1,32]{3,2,1,0} multiply(%mul.1156, %broadcast.167), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.905 = f32[32,4096,1,32]{3,2,1,0} real(%mul.1157), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.906 = bf16[32,4096,1,32]{3,2,1,0} convert(%convert_element_type.905), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1468 = bf16[32,4096,1,32,1]{4,3,2,1,0} reshape(%convert_element_type.906), metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.14 = bf16[32,4096,1,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.1468, %constant.492), padding=0_0x0_0x0_0x0_0x1_0, metadata={op_name="checkpoint/dense_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.903 = f32[32,4096,1,32]{3,2,1,0} real(%mul.1156), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.904 = bf16[32,4096,1,32]{3,2,1,0} convert(%convert_element_type.903), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1469 = bf16[32,4096,1,32,1]{4,3,2,1,0} reshape(%convert_element_type.904), metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.15 = bf16[32,4096,1,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.1469, %constant.492), padding=0_0x0_0x0_0x0_0x0_1, metadata={op_name="checkpoint/dense_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.53 = bf16[32,4096,1,32,2]{4,3,2,1,0} add(%pad.14, %pad.15), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.52 = bf16[32,4096,1,64]{3,2,1,0} reshape(%add_any.53), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.482 = bf16[32,4096,64]{2,1,0} reduce(%reshape.52, %constant.492), dimensions={2}, to_apply=%region_282.368, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.46 = bf16[32,4096,576]{2,1,0} concatenate(%convert_element_type.908, %reduce_sum.482), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_33.7 = f32[1024]{0} parameter(33)
  %reduce_max.1339 = f32[] reduce(%Arg_33.7, %constant.500), dimensions={0}, to_apply=%region_294.380, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.206 = pred[] is-finite(%reduce_max.1339), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.206 = pred[] compare(%reduce_max.1339, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1171 = f32[] divide(%constant.491, %reduce_max.1339), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1172 = f32[] divide(%div.1171, %constant.499), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_35.7 = f32[1]{0} parameter(35)
  %div.1170 = f32[1]{0} divide(%constant.481, %Arg_35.7), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.416 = f32[1]{0} call(%gt.206, %div.1172, %div.1170), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.417 = f32[1]{0} call(%is_finite.206, %jit__where_.416, %div.1170), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1173 = f32[1]{0} divide(%constant.481, %jit__where_.417), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.922 = bf16[1]{0} convert(%div.1173), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1483 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.922), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1484 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1483), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1485 = bf16[32,4096,576]{2,1,0} broadcast(%broadcast_in_dim.1484), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1174 = bf16[32,4096,576]{2,1,0} divide(%concatenate.46, %broadcast_in_dim.1485), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.218 = bf16[32,4096,576]{2,1,0} call(%div.1174, %constant.490, %constant.489), to_apply=%clip_689.281, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.923 = f8e5m2[32,4096,576]{2,1,0} convert(%jit_clip_.218), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_62.7 = bf16[7168,576]{1,0} parameter(62)
  %Arg_29.7 = f32[1024]{0} parameter(29)
  %reduce_max.1301 = f32[] reduce(%Arg_29.7, %constant.500), dimensions={0}, to_apply=%region_220.300, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.187 = pred[] is-finite(%reduce_max.1301), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.187 = pred[] compare(%reduce_max.1301, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1059 = f32[] divide(%constant.498, %reduce_max.1301), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1060 = f32[] divide(%div.1059, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_31.7 = f32[1]{0} parameter(31)
  %div.1058 = f32[1]{0} divide(%constant.481, %Arg_31.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.378 = f32[1]{0} call(%gt.187, %div.1060, %div.1058), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.379 = f32[1]{0} call(%is_finite.187, %jit__where_.378, %div.1058), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1061 = f32[1]{0} divide(%constant.481, %jit__where_.379), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.821 = bf16[1]{0} convert(%div.1061), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1361 = bf16[7168,1]{1,0} broadcast(%convert_element_type.821), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1362 = bf16[7168]{0} reshape(%broadcast_in_dim.1361), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1363 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.1362), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1062 = bf16[7168,576]{1,0} divide(%Arg_62.7, %broadcast_in_dim.1363), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.197 = bf16[7168,576]{1,0} call(%div.1062, %constant.495, %constant.494), to_apply=%clip_490.117, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.822 = f8e4m3fn[7168,576]{1,0} convert(%jit_clip_.197), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.143 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.923, %convert_element_type.822), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1192 = f32[1]{0} multiply(%div.1061, %div.1173), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.924 = bf16[1]{0} convert(%mul.1192), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1486 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.924), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1487 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1486), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1488 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1487), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1193 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.143, %broadcast_in_dim.1488), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %custom_partitioning.55 = bf16[32,4096,128,192]{3,2,1,0} get-tuple-element(%custom_partitioning.54), index=0, frontend_attributes={xla.sdy.sharding_rule="#sdy.op_sharding_rule<([i, j, k, l], [m, n, o, p], [q, r, s, t], [u], [v], [w], [x], [y], [z], [z_1], [z_2, z_3, z_4], [z_5, z_6, z_7, z_8], [z_9, z_10, z_11, z_12])->([i, j, k, l], [m, n, o, p], [q, r, s, t]) {i=32, j=4096, k=128, l=192, m=32, n=4096, o=128, p=192, q=32, r=4096, s=128, t=128, u=0, v=0, w=0, x=0, y=0, z=0, z_1=0, z_2=32, z_3=128, z_4=4096, z_5=32, z_6=4096, z_7=128, z_8=128, z_9=32, z_10=4096, z_11=128, z_12=128}, custom>"}, metadata={op_name="checkpoint/dense_layers/self_attention/custom_partitioning" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.187 = bf16[32,4096,128,192]{3,2,1,0} custom-call(%custom_partitioning.55), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\"}, {}]>]>"}, metadata={op_name="checkpoint/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1170 = bf16[32,4096,128,192]{3,2,1,0} multiply(%sharding_constraint.187, %broadcast.169), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.76 = bf16[32,4096,128,128]{3,2,1,0} slice(%mul.1170), slice={[0:32], [0:4096], [0:128], [0:128]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.462 = f32[] constant(0)
  %broadcast.165 = f32[32,4096,128,32]{3,2,1,0} broadcast(%constant.462), dimensions={}
  %split.77 = bf16[32,4096,128,64]{3,2,1,0} slice(%mul.1170), slice={[0:32], [0:4096], [0:128], [128:192]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.909 = f32[32,4096,128,64]{3,2,1,0} convert(%split.77), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.79 = f32[32,4096,128,32]{3,2,1,0} slice(%convert_element_type.909), slice={[0:32], [0:4096], [0:128], [32:64]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %neg.20 = f32[32,4096,128,32]{3,2,1,0} negate(%split.79), metadata={op_name="checkpoint/dense_layers/self_attention/neg" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.14 = c64[32,4096,128,32]{3,2,1,0} complex(%broadcast.165, %neg.20), metadata={op_name="checkpoint/dense_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %split.78 = f32[32,4096,128,32]{3,2,1,0} slice(%convert_element_type.909), slice={[0:32], [0:4096], [0:128], [0:32]}, metadata={op_name="checkpoint/dense_layers/self_attention/split" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %complex.15 = c64[32,4096,128,32]{3,2,1,0} complex(%split.78, %broadcast.165), metadata={op_name="checkpoint/dense_layers/self_attention/complex" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.55 = c64[32,4096,128,32]{3,2,1,0} add(%complex.14, %complex.15), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1171 = c64[32,4096,1,32]{3,2,1,0} broadcast(%broadcast_in_dim.1377), dimensions={0,1,2,3}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1172 = c64[32,4096,32]{2,1,0} reshape(%mul.1171), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1173 = c64[32,4096,128,32]{3,2,1,0} broadcast(%mul.1172), dimensions={0,1,3}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1174 = c64[32,4096,128,32]{3,2,1,0} multiply(%add_any.55, %mul.1173), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1175 = c64[32,4096,128,32]{3,2,1,0} multiply(%mul.1174, %broadcast.170), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.912 = f32[32,4096,128,32]{3,2,1,0} real(%mul.1175), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.913 = bf16[32,4096,128,32]{3,2,1,0} convert(%convert_element_type.912), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1471 = bf16[32,4096,128,32,1]{4,3,2,1,0} reshape(%convert_element_type.913), metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.16 = bf16[32,4096,128,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.1471, %constant.492), padding=0_0x0_0x0_0x0_0x1_0, metadata={op_name="checkpoint/dense_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.910 = f32[32,4096,128,32]{3,2,1,0} real(%mul.1174), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.911 = bf16[32,4096,128,32]{3,2,1,0} convert(%convert_element_type.910), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1472 = bf16[32,4096,128,32,1]{4,3,2,1,0} reshape(%convert_element_type.911), metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %pad.17 = bf16[32,4096,128,32,2]{4,3,2,1,0} pad(%broadcast_in_dim.1472, %constant.492), padding=0_0x0_0x0_0x0_0x0_1, metadata={op_name="checkpoint/dense_layers/self_attention/pad" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.56 = bf16[32,4096,128,32,2]{4,3,2,1,0} add(%pad.16, %pad.17), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.55 = bf16[32,4096,128,64]{3,2,1,0} reshape(%add_any.56), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %concatenate.47 = bf16[32,4096,128,192]{3,2,1,0} concatenate(%split.76, %reshape.55), dimensions={3}, metadata={op_name="checkpoint/dense_layers/self_attention/concatenate" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_52.7 = f32[1024]{0} parameter(52)
  %reduce_max.1337 = f32[] reduce(%Arg_52.7, %constant.500), dimensions={0}, to_apply=%region_287.373, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.205 = pred[] is-finite(%reduce_max.1337), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.205 = pred[] compare(%reduce_max.1337, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1165 = f32[] divide(%constant.491, %reduce_max.1337), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1166 = f32[] divide(%div.1165, %constant.499), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_53.7 = f32[1]{0} parameter(53)
  %div.1164 = f32[1]{0} divide(%constant.481, %Arg_53.7), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.414 = f32[1]{0} call(%gt.205, %div.1166, %div.1164), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.415 = f32[1]{0} call(%is_finite.205, %jit__where_.414, %div.1164), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1167 = f32[1]{0} divide(%constant.481, %jit__where_.415), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.915 = bf16[1]{0} convert(%div.1167), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1473 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.915), dimensions={3}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1474 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1473), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1475 = bf16[32,4096,128,192]{3,2,1,0} broadcast(%broadcast_in_dim.1474), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1168 = bf16[32,4096,128,192]{3,2,1,0} divide(%concatenate.47, %broadcast_in_dim.1475), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.217 = bf16[32,4096,128,192]{3,2,1,0} call(%div.1168, %constant.490, %constant.489), to_apply=%clip_672.273, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.916 = f8e5m2[32,4096,128,192]{3,2,1,0} convert(%jit_clip_.217), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.141 = bf16[32,4096,1536]{2,1,0} dot(%convert_element_type.916, %convert_element_type.830), lhs_contracting_dims={2,3}, rhs_contracting_dims={1,2}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1176 = f32[1]{0} multiply(%div.1073, %div.1167), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.917 = bf16[1]{0} convert(%mul.1176), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1476 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.917), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1477 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1476), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1478 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.1477), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1177 = bf16[32,4096,1536]{2,1,0} multiply(%dot_general.141, %broadcast_in_dim.1478), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1181 = bf16[1,1,1536]{2,1,0} broadcast(%broadcast_in_dim.1365), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1182 = bf16[1536]{0} reshape(%mul.1181), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1183 = bf16[32,4096,1536]{2,1,0} broadcast(%mul.1182), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1184 = bf16[32,4096,1536]{2,1,0} multiply(%mul.1177, %mul.1183), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.919 = f32[32,4096,1536]{2,1,0} convert(%mul.1184), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1186 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.30), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1187 = f32[32,4096]{1,0} reshape(%mul.1186), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1188 = f32[32,4096,1536]{2,1,0} broadcast(%mul.1187), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1189 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.919, %mul.1188), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1185 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.823, %convert_element_type.919), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.489 = f32[32,4096]{1,0} reduce(%mul.1185, %constant.501), dimensions={2}, to_apply=%region_292.378, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.57 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.489), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1064 = f32[32,4096,1]{2,1,0} divide(%rsqrt.30, %add.122), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1058 = f32[32,4096,1]{2,1,0} multiply(%div.1064, %broadcast.180), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1190 = f32[32,4096,1]{2,1,0} multiply(%reshape.57, %mul.1058), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1169 = f32[32,4096,1]{2,1,0} divide(%mul.1190, %broadcast.179), metadata={op_name="checkpoint/dense_layers/self_attention/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.490 = f32[32,4096]{1,0} reduce(%div.1169, %constant.501), dimensions={2}, to_apply=%region_293.379, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1482 = f32[32,4096,1536]{2,1,0} broadcast(%reduce_sum.490), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.479 = f32[] constant(2)
  %mul.1046 = f32[32,4096,1536]{2,1,0} broadcast(%constant.479), dimensions={}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1057 = f32[32,4096,1536]{2,1,0} multiply(%convert_element_type.823, %mul.1046), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1191 = f32[32,4096,1536]{2,1,0} multiply(%broadcast_in_dim.1482, %mul.1057), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.57 = f32[32,4096,1536]{2,1,0} add(%mul.1189, %mul.1191), metadata={op_name="checkpoint/dense_layers/self_attention/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.920 = bf16[32,4096,1536]{2,1,0} convert(%add_any.57), metadata={op_name="checkpoint/dense_layers/self_attention/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_32.7 = f32[1024]{0} parameter(32)
  %reduce_max.1341 = f32[] reduce(%Arg_32.7, %constant.500), dimensions={0}, to_apply=%region_297.383, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.207 = pred[] is-finite(%reduce_max.1341), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.207 = pred[] compare(%reduce_max.1341, %constant.501), direction=GT, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1176 = f32[] divide(%constant.491, %reduce_max.1341), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1177 = f32[] divide(%div.1176, %constant.499), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_34.7 = f32[1]{0} parameter(34)
  %div.1175 = f32[1]{0} divide(%constant.481, %Arg_34.7), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.418 = f32[1]{0} call(%gt.207, %div.1177, %div.1175), to_apply=%_where_552.214, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.419 = f32[1]{0} call(%is_finite.207, %jit__where_.418, %div.1175), to_apply=%_where_553.215, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1178 = f32[1]{0} divide(%constant.481, %jit__where_.419), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.927 = bf16[1]{0} convert(%div.1178), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1492 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.927), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1493 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1492), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1494 = bf16[32,4096,1536]{2,1,0} broadcast(%broadcast_in_dim.1493), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1179 = bf16[32,4096,1536]{2,1,0} divide(%convert_element_type.920, %broadcast_in_dim.1494), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.219 = bf16[32,4096,1536]{2,1,0} call(%div.1179, %constant.490, %constant.489), to_apply=%clip_697.285, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.928 = f8e5m2[32,4096,1536]{2,1,0} convert(%jit_clip_.219), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_64.7 = bf16[7168,1536]{1,0} parameter(64)
  %Arg_28.7 = f32[1024]{0} parameter(28)
  %reduce_max.1299 = f32[] reduce(%Arg_28.7, %constant.500), dimensions={0}, to_apply=%region_217.297, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.186 = pred[] is-finite(%reduce_max.1299), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.186 = pred[] compare(%reduce_max.1299, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1054 = f32[] divide(%constant.498, %reduce_max.1299), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1055 = f32[] divide(%div.1054, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_30.7 = f32[1]{0} parameter(30)
  %div.1053 = f32[1]{0} divide(%constant.481, %Arg_30.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.376 = f32[1]{0} call(%gt.186, %div.1055, %div.1053), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.377 = f32[1]{0} call(%is_finite.186, %jit__where_.376, %div.1053), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1056 = f32[1]{0} divide(%constant.481, %jit__where_.377), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.818 = bf16[1]{0} convert(%div.1056), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1358 = bf16[7168,1]{1,0} broadcast(%convert_element_type.818), dimensions={1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1359 = bf16[7168]{0} reshape(%broadcast_in_dim.1358), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1360 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.1359), dimensions={0}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1057 = bf16[7168,1536]{1,0} divide(%Arg_64.7, %broadcast_in_dim.1360), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.196 = bf16[7168,1536]{1,0} call(%div.1057, %constant.495, %constant.494), to_apply=%clip_487.113, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.819 = f8e4m3fn[7168,1536]{1,0} convert(%jit_clip_.196), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.145 = bf16[32,4096,7168]{2,1,0} dot(%convert_element_type.928, %convert_element_type.819), lhs_contracting_dims={2}, rhs_contracting_dims={1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1196 = f32[1]{0} multiply(%div.1056, %div.1178), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.929 = bf16[1]{0} convert(%mul.1196), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1495 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.929), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1496 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1495), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1497 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1496), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1197 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.145, %broadcast_in_dim.1497), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.58 = bf16[32,4096,7168]{2,1,0} add(%mul.1193, %mul.1197), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.188 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.58), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.189 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.188), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_58.7 = bf16[7168]{0} parameter(58)
  %broadcast_in_dim.1354 = bf16[1,1,7168]{2,1,0} reshape(%Arg_58.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1201 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1354), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1202 = bf16[7168]{0} reshape(%mul.1201), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1203 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1202), dimensions={2}, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1204 = bf16[32,4096,7168]{2,1,0} multiply(%sharding_constraint.189, %mul.1203), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.931 = f32[32,4096,7168]{2,1,0} convert(%mul.1204), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.812 = f32[32,4096,7168]{2,1,0} convert(%Arg_2.139), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %square.30 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.812, %convert_element_type.812), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/square" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.473 = f32[32,4096]{1,0} reduce(%square.30, %constant.501), dimensions={2}, to_apply=%region_213.293, metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1353 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.473), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1046 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.1353, %broadcast.182), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add.121 = f32[32,4096,1]{2,1,0} add(%div.1046, %broadcast.181), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %rsqrt.29 = f32[32,4096,1]{2,1,0} rsqrt(%add.121), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/rsqrt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1206 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.29), dimensions={0,1,2}, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1207 = f32[32,4096]{1,0} reshape(%mul.1206), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1208 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1207), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1209 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.931, %mul.1208), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1205 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.812, %convert_element_type.931), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.493 = f32[32,4096]{1,0} reduce(%mul.1205, %constant.501), dimensions={2}, to_apply=%region_302.388, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.59 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.493), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1047 = f32[32,4096,1]{2,1,0} divide(%rsqrt.29, %add.121), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1048 = f32[32,4096,1]{2,1,0} multiply(%div.1047, %broadcast.180), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1210 = f32[32,4096,1]{2,1,0} multiply(%reshape.59, %mul.1048), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1180 = f32[32,4096,1]{2,1,0} divide(%mul.1210, %broadcast.182), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.494 = f32[32,4096]{1,0} reduce(%div.1180, %constant.501), dimensions={2}, to_apply=%region_303.389, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1501 = f32[32,4096,7168]{2,1,0} broadcast(%reduce_sum.494), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1047 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.812, %broadcast.183), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1211 = f32[32,4096,7168]{2,1,0} multiply(%broadcast_in_dim.1501, %mul.1047), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.59 = f32[32,4096,7168]{2,1,0} add(%mul.1209, %mul.1211), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.932 = bf16[32,4096,7168]{2,1,0} convert(%add_any.59), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %add_any.60 = bf16[32,4096,7168]{2,1,0} add(%add_any.51, %convert_element_type.932), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/add_any" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.190 = bf16[32,4096,7168]{2,1,0} custom-call(%add_any.60), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1113 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.32), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1114 = f32[32,4096]{1,0} reshape(%mul.1113), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1115 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1114), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1116 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.855, %mul.1115), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.856 = bf16[32,4096,7168]{2,1,0} convert(%mul.1116), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1117 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1402), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1118 = bf16[7168]{0} reshape(%mul.1117), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1119 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1118), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1120 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.856, %mul.1119), metadata={op_name="checkpoint/rematted_computation/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.177 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.1120), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_8.7 = f32[1024]{0} parameter(8)
  %reduce_max.1315 = f32[] reduce(%Arg_8.7, %constant.500), dimensions={0}, to_apply=%region_244.324, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.194 = pred[] is-finite(%reduce_max.1315), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.194 = pred[] compare(%reduce_max.1315, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1108 = f32[] divide(%constant.498, %reduce_max.1315), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1109 = f32[] divide(%div.1108, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_9.7 = f32[1]{0} parameter(9)
  %div.1107 = f32[1]{0} divide(%constant.481, %Arg_9.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.392 = f32[1]{0} call(%gt.194, %div.1109, %div.1107), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.393 = f32[1]{0} call(%is_finite.194, %jit__where_.392, %div.1107), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1110 = f32[1]{0} divide(%constant.481, %jit__where_.393), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.858 = bf16[1]{0} convert(%div.1110), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1403 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.858), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1404 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1403), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1405 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1404), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1111 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.177, %broadcast_in_dim.1405), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.206 = bf16[32,4096,7168]{2,1,0} call(%div.1111, %constant.495, %constant.494), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.859 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.206), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.136 = bf16[18432,7168]{1,0} dot(%convert_element_type.887, %convert_element_type.859), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.91 = bf16[7168,18432]{0,1} transpose(%dot_general.136), dimensions={1,0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1134 = f32[1]{0} multiply(%div.1110, %div.1150), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.889 = bf16[1]{0} convert(%mul.1134), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1445 = bf16[7168,1]{1,0} broadcast(%convert_element_type.889), dimensions={1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1446 = bf16[7168]{0} reshape(%broadcast_in_dim.1445), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1447 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.1446), dimensions={0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1135 = bf16[7168,18432]{0,1} multiply(%transpose.91, %broadcast_in_dim.1447), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_14.7 = f32[1024]{0} parameter(14)
  %reduce_max.1319 = f32[] reduce(%Arg_14.7, %constant.500), dimensions={0}, to_apply=%region_250.332, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.196 = pred[] is-finite(%reduce_max.1319), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.196 = pred[] compare(%reduce_max.1319, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1118 = f32[] divide(%constant.498, %reduce_max.1319), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1119 = f32[] divide(%div.1118, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_15.7 = f32[1]{0} parameter(15)
  %div.1117 = f32[1]{0} divide(%constant.481, %Arg_15.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.396 = f32[1]{0} call(%gt.196, %div.1119, %div.1117), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.397 = f32[1]{0} call(%is_finite.196, %jit__where_.396, %div.1117), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1120 = f32[1]{0} divide(%constant.481, %jit__where_.397), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.864 = bf16[1]{0} convert(%div.1120), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1409 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.864), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1410 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1409), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1411 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1410), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1121 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.177, %broadcast_in_dim.1411), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.208 = bf16[32,4096,7168]{2,1,0} call(%div.1121, %constant.495, %constant.494), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.865 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.208), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.134 = bf16[18432,7168]{1,0} dot(%convert_element_type.882, %convert_element_type.865), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.90 = bf16[7168,18432]{0,1} transpose(%dot_general.134), dimensions={1,0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1130 = f32[1]{0} multiply(%div.1120, %div.1145), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.884 = bf16[1]{0} convert(%mul.1130), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1436 = bf16[7168,1]{1,0} broadcast(%convert_element_type.884), dimensions={1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1437 = bf16[7168]{0} reshape(%broadcast_in_dim.1436), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1438 = bf16[7168,18432]{1,0} broadcast(%broadcast_in_dim.1437), dimensions={0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1131 = bf16[7168,18432]{0,1} multiply(%transpose.90, %broadcast_in_dim.1438), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1121 = bf16[32,4096,18432]{2,1,0} multiply(%jit_silu_.32, %device_put.39), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.178 = bf16[32,4096,18432]{2,1,0} custom-call(%mul.1121), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_20.7 = f32[1024]{0} parameter(20)
  %reduce_max.1323 = f32[] reduce(%Arg_20.7, %constant.500), dimensions={0}, to_apply=%region_256.338, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.198 = pred[] is-finite(%reduce_max.1323), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.198 = pred[] compare(%reduce_max.1323, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1128 = f32[] divide(%constant.498, %reduce_max.1323), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1129 = f32[] divide(%div.1128, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_21.7 = f32[1]{0} parameter(21)
  %div.1127 = f32[1]{0} divide(%constant.481, %Arg_21.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.400 = f32[1]{0} call(%gt.198, %div.1129, %div.1127), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.401 = f32[1]{0} call(%is_finite.198, %jit__where_.400, %div.1127), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1130 = f32[1]{0} divide(%constant.481, %jit__where_.401), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.870 = bf16[1]{0} convert(%div.1130), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1415 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.870), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1416 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1415), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1417 = bf16[32,4096,18432]{2,1,0} broadcast(%broadcast_in_dim.1416), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1131 = bf16[32,4096,18432]{2,1,0} divide(%sharding_constraint.178, %broadcast_in_dim.1417), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.210 = bf16[32,4096,18432]{2,1,0} call(%div.1131, %constant.495, %constant.494), to_apply=%clip_779.341, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.871 = f8e4m3fn[32,4096,18432]{2,1,0} convert(%jit_clip_.210), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.132 = bf16[7168,18432]{1,0} dot(%convert_element_type.877, %convert_element_type.871), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.89 = bf16[18432,7168]{0,1} transpose(%dot_general.132), dimensions={1,0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1124 = f32[1]{0} multiply(%div.1130, %div.1140), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.879 = bf16[1]{0} convert(%mul.1124), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1427 = bf16[18432,1]{1,0} broadcast(%convert_element_type.879), dimensions={1}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1428 = bf16[18432]{0} reshape(%broadcast_in_dim.1427), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1429 = bf16[18432,7168]{1,0} broadcast(%broadcast_in_dim.1428), dimensions={0}, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1125 = bf16[18432,7168]{0,1} multiply(%transpose.89, %broadcast_in_dim.1429), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1136 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.856, %sharding_constraint.182), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.477 = bf16[7168]{0} reduce(%mul.1136, %constant.492), dimensions={0,1}, to_apply=%region_271.357, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.50 = bf16[1,1,7168]{2,1,0} reshape(%reduce_sum.477), metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.478 = bf16[7168]{0} reduce(%reshape.50, %constant.492), dimensions={0,1}, to_apply=%region_272.358, metadata={op_name="checkpoint/dense_layers/post_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1049 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.29), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1050 = f32[32,4096]{1,0} reshape(%mul.1049), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1051 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1050), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1052 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.812, %mul.1051), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.813 = bf16[32,4096,7168]{2,1,0} convert(%mul.1052), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1200 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.813, %sharding_constraint.189), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.491 = bf16[7168]{0} reduce(%mul.1200, %constant.492), dimensions={0,1}, to_apply=%region_300.386, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.58 = bf16[1,1,7168]{2,1,0} reshape(%reduce_sum.491), metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.492 = bf16[7168]{0} reduce(%reshape.58, %constant.492), dimensions={0,1}, to_apply=%region_301.387, metadata={op_name="checkpoint/dense_layers/pre_self_attention_layer_norm/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1158 = bf16[32,4096,512]{2,1,0} multiply(%convert_element_type.837, %mul.1153), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.483 = bf16[512]{0} reduce(%mul.1158, %constant.492), dimensions={0,1}, to_apply=%region_283.369, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.53 = bf16[1,1,512]{2,1,0} reshape(%reduce_sum.483), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.484 = bf16[512]{0} reduce(%reshape.53, %constant.492), dimensions={0,1}, to_apply=%region_284.370, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.175 = bf16[32,4096,128,128]{3,2,1,0} custom-call(%custom_partitioning.52), custom_call_target="Sharding", sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"context\"}, {\"tensor\", \"tensor_transpose\", \"sequence\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_36.7 = f32[1024]{0} parameter(36)
  %reduce_max.1311 = f32[] reduce(%Arg_36.7, %constant.500), dimensions={0}, to_apply=%region_237.317, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.192 = pred[] is-finite(%reduce_max.1311), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.192 = pred[] compare(%reduce_max.1311, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1096 = f32[] divide(%constant.498, %reduce_max.1311), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1097 = f32[] divide(%div.1096, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_37.7 = f32[1]{0} parameter(37)
  %div.1095 = f32[1]{0} divide(%constant.481, %Arg_37.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.388 = f32[1]{0} call(%gt.192, %div.1097, %div.1095), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.389 = f32[1]{0} call(%is_finite.192, %jit__where_.388, %div.1095), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1098 = f32[1]{0} divide(%constant.481, %jit__where_.389), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.850 = bf16[1]{0} convert(%div.1098), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1395 = bf16[32,4096,128,1]{3,2,1,0} broadcast(%convert_element_type.850), dimensions={3}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1396 = bf16[32,4096,128]{2,1,0} reshape(%broadcast_in_dim.1395), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1397 = bf16[32,4096,128,128]{3,2,1,0} broadcast(%broadcast_in_dim.1396), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1099 = bf16[32,4096,128,128]{3,2,1,0} divide(%sharding_constraint.175, %broadcast_in_dim.1397), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.204 = bf16[32,4096,128,128]{3,2,1,0} call(%div.1099, %constant.495, %constant.494), to_apply=%clip_512.143, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.851 = f8e4m3fn[32,4096,128,128]{3,2,1,0} convert(%jit_clip_.204), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.138 = bf16[7168,128,128]{2,1,0} dot(%convert_element_type.894, %convert_element_type.851), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.92 = bf16[128,128,7168]{1,0,2} transpose(%dot_general.138), dimensions={1,2,0}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1150 = f32[1]{0} multiply(%div.1098, %div.1156), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.896 = bf16[1]{0} convert(%mul.1150), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1455 = bf16[128,128,1]{2,1,0} broadcast(%convert_element_type.896), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1456 = bf16[128,128]{1,0} reshape(%broadcast_in_dim.1455), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1457 = bf16[128,128,7168]{2,1,0} broadcast(%broadcast_in_dim.1456), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1151 = bf16[128,128,7168]{1,0,2} multiply(%transpose.92, %broadcast_in_dim.1457), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1180 = bf16[32,4096,1536]{2,1,0} multiply(%convert_element_type.824, %mul.1177), metadata={op_name="checkpoint/dense_layers/self_attention/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.487 = bf16[1536]{0} reduce(%mul.1180, %constant.492), dimensions={0,1}, to_apply=%region_290.376, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reshape.56 = bf16[1,1,1536]{2,1,0} reshape(%reduce_sum.487), metadata={op_name="checkpoint/dense_layers/self_attention/reshape" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_sum.488 = bf16[1536]{0} reduce(%reshape.56, %constant.492), dimensions={0,1}, to_apply=%region_291.377, metadata={op_name="checkpoint/dense_layers/self_attention/reduce_sum" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1053 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1354), dimensions={0,1,2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1054 = bf16[7168]{0} reshape(%mul.1053), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1055 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1054), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1056 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.813, %mul.1055), metadata={op_name="checkpoint/rematted_computation/dense_layers/pre_self_attention_layer_norm/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.170 = bf16[32,4096,7168]{2,1,0} custom-call(%mul.1056), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %sharding_constraint.171 = bf16[32,4096,7168]{2,1,0} custom-call(%sharding_constraint.170), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/sharding_constraint" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_26.7 = f32[1024]{0} parameter(26)
  %reduce_max.1297 = f32[] reduce(%Arg_26.7, %constant.500), dimensions={0}, to_apply=%region_214.294, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %is_finite.185 = pred[] is-finite(%reduce_max.1297), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/is_finite" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %gt.185 = pred[] compare(%reduce_max.1297, %constant.501), direction=GT, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/gt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1049 = f32[] divide(%constant.498, %reduce_max.1297), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1050 = f32[] divide(%div.1049, %constant.499), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %Arg_27.7 = f32[1]{0} parameter(27)
  %div.1048 = f32[1]{0} divide(%constant.481, %Arg_27.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.374 = f32[1]{0} call(%gt.185, %div.1050, %div.1048), to_apply=%_where_476.104, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__where_.375 = f32[1]{0} call(%is_finite.185, %jit__where_.374, %div.1048), to_apply=%_where_477.105, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_where)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1051 = f32[1]{0} divide(%constant.481, %jit__where_.375), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.815 = bf16[1]{0} convert(%div.1051), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1355 = bf16[32,4096,1]{2,1,0} broadcast(%convert_element_type.815), dimensions={2}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1356 = bf16[32,4096]{1,0} reshape(%broadcast_in_dim.1355), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1357 = bf16[32,4096,7168]{2,1,0} broadcast(%broadcast_in_dim.1356), dimensions={0,1}, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %div.1052 = bf16[32,4096,7168]{2,1,0} divide(%sharding_constraint.171, %broadcast_in_dim.1357), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/div" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit_clip_.195 = bf16[32,4096,7168]{2,1,0} call(%div.1052, %constant.495, %constant.494), to_apply=%clip_484.109, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(clip)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.816 = f8e4m3fn[32,4096,7168]{2,1,0} convert(%jit_clip_.195), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.144 = bf16[576,7168]{1,0} dot(%convert_element_type.923, %convert_element_type.816), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.95 = bf16[7168,576]{0,1} transpose(%dot_general.144), dimensions={1,0}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1194 = f32[1]{0} multiply(%div.1051, %div.1173), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.925 = bf16[1]{0} convert(%mul.1194), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1489 = bf16[7168,1]{1,0} broadcast(%convert_element_type.925), dimensions={1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1490 = bf16[7168]{0} reshape(%broadcast_in_dim.1489), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1491 = bf16[7168,576]{1,0} broadcast(%broadcast_in_dim.1490), dimensions={0}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1195 = bf16[7168,576]{0,1} multiply(%transpose.95, %broadcast_in_dim.1491), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.140 = bf16[128,256,512]{2,1,0} dot(%convert_element_type.899, %convert_element_type.844), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.93 = bf16[512,128,256]{0,2,1} transpose(%dot_general.140), dimensions={2,0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1154 = f32[1]{0} multiply(%div.1088, %div.1161), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.901 = bf16[1]{0} convert(%mul.1154), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1465 = bf16[512,128,1]{2,1,0} broadcast(%convert_element_type.901), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1466 = bf16[512,128]{1,0} reshape(%broadcast_in_dim.1465), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1467 = bf16[512,128,256]{2,1,0} broadcast(%broadcast_in_dim.1466), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1155 = bf16[512,128,256]{0,2,1} multiply(%transpose.93, %broadcast_in_dim.1467), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.146 = bf16[1536,7168]{1,0} dot(%convert_element_type.928, %convert_element_type.816), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.96 = bf16[7168,1536]{0,1} transpose(%dot_general.146), dimensions={1,0}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1198 = f32[1]{0} multiply(%div.1051, %div.1178), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.930 = bf16[1]{0} convert(%mul.1198), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1498 = bf16[7168,1]{1,0} broadcast(%convert_element_type.930), dimensions={1}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1499 = bf16[7168]{0} reshape(%broadcast_in_dim.1498), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1500 = bf16[7168,1536]{1,0} broadcast(%broadcast_in_dim.1499), dimensions={0}, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1199 = bf16[7168,1536]{0,1} multiply(%transpose.96, %broadcast_in_dim.1500), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %dot_general.142 = bf16[128,192,1536]{2,1,0} dot(%convert_element_type.916, %convert_element_type.827), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, operand_precision={highest,highest}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/dot_general" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %transpose.94 = bf16[1536,128,192]{0,2,1} transpose(%dot_general.142), dimensions={2,0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1178 = f32[1]{0} multiply(%div.1068, %div.1167), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.918 = bf16[1]{0} convert(%mul.1178), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1479 = bf16[1536,128,1]{2,1,0} broadcast(%convert_element_type.918), dimensions={2}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1480 = bf16[1536,128]{1,0} reshape(%broadcast_in_dim.1479), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %broadcast_in_dim.1481 = bf16[1536,128,192]{2,1,0} broadcast(%broadcast_in_dim.1480), dimensions={0,1}, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %mul.1179 = bf16[1536,128,192]{0,2,1} multiply(%transpose.94, %broadcast_in_dim.1481), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/mul" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.112 = f32[1024]{0} call(%Arg_8.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.480 = s32[1]{0} constant({0})
  %abs.112 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.177), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %constant.497 = bf16[] constant(-inf)
  %reduce_max.1316 = bf16[] reduce(%abs.112, %constant.497), dimensions={0,1,2}, to_apply=%region_245.325, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.857 = f32[] convert(%reduce_max.1316), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.364 = f32[1024]{0} scatter(%jit__roll_static_.112, %constant.480, %convert_element_type.857), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_246.326, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.113 = f32[1024]{0} call(%Arg_10.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.113 = bf16[7168,18432]{1,0} abs(%Arg_54.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1318 = bf16[] reduce(%abs.113, %constant.497), dimensions={0,1}, to_apply=%region_248.328, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.860 = f32[] convert(%reduce_max.1318), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.365 = f32[1024]{0} scatter(%jit__roll_static_.113, %constant.480, %convert_element_type.860), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_249.329, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.120 = f32[1024]{0} call(%Arg_12.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.120 = bf16[32,4096,18432]{2,1,0} abs(%jit_silu_.35), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1332 = bf16[] reduce(%abs.120, %constant.497), dimensions={0,1,2}, to_apply=%region_269.355, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.885 = f32[] convert(%reduce_max.1332), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.372 = f32[1024]{0} scatter(%jit__roll_static_.120, %constant.480, %convert_element_type.885), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_270.356, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.114 = f32[1024]{0} call(%Arg_14.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.114 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.177), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1320 = bf16[] reduce(%abs.114, %constant.497), dimensions={0,1,2}, to_apply=%region_251.333, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.863 = f32[] convert(%reduce_max.1320), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.366 = f32[1024]{0} scatter(%jit__roll_static_.114, %constant.480, %convert_element_type.863), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_252.334, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.115 = f32[1024]{0} call(%Arg_16.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.115 = bf16[7168,18432]{1,0} abs(%Arg_55.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1322 = bf16[] reduce(%abs.115, %constant.497), dimensions={0,1}, to_apply=%region_254.336, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.866 = f32[] convert(%reduce_max.1322), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.367 = f32[1024]{0} scatter(%jit__roll_static_.115, %constant.480, %convert_element_type.866), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_255.337, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.119 = f32[1024]{0} call(%Arg_18.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.119 = bf16[32,4096,18432]{2,1,0} abs(%mul.1126), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1330 = bf16[] reduce(%abs.119, %constant.497), dimensions={0,1,2}, to_apply=%region_266.350, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.880 = f32[] convert(%reduce_max.1330), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.371 = f32[1024]{0} scatter(%jit__roll_static_.119, %constant.480, %convert_element_type.880), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_267.351, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.116 = f32[1024]{0} call(%Arg_20.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.116 = bf16[32,4096,18432]{2,1,0} abs(%sharding_constraint.178), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1324 = bf16[] reduce(%abs.116, %constant.497), dimensions={0,1,2}, to_apply=%region_257.339, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.869 = f32[] convert(%reduce_max.1324), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.368 = f32[1024]{0} scatter(%jit__roll_static_.116, %constant.480, %convert_element_type.869), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_258.340, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.117 = f32[1024]{0} call(%Arg_22.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.117 = bf16[18432,7168]{1,0} abs(%Arg_56.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1326 = bf16[] reduce(%abs.117, %constant.497), dimensions={0,1}, to_apply=%region_260.343, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.872 = f32[] convert(%reduce_max.1326), metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.369 = f32[1024]{0} scatter(%jit__roll_static_.117, %constant.480, %convert_element_type.872), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_261.344, metadata={op_name="checkpoint/rematted_computation/dense_layers/mlp/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.118 = f32[1024]{0} call(%Arg_24.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.118 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.180), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1328 = bf16[] reduce(%abs.118, %constant.497), dimensions={0,1,2}, to_apply=%region_263.347, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.875 = f32[] convert(%reduce_max.1328), metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.370 = f32[1024]{0} scatter(%jit__roll_static_.118, %constant.480, %convert_element_type.875), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_264.348, metadata={op_name="checkpoint/dense_layers/mlp/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.103 = f32[1024]{0} call(%Arg_26.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.103 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.171), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1298 = bf16[] reduce(%abs.103, %constant.497), dimensions={0,1,2}, to_apply=%region_215.295, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.814 = f32[] convert(%reduce_max.1298), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.355 = f32[1024]{0} scatter(%jit__roll_static_.103, %constant.480, %convert_element_type.814), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_216.296, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.104 = f32[1024]{0} call(%Arg_28.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.104 = bf16[7168,1536]{1,0} abs(%Arg_64.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1300 = bf16[] reduce(%abs.104, %constant.497), dimensions={0,1}, to_apply=%region_218.298, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.817 = f32[] convert(%reduce_max.1300), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.356 = f32[1024]{0} scatter(%jit__roll_static_.104, %constant.480, %convert_element_type.817), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_219.299, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.105 = f32[1024]{0} call(%Arg_29.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.105 = bf16[7168,576]{1,0} abs(%Arg_62.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1302 = bf16[] reduce(%abs.105, %constant.497), dimensions={0,1}, to_apply=%region_221.301, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.820 = f32[] convert(%reduce_max.1302), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.357 = f32[1024]{0} scatter(%jit__roll_static_.105, %constant.480, %convert_element_type.820), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_222.302, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/fp8_einsum/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.125 = f32[1024]{0} call(%Arg_32.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.125 = bf16[32,4096,1536]{2,1,0} abs(%convert_element_type.920), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1342 = bf16[] reduce(%abs.125, %constant.497), dimensions={0,1,2}, to_apply=%region_298.384, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.926 = f32[] convert(%reduce_max.1342), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.377 = f32[1024]{0} scatter(%jit__roll_static_.125, %constant.480, %convert_element_type.926), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_299.385, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.124 = f32[1024]{0} call(%Arg_33.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.124 = bf16[32,4096,576]{2,1,0} abs(%concatenate.46), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1340 = bf16[] reduce(%abs.124, %constant.497), dimensions={0,1,2}, to_apply=%region_295.381, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.921 = f32[] convert(%reduce_max.1340), metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.376 = f32[1024]{0} scatter(%jit__roll_static_.124, %constant.480, %convert_element_type.921), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_296.382, metadata={op_name="checkpoint/dense_layers/self_attention/fp8_einsum/BSD,DH->BSH/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.110 = f32[1024]{0} call(%Arg_36.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.110 = bf16[32,4096,128,128]{3,2,1,0} abs(%sharding_constraint.175), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1312 = bf16[] reduce(%abs.110, %constant.497), dimensions={0,1,2,3}, to_apply=%region_238.318, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.849 = f32[] convert(%reduce_max.1312), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.362 = f32[1024]{0} scatter(%jit__roll_static_.110, %constant.480, %convert_element_type.849), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_239.319, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.111 = f32[1024]{0} call(%Arg_38.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.111 = bf16[128,128,7168]{2,1,0} abs(%Arg_60.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1314 = bf16[] reduce(%abs.111, %constant.497), dimensions={0,1,2}, to_apply=%region_241.321, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.852 = f32[] convert(%reduce_max.1314), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.363 = f32[1024]{0} scatter(%jit__roll_static_.111, %constant.480, %convert_element_type.852), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_242.322, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.121 = f32[1024]{0} call(%Arg_40.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.121 = bf16[32,4096,7168]{2,1,0} abs(%sharding_constraint.183), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1334 = bf16[] reduce(%abs.121, %constant.497), dimensions={0,1,2}, to_apply=%region_276.362, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.892 = f32[] convert(%reduce_max.1334), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.373 = f32[1024]{0} scatter(%jit__roll_static_.121, %constant.480, %convert_element_type.892), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_277.363, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_2/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.108 = f32[1024]{0} call(%Arg_42.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.108 = bf16[32,4096,512]{2,1,0} abs(%mul.1095), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1308 = bf16[] reduce(%abs.108, %constant.497), dimensions={0,1,2}, to_apply=%region_232.312, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.842 = f32[] convert(%reduce_max.1308), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.360 = f32[1024]{0} scatter(%jit__roll_static_.108, %constant.480, %convert_element_type.842), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_233.313, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.109 = f32[1024]{0} call(%Arg_44.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.109 = bf16[512,128,256]{2,1,0} abs(%Arg_63.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1310 = bf16[] reduce(%abs.109, %constant.497), dimensions={0,1,2}, to_apply=%region_235.315, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.845 = f32[] convert(%reduce_max.1310), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.361 = f32[1024]{0} scatter(%jit__roll_static_.109, %constant.480, %convert_element_type.845), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_236.316, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.122 = f32[1024]{0} call(%Arg_46.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.122 = bf16[32,4096,128,256]{3,2,1,0} abs(%concatenate.45), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1336 = bf16[] reduce(%abs.122, %constant.497), dimensions={0,1,2,3}, to_apply=%region_280.366, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.897 = f32[] convert(%reduce_max.1336), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.374 = f32[1024]{0} scatter(%jit__roll_static_.122, %constant.480, %convert_element_type.897), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_281.367, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_1/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.106 = f32[1024]{0} call(%Arg_48.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.106 = bf16[32,4096,1536]{2,1,0} abs(%mul.1066), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1304 = bf16[] reduce(%abs.106, %constant.497), dimensions={0,1,2}, to_apply=%region_225.305, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.825 = f32[] convert(%reduce_max.1304), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.358 = f32[1024]{0} scatter(%jit__roll_static_.106, %constant.480, %convert_element_type.825), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_226.306, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.107 = f32[1024]{0} call(%Arg_50.7), to_apply=%_roll_static.107, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.107 = bf16[1536,128,192]{2,1,0} abs(%Arg_65.7), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1306 = bf16[] reduce(%abs.107, %constant.497), dimensions={0,1,2}, to_apply=%region_228.308, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.828 = f32[] convert(%reduce_max.1306), metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.359 = f32[1024]{0} scatter(%jit__roll_static_.107, %constant.480, %convert_element_type.828), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_229.309, metadata={op_name="checkpoint/rematted_computation/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %jit__roll_static_.123 = f32[1024]{0} call(%Arg_52.7), to_apply=%_roll_static_554.217, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/jit(_roll_static)" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %abs.123 = bf16[32,4096,128,192]{3,2,1,0} abs(%concatenate.47), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/abs" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %reduce_max.1338 = bf16[] reduce(%abs.123, %constant.497), dimensions={0,1,2,3}, to_apply=%region_288.374, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/reduce_max" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %convert_element_type.914 = f32[] convert(%reduce_max.1338), metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/convert_element_type" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  %scatter.375 = f32[1024]{0} scatter(%jit__roll_static_.123, %constant.480, %convert_element_type.914), update_window_dims={}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, indices_are_sorted=true, unique_indices=true, to_apply=%region_289.375, metadata={op_name="checkpoint/dense_layers/self_attention/Fp8DirectDotGeneralOp_0/scatter" source_file="/opt/flax/flax/core/axes_scan.py" source_line=156 source_end_line=156 source_column=29 source_end_column=53}
  ROOT %tuple.19 = (bf16[32,4096,7168]{2,1,0}, bf16[7168,18432]{0,1}, bf16[7168,18432]{0,1}, bf16[18432,7168]{0,1}, bf16[7168]{0}, /*index=5*/bf16[7168]{0}, bf16[512]{0}, bf16[128,128,7168]{1,0,2}, bf16[1536]{0}, bf16[7168,576]{0,1}, /*index=10*/bf16[512,128,256]{0,2,1}, bf16[7168,1536]{0,1}, bf16[1536,128,192]{0,2,1}, f32[1024]{0}, f32[1]{0}, /*index=15*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=20*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=25*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=30*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, /*index=35*/f32[1]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=40*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=45*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=50*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=55*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}) tuple(%sharding_constraint.190, %mul.1135, %mul.1131, %mul.1125, %reduce_sum.478, /*index=5*/%reduce_sum.492, %reduce_sum.484, %mul.1151, %reduce_sum.488, %mul.1195, /*index=10*/%mul.1155, %mul.1199, %mul.1179, %scatter.364, %div.1110, /*index=15*/%scatter.365, %div.1115, %scatter.372, %div.1150, %scatter.366, /*index=20*/%div.1120, %scatter.367, %div.1125, %scatter.371, %div.1145, /*index=25*/%scatter.368, %div.1130, %scatter.369, %div.1135, %scatter.370, /*index=30*/%div.1140, %scatter.355, %div.1051, %scatter.356, %scatter.357, /*index=35*/%div.1056, %div.1061, %scatter.377, %scatter.376, %div.1178, /*index=40*/%div.1173, %scatter.362, %div.1098, %scatter.363, %div.1103, /*index=45*/%scatter.373, %div.1156, %scatter.360, %div.1088, %scatter.361, /*index=50*/%div.1093, %scatter.374, %div.1161, %scatter.358, %div.1068, /*index=55*/%scatter.359, %div.1073, %scatter.375, %div.1167)
}

%region_212.391 (arg_tuple.13: (s32[], bf16[32,4096,7168], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=5*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=10*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], f32[1,1024], /*index=15*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1024], /*index=40*/f32[1,1], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=55*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=60*/bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], bf16[1,32,4096,7168], bf16[1,32,4096,18432], /*index=65*/bf16[1,32,4096,18432], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=70*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=75*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=80*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=85*/f32[1,1], f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], /*index=90*/f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], /*index=95*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=100*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=105*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=110*/f32[1,1024], f32[1,1], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=115*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=120*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], s32[32,4096])) -> (s32[], bf16[32,4096,7168], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=5*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=10*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], f32[1,1024], /*index=15*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1024], /*index=40*/f32[1,1], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=55*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=60*/bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], bf16[1,32,4096,7168], bf16[1,32,4096,18432], /*index=65*/bf16[1,32,4096,18432], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=70*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=75*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=80*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=85*/f32[1,1], f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], /*index=90*/f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], /*index=95*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=100*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=105*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=110*/f32[1,1024], f32[1,1], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=115*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=120*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], s32[32,4096]) {
  %arg_tuple.13 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=5*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=10*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, f32[1,1024]{1,0}, /*index=15*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=55*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=60*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, /*index=65*/bf16[1,32,4096,18432]{3,2,1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=70*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=75*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=80*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=85*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=90*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=95*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=100*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=105*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=110*/f32[1,1024]{1,0}, f32[1,1]{1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=115*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=120*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) parameter(0)
  %get-tuple-element.1481 = s32[] get-tuple-element(%arg_tuple.13), index=0
  %constant.503 = s32[] constant(1)
  %add.131 = s32[] add(%get-tuple-element.1481, %constant.503), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/add" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1605 = s32[32,4096]{1,0} get-tuple-element(%arg_tuple.13), index=124
  %get-tuple-element.1482 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.13), index=1
  %get-tuple-element.1541 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=60
  %sub.57 = s32[] subtract(%constant.503, %get-tuple-element.1481), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %sub.58 = s32[] subtract(%sub.57, %constant.503), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/sub" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.502 = s32[] constant(0)
  %dynamic_slice.496 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.1541, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.529 = bf16[32,4096,7168]{2,1,0} reshape(%dynamic_slice.496), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1542 = bf16[1,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=61
  %dynamic_slice.497 = bf16[1,32,4096,1536]{3,2,1,0} dynamic-slice(%get-tuple-element.1542, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.530 = bf16[32,4096,1536]{2,1,0} reshape(%dynamic_slice.497), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1543 = bf16[1,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=62
  %dynamic_slice.498 = bf16[1,32,4096,576]{3,2,1,0} dynamic-slice(%get-tuple-element.1543, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,576}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.531 = bf16[32,4096,576]{2,1,0} reshape(%dynamic_slice.498), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1544 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=63
  %dynamic_slice.499 = bf16[1,32,4096,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.1544, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.532 = bf16[32,4096,7168]{2,1,0} reshape(%dynamic_slice.499), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1545 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=64
  %dynamic_slice.500 = bf16[1,32,4096,18432]{3,2,1,0} dynamic-slice(%get-tuple-element.1545, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,18432}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.533 = bf16[32,4096,18432]{2,1,0} reshape(%dynamic_slice.500), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1546 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=65
  %dynamic_slice.501 = bf16[1,32,4096,18432]{3,2,1,0} dynamic-slice(%get-tuple-element.1546, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,32,4096,18432}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.534 = bf16[32,4096,18432]{2,1,0} reshape(%dynamic_slice.501), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1547 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=66
  %dynamic_slice.502 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1547, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.535 = f32[1024]{0} reshape(%dynamic_slice.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1548 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=67
  %dynamic_slice.503 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1548, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.536 = f32[1]{0} reshape(%dynamic_slice.503), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1549 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=68
  %dynamic_slice.504 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1549, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.537 = f32[1024]{0} reshape(%dynamic_slice.504), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1550 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=69
  %dynamic_slice.505 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1550, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.538 = f32[1]{0} reshape(%dynamic_slice.505), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1551 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=70
  %dynamic_slice.506 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1551, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.539 = f32[1024]{0} reshape(%dynamic_slice.506), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1552 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=71
  %dynamic_slice.507 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1552, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.540 = f32[1]{0} reshape(%dynamic_slice.507), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1553 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=72
  %dynamic_slice.508 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1553, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.541 = f32[1024]{0} reshape(%dynamic_slice.508), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1554 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=73
  %dynamic_slice.509 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1554, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.542 = f32[1]{0} reshape(%dynamic_slice.509), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1555 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=74
  %dynamic_slice.510 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1555, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.543 = f32[1024]{0} reshape(%dynamic_slice.510), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1556 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=75
  %dynamic_slice.511 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1556, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.544 = f32[1]{0} reshape(%dynamic_slice.511), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1557 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=76
  %dynamic_slice.512 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1557, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.545 = f32[1024]{0} reshape(%dynamic_slice.512), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1558 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=77
  %dynamic_slice.513 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1558, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.546 = f32[1]{0} reshape(%dynamic_slice.513), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1559 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=78
  %dynamic_slice.514 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1559, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.547 = f32[1024]{0} reshape(%dynamic_slice.514), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1560 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=79
  %dynamic_slice.515 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1560, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.548 = f32[1]{0} reshape(%dynamic_slice.515), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1561 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=80
  %dynamic_slice.516 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1561, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.549 = f32[1024]{0} reshape(%dynamic_slice.516), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1562 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=81
  %dynamic_slice.517 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1562, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.550 = f32[1]{0} reshape(%dynamic_slice.517), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1563 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=82
  %dynamic_slice.518 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1563, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.551 = f32[1024]{0} reshape(%dynamic_slice.518), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1564 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=83
  %dynamic_slice.519 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1564, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.552 = f32[1]{0} reshape(%dynamic_slice.519), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1565 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=84
  %dynamic_slice.520 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1565, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.553 = f32[1024]{0} reshape(%dynamic_slice.520), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1566 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=85
  %dynamic_slice.521 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1566, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.554 = f32[1]{0} reshape(%dynamic_slice.521), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1567 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=86
  %dynamic_slice.522 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1567, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.555 = f32[1024]{0} reshape(%dynamic_slice.522), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1568 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=87
  %dynamic_slice.523 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1568, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.556 = f32[1024]{0} reshape(%dynamic_slice.523), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1569 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=88
  %dynamic_slice.524 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1569, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.557 = f32[1]{0} reshape(%dynamic_slice.524), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1570 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=89
  %dynamic_slice.525 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1570, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.558 = f32[1]{0} reshape(%dynamic_slice.525), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1571 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=90
  %dynamic_slice.526 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1571, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.559 = f32[1024]{0} reshape(%dynamic_slice.526), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1572 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=91
  %dynamic_slice.527 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1572, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.560 = f32[1024]{0} reshape(%dynamic_slice.527), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1573 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=92
  %dynamic_slice.528 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1573, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.561 = f32[1]{0} reshape(%dynamic_slice.528), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1574 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=93
  %dynamic_slice.529 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1574, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.562 = f32[1]{0} reshape(%dynamic_slice.529), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1575 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=94
  %dynamic_slice.530 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1575, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.563 = f32[1024]{0} reshape(%dynamic_slice.530), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1576 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=95
  %dynamic_slice.531 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1576, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.564 = f32[1]{0} reshape(%dynamic_slice.531), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1577 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=96
  %dynamic_slice.532 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1577, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.565 = f32[1024]{0} reshape(%dynamic_slice.532), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1578 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=97
  %dynamic_slice.533 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1578, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.566 = f32[1]{0} reshape(%dynamic_slice.533), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1579 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=98
  %dynamic_slice.534 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1579, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.567 = f32[1024]{0} reshape(%dynamic_slice.534), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1580 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=99
  %dynamic_slice.535 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1580, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.568 = f32[1]{0} reshape(%dynamic_slice.535), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1581 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=100
  %dynamic_slice.536 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1581, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.569 = f32[1024]{0} reshape(%dynamic_slice.536), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1582 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=101
  %dynamic_slice.537 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1582, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.570 = f32[1]{0} reshape(%dynamic_slice.537), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1583 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=102
  %dynamic_slice.538 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1583, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.571 = f32[1024]{0} reshape(%dynamic_slice.538), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1584 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=103
  %dynamic_slice.539 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1584, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.572 = f32[1]{0} reshape(%dynamic_slice.539), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1585 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=104
  %dynamic_slice.540 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1585, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.573 = f32[1024]{0} reshape(%dynamic_slice.540), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1586 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=105
  %dynamic_slice.541 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1586, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.574 = f32[1]{0} reshape(%dynamic_slice.541), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1587 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=106
  %dynamic_slice.542 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1587, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.575 = f32[1024]{0} reshape(%dynamic_slice.542), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1588 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=107
  %dynamic_slice.543 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1588, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.576 = f32[1]{0} reshape(%dynamic_slice.543), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1589 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=108
  %dynamic_slice.544 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1589, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.577 = f32[1024]{0} reshape(%dynamic_slice.544), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1590 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=109
  %dynamic_slice.545 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1590, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.578 = f32[1]{0} reshape(%dynamic_slice.545), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1591 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=110
  %dynamic_slice.546 = f32[1,1024]{1,0} dynamic-slice(%get-tuple-element.1591, %sub.58, %constant.502), dynamic_slice_sizes={1,1024}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.579 = f32[1024]{0} reshape(%dynamic_slice.546), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1592 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=111
  %dynamic_slice.547 = f32[1,1]{1,0} dynamic-slice(%get-tuple-element.1592, %sub.58, %constant.502), dynamic_slice_sizes={1,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.580 = f32[1]{0} reshape(%dynamic_slice.547), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1593 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.13), index=112
  %dynamic_slice.548 = bf16[1,7168,18432]{2,1,0} dynamic-slice(%get-tuple-element.1593, %sub.58, %constant.502, %constant.502), dynamic_slice_sizes={1,7168,18432}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.581 = bf16[7168,18432]{1,0} reshape(%dynamic_slice.548), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1594 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.13), index=113
  %dynamic_slice.549 = bf16[1,7168,18432]{2,1,0} dynamic-slice(%get-tuple-element.1594, %sub.58, %constant.502, %constant.502), dynamic_slice_sizes={1,7168,18432}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.582 = bf16[7168,18432]{1,0} reshape(%dynamic_slice.549), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1595 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.13), index=114
  %dynamic_slice.550 = bf16[1,18432,7168]{2,1,0} dynamic-slice(%get-tuple-element.1595, %sub.58, %constant.502, %constant.502), dynamic_slice_sizes={1,18432,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.583 = bf16[18432,7168]{1,0} reshape(%dynamic_slice.550), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1596 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.13), index=115
  %dynamic_slice.551 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.1596, %sub.58, %constant.502), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.584 = bf16[7168]{0} reshape(%dynamic_slice.551), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1597 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.13), index=116
  %dynamic_slice.552 = bf16[1,7168]{1,0} dynamic-slice(%get-tuple-element.1597, %sub.58, %constant.502), dynamic_slice_sizes={1,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.585 = bf16[7168]{0} reshape(%dynamic_slice.552), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1598 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.13), index=117
  %dynamic_slice.553 = bf16[1,512]{1,0} dynamic-slice(%get-tuple-element.1598, %sub.58, %constant.502), dynamic_slice_sizes={1,512}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.586 = bf16[512]{0} reshape(%dynamic_slice.553), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1599 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=118
  %dynamic_slice.554 = bf16[1,128,128,7168]{3,2,1,0} dynamic-slice(%get-tuple-element.1599, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,128,128,7168}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.587 = bf16[128,128,7168]{2,1,0} reshape(%dynamic_slice.554), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1600 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.13), index=119
  %dynamic_slice.555 = bf16[1,1536]{1,0} dynamic-slice(%get-tuple-element.1600, %sub.58, %constant.502), dynamic_slice_sizes={1,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.588 = bf16[1536]{0} reshape(%dynamic_slice.555), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1601 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.13), index=120
  %dynamic_slice.556 = bf16[1,7168,576]{2,1,0} dynamic-slice(%get-tuple-element.1601, %sub.58, %constant.502, %constant.502), dynamic_slice_sizes={1,7168,576}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.589 = bf16[7168,576]{1,0} reshape(%dynamic_slice.556), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1602 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=121
  %dynamic_slice.557 = bf16[1,512,128,256]{3,2,1,0} dynamic-slice(%get-tuple-element.1602, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,512,128,256}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.590 = bf16[512,128,256]{2,1,0} reshape(%dynamic_slice.557), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1603 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.13), index=122
  %dynamic_slice.558 = bf16[1,7168,1536]{2,1,0} dynamic-slice(%get-tuple-element.1603, %sub.58, %constant.502, %constant.502), dynamic_slice_sizes={1,7168,1536}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.591 = bf16[7168,1536]{1,0} reshape(%dynamic_slice.558), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1604 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=123
  %dynamic_slice.559 = bf16[1,1536,128,192]{3,2,1,0} dynamic-slice(%get-tuple-element.1604, %sub.58, %constant.502, %constant.502, %constant.502), dynamic_slice_sizes={1,1536,128,192}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %squeeze.592 = bf16[1536,128,192]{2,1,0} reshape(%dynamic_slice.559), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/squeeze" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.294 = (bf16[32,4096,7168]{2,1,0}, bf16[7168,18432]{0,1}, bf16[7168,18432]{0,1}, bf16[18432,7168]{0,1}, bf16[7168]{0}, /*index=5*/bf16[7168]{0}, bf16[512]{0}, bf16[128,128,7168]{1,0,2}, bf16[1536]{0}, bf16[7168,576]{0,1}, /*index=10*/bf16[512,128,256]{0,2,1}, bf16[7168,1536]{0,1}, bf16[1536,128,192]{0,2,1}, f32[1024]{0}, f32[1]{0}, /*index=15*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=20*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=25*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=30*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, /*index=35*/f32[1]{0}, f32[1]{0}, f32[1024]{0}, f32[1024]{0}, f32[1]{0}, /*index=40*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=45*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, /*index=50*/f32[1]{0}, f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}, /*index=55*/f32[1024]{0}, f32[1]{0}, f32[1024]{0}, f32[1]{0}) call(%get-tuple-element.1605, %get-tuple-element.1482, %squeeze.529, %squeeze.530, %squeeze.531, /*index=5*/%squeeze.532, %squeeze.533, %squeeze.534, %squeeze.535, %squeeze.536, /*index=10*/%squeeze.537, %squeeze.538, %squeeze.539, %squeeze.540, %squeeze.541, /*index=15*/%squeeze.542, %squeeze.543, %squeeze.544, %squeeze.545, %squeeze.546, /*index=20*/%squeeze.547, %squeeze.548, %squeeze.549, %squeeze.550, %squeeze.551, /*index=25*/%squeeze.552, %squeeze.553, %squeeze.554, %squeeze.555, %squeeze.556, /*index=30*/%squeeze.557, %squeeze.558, %squeeze.559, %squeeze.560, %squeeze.561, /*index=35*/%squeeze.562, %squeeze.563, %squeeze.564, %squeeze.565, %squeeze.566, /*index=40*/%squeeze.567, %squeeze.568, %squeeze.569, %squeeze.570, %squeeze.571, /*index=45*/%squeeze.572, %squeeze.573, %squeeze.574, %squeeze.575, %squeeze.576, /*index=50*/%squeeze.577, %squeeze.578, %squeeze.579, %squeeze.580, %squeeze.581, /*index=55*/%squeeze.582, %squeeze.583, %squeeze.584, %squeeze.585, %squeeze.586, /*index=60*/%squeeze.587, %squeeze.588, %squeeze.589, %squeeze.590, %squeeze.591, /*index=65*/%squeeze.592), to_apply=%closed_call_769.390, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %closed_call.295 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%closed_call.294), index=0, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1483 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.13), index=2
  %closed_call.296 = bf16[7168,18432]{0,1} get-tuple-element(%closed_call.294), index=1, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1560 = bf16[1,7168,18432]{2,1,0} reshape(%closed_call.296), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.280 = bf16[1,7168,18432]{2,1,0} dynamic-update-slice(%get-tuple-element.1483, %broadcast_in_dim.1560, %sub.58, %constant.502, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1484 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.13), index=3
  %closed_call.297 = bf16[7168,18432]{0,1} get-tuple-element(%closed_call.294), index=2, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1561 = bf16[1,7168,18432]{2,1,0} reshape(%closed_call.297), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.281 = bf16[1,7168,18432]{2,1,0} dynamic-update-slice(%get-tuple-element.1484, %broadcast_in_dim.1561, %sub.58, %constant.502, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1485 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.13), index=4
  %closed_call.298 = bf16[18432,7168]{0,1} get-tuple-element(%closed_call.294), index=3, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1562 = bf16[1,18432,7168]{2,1,0} reshape(%closed_call.298), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.282 = bf16[1,18432,7168]{2,1,0} dynamic-update-slice(%get-tuple-element.1485, %broadcast_in_dim.1562, %sub.58, %constant.502, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1486 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.13), index=5
  %closed_call.299 = bf16[7168]{0} get-tuple-element(%closed_call.294), index=4, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1563 = bf16[1,7168]{1,0} reshape(%closed_call.299), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.283 = bf16[1,7168]{1,0} dynamic-update-slice(%get-tuple-element.1486, %broadcast_in_dim.1563, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1487 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.13), index=6
  %closed_call.300 = bf16[7168]{0} get-tuple-element(%closed_call.294), index=5, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1564 = bf16[1,7168]{1,0} reshape(%closed_call.300), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.284 = bf16[1,7168]{1,0} dynamic-update-slice(%get-tuple-element.1487, %broadcast_in_dim.1564, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1488 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.13), index=7
  %closed_call.301 = bf16[512]{0} get-tuple-element(%closed_call.294), index=6, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1565 = bf16[1,512]{1,0} reshape(%closed_call.301), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.285 = bf16[1,512]{1,0} dynamic-update-slice(%get-tuple-element.1488, %broadcast_in_dim.1565, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1489 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=8
  %closed_call.302 = bf16[128,128,7168]{1,0,2} get-tuple-element(%closed_call.294), index=7, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1566 = bf16[1,128,128,7168]{3,2,1,0} reshape(%closed_call.302), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.286 = bf16[1,128,128,7168]{3,2,1,0} dynamic-update-slice(%get-tuple-element.1489, %broadcast_in_dim.1566, %sub.58, %constant.502, %constant.502, /*index=5*/%constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1490 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.13), index=9
  %closed_call.303 = bf16[1536]{0} get-tuple-element(%closed_call.294), index=8, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1567 = bf16[1,1536]{1,0} reshape(%closed_call.303), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.287 = bf16[1,1536]{1,0} dynamic-update-slice(%get-tuple-element.1490, %broadcast_in_dim.1567, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1491 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.13), index=10
  %closed_call.304 = bf16[7168,576]{0,1} get-tuple-element(%closed_call.294), index=9, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1568 = bf16[1,7168,576]{2,1,0} reshape(%closed_call.304), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.288 = bf16[1,7168,576]{2,1,0} dynamic-update-slice(%get-tuple-element.1491, %broadcast_in_dim.1568, %sub.58, %constant.502, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1492 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=11
  %closed_call.305 = bf16[512,128,256]{0,2,1} get-tuple-element(%closed_call.294), index=10, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1569 = bf16[1,512,128,256]{3,2,1,0} reshape(%closed_call.305), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.289 = bf16[1,512,128,256]{3,2,1,0} dynamic-update-slice(%get-tuple-element.1492, %broadcast_in_dim.1569, %sub.58, %constant.502, %constant.502, /*index=5*/%constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1493 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.13), index=12
  %closed_call.306 = bf16[7168,1536]{0,1} get-tuple-element(%closed_call.294), index=11, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1570 = bf16[1,7168,1536]{2,1,0} reshape(%closed_call.306), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.290 = bf16[1,7168,1536]{2,1,0} dynamic-update-slice(%get-tuple-element.1493, %broadcast_in_dim.1570, %sub.58, %constant.502, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1494 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.13), index=13
  %closed_call.307 = bf16[1536,128,192]{0,2,1} get-tuple-element(%closed_call.294), index=12, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1571 = bf16[1,1536,128,192]{3,2,1,0} reshape(%closed_call.307), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.291 = bf16[1,1536,128,192]{3,2,1,0} dynamic-update-slice(%get-tuple-element.1494, %broadcast_in_dim.1571, %sub.58, %constant.502, %constant.502, /*index=5*/%constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1495 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=14
  %closed_call.308 = f32[1024]{0} get-tuple-element(%closed_call.294), index=13, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1572 = f32[1,1024]{1,0} reshape(%closed_call.308), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.292 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1495, %broadcast_in_dim.1572, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1496 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=15
  %closed_call.309 = f32[1]{0} get-tuple-element(%closed_call.294), index=14, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1573 = f32[1,1]{1,0} reshape(%closed_call.309), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.293 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1496, %broadcast_in_dim.1573, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1497 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=16
  %closed_call.310 = f32[1024]{0} get-tuple-element(%closed_call.294), index=15, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1574 = f32[1,1024]{1,0} reshape(%closed_call.310), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.294 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1497, %broadcast_in_dim.1574, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1498 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=17
  %closed_call.311 = f32[1]{0} get-tuple-element(%closed_call.294), index=16, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1575 = f32[1,1]{1,0} reshape(%closed_call.311), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.295 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1498, %broadcast_in_dim.1575, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1499 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=18
  %closed_call.312 = f32[1024]{0} get-tuple-element(%closed_call.294), index=17, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1576 = f32[1,1024]{1,0} reshape(%closed_call.312), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.296 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1499, %broadcast_in_dim.1576, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1500 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=19
  %closed_call.313 = f32[1]{0} get-tuple-element(%closed_call.294), index=18, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1577 = f32[1,1]{1,0} reshape(%closed_call.313), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.297 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1500, %broadcast_in_dim.1577, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1501 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=20
  %closed_call.314 = f32[1024]{0} get-tuple-element(%closed_call.294), index=19, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1578 = f32[1,1024]{1,0} reshape(%closed_call.314), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.298 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1501, %broadcast_in_dim.1578, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1502 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=21
  %closed_call.315 = f32[1]{0} get-tuple-element(%closed_call.294), index=20, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1579 = f32[1,1]{1,0} reshape(%closed_call.315), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.299 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1502, %broadcast_in_dim.1579, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1503 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=22
  %closed_call.316 = f32[1024]{0} get-tuple-element(%closed_call.294), index=21, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1580 = f32[1,1024]{1,0} reshape(%closed_call.316), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.300 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1503, %broadcast_in_dim.1580, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1504 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=23
  %closed_call.317 = f32[1]{0} get-tuple-element(%closed_call.294), index=22, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1581 = f32[1,1]{1,0} reshape(%closed_call.317), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.301 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1504, %broadcast_in_dim.1581, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1505 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=24
  %closed_call.318 = f32[1024]{0} get-tuple-element(%closed_call.294), index=23, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1582 = f32[1,1024]{1,0} reshape(%closed_call.318), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.302 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1505, %broadcast_in_dim.1582, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1506 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=25
  %closed_call.319 = f32[1]{0} get-tuple-element(%closed_call.294), index=24, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1583 = f32[1,1]{1,0} reshape(%closed_call.319), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.303 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1506, %broadcast_in_dim.1583, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1507 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=26
  %closed_call.320 = f32[1024]{0} get-tuple-element(%closed_call.294), index=25, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1584 = f32[1,1024]{1,0} reshape(%closed_call.320), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.304 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1507, %broadcast_in_dim.1584, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1508 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=27
  %closed_call.321 = f32[1]{0} get-tuple-element(%closed_call.294), index=26, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1585 = f32[1,1]{1,0} reshape(%closed_call.321), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.305 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1508, %broadcast_in_dim.1585, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1509 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=28
  %closed_call.322 = f32[1024]{0} get-tuple-element(%closed_call.294), index=27, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1586 = f32[1,1024]{1,0} reshape(%closed_call.322), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.306 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1509, %broadcast_in_dim.1586, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1510 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=29
  %closed_call.323 = f32[1]{0} get-tuple-element(%closed_call.294), index=28, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1587 = f32[1,1]{1,0} reshape(%closed_call.323), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.307 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1510, %broadcast_in_dim.1587, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1511 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=30
  %closed_call.324 = f32[1024]{0} get-tuple-element(%closed_call.294), index=29, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1588 = f32[1,1024]{1,0} reshape(%closed_call.324), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.308 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1511, %broadcast_in_dim.1588, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1512 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=31
  %closed_call.325 = f32[1]{0} get-tuple-element(%closed_call.294), index=30, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1589 = f32[1,1]{1,0} reshape(%closed_call.325), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.309 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1512, %broadcast_in_dim.1589, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1513 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=32
  %closed_call.326 = f32[1024]{0} get-tuple-element(%closed_call.294), index=31, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1590 = f32[1,1024]{1,0} reshape(%closed_call.326), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.310 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1513, %broadcast_in_dim.1590, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1514 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=33
  %closed_call.327 = f32[1]{0} get-tuple-element(%closed_call.294), index=32, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1591 = f32[1,1]{1,0} reshape(%closed_call.327), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.311 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1514, %broadcast_in_dim.1591, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1515 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=34
  %closed_call.328 = f32[1024]{0} get-tuple-element(%closed_call.294), index=33, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1592 = f32[1,1024]{1,0} reshape(%closed_call.328), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.312 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1515, %broadcast_in_dim.1592, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1516 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=35
  %closed_call.329 = f32[1024]{0} get-tuple-element(%closed_call.294), index=34, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1593 = f32[1,1024]{1,0} reshape(%closed_call.329), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.313 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1516, %broadcast_in_dim.1593, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1517 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=36
  %closed_call.330 = f32[1]{0} get-tuple-element(%closed_call.294), index=35, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1594 = f32[1,1]{1,0} reshape(%closed_call.330), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.314 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1517, %broadcast_in_dim.1594, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1518 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=37
  %closed_call.331 = f32[1]{0} get-tuple-element(%closed_call.294), index=36, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1595 = f32[1,1]{1,0} reshape(%closed_call.331), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.315 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1518, %broadcast_in_dim.1595, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1519 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=38
  %closed_call.332 = f32[1024]{0} get-tuple-element(%closed_call.294), index=37, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1596 = f32[1,1024]{1,0} reshape(%closed_call.332), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.316 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1519, %broadcast_in_dim.1596, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1520 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=39
  %closed_call.333 = f32[1024]{0} get-tuple-element(%closed_call.294), index=38, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1597 = f32[1,1024]{1,0} reshape(%closed_call.333), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.317 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1520, %broadcast_in_dim.1597, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1521 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=40
  %closed_call.334 = f32[1]{0} get-tuple-element(%closed_call.294), index=39, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1598 = f32[1,1]{1,0} reshape(%closed_call.334), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.318 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1521, %broadcast_in_dim.1598, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1522 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=41
  %closed_call.335 = f32[1]{0} get-tuple-element(%closed_call.294), index=40, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1599 = f32[1,1]{1,0} reshape(%closed_call.335), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.319 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1522, %broadcast_in_dim.1599, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1523 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=42
  %closed_call.336 = f32[1024]{0} get-tuple-element(%closed_call.294), index=41, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1600 = f32[1,1024]{1,0} reshape(%closed_call.336), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.320 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1523, %broadcast_in_dim.1600, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1524 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=43
  %closed_call.337 = f32[1]{0} get-tuple-element(%closed_call.294), index=42, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1601 = f32[1,1]{1,0} reshape(%closed_call.337), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.321 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1524, %broadcast_in_dim.1601, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1525 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=44
  %closed_call.338 = f32[1024]{0} get-tuple-element(%closed_call.294), index=43, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1602 = f32[1,1024]{1,0} reshape(%closed_call.338), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.322 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1525, %broadcast_in_dim.1602, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1526 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=45
  %closed_call.339 = f32[1]{0} get-tuple-element(%closed_call.294), index=44, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1603 = f32[1,1]{1,0} reshape(%closed_call.339), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.323 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1526, %broadcast_in_dim.1603, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1527 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=46
  %closed_call.340 = f32[1024]{0} get-tuple-element(%closed_call.294), index=45, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1604 = f32[1,1024]{1,0} reshape(%closed_call.340), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.324 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1527, %broadcast_in_dim.1604, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1528 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=47
  %closed_call.341 = f32[1]{0} get-tuple-element(%closed_call.294), index=46, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1605 = f32[1,1]{1,0} reshape(%closed_call.341), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.325 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1528, %broadcast_in_dim.1605, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1529 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=48
  %closed_call.342 = f32[1024]{0} get-tuple-element(%closed_call.294), index=47, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1606 = f32[1,1024]{1,0} reshape(%closed_call.342), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.326 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1529, %broadcast_in_dim.1606, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1530 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=49
  %closed_call.343 = f32[1]{0} get-tuple-element(%closed_call.294), index=48, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1607 = f32[1,1]{1,0} reshape(%closed_call.343), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.327 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1530, %broadcast_in_dim.1607, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1531 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=50
  %closed_call.344 = f32[1024]{0} get-tuple-element(%closed_call.294), index=49, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1608 = f32[1,1024]{1,0} reshape(%closed_call.344), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.328 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1531, %broadcast_in_dim.1608, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1532 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=51
  %closed_call.345 = f32[1]{0} get-tuple-element(%closed_call.294), index=50, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1609 = f32[1,1]{1,0} reshape(%closed_call.345), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.329 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1532, %broadcast_in_dim.1609, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1533 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=52
  %closed_call.346 = f32[1024]{0} get-tuple-element(%closed_call.294), index=51, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1610 = f32[1,1024]{1,0} reshape(%closed_call.346), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.330 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1533, %broadcast_in_dim.1610, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1534 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=53
  %closed_call.347 = f32[1]{0} get-tuple-element(%closed_call.294), index=52, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1611 = f32[1,1]{1,0} reshape(%closed_call.347), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.331 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1534, %broadcast_in_dim.1611, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1535 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=54
  %closed_call.348 = f32[1024]{0} get-tuple-element(%closed_call.294), index=53, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1612 = f32[1,1024]{1,0} reshape(%closed_call.348), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.332 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1535, %broadcast_in_dim.1612, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1536 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=55
  %closed_call.349 = f32[1]{0} get-tuple-element(%closed_call.294), index=54, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1613 = f32[1,1]{1,0} reshape(%closed_call.349), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.333 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1536, %broadcast_in_dim.1613, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1537 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=56
  %closed_call.350 = f32[1024]{0} get-tuple-element(%closed_call.294), index=55, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1614 = f32[1,1024]{1,0} reshape(%closed_call.350), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.334 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1537, %broadcast_in_dim.1614, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1538 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=57
  %closed_call.351 = f32[1]{0} get-tuple-element(%closed_call.294), index=56, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1615 = f32[1,1]{1,0} reshape(%closed_call.351), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.335 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1538, %broadcast_in_dim.1615, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1539 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.13), index=58
  %closed_call.352 = f32[1024]{0} get-tuple-element(%closed_call.294), index=57, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1616 = f32[1,1024]{1,0} reshape(%closed_call.352), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.336 = f32[1,1024]{1,0} dynamic-update-slice(%get-tuple-element.1539, %broadcast_in_dim.1616, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %get-tuple-element.1540 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.13), index=59
  %closed_call.353 = f32[1]{0} get-tuple-element(%closed_call.294), index=58, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/closed_call" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %broadcast_in_dim.1617 = f32[1,1]{1,0} reshape(%closed_call.353), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %dynamic_update_slice.337 = f32[1,1]{1,0} dynamic-update-slice(%get-tuple-element.1540, %broadcast_in_dim.1617, %sub.58, %constant.502), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/body/dynamic_update_slice" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  ROOT %tuple.21 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=5*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=10*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, f32[1,1024]{1,0}, /*index=15*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=55*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=60*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, /*index=65*/bf16[1,32,4096,18432]{3,2,1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=70*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=75*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=80*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=85*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=90*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=95*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=100*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=105*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=110*/f32[1,1024]{1,0}, f32[1,1]{1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=115*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=120*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) tuple(%add.131, %closed_call.295, %dynamic_update_slice.280, %dynamic_update_slice.281, %dynamic_update_slice.282, /*index=5*/%dynamic_update_slice.283, %dynamic_update_slice.284, %dynamic_update_slice.285, %dynamic_update_slice.286, %dynamic_update_slice.287, /*index=10*/%dynamic_update_slice.288, %dynamic_update_slice.289, %dynamic_update_slice.290, %dynamic_update_slice.291, %dynamic_update_slice.292, /*index=15*/%dynamic_update_slice.293, %dynamic_update_slice.294, %dynamic_update_slice.295, %dynamic_update_slice.296, %dynamic_update_slice.297, /*index=20*/%dynamic_update_slice.298, %dynamic_update_slice.299, %dynamic_update_slice.300, %dynamic_update_slice.301, %dynamic_update_slice.302, /*index=25*/%dynamic_update_slice.303, %dynamic_update_slice.304, %dynamic_update_slice.305, %dynamic_update_slice.306, %dynamic_update_slice.307, /*index=30*/%dynamic_update_slice.308, %dynamic_update_slice.309, %dynamic_update_slice.310, %dynamic_update_slice.311, %dynamic_update_slice.312, /*index=35*/%dynamic_update_slice.313, %dynamic_update_slice.314, %dynamic_update_slice.315, %dynamic_update_slice.316, %dynamic_update_slice.317, /*index=40*/%dynamic_update_slice.318, %dynamic_update_slice.319, %dynamic_update_slice.320, %dynamic_update_slice.321, %dynamic_update_slice.322, /*index=45*/%dynamic_update_slice.323, %dynamic_update_slice.324, %dynamic_update_slice.325, %dynamic_update_slice.326, %dynamic_update_slice.327, /*index=50*/%dynamic_update_slice.328, %dynamic_update_slice.329, %dynamic_update_slice.330, %dynamic_update_slice.331, %dynamic_update_slice.332, /*index=55*/%dynamic_update_slice.333, %dynamic_update_slice.334, %dynamic_update_slice.335, %dynamic_update_slice.336, %dynamic_update_slice.337, /*index=60*/%get-tuple-element.1541, %get-tuple-element.1542, %get-tuple-element.1543, %get-tuple-element.1544, %get-tuple-element.1545, /*index=65*/%get-tuple-element.1546, %get-tuple-element.1547, %get-tuple-element.1548, %get-tuple-element.1549, %get-tuple-element.1550, /*index=70*/%get-tuple-element.1551, %get-tuple-element.1552, %get-tuple-element.1553, %get-tuple-element.1554, %get-tuple-element.1555, /*index=75*/%get-tuple-element.1556, %get-tuple-element.1557, %get-tuple-element.1558, %get-tuple-element.1559, %get-tuple-element.1560, /*index=80*/%get-tuple-element.1561, %get-tuple-element.1562, %get-tuple-element.1563, %get-tuple-element.1564, %get-tuple-element.1565, /*index=85*/%get-tuple-element.1566, %get-tuple-element.1567, %get-tuple-element.1568, %get-tuple-element.1569, %get-tuple-element.1570, /*index=90*/%get-tuple-element.1571, %get-tuple-element.1572, %get-tuple-element.1573, %get-tuple-element.1574, %get-tuple-element.1575, /*index=95*/%get-tuple-element.1576, %get-tuple-element.1577, %get-tuple-element.1578, %get-tuple-element.1579, %get-tuple-element.1580, /*index=100*/%get-tuple-element.1581, %get-tuple-element.1582, %get-tuple-element.1583, %get-tuple-element.1584, %get-tuple-element.1585, /*index=105*/%get-tuple-element.1586, %get-tuple-element.1587, %get-tuple-element.1588, %get-tuple-element.1589, %get-tuple-element.1590, /*index=110*/%get-tuple-element.1591, %get-tuple-element.1592, %get-tuple-element.1593, %get-tuple-element.1594, %get-tuple-element.1595, /*index=115*/%get-tuple-element.1596, %get-tuple-element.1597, %get-tuple-element.1598, %get-tuple-element.1599, %get-tuple-element.1600, /*index=120*/%get-tuple-element.1601, %get-tuple-element.1602, %get-tuple-element.1603, %get-tuple-element.1604, %get-tuple-element.1605)
}

%region_304.392 (arg_tuple.15: (s32[], bf16[32,4096,7168], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=5*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=10*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], f32[1,1024], /*index=15*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=20*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=25*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=30*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=35*/f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], f32[1,1024], /*index=40*/f32[1,1], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=45*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=50*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=55*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=60*/bf16[1,32,4096,7168], bf16[1,32,4096,1536], bf16[1,32,4096,576], bf16[1,32,4096,7168], bf16[1,32,4096,18432], /*index=65*/bf16[1,32,4096,18432], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=70*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=75*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=80*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=85*/f32[1,1], f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], /*index=90*/f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], /*index=95*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=100*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=105*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=110*/f32[1,1024], f32[1,1], bf16[1,7168,18432], bf16[1,7168,18432], bf16[1,18432,7168], /*index=115*/bf16[1,7168], bf16[1,7168], bf16[1,512], bf16[1,128,128,7168], bf16[1,1536], /*index=120*/bf16[1,7168,576], bf16[1,512,128,256], bf16[1,7168,1536], bf16[1,1536,128,192], s32[32,4096])) -> pred[] {
  %arg_tuple.15 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=5*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=10*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, f32[1,1024]{1,0}, /*index=15*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=55*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=60*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, /*index=65*/bf16[1,32,4096,18432]{3,2,1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=70*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=75*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=80*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=85*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=90*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=95*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=100*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=105*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=110*/f32[1,1024]{1,0}, f32[1,1]{1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=115*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=120*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) parameter(0)
  %get-tuple-element.1732 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%arg_tuple.15), index=1
  %get-tuple-element.1733 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.15), index=2
  %get-tuple-element.1734 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.15), index=3
  %get-tuple-element.1735 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.15), index=4
  %get-tuple-element.1736 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.15), index=5
  %get-tuple-element.1737 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.15), index=6
  %get-tuple-element.1738 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.15), index=7
  %get-tuple-element.1739 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=8
  %get-tuple-element.1740 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.15), index=9
  %get-tuple-element.1741 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.15), index=10
  %get-tuple-element.1742 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=11
  %get-tuple-element.1743 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.15), index=12
  %get-tuple-element.1744 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=13
  %get-tuple-element.1745 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=14
  %get-tuple-element.1746 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=15
  %get-tuple-element.1747 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=16
  %get-tuple-element.1748 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=17
  %get-tuple-element.1749 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=18
  %get-tuple-element.1750 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=19
  %get-tuple-element.1751 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=20
  %get-tuple-element.1752 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=21
  %get-tuple-element.1753 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=22
  %get-tuple-element.1754 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=23
  %get-tuple-element.1755 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=24
  %get-tuple-element.1756 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=25
  %get-tuple-element.1757 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=26
  %get-tuple-element.1758 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=27
  %get-tuple-element.1759 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=28
  %get-tuple-element.1760 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=29
  %get-tuple-element.1761 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=30
  %get-tuple-element.1762 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=31
  %get-tuple-element.1763 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=32
  %get-tuple-element.1764 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=33
  %get-tuple-element.1765 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=34
  %get-tuple-element.1766 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=35
  %get-tuple-element.1767 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=36
  %get-tuple-element.1768 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=37
  %get-tuple-element.1769 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=38
  %get-tuple-element.1770 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=39
  %get-tuple-element.1771 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=40
  %get-tuple-element.1772 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=41
  %get-tuple-element.1773 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=42
  %get-tuple-element.1774 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=43
  %get-tuple-element.1775 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=44
  %get-tuple-element.1776 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=45
  %get-tuple-element.1777 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=46
  %get-tuple-element.1778 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=47
  %get-tuple-element.1779 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=48
  %get-tuple-element.1780 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=49
  %get-tuple-element.1781 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=50
  %get-tuple-element.1782 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=51
  %get-tuple-element.1783 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=52
  %get-tuple-element.1784 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=53
  %get-tuple-element.1785 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=54
  %get-tuple-element.1786 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=55
  %get-tuple-element.1787 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=56
  %get-tuple-element.1788 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=57
  %get-tuple-element.1789 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=58
  %get-tuple-element.1790 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=59
  %get-tuple-element.1791 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=60
  %get-tuple-element.1792 = bf16[1,32,4096,1536]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=61
  %get-tuple-element.1793 = bf16[1,32,4096,576]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=62
  %get-tuple-element.1794 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=63
  %get-tuple-element.1795 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=64
  %get-tuple-element.1796 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=65
  %get-tuple-element.1797 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=66
  %get-tuple-element.1798 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=67
  %get-tuple-element.1799 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=68
  %get-tuple-element.1800 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=69
  %get-tuple-element.1801 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=70
  %get-tuple-element.1802 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=71
  %get-tuple-element.1803 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=72
  %get-tuple-element.1804 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=73
  %get-tuple-element.1805 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=74
  %get-tuple-element.1806 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=75
  %get-tuple-element.1807 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=76
  %get-tuple-element.1808 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=77
  %get-tuple-element.1809 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=78
  %get-tuple-element.1810 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=79
  %get-tuple-element.1811 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=80
  %get-tuple-element.1812 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=81
  %get-tuple-element.1813 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=82
  %get-tuple-element.1814 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=83
  %get-tuple-element.1815 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=84
  %get-tuple-element.1816 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=85
  %get-tuple-element.1817 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=86
  %get-tuple-element.1818 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=87
  %get-tuple-element.1819 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=88
  %get-tuple-element.1820 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=89
  %get-tuple-element.1821 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=90
  %get-tuple-element.1822 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=91
  %get-tuple-element.1823 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=92
  %get-tuple-element.1824 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=93
  %get-tuple-element.1825 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=94
  %get-tuple-element.1826 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=95
  %get-tuple-element.1827 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=96
  %get-tuple-element.1828 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=97
  %get-tuple-element.1829 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=98
  %get-tuple-element.1830 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=99
  %get-tuple-element.1831 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=100
  %get-tuple-element.1832 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=101
  %get-tuple-element.1833 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=102
  %get-tuple-element.1834 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=103
  %get-tuple-element.1835 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=104
  %get-tuple-element.1836 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=105
  %get-tuple-element.1837 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=106
  %get-tuple-element.1838 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=107
  %get-tuple-element.1839 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=108
  %get-tuple-element.1840 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=109
  %get-tuple-element.1841 = f32[1,1024]{1,0} get-tuple-element(%arg_tuple.15), index=110
  %get-tuple-element.1842 = f32[1,1]{1,0} get-tuple-element(%arg_tuple.15), index=111
  %get-tuple-element.1843 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.15), index=112
  %get-tuple-element.1844 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%arg_tuple.15), index=113
  %get-tuple-element.1845 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%arg_tuple.15), index=114
  %get-tuple-element.1846 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.15), index=115
  %get-tuple-element.1847 = bf16[1,7168]{1,0} get-tuple-element(%arg_tuple.15), index=116
  %get-tuple-element.1848 = bf16[1,512]{1,0} get-tuple-element(%arg_tuple.15), index=117
  %get-tuple-element.1849 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=118
  %get-tuple-element.1850 = bf16[1,1536]{1,0} get-tuple-element(%arg_tuple.15), index=119
  %get-tuple-element.1851 = bf16[1,7168,576]{2,1,0} get-tuple-element(%arg_tuple.15), index=120
  %get-tuple-element.1852 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=121
  %get-tuple-element.1853 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%arg_tuple.15), index=122
  %get-tuple-element.1854 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%arg_tuple.15), index=123
  %get-tuple-element.1855 = s32[32,4096]{1,0} get-tuple-element(%arg_tuple.15), index=124
  %get-tuple-element.1731 = s32[] get-tuple-element(%arg_tuple.15), index=0
  %constant.505 = s32[] constant(1)
  ROOT %lt.16 = pred[] compare(%get-tuple-element.1731, %constant.505), direction=LT, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while/cond/lt" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
}

%clip_1183.428 (Arg_0.173: s32[], Arg_1.149: s32[], Arg_2.143: s32[]) -> s32[] {
  %Arg_2.143 = s32[] parameter(2)
  %Arg_1.149 = s32[] parameter(1)
  %Arg_0.173 = s32[] parameter(0)
  %max.221 = s32[] maximum(%Arg_1.149, %Arg_0.173), metadata={op_name="max" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=143 source_end_line=143 source_column=12 source_end_column=67}
  ROOT %min.221 = s32[] minimum(%Arg_2.143, %max.221), metadata={op_name="min" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=143 source_end_line=143 source_column=12 source_end_column=67}
}

%_where_1191.429 (Arg_0.175: pred[], Arg_1.151: f32[], Arg_2.145: f32[]) -> f32[] {
  %Arg_0.175 = pred[] parameter(0)
  %Arg_1.151 = f32[] parameter(1)
  %Arg_2.145 = f32[] parameter(2)
  ROOT %select_n.102 = f32[] select(%Arg_0.175, %Arg_1.151, %Arg_2.145), metadata={op_name="select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_join.py" source_line=43 source_end_line=43 source_column=15 source_end_column=76}
}

%region_61.98 (reduce_sum.102: bf16[], reduce_sum.103: bf16[]) -> bf16[] {
  %reduce_sum.102 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.103 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.104 = bf16[] add(%reduce_sum.102, %reduce_sum.103), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
}

%region_62.99 (reduce_sum.109: bf16[], reduce_sum.110: bf16[]) -> bf16[] {
  %reduce_sum.109 = bf16[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.110 = bf16[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.111 = bf16[] add(%reduce_sum.109, %reduce_sum.110), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
}

%region_306.394 (reduce_sum.498: f32[], reduce_sum.499: f32[]) -> f32[] {
  %reduce_sum.498 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.499 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.500 = f32[] add(%reduce_sum.498, %reduce_sum.499), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_307.395 (reduce_sum.505: f32[], reduce_sum.506: f32[]) -> f32[] {
  %reduce_sum.505 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.506 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.507 = f32[] add(%reduce_sum.505, %reduce_sum.506), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_308.396 (reduce_sum.512: f32[], reduce_sum.513: f32[]) -> f32[] {
  %reduce_sum.512 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.513 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.514 = f32[] add(%reduce_sum.512, %reduce_sum.513), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_309.397 (reduce_sum.519: f32[], reduce_sum.520: f32[]) -> f32[] {
  %reduce_sum.519 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.520 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.521 = f32[] add(%reduce_sum.519, %reduce_sum.520), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_310.398 (reduce_sum.526: f32[], reduce_sum.527: f32[]) -> f32[] {
  %reduce_sum.526 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.527 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.528 = f32[] add(%reduce_sum.526, %reduce_sum.527), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_311.399 (reduce_sum.533: f32[], reduce_sum.534: f32[]) -> f32[] {
  %reduce_sum.533 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.534 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.535 = f32[] add(%reduce_sum.533, %reduce_sum.534), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_312.400 (reduce_sum.540: f32[], reduce_sum.541: f32[]) -> f32[] {
  %reduce_sum.540 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.541 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.542 = f32[] add(%reduce_sum.540, %reduce_sum.541), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_313.401 (reduce_sum.547: f32[], reduce_sum.548: f32[]) -> f32[] {
  %reduce_sum.547 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.548 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.549 = f32[] add(%reduce_sum.547, %reduce_sum.548), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_314.402 (reduce_sum.554: f32[], reduce_sum.555: f32[]) -> f32[] {
  %reduce_sum.554 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.555 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.556 = f32[] add(%reduce_sum.554, %reduce_sum.555), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_315.403 (reduce_sum.561: f32[], reduce_sum.562: f32[]) -> f32[] {
  %reduce_sum.561 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.562 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.563 = f32[] add(%reduce_sum.561, %reduce_sum.562), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_316.404 (reduce_sum.568: f32[], reduce_sum.569: f32[]) -> f32[] {
  %reduce_sum.568 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.569 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.570 = f32[] add(%reduce_sum.568, %reduce_sum.569), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_317.405 (reduce_sum.575: f32[], reduce_sum.576: f32[]) -> f32[] {
  %reduce_sum.575 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.576 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.577 = f32[] add(%reduce_sum.575, %reduce_sum.576), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_318.406 (reduce_sum.582: f32[], reduce_sum.583: f32[]) -> f32[] {
  %reduce_sum.582 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.583 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.584 = f32[] add(%reduce_sum.582, %reduce_sum.583), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_319.407 (reduce_sum.589: f32[], reduce_sum.590: f32[]) -> f32[] {
  %reduce_sum.589 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.590 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.591 = f32[] add(%reduce_sum.589, %reduce_sum.590), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_320.408 (reduce_sum.596: f32[], reduce_sum.597: f32[]) -> f32[] {
  %reduce_sum.596 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.597 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.598 = f32[] add(%reduce_sum.596, %reduce_sum.597), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_321.409 (reduce_sum.603: f32[], reduce_sum.604: f32[]) -> f32[] {
  %reduce_sum.603 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.604 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.605 = f32[] add(%reduce_sum.603, %reduce_sum.604), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_322.410 (reduce_sum.610: f32[], reduce_sum.611: f32[]) -> f32[] {
  %reduce_sum.610 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.611 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.612 = f32[] add(%reduce_sum.610, %reduce_sum.611), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_323.411 (reduce_sum.617: f32[], reduce_sum.618: f32[]) -> f32[] {
  %reduce_sum.617 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.618 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.619 = f32[] add(%reduce_sum.617, %reduce_sum.618), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_324.412 (reduce_sum.624: f32[], reduce_sum.625: f32[]) -> f32[] {
  %reduce_sum.624 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.625 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.626 = f32[] add(%reduce_sum.624, %reduce_sum.625), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_325.413 (reduce_sum.631: f32[], reduce_sum.632: f32[]) -> f32[] {
  %reduce_sum.631 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.632 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.633 = f32[] add(%reduce_sum.631, %reduce_sum.632), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_326.414 (reduce_sum.638: f32[], reduce_sum.639: f32[]) -> f32[] {
  %reduce_sum.638 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.639 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.640 = f32[] add(%reduce_sum.638, %reduce_sum.639), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_327.415 (reduce_sum.645: f32[], reduce_sum.646: f32[]) -> f32[] {
  %reduce_sum.645 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.646 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.647 = f32[] add(%reduce_sum.645, %reduce_sum.646), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_328.416 (reduce_sum.652: f32[], reduce_sum.653: f32[]) -> f32[] {
  %reduce_sum.652 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.653 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.654 = f32[] add(%reduce_sum.652, %reduce_sum.653), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_329.417 (reduce_sum.659: f32[], reduce_sum.660: f32[]) -> f32[] {
  %reduce_sum.659 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.660 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.661 = f32[] add(%reduce_sum.659, %reduce_sum.660), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_330.418 (reduce_sum.666: f32[], reduce_sum.667: f32[]) -> f32[] {
  %reduce_sum.666 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.667 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.668 = f32[] add(%reduce_sum.666, %reduce_sum.667), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_331.419 (reduce_sum.673: f32[], reduce_sum.674: f32[]) -> f32[] {
  %reduce_sum.673 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.674 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.675 = f32[] add(%reduce_sum.673, %reduce_sum.674), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_332.420 (reduce_sum.680: f32[], reduce_sum.681: f32[]) -> f32[] {
  %reduce_sum.680 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.681 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.682 = f32[] add(%reduce_sum.680, %reduce_sum.681), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_333.421 (reduce_sum.687: f32[], reduce_sum.688: f32[]) -> f32[] {
  %reduce_sum.687 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.688 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.689 = f32[] add(%reduce_sum.687, %reduce_sum.688), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_334.422 (reduce_sum.694: f32[], reduce_sum.695: f32[]) -> f32[] {
  %reduce_sum.694 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.695 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.696 = f32[] add(%reduce_sum.694, %reduce_sum.695), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_335.423 (reduce_sum.701: f32[], reduce_sum.702: f32[]) -> f32[] {
  %reduce_sum.701 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.702 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.703 = f32[] add(%reduce_sum.701, %reduce_sum.702), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_336.424 (reduce_sum.708: f32[], reduce_sum.709: f32[]) -> f32[] {
  %reduce_sum.708 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.709 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.710 = f32[] add(%reduce_sum.708, %reduce_sum.709), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_337.425 (reduce_sum.715: f32[], reduce_sum.716: f32[]) -> f32[] {
  %reduce_sum.715 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.716 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.717 = f32[] add(%reduce_sum.715, %reduce_sum.716), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%region_305.393 (scatter-add.2: bf16[], scatter-add.3: bf16[]) -> bf16[] {
  %scatter-add.2 = bf16[] parameter(0), metadata={op_name="scatter-add"}
  %scatter-add.3 = bf16[] parameter(1), metadata={op_name="scatter-add"}
  ROOT %add.133 = bf16[] add(%scatter-add.2, %scatter-add.3), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
}

%region_338.426 (reduce_sum.722: f32[], reduce_sum.723: f32[]) -> f32[] {
  %reduce_sum.722 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.723 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.724 = f32[] add(%reduce_sum.722, %reduce_sum.723), metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
}

%_where_1097.427 (Arg_0.171: pred[], Arg_1.147: s32[], Arg_2.141: s32[]) -> s32[] {
  %Arg_0.171 = pred[] parameter(0)
  %Arg_1.147 = s32[] parameter(1)
  %Arg_2.141 = s32[] parameter(2)
  ROOT %select_n.100 = s32[] select(%Arg_0.171, %Arg_1.147, %Arg_2.141), metadata={op_name="select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=9 source_end_column=61}
}

%region_339.430 (reduce_sum.729: f32[], reduce_sum.730: f32[]) -> f32[] {
  %reduce_sum.729 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.730 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.731 = f32[] add(%reduce_sum.729, %reduce_sum.730), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_340.431 (reduce_sum.736: f32[], reduce_sum.737: f32[]) -> f32[] {
  %reduce_sum.736 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.737 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.738 = f32[] add(%reduce_sum.736, %reduce_sum.737), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_341.432 (reduce_sum.743: f32[], reduce_sum.744: f32[]) -> f32[] {
  %reduce_sum.743 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.744 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.745 = f32[] add(%reduce_sum.743, %reduce_sum.744), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_342.433 (reduce_sum.750: f32[], reduce_sum.751: f32[]) -> f32[] {
  %reduce_sum.750 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.751 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.752 = f32[] add(%reduce_sum.750, %reduce_sum.751), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_343.434 (reduce_sum.757: f32[], reduce_sum.758: f32[]) -> f32[] {
  %reduce_sum.757 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.758 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.759 = f32[] add(%reduce_sum.757, %reduce_sum.758), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_344.435 (reduce_sum.764: f32[], reduce_sum.765: f32[]) -> f32[] {
  %reduce_sum.764 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.765 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.766 = f32[] add(%reduce_sum.764, %reduce_sum.765), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_345.436 (reduce_sum.771: f32[], reduce_sum.772: f32[]) -> f32[] {
  %reduce_sum.771 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.772 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.773 = f32[] add(%reduce_sum.771, %reduce_sum.772), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_346.437 (reduce_sum.778: f32[], reduce_sum.779: f32[]) -> f32[] {
  %reduce_sum.778 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.779 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.780 = f32[] add(%reduce_sum.778, %reduce_sum.779), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_347.438 (reduce_sum.785: f32[], reduce_sum.786: f32[]) -> f32[] {
  %reduce_sum.785 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.786 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.787 = f32[] add(%reduce_sum.785, %reduce_sum.786), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_348.439 (reduce_sum.792: f32[], reduce_sum.793: f32[]) -> f32[] {
  %reduce_sum.792 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.793 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.794 = f32[] add(%reduce_sum.792, %reduce_sum.793), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_349.440 (reduce_sum.799: f32[], reduce_sum.800: f32[]) -> f32[] {
  %reduce_sum.799 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.800 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.801 = f32[] add(%reduce_sum.799, %reduce_sum.800), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_350.441 (reduce_sum.806: f32[], reduce_sum.807: f32[]) -> f32[] {
  %reduce_sum.806 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.807 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.808 = f32[] add(%reduce_sum.806, %reduce_sum.807), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_351.442 (reduce_sum.813: f32[], reduce_sum.814: f32[]) -> f32[] {
  %reduce_sum.813 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.814 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.815 = f32[] add(%reduce_sum.813, %reduce_sum.814), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_352.443 (reduce_sum.820: f32[], reduce_sum.821: f32[]) -> f32[] {
  %reduce_sum.820 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.821 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.822 = f32[] add(%reduce_sum.820, %reduce_sum.821), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_353.444 (reduce_sum.827: f32[], reduce_sum.828: f32[]) -> f32[] {
  %reduce_sum.827 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.828 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.829 = f32[] add(%reduce_sum.827, %reduce_sum.828), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_354.445 (reduce_sum.834: f32[], reduce_sum.835: f32[]) -> f32[] {
  %reduce_sum.834 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.835 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.836 = f32[] add(%reduce_sum.834, %reduce_sum.835), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_355.446 (reduce_sum.841: f32[], reduce_sum.842: f32[]) -> f32[] {
  %reduce_sum.841 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.842 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.843 = f32[] add(%reduce_sum.841, %reduce_sum.842), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_356.447 (reduce_sum.848: f32[], reduce_sum.849: f32[]) -> f32[] {
  %reduce_sum.848 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.849 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.850 = f32[] add(%reduce_sum.848, %reduce_sum.849), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_357.448 (reduce_sum.855: f32[], reduce_sum.856: f32[]) -> f32[] {
  %reduce_sum.855 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.856 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.857 = f32[] add(%reduce_sum.855, %reduce_sum.856), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_358.449 (reduce_sum.862: f32[], reduce_sum.863: f32[]) -> f32[] {
  %reduce_sum.862 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.863 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.864 = f32[] add(%reduce_sum.862, %reduce_sum.863), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_359.450 (reduce_sum.869: f32[], reduce_sum.870: f32[]) -> f32[] {
  %reduce_sum.869 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.870 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.871 = f32[] add(%reduce_sum.869, %reduce_sum.870), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_360.451 (reduce_sum.876: f32[], reduce_sum.877: f32[]) -> f32[] {
  %reduce_sum.876 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.877 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.878 = f32[] add(%reduce_sum.876, %reduce_sum.877), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_361.452 (reduce_sum.883: f32[], reduce_sum.884: f32[]) -> f32[] {
  %reduce_sum.883 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.884 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.885 = f32[] add(%reduce_sum.883, %reduce_sum.884), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_362.453 (reduce_sum.890: f32[], reduce_sum.891: f32[]) -> f32[] {
  %reduce_sum.890 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.891 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.892 = f32[] add(%reduce_sum.890, %reduce_sum.891), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_363.454 (reduce_sum.897: f32[], reduce_sum.898: f32[]) -> f32[] {
  %reduce_sum.897 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.898 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.899 = f32[] add(%reduce_sum.897, %reduce_sum.898), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_364.455 (reduce_sum.904: f32[], reduce_sum.905: f32[]) -> f32[] {
  %reduce_sum.904 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.905 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.906 = f32[] add(%reduce_sum.904, %reduce_sum.905), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_365.456 (reduce_sum.911: f32[], reduce_sum.912: f32[]) -> f32[] {
  %reduce_sum.911 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.912 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.913 = f32[] add(%reduce_sum.911, %reduce_sum.912), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_366.457 (reduce_sum.918: f32[], reduce_sum.919: f32[]) -> f32[] {
  %reduce_sum.918 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.919 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.920 = f32[] add(%reduce_sum.918, %reduce_sum.919), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_367.458 (reduce_sum.925: f32[], reduce_sum.926: f32[]) -> f32[] {
  %reduce_sum.925 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.926 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.927 = f32[] add(%reduce_sum.925, %reduce_sum.926), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_368.459 (reduce_sum.932: f32[], reduce_sum.933: f32[]) -> f32[] {
  %reduce_sum.932 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.933 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.934 = f32[] add(%reduce_sum.932, %reduce_sum.933), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_369.460 (reduce_sum.939: f32[], reduce_sum.940: f32[]) -> f32[] {
  %reduce_sum.939 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.940 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.941 = f32[] add(%reduce_sum.939, %reduce_sum.940), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_370.461 (reduce_sum.946: f32[], reduce_sum.947: f32[]) -> f32[] {
  %reduce_sum.946 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.947 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.948 = f32[] add(%reduce_sum.946, %reduce_sum.947), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_371.462 (reduce_sum.953: f32[], reduce_sum.954: f32[]) -> f32[] {
  %reduce_sum.953 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.954 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.955 = f32[] add(%reduce_sum.953, %reduce_sum.954), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_372.463 (reduce_sum.960: f32[], reduce_sum.961: f32[]) -> f32[] {
  %reduce_sum.960 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.961 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.962 = f32[] add(%reduce_sum.960, %reduce_sum.961), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_373.464 (reduce_sum.967: f32[], reduce_sum.968: f32[]) -> f32[] {
  %reduce_sum.967 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.968 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.969 = f32[] add(%reduce_sum.967, %reduce_sum.968), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_374.465 (reduce_sum.974: f32[], reduce_sum.975: f32[]) -> f32[] {
  %reduce_sum.974 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.975 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.976 = f32[] add(%reduce_sum.974, %reduce_sum.975), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_375.466 (reduce_sum.981: f32[], reduce_sum.982: f32[]) -> f32[] {
  %reduce_sum.981 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.982 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.983 = f32[] add(%reduce_sum.981, %reduce_sum.982), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_376.467 (reduce_sum.988: f32[], reduce_sum.989: f32[]) -> f32[] {
  %reduce_sum.988 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.989 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.990 = f32[] add(%reduce_sum.988, %reduce_sum.989), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_377.468 (reduce_sum.995: f32[], reduce_sum.996: f32[]) -> f32[] {
  %reduce_sum.995 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.996 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.997 = f32[] add(%reduce_sum.995, %reduce_sum.996), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_378.469 (reduce_sum.1002: f32[], reduce_sum.1003: f32[]) -> f32[] {
  %reduce_sum.1002 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1003 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1004 = f32[] add(%reduce_sum.1002, %reduce_sum.1003), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_379.470 (reduce_sum.1009: f32[], reduce_sum.1010: f32[]) -> f32[] {
  %reduce_sum.1009 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1010 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1011 = f32[] add(%reduce_sum.1009, %reduce_sum.1010), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_380.471 (reduce_sum.1016: f32[], reduce_sum.1017: f32[]) -> f32[] {
  %reduce_sum.1016 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1017 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1018 = f32[] add(%reduce_sum.1016, %reduce_sum.1017), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_381.472 (reduce_sum.1023: f32[], reduce_sum.1024: f32[]) -> f32[] {
  %reduce_sum.1023 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1024 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1025 = f32[] add(%reduce_sum.1023, %reduce_sum.1024), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_382.473 (reduce_sum.1030: f32[], reduce_sum.1031: f32[]) -> f32[] {
  %reduce_sum.1030 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1031 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1032 = f32[] add(%reduce_sum.1030, %reduce_sum.1031), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_383.474 (reduce_sum.1037: f32[], reduce_sum.1038: f32[]) -> f32[] {
  %reduce_sum.1037 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1038 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1039 = f32[] add(%reduce_sum.1037, %reduce_sum.1038), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_384.475 (reduce_sum.1044: f32[], reduce_sum.1045: f32[]) -> f32[] {
  %reduce_sum.1044 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1045 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1046 = f32[] add(%reduce_sum.1044, %reduce_sum.1045), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_385.476 (reduce_sum.1051: f32[], reduce_sum.1052: f32[]) -> f32[] {
  %reduce_sum.1051 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1052 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1053 = f32[] add(%reduce_sum.1051, %reduce_sum.1052), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_386.477 (reduce_sum.1058: f32[], reduce_sum.1059: f32[]) -> f32[] {
  %reduce_sum.1058 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1059 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1060 = f32[] add(%reduce_sum.1058, %reduce_sum.1059), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_387.478 (reduce_sum.1065: f32[], reduce_sum.1066: f32[]) -> f32[] {
  %reduce_sum.1065 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1066 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1067 = f32[] add(%reduce_sum.1065, %reduce_sum.1066), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_388.479 (reduce_sum.1072: f32[], reduce_sum.1073: f32[]) -> f32[] {
  %reduce_sum.1072 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1073 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1074 = f32[] add(%reduce_sum.1072, %reduce_sum.1073), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_389.480 (reduce_sum.1079: f32[], reduce_sum.1080: f32[]) -> f32[] {
  %reduce_sum.1079 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1080 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1081 = f32[] add(%reduce_sum.1079, %reduce_sum.1080), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_390.481 (reduce_sum.1086: f32[], reduce_sum.1087: f32[]) -> f32[] {
  %reduce_sum.1086 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1087 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1088 = f32[] add(%reduce_sum.1086, %reduce_sum.1087), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_391.482 (reduce_sum.1093: f32[], reduce_sum.1094: f32[]) -> f32[] {
  %reduce_sum.1093 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1094 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1095 = f32[] add(%reduce_sum.1093, %reduce_sum.1094), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_392.483 (reduce_sum.1100: f32[], reduce_sum.1101: f32[]) -> f32[] {
  %reduce_sum.1100 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1101 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1102 = f32[] add(%reduce_sum.1100, %reduce_sum.1101), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_393.484 (reduce_sum.1107: f32[], reduce_sum.1108: f32[]) -> f32[] {
  %reduce_sum.1107 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1108 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1109 = f32[] add(%reduce_sum.1107, %reduce_sum.1108), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_394.485 (reduce_sum.1114: f32[], reduce_sum.1115: f32[]) -> f32[] {
  %reduce_sum.1114 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1115 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1116 = f32[] add(%reduce_sum.1114, %reduce_sum.1115), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_395.486 (reduce_sum.1121: f32[], reduce_sum.1122: f32[]) -> f32[] {
  %reduce_sum.1121 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1122 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1123 = f32[] add(%reduce_sum.1121, %reduce_sum.1122), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_396.487 (reduce_sum.1128: f32[], reduce_sum.1129: f32[]) -> f32[] {
  %reduce_sum.1128 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1129 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1130 = f32[] add(%reduce_sum.1128, %reduce_sum.1129), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_397.488 (reduce_sum.1135: f32[], reduce_sum.1136: f32[]) -> f32[] {
  %reduce_sum.1135 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1136 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1137 = f32[] add(%reduce_sum.1135, %reduce_sum.1136), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_398.489 (reduce_sum.1142: f32[], reduce_sum.1143: f32[]) -> f32[] {
  %reduce_sum.1142 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1143 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1144 = f32[] add(%reduce_sum.1142, %reduce_sum.1143), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_399.490 (reduce_sum.1149: f32[], reduce_sum.1150: f32[]) -> f32[] {
  %reduce_sum.1149 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1150 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1151 = f32[] add(%reduce_sum.1149, %reduce_sum.1150), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_400.491 (reduce_sum.1156: f32[], reduce_sum.1157: f32[]) -> f32[] {
  %reduce_sum.1156 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1157 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1158 = f32[] add(%reduce_sum.1156, %reduce_sum.1157), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_401.492 (reduce_sum.1163: f32[], reduce_sum.1164: f32[]) -> f32[] {
  %reduce_sum.1163 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1164 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1165 = f32[] add(%reduce_sum.1163, %reduce_sum.1164), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_402.493 (reduce_sum.1170: f32[], reduce_sum.1171: f32[]) -> f32[] {
  %reduce_sum.1170 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1171 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1172 = f32[] add(%reduce_sum.1170, %reduce_sum.1171), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_403.494 (reduce_sum.1177: f32[], reduce_sum.1178: f32[]) -> f32[] {
  %reduce_sum.1177 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1178 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1179 = f32[] add(%reduce_sum.1177, %reduce_sum.1178), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_404.495 (reduce_sum.1184: f32[], reduce_sum.1185: f32[]) -> f32[] {
  %reduce_sum.1184 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1185 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1186 = f32[] add(%reduce_sum.1184, %reduce_sum.1185), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_405.496 (reduce_sum.1191: f32[], reduce_sum.1192: f32[]) -> f32[] {
  %reduce_sum.1191 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1192 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1193 = f32[] add(%reduce_sum.1191, %reduce_sum.1192), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_406.497 (reduce_sum.1198: f32[], reduce_sum.1199: f32[]) -> f32[] {
  %reduce_sum.1198 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1199 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1200 = f32[] add(%reduce_sum.1198, %reduce_sum.1199), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_407.498 (reduce_sum.1205: f32[], reduce_sum.1206: f32[]) -> f32[] {
  %reduce_sum.1205 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1206 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1207 = f32[] add(%reduce_sum.1205, %reduce_sum.1206), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_408.499 (reduce_sum.1212: f32[], reduce_sum.1213: f32[]) -> f32[] {
  %reduce_sum.1212 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1213 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1214 = f32[] add(%reduce_sum.1212, %reduce_sum.1213), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_409.500 (reduce_sum.1219: f32[], reduce_sum.1220: f32[]) -> f32[] {
  %reduce_sum.1219 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1220 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1221 = f32[] add(%reduce_sum.1219, %reduce_sum.1220), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_410.501 (reduce_sum.1226: f32[], reduce_sum.1227: f32[]) -> f32[] {
  %reduce_sum.1226 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1227 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1228 = f32[] add(%reduce_sum.1226, %reduce_sum.1227), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_411.502 (reduce_sum.1233: f32[], reduce_sum.1234: f32[]) -> f32[] {
  %reduce_sum.1233 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1234 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1235 = f32[] add(%reduce_sum.1233, %reduce_sum.1234), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_412.503 (reduce_sum.1240: f32[], reduce_sum.1241: f32[]) -> f32[] {
  %reduce_sum.1240 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1241 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1242 = f32[] add(%reduce_sum.1240, %reduce_sum.1241), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_413.504 (reduce_sum.1247: f32[], reduce_sum.1248: f32[]) -> f32[] {
  %reduce_sum.1247 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1248 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1249 = f32[] add(%reduce_sum.1247, %reduce_sum.1248), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_414.505 (reduce_sum.1254: f32[], reduce_sum.1255: f32[]) -> f32[] {
  %reduce_sum.1254 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1255 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1256 = f32[] add(%reduce_sum.1254, %reduce_sum.1255), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_415.506 (reduce_sum.1261: f32[], reduce_sum.1262: f32[]) -> f32[] {
  %reduce_sum.1261 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1262 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1263 = f32[] add(%reduce_sum.1261, %reduce_sum.1262), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_416.507 (reduce_sum.1268: f32[], reduce_sum.1269: f32[]) -> f32[] {
  %reduce_sum.1268 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1269 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1270 = f32[] add(%reduce_sum.1268, %reduce_sum.1269), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_417.508 (reduce_sum.1275: f32[], reduce_sum.1276: f32[]) -> f32[] {
  %reduce_sum.1275 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1276 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1277 = f32[] add(%reduce_sum.1275, %reduce_sum.1276), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_418.509 (reduce_sum.1282: f32[], reduce_sum.1283: f32[]) -> f32[] {
  %reduce_sum.1282 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1283 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1284 = f32[] add(%reduce_sum.1282, %reduce_sum.1283), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_419.510 (reduce_sum.1289: f32[], reduce_sum.1290: f32[]) -> f32[] {
  %reduce_sum.1289 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1290 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1291 = f32[] add(%reduce_sum.1289, %reduce_sum.1290), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_420.511 (reduce_sum.1296: f32[], reduce_sum.1297: f32[]) -> f32[] {
  %reduce_sum.1296 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1297 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1298 = f32[] add(%reduce_sum.1296, %reduce_sum.1297), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_421.512 (reduce_sum.1303: f32[], reduce_sum.1304: f32[]) -> f32[] {
  %reduce_sum.1303 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1304 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1305 = f32[] add(%reduce_sum.1303, %reduce_sum.1304), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_422.513 (reduce_sum.1310: f32[], reduce_sum.1311: f32[]) -> f32[] {
  %reduce_sum.1310 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1311 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1312 = f32[] add(%reduce_sum.1310, %reduce_sum.1311), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_423.514 (reduce_sum.1317: f32[], reduce_sum.1318: f32[]) -> f32[] {
  %reduce_sum.1317 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1318 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1319 = f32[] add(%reduce_sum.1317, %reduce_sum.1318), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_424.515 (reduce_sum.1324: f32[], reduce_sum.1325: f32[]) -> f32[] {
  %reduce_sum.1324 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1325 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1326 = f32[] add(%reduce_sum.1324, %reduce_sum.1325), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_425.516 (reduce_sum.1331: f32[], reduce_sum.1332: f32[]) -> f32[] {
  %reduce_sum.1331 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1332 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1333 = f32[] add(%reduce_sum.1331, %reduce_sum.1332), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_426.517 (reduce_sum.1338: f32[], reduce_sum.1339: f32[]) -> f32[] {
  %reduce_sum.1338 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1339 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1340 = f32[] add(%reduce_sum.1338, %reduce_sum.1339), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_427.518 (reduce_sum.1345: f32[], reduce_sum.1346: f32[]) -> f32[] {
  %reduce_sum.1345 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1346 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1347 = f32[] add(%reduce_sum.1345, %reduce_sum.1346), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_428.519 (reduce_sum.1352: f32[], reduce_sum.1353: f32[]) -> f32[] {
  %reduce_sum.1352 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1353 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1354 = f32[] add(%reduce_sum.1352, %reduce_sum.1353), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_429.520 (reduce_sum.1359: f32[], reduce_sum.1360: f32[]) -> f32[] {
  %reduce_sum.1359 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1360 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1361 = f32[] add(%reduce_sum.1359, %reduce_sum.1360), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_430.521 (reduce_sum.1366: f32[], reduce_sum.1367: f32[]) -> f32[] {
  %reduce_sum.1366 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1367 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1368 = f32[] add(%reduce_sum.1366, %reduce_sum.1367), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_431.522 (reduce_sum.1373: f32[], reduce_sum.1374: f32[]) -> f32[] {
  %reduce_sum.1373 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1374 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1375 = f32[] add(%reduce_sum.1373, %reduce_sum.1374), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_432.523 (reduce_sum.1380: f32[], reduce_sum.1381: f32[]) -> f32[] {
  %reduce_sum.1380 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1381 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1382 = f32[] add(%reduce_sum.1380, %reduce_sum.1381), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_433.524 (reduce_sum.1387: f32[], reduce_sum.1388: f32[]) -> f32[] {
  %reduce_sum.1387 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1388 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1389 = f32[] add(%reduce_sum.1387, %reduce_sum.1388), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_434.525 (reduce_sum.1394: f32[], reduce_sum.1395: f32[]) -> f32[] {
  %reduce_sum.1394 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1395 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1396 = f32[] add(%reduce_sum.1394, %reduce_sum.1395), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_435.526 (reduce_sum.1401: f32[], reduce_sum.1402: f32[]) -> f32[] {
  %reduce_sum.1401 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1402 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1403 = f32[] add(%reduce_sum.1401, %reduce_sum.1402), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_436.527 (reduce_sum.1408: f32[], reduce_sum.1409: f32[]) -> f32[] {
  %reduce_sum.1408 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1409 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1410 = f32[] add(%reduce_sum.1408, %reduce_sum.1409), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_437.528 (reduce_sum.1415: f32[], reduce_sum.1416: f32[]) -> f32[] {
  %reduce_sum.1415 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1416 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1417 = f32[] add(%reduce_sum.1415, %reduce_sum.1416), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_438.529 (reduce_sum.1422: f32[], reduce_sum.1423: f32[]) -> f32[] {
  %reduce_sum.1422 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1423 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1424 = f32[] add(%reduce_sum.1422, %reduce_sum.1423), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_439.530 (reduce_sum.1429: f32[], reduce_sum.1430: f32[]) -> f32[] {
  %reduce_sum.1429 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1430 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1431 = f32[] add(%reduce_sum.1429, %reduce_sum.1430), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_440.531 (reduce_sum.1436: f32[], reduce_sum.1437: f32[]) -> f32[] {
  %reduce_sum.1436 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1437 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1438 = f32[] add(%reduce_sum.1436, %reduce_sum.1437), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_441.532 (reduce_sum.1443: f32[], reduce_sum.1444: f32[]) -> f32[] {
  %reduce_sum.1443 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1444 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1445 = f32[] add(%reduce_sum.1443, %reduce_sum.1444), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_442.533 (reduce_sum.1450: f32[], reduce_sum.1451: f32[]) -> f32[] {
  %reduce_sum.1450 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1451 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1452 = f32[] add(%reduce_sum.1450, %reduce_sum.1451), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_443.534 (reduce_sum.1457: f32[], reduce_sum.1458: f32[]) -> f32[] {
  %reduce_sum.1457 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1458 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1459 = f32[] add(%reduce_sum.1457, %reduce_sum.1458), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_444.535 (reduce_sum.1464: f32[], reduce_sum.1465: f32[]) -> f32[] {
  %reduce_sum.1464 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1465 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1466 = f32[] add(%reduce_sum.1464, %reduce_sum.1465), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_445.536 (reduce_sum.1471: f32[], reduce_sum.1472: f32[]) -> f32[] {
  %reduce_sum.1471 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1472 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1473 = f32[] add(%reduce_sum.1471, %reduce_sum.1472), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_446.537 (reduce_sum.1478: f32[], reduce_sum.1479: f32[]) -> f32[] {
  %reduce_sum.1478 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1479 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1480 = f32[] add(%reduce_sum.1478, %reduce_sum.1479), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_447.538 (reduce_sum.1485: f32[], reduce_sum.1486: f32[]) -> f32[] {
  %reduce_sum.1485 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1486 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1487 = f32[] add(%reduce_sum.1485, %reduce_sum.1486), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_448.539 (reduce_sum.1492: f32[], reduce_sum.1493: f32[]) -> f32[] {
  %reduce_sum.1492 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1493 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1494 = f32[] add(%reduce_sum.1492, %reduce_sum.1493), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_449.540 (reduce_sum.1499: f32[], reduce_sum.1500: f32[]) -> f32[] {
  %reduce_sum.1499 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1500 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1501 = f32[] add(%reduce_sum.1499, %reduce_sum.1500), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_450.541 (reduce_sum.1506: f32[], reduce_sum.1507: f32[]) -> f32[] {
  %reduce_sum.1506 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1507 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1508 = f32[] add(%reduce_sum.1506, %reduce_sum.1507), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_451.542 (reduce_sum.1513: f32[], reduce_sum.1514: f32[]) -> f32[] {
  %reduce_sum.1513 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1514 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1515 = f32[] add(%reduce_sum.1513, %reduce_sum.1514), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_452.543 (reduce_sum.1520: f32[], reduce_sum.1521: f32[]) -> f32[] {
  %reduce_sum.1520 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1521 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1522 = f32[] add(%reduce_sum.1520, %reduce_sum.1521), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_453.544 (reduce_sum.1527: f32[], reduce_sum.1528: f32[]) -> f32[] {
  %reduce_sum.1527 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1528 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1529 = f32[] add(%reduce_sum.1527, %reduce_sum.1528), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_454.545 (reduce_sum.1534: f32[], reduce_sum.1535: f32[]) -> f32[] {
  %reduce_sum.1534 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1535 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1536 = f32[] add(%reduce_sum.1534, %reduce_sum.1535), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_455.546 (reduce_sum.1541: f32[], reduce_sum.1542: f32[]) -> f32[] {
  %reduce_sum.1541 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1542 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1543 = f32[] add(%reduce_sum.1541, %reduce_sum.1542), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_456.547 (reduce_sum.1548: f32[], reduce_sum.1549: f32[]) -> f32[] {
  %reduce_sum.1548 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1549 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1550 = f32[] add(%reduce_sum.1548, %reduce_sum.1549), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_457.548 (reduce_sum.1555: f32[], reduce_sum.1556: f32[]) -> f32[] {
  %reduce_sum.1555 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1556 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1557 = f32[] add(%reduce_sum.1555, %reduce_sum.1556), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_458.549 (reduce_sum.1562: f32[], reduce_sum.1563: f32[]) -> f32[] {
  %reduce_sum.1562 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1563 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1564 = f32[] add(%reduce_sum.1562, %reduce_sum.1563), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_459.550 (reduce_sum.1569: f32[], reduce_sum.1570: f32[]) -> f32[] {
  %reduce_sum.1569 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1570 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1571 = f32[] add(%reduce_sum.1569, %reduce_sum.1570), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_460.551 (reduce_sum.1576: f32[], reduce_sum.1577: f32[]) -> f32[] {
  %reduce_sum.1576 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1577 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1578 = f32[] add(%reduce_sum.1576, %reduce_sum.1577), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_461.552 (reduce_sum.1583: f32[], reduce_sum.1584: f32[]) -> f32[] {
  %reduce_sum.1583 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1584 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1585 = f32[] add(%reduce_sum.1583, %reduce_sum.1584), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_462.553 (reduce_sum.1590: f32[], reduce_sum.1591: f32[]) -> f32[] {
  %reduce_sum.1590 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1591 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1592 = f32[] add(%reduce_sum.1590, %reduce_sum.1591), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_463.554 (reduce_sum.1597: f32[], reduce_sum.1598: f32[]) -> f32[] {
  %reduce_sum.1597 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1598 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1599 = f32[] add(%reduce_sum.1597, %reduce_sum.1598), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_464.555 (reduce_sum.1604: f32[], reduce_sum.1605: f32[]) -> f32[] {
  %reduce_sum.1604 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1605 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1606 = f32[] add(%reduce_sum.1604, %reduce_sum.1605), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_465.556 (reduce_sum.1611: f32[], reduce_sum.1612: f32[]) -> f32[] {
  %reduce_sum.1611 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1612 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1613 = f32[] add(%reduce_sum.1611, %reduce_sum.1612), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_466.557 (reduce_sum.1618: f32[], reduce_sum.1619: f32[]) -> f32[] {
  %reduce_sum.1618 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1619 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1620 = f32[] add(%reduce_sum.1618, %reduce_sum.1619), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_467.558 (reduce_sum.1625: f32[], reduce_sum.1626: f32[]) -> f32[] {
  %reduce_sum.1625 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1626 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1627 = f32[] add(%reduce_sum.1625, %reduce_sum.1626), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_468.559 (reduce_sum.1632: f32[], reduce_sum.1633: f32[]) -> f32[] {
  %reduce_sum.1632 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1633 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1634 = f32[] add(%reduce_sum.1632, %reduce_sum.1633), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_469.560 (reduce_sum.1639: f32[], reduce_sum.1640: f32[]) -> f32[] {
  %reduce_sum.1639 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1640 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1641 = f32[] add(%reduce_sum.1639, %reduce_sum.1640), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_470.561 (reduce_sum.1646: f32[], reduce_sum.1647: f32[]) -> f32[] {
  %reduce_sum.1646 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1647 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1648 = f32[] add(%reduce_sum.1646, %reduce_sum.1647), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_471.562 (reduce_sum.1653: f32[], reduce_sum.1654: f32[]) -> f32[] {
  %reduce_sum.1653 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1654 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1655 = f32[] add(%reduce_sum.1653, %reduce_sum.1654), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_472.563 (reduce_sum.1660: f32[], reduce_sum.1661: f32[]) -> f32[] {
  %reduce_sum.1660 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1661 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1662 = f32[] add(%reduce_sum.1660, %reduce_sum.1661), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_473.564 (reduce_sum.1667: f32[], reduce_sum.1668: f32[]) -> f32[] {
  %reduce_sum.1667 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1668 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1669 = f32[] add(%reduce_sum.1667, %reduce_sum.1668), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_474.565 (reduce_sum.1674: f32[], reduce_sum.1675: f32[]) -> f32[] {
  %reduce_sum.1674 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1675 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1676 = f32[] add(%reduce_sum.1674, %reduce_sum.1675), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_475.566 (reduce_sum.1681: f32[], reduce_sum.1682: f32[]) -> f32[] {
  %reduce_sum.1681 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1682 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1683 = f32[] add(%reduce_sum.1681, %reduce_sum.1682), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_476.567 (reduce_sum.1688: f32[], reduce_sum.1689: f32[]) -> f32[] {
  %reduce_sum.1688 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1689 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1690 = f32[] add(%reduce_sum.1688, %reduce_sum.1689), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_477.568 (reduce_sum.1695: f32[], reduce_sum.1696: f32[]) -> f32[] {
  %reduce_sum.1695 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1696 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1697 = f32[] add(%reduce_sum.1695, %reduce_sum.1696), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_478.569 (reduce_sum.1702: f32[], reduce_sum.1703: f32[]) -> f32[] {
  %reduce_sum.1702 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1703 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1704 = f32[] add(%reduce_sum.1702, %reduce_sum.1703), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_479.570 (reduce_sum.1709: f32[], reduce_sum.1710: f32[]) -> f32[] {
  %reduce_sum.1709 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1710 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1711 = f32[] add(%reduce_sum.1709, %reduce_sum.1710), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_480.571 (reduce_sum.1716: f32[], reduce_sum.1717: f32[]) -> f32[] {
  %reduce_sum.1716 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1717 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1718 = f32[] add(%reduce_sum.1716, %reduce_sum.1717), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_481.572 (reduce_sum.1723: f32[], reduce_sum.1724: f32[]) -> f32[] {
  %reduce_sum.1723 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1724 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1725 = f32[] add(%reduce_sum.1723, %reduce_sum.1724), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_482.573 (reduce_sum.1730: f32[], reduce_sum.1731: f32[]) -> f32[] {
  %reduce_sum.1730 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1731 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1732 = f32[] add(%reduce_sum.1730, %reduce_sum.1731), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_483.574 (reduce_sum.1737: f32[], reduce_sum.1738: f32[]) -> f32[] {
  %reduce_sum.1737 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1738 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1739 = f32[] add(%reduce_sum.1737, %reduce_sum.1738), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_484.575 (reduce_sum.1744: f32[], reduce_sum.1745: f32[]) -> f32[] {
  %reduce_sum.1744 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1745 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1746 = f32[] add(%reduce_sum.1744, %reduce_sum.1745), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_485.576 (reduce_sum.1751: f32[], reduce_sum.1752: f32[]) -> f32[] {
  %reduce_sum.1751 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1752 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1753 = f32[] add(%reduce_sum.1751, %reduce_sum.1752), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_486.577 (reduce_sum.1758: f32[], reduce_sum.1759: f32[]) -> f32[] {
  %reduce_sum.1758 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1759 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1760 = f32[] add(%reduce_sum.1758, %reduce_sum.1759), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_487.578 (reduce_sum.1765: f32[], reduce_sum.1766: f32[]) -> f32[] {
  %reduce_sum.1765 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1766 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1767 = f32[] add(%reduce_sum.1765, %reduce_sum.1766), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_488.579 (reduce_sum.1772: f32[], reduce_sum.1773: f32[]) -> f32[] {
  %reduce_sum.1772 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1773 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1774 = f32[] add(%reduce_sum.1772, %reduce_sum.1773), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_489.580 (reduce_sum.1779: f32[], reduce_sum.1780: f32[]) -> f32[] {
  %reduce_sum.1779 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1780 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1781 = f32[] add(%reduce_sum.1779, %reduce_sum.1780), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_490.581 (reduce_sum.1786: f32[], reduce_sum.1787: f32[]) -> f32[] {
  %reduce_sum.1786 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1787 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1788 = f32[] add(%reduce_sum.1786, %reduce_sum.1787), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_491.582 (reduce_sum.1793: f32[], reduce_sum.1794: f32[]) -> f32[] {
  %reduce_sum.1793 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1794 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1795 = f32[] add(%reduce_sum.1793, %reduce_sum.1794), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_492.583 (reduce_sum.1800: f32[], reduce_sum.1801: f32[]) -> f32[] {
  %reduce_sum.1800 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1801 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1802 = f32[] add(%reduce_sum.1800, %reduce_sum.1801), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_493.584 (reduce_sum.1807: f32[], reduce_sum.1808: f32[]) -> f32[] {
  %reduce_sum.1807 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1808 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1809 = f32[] add(%reduce_sum.1807, %reduce_sum.1808), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_494.585 (reduce_sum.1814: f32[], reduce_sum.1815: f32[]) -> f32[] {
  %reduce_sum.1814 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1815 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1816 = f32[] add(%reduce_sum.1814, %reduce_sum.1815), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_495.586 (reduce_sum.1821: f32[], reduce_sum.1822: f32[]) -> f32[] {
  %reduce_sum.1821 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1822 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1823 = f32[] add(%reduce_sum.1821, %reduce_sum.1822), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_496.587 (reduce_sum.1828: f32[], reduce_sum.1829: f32[]) -> f32[] {
  %reduce_sum.1828 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1829 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1830 = f32[] add(%reduce_sum.1828, %reduce_sum.1829), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_497.588 (reduce_sum.1835: f32[], reduce_sum.1836: f32[]) -> f32[] {
  %reduce_sum.1835 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1836 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1837 = f32[] add(%reduce_sum.1835, %reduce_sum.1836), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_58.95 (reduce_sum.81: f32[], reduce_sum.82: f32[]) -> f32[] {
  %reduce_sum.81 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.82 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.83 = f32[] add(%reduce_sum.81, %reduce_sum.82), metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=575 source_end_line=575 source_column=10 source_end_column=49}
}

%region_59.96 (reduce_sum.88: f32[], reduce_sum.89: f32[]) -> f32[] {
  %reduce_sum.88 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.89 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.90 = f32[] add(%reduce_sum.88, %reduce_sum.89), metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=150 source_end_line=150 source_column=15 source_end_column=28}
}

%region_657.748 (reduce_sum.2955: f32[], reduce_sum.2956: f32[]) -> f32[] {
  %reduce_sum.2955 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2956 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2957 = f32[] add(%reduce_sum.2955, %reduce_sum.2956), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_658.749 (reduce_sum.2962: f32[], reduce_sum.2963: f32[]) -> f32[] {
  %reduce_sum.2962 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2963 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2964 = f32[] add(%reduce_sum.2962, %reduce_sum.2963), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_659.750 (reduce_sum.2969: f32[], reduce_sum.2970: f32[]) -> f32[] {
  %reduce_sum.2969 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2970 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2971 = f32[] add(%reduce_sum.2969, %reduce_sum.2970), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_660.751 (reduce_sum.2976: f32[], reduce_sum.2977: f32[]) -> f32[] {
  %reduce_sum.2976 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2977 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2978 = f32[] add(%reduce_sum.2976, %reduce_sum.2977), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_661.752 (reduce_sum.2983: f32[], reduce_sum.2984: f32[]) -> f32[] {
  %reduce_sum.2983 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2984 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2985 = f32[] add(%reduce_sum.2983, %reduce_sum.2984), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_662.753 (reduce_sum.2990: f32[], reduce_sum.2991: f32[]) -> f32[] {
  %reduce_sum.2990 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2991 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2992 = f32[] add(%reduce_sum.2990, %reduce_sum.2991), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_663.754 (reduce_sum.2997: f32[], reduce_sum.2998: f32[]) -> f32[] {
  %reduce_sum.2997 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2998 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2999 = f32[] add(%reduce_sum.2997, %reduce_sum.2998), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_664.755 (reduce_sum.3004: f32[], reduce_sum.3005: f32[]) -> f32[] {
  %reduce_sum.3004 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3005 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3006 = f32[] add(%reduce_sum.3004, %reduce_sum.3005), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_665.756 (reduce_sum.3011: f32[], reduce_sum.3012: f32[]) -> f32[] {
  %reduce_sum.3011 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3012 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3013 = f32[] add(%reduce_sum.3011, %reduce_sum.3012), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_666.757 (reduce_sum.3018: f32[], reduce_sum.3019: f32[]) -> f32[] {
  %reduce_sum.3018 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3019 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3020 = f32[] add(%reduce_sum.3018, %reduce_sum.3019), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_667.758 (reduce_sum.3025: f32[], reduce_sum.3026: f32[]) -> f32[] {
  %reduce_sum.3025 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3026 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3027 = f32[] add(%reduce_sum.3025, %reduce_sum.3026), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_668.759 (reduce_sum.3032: f32[], reduce_sum.3033: f32[]) -> f32[] {
  %reduce_sum.3032 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3033 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3034 = f32[] add(%reduce_sum.3032, %reduce_sum.3033), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_669.760 (reduce_sum.3039: f32[], reduce_sum.3040: f32[]) -> f32[] {
  %reduce_sum.3039 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3040 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3041 = f32[] add(%reduce_sum.3039, %reduce_sum.3040), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_670.761 (reduce_sum.3046: f32[], reduce_sum.3047: f32[]) -> f32[] {
  %reduce_sum.3046 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3047 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3048 = f32[] add(%reduce_sum.3046, %reduce_sum.3047), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_671.762 (reduce_sum.3053: f32[], reduce_sum.3054: f32[]) -> f32[] {
  %reduce_sum.3053 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3054 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3055 = f32[] add(%reduce_sum.3053, %reduce_sum.3054), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_672.763 (reduce_sum.3060: f32[], reduce_sum.3061: f32[]) -> f32[] {
  %reduce_sum.3060 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3061 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3062 = f32[] add(%reduce_sum.3060, %reduce_sum.3061), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_673.764 (reduce_sum.3067: f32[], reduce_sum.3068: f32[]) -> f32[] {
  %reduce_sum.3067 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3068 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3069 = f32[] add(%reduce_sum.3067, %reduce_sum.3068), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_674.765 (reduce_sum.3074: f32[], reduce_sum.3075: f32[]) -> f32[] {
  %reduce_sum.3074 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3075 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3076 = f32[] add(%reduce_sum.3074, %reduce_sum.3075), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_675.766 (reduce_sum.3081: f32[], reduce_sum.3082: f32[]) -> f32[] {
  %reduce_sum.3081 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3082 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3083 = f32[] add(%reduce_sum.3081, %reduce_sum.3082), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_676.767 (reduce_sum.3088: f32[], reduce_sum.3089: f32[]) -> f32[] {
  %reduce_sum.3088 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3089 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3090 = f32[] add(%reduce_sum.3088, %reduce_sum.3089), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_677.768 (reduce_sum.3095: f32[], reduce_sum.3096: f32[]) -> f32[] {
  %reduce_sum.3095 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3096 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3097 = f32[] add(%reduce_sum.3095, %reduce_sum.3096), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_678.769 (reduce_sum.3102: f32[], reduce_sum.3103: f32[]) -> f32[] {
  %reduce_sum.3102 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3103 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3104 = f32[] add(%reduce_sum.3102, %reduce_sum.3103), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_679.770 (reduce_sum.3109: f32[], reduce_sum.3110: f32[]) -> f32[] {
  %reduce_sum.3109 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3110 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3111 = f32[] add(%reduce_sum.3109, %reduce_sum.3110), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_680.771 (reduce_sum.3116: f32[], reduce_sum.3117: f32[]) -> f32[] {
  %reduce_sum.3116 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3117 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3118 = f32[] add(%reduce_sum.3116, %reduce_sum.3117), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_681.772 (reduce_sum.3123: f32[], reduce_sum.3124: f32[]) -> f32[] {
  %reduce_sum.3123 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3124 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3125 = f32[] add(%reduce_sum.3123, %reduce_sum.3124), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_682.773 (reduce_sum.3130: f32[], reduce_sum.3131: f32[]) -> f32[] {
  %reduce_sum.3130 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3131 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3132 = f32[] add(%reduce_sum.3130, %reduce_sum.3131), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_683.774 (reduce_sum.3137: f32[], reduce_sum.3138: f32[]) -> f32[] {
  %reduce_sum.3137 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3138 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3139 = f32[] add(%reduce_sum.3137, %reduce_sum.3138), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_684.775 (reduce_sum.3144: f32[], reduce_sum.3145: f32[]) -> f32[] {
  %reduce_sum.3144 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3145 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3146 = f32[] add(%reduce_sum.3144, %reduce_sum.3145), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_685.776 (reduce_sum.3151: f32[], reduce_sum.3152: f32[]) -> f32[] {
  %reduce_sum.3151 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3152 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3153 = f32[] add(%reduce_sum.3151, %reduce_sum.3152), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_686.777 (reduce_sum.3158: f32[], reduce_sum.3159: f32[]) -> f32[] {
  %reduce_sum.3158 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3159 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3160 = f32[] add(%reduce_sum.3158, %reduce_sum.3159), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_687.778 (reduce_sum.3165: f32[], reduce_sum.3166: f32[]) -> f32[] {
  %reduce_sum.3165 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3166 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3167 = f32[] add(%reduce_sum.3165, %reduce_sum.3166), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_688.779 (reduce_sum.3172: f32[], reduce_sum.3173: f32[]) -> f32[] {
  %reduce_sum.3172 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3173 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3174 = f32[] add(%reduce_sum.3172, %reduce_sum.3173), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_689.780 (reduce_sum.3179: f32[], reduce_sum.3180: f32[]) -> f32[] {
  %reduce_sum.3179 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3180 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3181 = f32[] add(%reduce_sum.3179, %reduce_sum.3180), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_690.781 (reduce_sum.3186: f32[], reduce_sum.3187: f32[]) -> f32[] {
  %reduce_sum.3186 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3187 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3188 = f32[] add(%reduce_sum.3186, %reduce_sum.3187), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_691.782 (reduce_sum.3193: f32[], reduce_sum.3194: f32[]) -> f32[] {
  %reduce_sum.3193 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3194 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3195 = f32[] add(%reduce_sum.3193, %reduce_sum.3194), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_692.783 (reduce_sum.3200: f32[], reduce_sum.3201: f32[]) -> f32[] {
  %reduce_sum.3200 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3201 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3202 = f32[] add(%reduce_sum.3200, %reduce_sum.3201), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_693.784 (reduce_sum.3207: f32[], reduce_sum.3208: f32[]) -> f32[] {
  %reduce_sum.3207 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3208 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3209 = f32[] add(%reduce_sum.3207, %reduce_sum.3208), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_694.785 (reduce_sum.3214: f32[], reduce_sum.3215: f32[]) -> f32[] {
  %reduce_sum.3214 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3215 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3216 = f32[] add(%reduce_sum.3214, %reduce_sum.3215), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_695.786 (reduce_sum.3221: f32[], reduce_sum.3222: f32[]) -> f32[] {
  %reduce_sum.3221 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3222 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3223 = f32[] add(%reduce_sum.3221, %reduce_sum.3222), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_696.787 (reduce_sum.3228: f32[], reduce_sum.3229: f32[]) -> f32[] {
  %reduce_sum.3228 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3229 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3230 = f32[] add(%reduce_sum.3228, %reduce_sum.3229), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_697.788 (reduce_sum.3235: f32[], reduce_sum.3236: f32[]) -> f32[] {
  %reduce_sum.3235 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3236 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3237 = f32[] add(%reduce_sum.3235, %reduce_sum.3236), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_698.789 (reduce_sum.3242: f32[], reduce_sum.3243: f32[]) -> f32[] {
  %reduce_sum.3242 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3243 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3244 = f32[] add(%reduce_sum.3242, %reduce_sum.3243), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_699.790 (reduce_sum.3249: f32[], reduce_sum.3250: f32[]) -> f32[] {
  %reduce_sum.3249 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3250 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3251 = f32[] add(%reduce_sum.3249, %reduce_sum.3250), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_700.791 (reduce_sum.3256: f32[], reduce_sum.3257: f32[]) -> f32[] {
  %reduce_sum.3256 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3257 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3258 = f32[] add(%reduce_sum.3256, %reduce_sum.3257), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_701.792 (reduce_sum.3263: f32[], reduce_sum.3264: f32[]) -> f32[] {
  %reduce_sum.3263 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3264 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3265 = f32[] add(%reduce_sum.3263, %reduce_sum.3264), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_702.793 (reduce_sum.3270: f32[], reduce_sum.3271: f32[]) -> f32[] {
  %reduce_sum.3270 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3271 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3272 = f32[] add(%reduce_sum.3270, %reduce_sum.3271), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_703.794 (reduce_sum.3277: f32[], reduce_sum.3278: f32[]) -> f32[] {
  %reduce_sum.3277 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3278 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3279 = f32[] add(%reduce_sum.3277, %reduce_sum.3278), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_704.795 (reduce_sum.3284: f32[], reduce_sum.3285: f32[]) -> f32[] {
  %reduce_sum.3284 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3285 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3286 = f32[] add(%reduce_sum.3284, %reduce_sum.3285), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_705.796 (reduce_sum.3291: f32[], reduce_sum.3292: f32[]) -> f32[] {
  %reduce_sum.3291 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3292 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3293 = f32[] add(%reduce_sum.3291, %reduce_sum.3292), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_706.797 (reduce_sum.3298: f32[], reduce_sum.3299: f32[]) -> f32[] {
  %reduce_sum.3298 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3299 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3300 = f32[] add(%reduce_sum.3298, %reduce_sum.3299), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_707.798 (reduce_sum.3305: f32[], reduce_sum.3306: f32[]) -> f32[] {
  %reduce_sum.3305 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3306 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3307 = f32[] add(%reduce_sum.3305, %reduce_sum.3306), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_708.799 (reduce_sum.3312: f32[], reduce_sum.3313: f32[]) -> f32[] {
  %reduce_sum.3312 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3313 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3314 = f32[] add(%reduce_sum.3312, %reduce_sum.3313), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_709.800 (reduce_sum.3319: f32[], reduce_sum.3320: f32[]) -> f32[] {
  %reduce_sum.3319 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3320 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3321 = f32[] add(%reduce_sum.3319, %reduce_sum.3320), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_710.801 (reduce_sum.3326: f32[], reduce_sum.3327: f32[]) -> f32[] {
  %reduce_sum.3326 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3327 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3328 = f32[] add(%reduce_sum.3326, %reduce_sum.3327), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_711.802 (reduce_sum.3333: f32[], reduce_sum.3334: f32[]) -> f32[] {
  %reduce_sum.3333 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3334 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3335 = f32[] add(%reduce_sum.3333, %reduce_sum.3334), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_712.803 (reduce_sum.3340: f32[], reduce_sum.3341: f32[]) -> f32[] {
  %reduce_sum.3340 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3341 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3342 = f32[] add(%reduce_sum.3340, %reduce_sum.3341), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_713.804 (reduce_sum.3347: f32[], reduce_sum.3348: f32[]) -> f32[] {
  %reduce_sum.3347 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3348 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3349 = f32[] add(%reduce_sum.3347, %reduce_sum.3348), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_714.805 (reduce_sum.3354: f32[], reduce_sum.3355: f32[]) -> f32[] {
  %reduce_sum.3354 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3355 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3356 = f32[] add(%reduce_sum.3354, %reduce_sum.3355), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_715.806 (reduce_sum.3361: f32[], reduce_sum.3362: f32[]) -> f32[] {
  %reduce_sum.3361 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3362 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3363 = f32[] add(%reduce_sum.3361, %reduce_sum.3362), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_716.807 (reduce_sum.3368: f32[], reduce_sum.3369: f32[]) -> f32[] {
  %reduce_sum.3368 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3369 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3370 = f32[] add(%reduce_sum.3368, %reduce_sum.3369), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_717.808 (reduce_sum.3375: f32[], reduce_sum.3376: f32[]) -> f32[] {
  %reduce_sum.3375 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3376 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3377 = f32[] add(%reduce_sum.3375, %reduce_sum.3376), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_718.809 (reduce_sum.3382: f32[], reduce_sum.3383: f32[]) -> f32[] {
  %reduce_sum.3382 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3383 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3384 = f32[] add(%reduce_sum.3382, %reduce_sum.3383), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_719.810 (reduce_sum.3389: f32[], reduce_sum.3390: f32[]) -> f32[] {
  %reduce_sum.3389 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3390 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3391 = f32[] add(%reduce_sum.3389, %reduce_sum.3390), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_720.811 (reduce_sum.3396: f32[], reduce_sum.3397: f32[]) -> f32[] {
  %reduce_sum.3396 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3397 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3398 = f32[] add(%reduce_sum.3396, %reduce_sum.3397), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_721.812 (reduce_sum.3403: f32[], reduce_sum.3404: f32[]) -> f32[] {
  %reduce_sum.3403 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3404 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3405 = f32[] add(%reduce_sum.3403, %reduce_sum.3404), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_722.813 (reduce_sum.3410: f32[], reduce_sum.3411: f32[]) -> f32[] {
  %reduce_sum.3410 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3411 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3412 = f32[] add(%reduce_sum.3410, %reduce_sum.3411), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_723.814 (reduce_sum.3417: f32[], reduce_sum.3418: f32[]) -> f32[] {
  %reduce_sum.3417 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3418 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3419 = f32[] add(%reduce_sum.3417, %reduce_sum.3418), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_724.815 (reduce_sum.3424: f32[], reduce_sum.3425: f32[]) -> f32[] {
  %reduce_sum.3424 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3425 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3426 = f32[] add(%reduce_sum.3424, %reduce_sum.3425), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_725.816 (reduce_sum.3431: f32[], reduce_sum.3432: f32[]) -> f32[] {
  %reduce_sum.3431 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3432 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3433 = f32[] add(%reduce_sum.3431, %reduce_sum.3432), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_726.817 (reduce_sum.3438: f32[], reduce_sum.3439: f32[]) -> f32[] {
  %reduce_sum.3438 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3439 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3440 = f32[] add(%reduce_sum.3438, %reduce_sum.3439), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_727.818 (reduce_sum.3445: f32[], reduce_sum.3446: f32[]) -> f32[] {
  %reduce_sum.3445 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3446 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3447 = f32[] add(%reduce_sum.3445, %reduce_sum.3446), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_728.819 (reduce_sum.3452: f32[], reduce_sum.3453: f32[]) -> f32[] {
  %reduce_sum.3452 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3453 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3454 = f32[] add(%reduce_sum.3452, %reduce_sum.3453), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_729.820 (reduce_sum.3459: f32[], reduce_sum.3460: f32[]) -> f32[] {
  %reduce_sum.3459 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3460 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3461 = f32[] add(%reduce_sum.3459, %reduce_sum.3460), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_730.821 (reduce_sum.3466: f32[], reduce_sum.3467: f32[]) -> f32[] {
  %reduce_sum.3466 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3467 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3468 = f32[] add(%reduce_sum.3466, %reduce_sum.3467), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_731.822 (reduce_sum.3473: f32[], reduce_sum.3474: f32[]) -> f32[] {
  %reduce_sum.3473 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3474 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3475 = f32[] add(%reduce_sum.3473, %reduce_sum.3474), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_732.823 (reduce_sum.3480: f32[], reduce_sum.3481: f32[]) -> f32[] {
  %reduce_sum.3480 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3481 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3482 = f32[] add(%reduce_sum.3480, %reduce_sum.3481), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_733.824 (reduce_sum.3487: f32[], reduce_sum.3488: f32[]) -> f32[] {
  %reduce_sum.3487 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3488 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3489 = f32[] add(%reduce_sum.3487, %reduce_sum.3488), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_734.825 (reduce_sum.3494: f32[], reduce_sum.3495: f32[]) -> f32[] {
  %reduce_sum.3494 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3495 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3496 = f32[] add(%reduce_sum.3494, %reduce_sum.3495), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_735.826 (reduce_sum.3501: f32[], reduce_sum.3502: f32[]) -> f32[] {
  %reduce_sum.3501 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3502 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3503 = f32[] add(%reduce_sum.3501, %reduce_sum.3502), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_736.827 (reduce_sum.3508: f32[], reduce_sum.3509: f32[]) -> f32[] {
  %reduce_sum.3508 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3509 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3510 = f32[] add(%reduce_sum.3508, %reduce_sum.3509), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_737.828 (reduce_sum.3515: f32[], reduce_sum.3516: f32[]) -> f32[] {
  %reduce_sum.3515 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3516 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3517 = f32[] add(%reduce_sum.3515, %reduce_sum.3516), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_738.829 (reduce_sum.3522: f32[], reduce_sum.3523: f32[]) -> f32[] {
  %reduce_sum.3522 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3523 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3524 = f32[] add(%reduce_sum.3522, %reduce_sum.3523), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_739.830 (reduce_sum.3529: f32[], reduce_sum.3530: f32[]) -> f32[] {
  %reduce_sum.3529 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3530 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3531 = f32[] add(%reduce_sum.3529, %reduce_sum.3530), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_740.831 (reduce_sum.3536: f32[], reduce_sum.3537: f32[]) -> f32[] {
  %reduce_sum.3536 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3537 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3538 = f32[] add(%reduce_sum.3536, %reduce_sum.3537), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_741.832 (reduce_sum.3543: f32[], reduce_sum.3544: f32[]) -> f32[] {
  %reduce_sum.3543 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3544 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3545 = f32[] add(%reduce_sum.3543, %reduce_sum.3544), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_742.833 (reduce_sum.3550: f32[], reduce_sum.3551: f32[]) -> f32[] {
  %reduce_sum.3550 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3551 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3552 = f32[] add(%reduce_sum.3550, %reduce_sum.3551), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_743.834 (reduce_sum.3557: f32[], reduce_sum.3558: f32[]) -> f32[] {
  %reduce_sum.3557 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3558 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3559 = f32[] add(%reduce_sum.3557, %reduce_sum.3558), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_744.835 (reduce_sum.3564: f32[], reduce_sum.3565: f32[]) -> f32[] {
  %reduce_sum.3564 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3565 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3566 = f32[] add(%reduce_sum.3564, %reduce_sum.3565), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_745.836 (reduce_sum.3571: f32[], reduce_sum.3572: f32[]) -> f32[] {
  %reduce_sum.3571 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3572 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3573 = f32[] add(%reduce_sum.3571, %reduce_sum.3572), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_746.837 (reduce_sum.3578: f32[], reduce_sum.3579: f32[]) -> f32[] {
  %reduce_sum.3578 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3579 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3580 = f32[] add(%reduce_sum.3578, %reduce_sum.3579), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_747.838 (reduce_sum.3585: f32[], reduce_sum.3586: f32[]) -> f32[] {
  %reduce_sum.3585 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3586 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3587 = f32[] add(%reduce_sum.3585, %reduce_sum.3586), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_748.839 (reduce_sum.3592: f32[], reduce_sum.3593: f32[]) -> f32[] {
  %reduce_sum.3592 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3593 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3594 = f32[] add(%reduce_sum.3592, %reduce_sum.3593), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_749.840 (reduce_sum.3599: f32[], reduce_sum.3600: f32[]) -> f32[] {
  %reduce_sum.3599 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3600 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3601 = f32[] add(%reduce_sum.3599, %reduce_sum.3600), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_750.841 (reduce_sum.3606: f32[], reduce_sum.3607: f32[]) -> f32[] {
  %reduce_sum.3606 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3607 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3608 = f32[] add(%reduce_sum.3606, %reduce_sum.3607), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_751.842 (reduce_sum.3613: f32[], reduce_sum.3614: f32[]) -> f32[] {
  %reduce_sum.3613 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3614 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3615 = f32[] add(%reduce_sum.3613, %reduce_sum.3614), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_752.843 (reduce_sum.3620: f32[], reduce_sum.3621: f32[]) -> f32[] {
  %reduce_sum.3620 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3621 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3622 = f32[] add(%reduce_sum.3620, %reduce_sum.3621), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_753.844 (reduce_sum.3627: f32[], reduce_sum.3628: f32[]) -> f32[] {
  %reduce_sum.3627 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3628 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3629 = f32[] add(%reduce_sum.3627, %reduce_sum.3628), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_754.845 (reduce_sum.3634: f32[], reduce_sum.3635: f32[]) -> f32[] {
  %reduce_sum.3634 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3635 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3636 = f32[] add(%reduce_sum.3634, %reduce_sum.3635), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_755.846 (reduce_sum.3641: f32[], reduce_sum.3642: f32[]) -> f32[] {
  %reduce_sum.3641 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3642 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3643 = f32[] add(%reduce_sum.3641, %reduce_sum.3642), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_756.847 (reduce_sum.3648: f32[], reduce_sum.3649: f32[]) -> f32[] {
  %reduce_sum.3648 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3649 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3650 = f32[] add(%reduce_sum.3648, %reduce_sum.3649), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_757.848 (reduce_sum.3655: f32[], reduce_sum.3656: f32[]) -> f32[] {
  %reduce_sum.3655 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3656 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3657 = f32[] add(%reduce_sum.3655, %reduce_sum.3656), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_758.849 (reduce_sum.3662: f32[], reduce_sum.3663: f32[]) -> f32[] {
  %reduce_sum.3662 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3663 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3664 = f32[] add(%reduce_sum.3662, %reduce_sum.3663), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_759.850 (reduce_sum.3669: f32[], reduce_sum.3670: f32[]) -> f32[] {
  %reduce_sum.3669 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3670 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3671 = f32[] add(%reduce_sum.3669, %reduce_sum.3670), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_760.851 (reduce_sum.3676: f32[], reduce_sum.3677: f32[]) -> f32[] {
  %reduce_sum.3676 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3677 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3678 = f32[] add(%reduce_sum.3676, %reduce_sum.3677), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_761.852 (reduce_sum.3683: f32[], reduce_sum.3684: f32[]) -> f32[] {
  %reduce_sum.3683 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3684 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3685 = f32[] add(%reduce_sum.3683, %reduce_sum.3684), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_762.853 (reduce_sum.3690: f32[], reduce_sum.3691: f32[]) -> f32[] {
  %reduce_sum.3690 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3691 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3692 = f32[] add(%reduce_sum.3690, %reduce_sum.3691), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_763.854 (reduce_sum.3697: f32[], reduce_sum.3698: f32[]) -> f32[] {
  %reduce_sum.3697 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3698 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3699 = f32[] add(%reduce_sum.3697, %reduce_sum.3698), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_764.855 (reduce_sum.3704: f32[], reduce_sum.3705: f32[]) -> f32[] {
  %reduce_sum.3704 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3705 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3706 = f32[] add(%reduce_sum.3704, %reduce_sum.3705), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_765.856 (reduce_sum.3711: f32[], reduce_sum.3712: f32[]) -> f32[] {
  %reduce_sum.3711 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3712 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3713 = f32[] add(%reduce_sum.3711, %reduce_sum.3712), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_766.857 (reduce_sum.3718: f32[], reduce_sum.3719: f32[]) -> f32[] {
  %reduce_sum.3718 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3719 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3720 = f32[] add(%reduce_sum.3718, %reduce_sum.3719), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_767.858 (reduce_sum.3725: f32[], reduce_sum.3726: f32[]) -> f32[] {
  %reduce_sum.3725 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3726 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3727 = f32[] add(%reduce_sum.3725, %reduce_sum.3726), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_768.859 (reduce_sum.3732: f32[], reduce_sum.3733: f32[]) -> f32[] {
  %reduce_sum.3732 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3733 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3734 = f32[] add(%reduce_sum.3732, %reduce_sum.3733), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_769.860 (reduce_sum.3739: f32[], reduce_sum.3740: f32[]) -> f32[] {
  %reduce_sum.3739 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3740 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3741 = f32[] add(%reduce_sum.3739, %reduce_sum.3740), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_770.861 (reduce_sum.3746: f32[], reduce_sum.3747: f32[]) -> f32[] {
  %reduce_sum.3746 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3747 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3748 = f32[] add(%reduce_sum.3746, %reduce_sum.3747), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_771.862 (reduce_sum.3753: f32[], reduce_sum.3754: f32[]) -> f32[] {
  %reduce_sum.3753 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3754 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3755 = f32[] add(%reduce_sum.3753, %reduce_sum.3754), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_772.863 (reduce_sum.3760: f32[], reduce_sum.3761: f32[]) -> f32[] {
  %reduce_sum.3760 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3761 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3762 = f32[] add(%reduce_sum.3760, %reduce_sum.3761), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_773.864 (reduce_sum.3767: f32[], reduce_sum.3768: f32[]) -> f32[] {
  %reduce_sum.3767 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3768 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3769 = f32[] add(%reduce_sum.3767, %reduce_sum.3768), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_774.865 (reduce_sum.3774: f32[], reduce_sum.3775: f32[]) -> f32[] {
  %reduce_sum.3774 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3775 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3776 = f32[] add(%reduce_sum.3774, %reduce_sum.3775), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_775.866 (reduce_sum.3781: f32[], reduce_sum.3782: f32[]) -> f32[] {
  %reduce_sum.3781 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3782 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3783 = f32[] add(%reduce_sum.3781, %reduce_sum.3782), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_776.867 (reduce_sum.3788: f32[], reduce_sum.3789: f32[]) -> f32[] {
  %reduce_sum.3788 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3789 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3790 = f32[] add(%reduce_sum.3788, %reduce_sum.3789), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_777.868 (reduce_sum.3795: f32[], reduce_sum.3796: f32[]) -> f32[] {
  %reduce_sum.3795 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3796 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3797 = f32[] add(%reduce_sum.3795, %reduce_sum.3796), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_778.869 (reduce_sum.3802: f32[], reduce_sum.3803: f32[]) -> f32[] {
  %reduce_sum.3802 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3803 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3804 = f32[] add(%reduce_sum.3802, %reduce_sum.3803), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_779.870 (reduce_sum.3809: f32[], reduce_sum.3810: f32[]) -> f32[] {
  %reduce_sum.3809 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3810 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3811 = f32[] add(%reduce_sum.3809, %reduce_sum.3810), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_780.871 (reduce_sum.3816: f32[], reduce_sum.3817: f32[]) -> f32[] {
  %reduce_sum.3816 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3817 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3818 = f32[] add(%reduce_sum.3816, %reduce_sum.3817), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_781.872 (reduce_sum.3823: f32[], reduce_sum.3824: f32[]) -> f32[] {
  %reduce_sum.3823 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3824 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3825 = f32[] add(%reduce_sum.3823, %reduce_sum.3824), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_782.873 (reduce_sum.3830: f32[], reduce_sum.3831: f32[]) -> f32[] {
  %reduce_sum.3830 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3831 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3832 = f32[] add(%reduce_sum.3830, %reduce_sum.3831), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_783.874 (reduce_sum.3837: f32[], reduce_sum.3838: f32[]) -> f32[] {
  %reduce_sum.3837 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3838 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3839 = f32[] add(%reduce_sum.3837, %reduce_sum.3838), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_784.875 (reduce_sum.3844: f32[], reduce_sum.3845: f32[]) -> f32[] {
  %reduce_sum.3844 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3845 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3846 = f32[] add(%reduce_sum.3844, %reduce_sum.3845), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_785.876 (reduce_sum.3851: f32[], reduce_sum.3852: f32[]) -> f32[] {
  %reduce_sum.3851 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3852 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3853 = f32[] add(%reduce_sum.3851, %reduce_sum.3852), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_786.877 (reduce_sum.3858: f32[], reduce_sum.3859: f32[]) -> f32[] {
  %reduce_sum.3858 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3859 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3860 = f32[] add(%reduce_sum.3858, %reduce_sum.3859), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_787.878 (reduce_sum.3865: f32[], reduce_sum.3866: f32[]) -> f32[] {
  %reduce_sum.3865 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3866 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3867 = f32[] add(%reduce_sum.3865, %reduce_sum.3866), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_788.879 (reduce_sum.3872: f32[], reduce_sum.3873: f32[]) -> f32[] {
  %reduce_sum.3872 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3873 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3874 = f32[] add(%reduce_sum.3872, %reduce_sum.3873), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_789.880 (reduce_sum.3879: f32[], reduce_sum.3880: f32[]) -> f32[] {
  %reduce_sum.3879 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3880 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3881 = f32[] add(%reduce_sum.3879, %reduce_sum.3880), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_790.881 (reduce_sum.3886: f32[], reduce_sum.3887: f32[]) -> f32[] {
  %reduce_sum.3886 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3887 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3888 = f32[] add(%reduce_sum.3886, %reduce_sum.3887), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_791.882 (reduce_sum.3893: f32[], reduce_sum.3894: f32[]) -> f32[] {
  %reduce_sum.3893 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3894 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3895 = f32[] add(%reduce_sum.3893, %reduce_sum.3894), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_792.883 (reduce_sum.3900: f32[], reduce_sum.3901: f32[]) -> f32[] {
  %reduce_sum.3900 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3901 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3902 = f32[] add(%reduce_sum.3900, %reduce_sum.3901), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_793.884 (reduce_sum.3907: f32[], reduce_sum.3908: f32[]) -> f32[] {
  %reduce_sum.3907 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3908 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3909 = f32[] add(%reduce_sum.3907, %reduce_sum.3908), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_794.885 (reduce_sum.3914: f32[], reduce_sum.3915: f32[]) -> f32[] {
  %reduce_sum.3914 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3915 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3916 = f32[] add(%reduce_sum.3914, %reduce_sum.3915), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_795.886 (reduce_sum.3921: f32[], reduce_sum.3922: f32[]) -> f32[] {
  %reduce_sum.3921 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3922 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3923 = f32[] add(%reduce_sum.3921, %reduce_sum.3922), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_796.887 (reduce_sum.3928: f32[], reduce_sum.3929: f32[]) -> f32[] {
  %reduce_sum.3928 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3929 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3930 = f32[] add(%reduce_sum.3928, %reduce_sum.3929), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_797.888 (reduce_sum.3935: f32[], reduce_sum.3936: f32[]) -> f32[] {
  %reduce_sum.3935 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3936 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3937 = f32[] add(%reduce_sum.3935, %reduce_sum.3936), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_798.889 (reduce_sum.3942: f32[], reduce_sum.3943: f32[]) -> f32[] {
  %reduce_sum.3942 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3943 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3944 = f32[] add(%reduce_sum.3942, %reduce_sum.3943), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_799.890 (reduce_sum.3949: f32[], reduce_sum.3950: f32[]) -> f32[] {
  %reduce_sum.3949 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3950 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3951 = f32[] add(%reduce_sum.3949, %reduce_sum.3950), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_800.891 (reduce_sum.3956: f32[], reduce_sum.3957: f32[]) -> f32[] {
  %reduce_sum.3956 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3957 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3958 = f32[] add(%reduce_sum.3956, %reduce_sum.3957), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_801.892 (reduce_sum.3963: f32[], reduce_sum.3964: f32[]) -> f32[] {
  %reduce_sum.3963 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3964 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3965 = f32[] add(%reduce_sum.3963, %reduce_sum.3964), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_802.893 (reduce_sum.3970: f32[], reduce_sum.3971: f32[]) -> f32[] {
  %reduce_sum.3970 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3971 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3972 = f32[] add(%reduce_sum.3970, %reduce_sum.3971), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_803.894 (reduce_sum.3977: f32[], reduce_sum.3978: f32[]) -> f32[] {
  %reduce_sum.3977 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3978 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3979 = f32[] add(%reduce_sum.3977, %reduce_sum.3978), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_804.895 (reduce_sum.3984: f32[], reduce_sum.3985: f32[]) -> f32[] {
  %reduce_sum.3984 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3985 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3986 = f32[] add(%reduce_sum.3984, %reduce_sum.3985), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_805.896 (reduce_sum.3991: f32[], reduce_sum.3992: f32[]) -> f32[] {
  %reduce_sum.3991 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3992 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.3993 = f32[] add(%reduce_sum.3991, %reduce_sum.3992), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_806.897 (reduce_sum.3998: f32[], reduce_sum.3999: f32[]) -> f32[] {
  %reduce_sum.3998 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.3999 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4000 = f32[] add(%reduce_sum.3998, %reduce_sum.3999), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_807.898 (reduce_sum.4005: f32[], reduce_sum.4006: f32[]) -> f32[] {
  %reduce_sum.4005 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4006 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4007 = f32[] add(%reduce_sum.4005, %reduce_sum.4006), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_808.899 (reduce_sum.4012: f32[], reduce_sum.4013: f32[]) -> f32[] {
  %reduce_sum.4012 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4013 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4014 = f32[] add(%reduce_sum.4012, %reduce_sum.4013), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_809.900 (reduce_sum.4019: f32[], reduce_sum.4020: f32[]) -> f32[] {
  %reduce_sum.4019 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4020 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4021 = f32[] add(%reduce_sum.4019, %reduce_sum.4020), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_810.901 (reduce_sum.4026: f32[], reduce_sum.4027: f32[]) -> f32[] {
  %reduce_sum.4026 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4027 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4028 = f32[] add(%reduce_sum.4026, %reduce_sum.4027), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_811.902 (reduce_sum.4033: f32[], reduce_sum.4034: f32[]) -> f32[] {
  %reduce_sum.4033 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4034 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4035 = f32[] add(%reduce_sum.4033, %reduce_sum.4034), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_812.903 (reduce_sum.4040: f32[], reduce_sum.4041: f32[]) -> f32[] {
  %reduce_sum.4040 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4041 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4042 = f32[] add(%reduce_sum.4040, %reduce_sum.4041), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_813.904 (reduce_sum.4047: f32[], reduce_sum.4048: f32[]) -> f32[] {
  %reduce_sum.4047 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4048 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4049 = f32[] add(%reduce_sum.4047, %reduce_sum.4048), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_814.905 (reduce_sum.4054: f32[], reduce_sum.4055: f32[]) -> f32[] {
  %reduce_sum.4054 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4055 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4056 = f32[] add(%reduce_sum.4054, %reduce_sum.4055), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_815.906 (reduce_sum.4061: f32[], reduce_sum.4062: f32[]) -> f32[] {
  %reduce_sum.4061 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.4062 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.4063 = f32[] add(%reduce_sum.4061, %reduce_sum.4062), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_498.589 (reduce_sum.1842: f32[], reduce_sum.1843: f32[]) -> f32[] {
  %reduce_sum.1842 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1843 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1844 = f32[] add(%reduce_sum.1842, %reduce_sum.1843), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_499.590 (reduce_sum.1849: f32[], reduce_sum.1850: f32[]) -> f32[] {
  %reduce_sum.1849 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1850 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1851 = f32[] add(%reduce_sum.1849, %reduce_sum.1850), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_500.591 (reduce_sum.1856: f32[], reduce_sum.1857: f32[]) -> f32[] {
  %reduce_sum.1856 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1857 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1858 = f32[] add(%reduce_sum.1856, %reduce_sum.1857), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_501.592 (reduce_sum.1863: f32[], reduce_sum.1864: f32[]) -> f32[] {
  %reduce_sum.1863 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1864 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1865 = f32[] add(%reduce_sum.1863, %reduce_sum.1864), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_502.593 (reduce_sum.1870: f32[], reduce_sum.1871: f32[]) -> f32[] {
  %reduce_sum.1870 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1871 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1872 = f32[] add(%reduce_sum.1870, %reduce_sum.1871), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_503.594 (reduce_sum.1877: f32[], reduce_sum.1878: f32[]) -> f32[] {
  %reduce_sum.1877 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1878 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1879 = f32[] add(%reduce_sum.1877, %reduce_sum.1878), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_504.595 (reduce_sum.1884: f32[], reduce_sum.1885: f32[]) -> f32[] {
  %reduce_sum.1884 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1885 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1886 = f32[] add(%reduce_sum.1884, %reduce_sum.1885), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_505.596 (reduce_sum.1891: f32[], reduce_sum.1892: f32[]) -> f32[] {
  %reduce_sum.1891 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1892 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1893 = f32[] add(%reduce_sum.1891, %reduce_sum.1892), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_506.597 (reduce_sum.1898: f32[], reduce_sum.1899: f32[]) -> f32[] {
  %reduce_sum.1898 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1899 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1900 = f32[] add(%reduce_sum.1898, %reduce_sum.1899), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_507.598 (reduce_sum.1905: f32[], reduce_sum.1906: f32[]) -> f32[] {
  %reduce_sum.1905 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1906 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1907 = f32[] add(%reduce_sum.1905, %reduce_sum.1906), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_508.599 (reduce_sum.1912: f32[], reduce_sum.1913: f32[]) -> f32[] {
  %reduce_sum.1912 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1913 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1914 = f32[] add(%reduce_sum.1912, %reduce_sum.1913), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_509.600 (reduce_sum.1919: f32[], reduce_sum.1920: f32[]) -> f32[] {
  %reduce_sum.1919 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1920 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1921 = f32[] add(%reduce_sum.1919, %reduce_sum.1920), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_510.601 (reduce_sum.1926: f32[], reduce_sum.1927: f32[]) -> f32[] {
  %reduce_sum.1926 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1927 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1928 = f32[] add(%reduce_sum.1926, %reduce_sum.1927), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_511.602 (reduce_sum.1933: f32[], reduce_sum.1934: f32[]) -> f32[] {
  %reduce_sum.1933 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1934 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1935 = f32[] add(%reduce_sum.1933, %reduce_sum.1934), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_512.603 (reduce_sum.1940: f32[], reduce_sum.1941: f32[]) -> f32[] {
  %reduce_sum.1940 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1941 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1942 = f32[] add(%reduce_sum.1940, %reduce_sum.1941), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_513.604 (reduce_sum.1947: f32[], reduce_sum.1948: f32[]) -> f32[] {
  %reduce_sum.1947 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1948 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1949 = f32[] add(%reduce_sum.1947, %reduce_sum.1948), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_514.605 (reduce_sum.1954: f32[], reduce_sum.1955: f32[]) -> f32[] {
  %reduce_sum.1954 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1955 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1956 = f32[] add(%reduce_sum.1954, %reduce_sum.1955), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_515.606 (reduce_sum.1961: f32[], reduce_sum.1962: f32[]) -> f32[] {
  %reduce_sum.1961 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1962 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1963 = f32[] add(%reduce_sum.1961, %reduce_sum.1962), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_516.607 (reduce_sum.1968: f32[], reduce_sum.1969: f32[]) -> f32[] {
  %reduce_sum.1968 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1969 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1970 = f32[] add(%reduce_sum.1968, %reduce_sum.1969), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_517.608 (reduce_sum.1975: f32[], reduce_sum.1976: f32[]) -> f32[] {
  %reduce_sum.1975 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1976 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1977 = f32[] add(%reduce_sum.1975, %reduce_sum.1976), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_518.609 (reduce_sum.1982: f32[], reduce_sum.1983: f32[]) -> f32[] {
  %reduce_sum.1982 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1983 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1984 = f32[] add(%reduce_sum.1982, %reduce_sum.1983), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_519.610 (reduce_sum.1989: f32[], reduce_sum.1990: f32[]) -> f32[] {
  %reduce_sum.1989 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1990 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1991 = f32[] add(%reduce_sum.1989, %reduce_sum.1990), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_520.611 (reduce_sum.1996: f32[], reduce_sum.1997: f32[]) -> f32[] {
  %reduce_sum.1996 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.1997 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.1998 = f32[] add(%reduce_sum.1996, %reduce_sum.1997), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_521.612 (reduce_sum.2003: f32[], reduce_sum.2004: f32[]) -> f32[] {
  %reduce_sum.2003 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2004 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2005 = f32[] add(%reduce_sum.2003, %reduce_sum.2004), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_522.613 (reduce_sum.2010: f32[], reduce_sum.2011: f32[]) -> f32[] {
  %reduce_sum.2010 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2011 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2012 = f32[] add(%reduce_sum.2010, %reduce_sum.2011), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_523.614 (reduce_sum.2017: f32[], reduce_sum.2018: f32[]) -> f32[] {
  %reduce_sum.2017 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2018 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2019 = f32[] add(%reduce_sum.2017, %reduce_sum.2018), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_524.615 (reduce_sum.2024: f32[], reduce_sum.2025: f32[]) -> f32[] {
  %reduce_sum.2024 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2025 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2026 = f32[] add(%reduce_sum.2024, %reduce_sum.2025), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_525.616 (reduce_sum.2031: f32[], reduce_sum.2032: f32[]) -> f32[] {
  %reduce_sum.2031 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2032 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2033 = f32[] add(%reduce_sum.2031, %reduce_sum.2032), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_526.617 (reduce_sum.2038: f32[], reduce_sum.2039: f32[]) -> f32[] {
  %reduce_sum.2038 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2039 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2040 = f32[] add(%reduce_sum.2038, %reduce_sum.2039), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_527.618 (reduce_sum.2045: f32[], reduce_sum.2046: f32[]) -> f32[] {
  %reduce_sum.2045 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2046 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2047 = f32[] add(%reduce_sum.2045, %reduce_sum.2046), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_528.619 (reduce_sum.2052: f32[], reduce_sum.2053: f32[]) -> f32[] {
  %reduce_sum.2052 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2053 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2054 = f32[] add(%reduce_sum.2052, %reduce_sum.2053), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_529.620 (reduce_sum.2059: f32[], reduce_sum.2060: f32[]) -> f32[] {
  %reduce_sum.2059 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2060 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2061 = f32[] add(%reduce_sum.2059, %reduce_sum.2060), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_530.621 (reduce_sum.2066: f32[], reduce_sum.2067: f32[]) -> f32[] {
  %reduce_sum.2066 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2067 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2068 = f32[] add(%reduce_sum.2066, %reduce_sum.2067), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_531.622 (reduce_sum.2073: f32[], reduce_sum.2074: f32[]) -> f32[] {
  %reduce_sum.2073 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2074 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2075 = f32[] add(%reduce_sum.2073, %reduce_sum.2074), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_532.623 (reduce_sum.2080: f32[], reduce_sum.2081: f32[]) -> f32[] {
  %reduce_sum.2080 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2081 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2082 = f32[] add(%reduce_sum.2080, %reduce_sum.2081), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_533.624 (reduce_sum.2087: f32[], reduce_sum.2088: f32[]) -> f32[] {
  %reduce_sum.2087 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2088 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2089 = f32[] add(%reduce_sum.2087, %reduce_sum.2088), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_534.625 (reduce_sum.2094: f32[], reduce_sum.2095: f32[]) -> f32[] {
  %reduce_sum.2094 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2095 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2096 = f32[] add(%reduce_sum.2094, %reduce_sum.2095), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_535.626 (reduce_sum.2101: f32[], reduce_sum.2102: f32[]) -> f32[] {
  %reduce_sum.2101 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2102 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2103 = f32[] add(%reduce_sum.2101, %reduce_sum.2102), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_536.627 (reduce_sum.2108: f32[], reduce_sum.2109: f32[]) -> f32[] {
  %reduce_sum.2108 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2109 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2110 = f32[] add(%reduce_sum.2108, %reduce_sum.2109), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_537.628 (reduce_sum.2115: f32[], reduce_sum.2116: f32[]) -> f32[] {
  %reduce_sum.2115 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2116 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2117 = f32[] add(%reduce_sum.2115, %reduce_sum.2116), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_538.629 (reduce_sum.2122: f32[], reduce_sum.2123: f32[]) -> f32[] {
  %reduce_sum.2122 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2123 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2124 = f32[] add(%reduce_sum.2122, %reduce_sum.2123), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_539.630 (reduce_sum.2129: f32[], reduce_sum.2130: f32[]) -> f32[] {
  %reduce_sum.2129 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2130 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2131 = f32[] add(%reduce_sum.2129, %reduce_sum.2130), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_540.631 (reduce_sum.2136: f32[], reduce_sum.2137: f32[]) -> f32[] {
  %reduce_sum.2136 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2137 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2138 = f32[] add(%reduce_sum.2136, %reduce_sum.2137), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_541.632 (reduce_sum.2143: f32[], reduce_sum.2144: f32[]) -> f32[] {
  %reduce_sum.2143 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2144 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2145 = f32[] add(%reduce_sum.2143, %reduce_sum.2144), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_542.633 (reduce_sum.2150: f32[], reduce_sum.2151: f32[]) -> f32[] {
  %reduce_sum.2150 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2151 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2152 = f32[] add(%reduce_sum.2150, %reduce_sum.2151), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_543.634 (reduce_sum.2157: f32[], reduce_sum.2158: f32[]) -> f32[] {
  %reduce_sum.2157 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2158 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2159 = f32[] add(%reduce_sum.2157, %reduce_sum.2158), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_544.635 (reduce_sum.2164: f32[], reduce_sum.2165: f32[]) -> f32[] {
  %reduce_sum.2164 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2165 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2166 = f32[] add(%reduce_sum.2164, %reduce_sum.2165), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_545.636 (reduce_sum.2171: f32[], reduce_sum.2172: f32[]) -> f32[] {
  %reduce_sum.2171 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2172 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2173 = f32[] add(%reduce_sum.2171, %reduce_sum.2172), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_546.637 (reduce_sum.2178: f32[], reduce_sum.2179: f32[]) -> f32[] {
  %reduce_sum.2178 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2179 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2180 = f32[] add(%reduce_sum.2178, %reduce_sum.2179), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_547.638 (reduce_sum.2185: f32[], reduce_sum.2186: f32[]) -> f32[] {
  %reduce_sum.2185 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2186 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2187 = f32[] add(%reduce_sum.2185, %reduce_sum.2186), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_548.639 (reduce_sum.2192: f32[], reduce_sum.2193: f32[]) -> f32[] {
  %reduce_sum.2192 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2193 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2194 = f32[] add(%reduce_sum.2192, %reduce_sum.2193), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_549.640 (reduce_sum.2199: f32[], reduce_sum.2200: f32[]) -> f32[] {
  %reduce_sum.2199 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2200 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2201 = f32[] add(%reduce_sum.2199, %reduce_sum.2200), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_550.641 (reduce_sum.2206: f32[], reduce_sum.2207: f32[]) -> f32[] {
  %reduce_sum.2206 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2207 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2208 = f32[] add(%reduce_sum.2206, %reduce_sum.2207), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_551.642 (reduce_sum.2213: f32[], reduce_sum.2214: f32[]) -> f32[] {
  %reduce_sum.2213 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2214 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2215 = f32[] add(%reduce_sum.2213, %reduce_sum.2214), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_552.643 (reduce_sum.2220: f32[], reduce_sum.2221: f32[]) -> f32[] {
  %reduce_sum.2220 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2221 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2222 = f32[] add(%reduce_sum.2220, %reduce_sum.2221), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_553.644 (reduce_sum.2227: f32[], reduce_sum.2228: f32[]) -> f32[] {
  %reduce_sum.2227 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2228 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2229 = f32[] add(%reduce_sum.2227, %reduce_sum.2228), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_554.645 (reduce_sum.2234: f32[], reduce_sum.2235: f32[]) -> f32[] {
  %reduce_sum.2234 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2235 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2236 = f32[] add(%reduce_sum.2234, %reduce_sum.2235), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_555.646 (reduce_sum.2241: f32[], reduce_sum.2242: f32[]) -> f32[] {
  %reduce_sum.2241 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2242 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2243 = f32[] add(%reduce_sum.2241, %reduce_sum.2242), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_556.647 (reduce_sum.2248: f32[], reduce_sum.2249: f32[]) -> f32[] {
  %reduce_sum.2248 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2249 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2250 = f32[] add(%reduce_sum.2248, %reduce_sum.2249), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_557.648 (reduce_sum.2255: f32[], reduce_sum.2256: f32[]) -> f32[] {
  %reduce_sum.2255 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2256 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2257 = f32[] add(%reduce_sum.2255, %reduce_sum.2256), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_558.649 (reduce_sum.2262: f32[], reduce_sum.2263: f32[]) -> f32[] {
  %reduce_sum.2262 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2263 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2264 = f32[] add(%reduce_sum.2262, %reduce_sum.2263), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_559.650 (reduce_sum.2269: f32[], reduce_sum.2270: f32[]) -> f32[] {
  %reduce_sum.2269 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2270 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2271 = f32[] add(%reduce_sum.2269, %reduce_sum.2270), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_560.651 (reduce_sum.2276: f32[], reduce_sum.2277: f32[]) -> f32[] {
  %reduce_sum.2276 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2277 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2278 = f32[] add(%reduce_sum.2276, %reduce_sum.2277), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_561.652 (reduce_sum.2283: f32[], reduce_sum.2284: f32[]) -> f32[] {
  %reduce_sum.2283 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2284 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2285 = f32[] add(%reduce_sum.2283, %reduce_sum.2284), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_562.653 (reduce_sum.2290: f32[], reduce_sum.2291: f32[]) -> f32[] {
  %reduce_sum.2290 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2291 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2292 = f32[] add(%reduce_sum.2290, %reduce_sum.2291), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_563.654 (reduce_sum.2297: f32[], reduce_sum.2298: f32[]) -> f32[] {
  %reduce_sum.2297 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2298 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2299 = f32[] add(%reduce_sum.2297, %reduce_sum.2298), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_564.655 (reduce_sum.2304: f32[], reduce_sum.2305: f32[]) -> f32[] {
  %reduce_sum.2304 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2305 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2306 = f32[] add(%reduce_sum.2304, %reduce_sum.2305), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_565.656 (reduce_sum.2311: f32[], reduce_sum.2312: f32[]) -> f32[] {
  %reduce_sum.2311 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2312 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2313 = f32[] add(%reduce_sum.2311, %reduce_sum.2312), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_566.657 (reduce_sum.2318: f32[], reduce_sum.2319: f32[]) -> f32[] {
  %reduce_sum.2318 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2319 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2320 = f32[] add(%reduce_sum.2318, %reduce_sum.2319), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_567.658 (reduce_sum.2325: f32[], reduce_sum.2326: f32[]) -> f32[] {
  %reduce_sum.2325 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2326 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2327 = f32[] add(%reduce_sum.2325, %reduce_sum.2326), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_568.659 (reduce_sum.2332: f32[], reduce_sum.2333: f32[]) -> f32[] {
  %reduce_sum.2332 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2333 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2334 = f32[] add(%reduce_sum.2332, %reduce_sum.2333), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_569.660 (reduce_sum.2339: f32[], reduce_sum.2340: f32[]) -> f32[] {
  %reduce_sum.2339 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2340 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2341 = f32[] add(%reduce_sum.2339, %reduce_sum.2340), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_570.661 (reduce_sum.2346: f32[], reduce_sum.2347: f32[]) -> f32[] {
  %reduce_sum.2346 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2347 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2348 = f32[] add(%reduce_sum.2346, %reduce_sum.2347), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_571.662 (reduce_sum.2353: f32[], reduce_sum.2354: f32[]) -> f32[] {
  %reduce_sum.2353 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2354 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2355 = f32[] add(%reduce_sum.2353, %reduce_sum.2354), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_572.663 (reduce_sum.2360: f32[], reduce_sum.2361: f32[]) -> f32[] {
  %reduce_sum.2360 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2361 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2362 = f32[] add(%reduce_sum.2360, %reduce_sum.2361), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_573.664 (reduce_sum.2367: f32[], reduce_sum.2368: f32[]) -> f32[] {
  %reduce_sum.2367 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2368 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2369 = f32[] add(%reduce_sum.2367, %reduce_sum.2368), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_574.665 (reduce_sum.2374: f32[], reduce_sum.2375: f32[]) -> f32[] {
  %reduce_sum.2374 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2375 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2376 = f32[] add(%reduce_sum.2374, %reduce_sum.2375), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_575.666 (reduce_sum.2381: f32[], reduce_sum.2382: f32[]) -> f32[] {
  %reduce_sum.2381 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2382 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2383 = f32[] add(%reduce_sum.2381, %reduce_sum.2382), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_576.667 (reduce_sum.2388: f32[], reduce_sum.2389: f32[]) -> f32[] {
  %reduce_sum.2388 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2389 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2390 = f32[] add(%reduce_sum.2388, %reduce_sum.2389), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_577.668 (reduce_sum.2395: f32[], reduce_sum.2396: f32[]) -> f32[] {
  %reduce_sum.2395 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2396 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2397 = f32[] add(%reduce_sum.2395, %reduce_sum.2396), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_578.669 (reduce_sum.2402: f32[], reduce_sum.2403: f32[]) -> f32[] {
  %reduce_sum.2402 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2403 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2404 = f32[] add(%reduce_sum.2402, %reduce_sum.2403), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_579.670 (reduce_sum.2409: f32[], reduce_sum.2410: f32[]) -> f32[] {
  %reduce_sum.2409 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2410 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2411 = f32[] add(%reduce_sum.2409, %reduce_sum.2410), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_580.671 (reduce_sum.2416: f32[], reduce_sum.2417: f32[]) -> f32[] {
  %reduce_sum.2416 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2417 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2418 = f32[] add(%reduce_sum.2416, %reduce_sum.2417), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_581.672 (reduce_sum.2423: f32[], reduce_sum.2424: f32[]) -> f32[] {
  %reduce_sum.2423 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2424 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2425 = f32[] add(%reduce_sum.2423, %reduce_sum.2424), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_582.673 (reduce_sum.2430: f32[], reduce_sum.2431: f32[]) -> f32[] {
  %reduce_sum.2430 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2431 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2432 = f32[] add(%reduce_sum.2430, %reduce_sum.2431), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_583.674 (reduce_sum.2437: f32[], reduce_sum.2438: f32[]) -> f32[] {
  %reduce_sum.2437 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2438 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2439 = f32[] add(%reduce_sum.2437, %reduce_sum.2438), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_584.675 (reduce_sum.2444: f32[], reduce_sum.2445: f32[]) -> f32[] {
  %reduce_sum.2444 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2445 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2446 = f32[] add(%reduce_sum.2444, %reduce_sum.2445), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_585.676 (reduce_sum.2451: f32[], reduce_sum.2452: f32[]) -> f32[] {
  %reduce_sum.2451 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2452 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2453 = f32[] add(%reduce_sum.2451, %reduce_sum.2452), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_586.677 (reduce_sum.2458: f32[], reduce_sum.2459: f32[]) -> f32[] {
  %reduce_sum.2458 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2459 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2460 = f32[] add(%reduce_sum.2458, %reduce_sum.2459), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_587.678 (reduce_sum.2465: f32[], reduce_sum.2466: f32[]) -> f32[] {
  %reduce_sum.2465 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2466 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2467 = f32[] add(%reduce_sum.2465, %reduce_sum.2466), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_588.679 (reduce_sum.2472: f32[], reduce_sum.2473: f32[]) -> f32[] {
  %reduce_sum.2472 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2473 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2474 = f32[] add(%reduce_sum.2472, %reduce_sum.2473), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_589.680 (reduce_sum.2479: f32[], reduce_sum.2480: f32[]) -> f32[] {
  %reduce_sum.2479 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2480 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2481 = f32[] add(%reduce_sum.2479, %reduce_sum.2480), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_590.681 (reduce_sum.2486: f32[], reduce_sum.2487: f32[]) -> f32[] {
  %reduce_sum.2486 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2487 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2488 = f32[] add(%reduce_sum.2486, %reduce_sum.2487), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_591.682 (reduce_sum.2493: f32[], reduce_sum.2494: f32[]) -> f32[] {
  %reduce_sum.2493 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2494 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2495 = f32[] add(%reduce_sum.2493, %reduce_sum.2494), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_592.683 (reduce_sum.2500: f32[], reduce_sum.2501: f32[]) -> f32[] {
  %reduce_sum.2500 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2501 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2502 = f32[] add(%reduce_sum.2500, %reduce_sum.2501), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_593.684 (reduce_sum.2507: f32[], reduce_sum.2508: f32[]) -> f32[] {
  %reduce_sum.2507 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2508 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2509 = f32[] add(%reduce_sum.2507, %reduce_sum.2508), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_594.685 (reduce_sum.2514: f32[], reduce_sum.2515: f32[]) -> f32[] {
  %reduce_sum.2514 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2515 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2516 = f32[] add(%reduce_sum.2514, %reduce_sum.2515), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_595.686 (reduce_sum.2521: f32[], reduce_sum.2522: f32[]) -> f32[] {
  %reduce_sum.2521 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2522 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2523 = f32[] add(%reduce_sum.2521, %reduce_sum.2522), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_596.687 (reduce_sum.2528: f32[], reduce_sum.2529: f32[]) -> f32[] {
  %reduce_sum.2528 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2529 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2530 = f32[] add(%reduce_sum.2528, %reduce_sum.2529), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_597.688 (reduce_sum.2535: f32[], reduce_sum.2536: f32[]) -> f32[] {
  %reduce_sum.2535 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2536 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2537 = f32[] add(%reduce_sum.2535, %reduce_sum.2536), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_598.689 (reduce_sum.2542: f32[], reduce_sum.2543: f32[]) -> f32[] {
  %reduce_sum.2542 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2543 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2544 = f32[] add(%reduce_sum.2542, %reduce_sum.2543), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_599.690 (reduce_sum.2549: f32[], reduce_sum.2550: f32[]) -> f32[] {
  %reduce_sum.2549 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2550 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2551 = f32[] add(%reduce_sum.2549, %reduce_sum.2550), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_600.691 (reduce_sum.2556: f32[], reduce_sum.2557: f32[]) -> f32[] {
  %reduce_sum.2556 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2557 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2558 = f32[] add(%reduce_sum.2556, %reduce_sum.2557), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_601.692 (reduce_sum.2563: f32[], reduce_sum.2564: f32[]) -> f32[] {
  %reduce_sum.2563 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2564 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2565 = f32[] add(%reduce_sum.2563, %reduce_sum.2564), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_602.693 (reduce_sum.2570: f32[], reduce_sum.2571: f32[]) -> f32[] {
  %reduce_sum.2570 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2571 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2572 = f32[] add(%reduce_sum.2570, %reduce_sum.2571), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_603.694 (reduce_sum.2577: f32[], reduce_sum.2578: f32[]) -> f32[] {
  %reduce_sum.2577 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2578 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2579 = f32[] add(%reduce_sum.2577, %reduce_sum.2578), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_604.695 (reduce_sum.2584: f32[], reduce_sum.2585: f32[]) -> f32[] {
  %reduce_sum.2584 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2585 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2586 = f32[] add(%reduce_sum.2584, %reduce_sum.2585), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_605.696 (reduce_sum.2591: f32[], reduce_sum.2592: f32[]) -> f32[] {
  %reduce_sum.2591 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2592 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2593 = f32[] add(%reduce_sum.2591, %reduce_sum.2592), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_606.697 (reduce_sum.2598: f32[], reduce_sum.2599: f32[]) -> f32[] {
  %reduce_sum.2598 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2599 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2600 = f32[] add(%reduce_sum.2598, %reduce_sum.2599), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_607.698 (reduce_sum.2605: f32[], reduce_sum.2606: f32[]) -> f32[] {
  %reduce_sum.2605 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2606 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2607 = f32[] add(%reduce_sum.2605, %reduce_sum.2606), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_608.699 (reduce_sum.2612: f32[], reduce_sum.2613: f32[]) -> f32[] {
  %reduce_sum.2612 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2613 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2614 = f32[] add(%reduce_sum.2612, %reduce_sum.2613), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_609.700 (reduce_sum.2619: f32[], reduce_sum.2620: f32[]) -> f32[] {
  %reduce_sum.2619 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2620 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2621 = f32[] add(%reduce_sum.2619, %reduce_sum.2620), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_610.701 (reduce_sum.2626: f32[], reduce_sum.2627: f32[]) -> f32[] {
  %reduce_sum.2626 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2627 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2628 = f32[] add(%reduce_sum.2626, %reduce_sum.2627), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_611.702 (reduce_sum.2633: f32[], reduce_sum.2634: f32[]) -> f32[] {
  %reduce_sum.2633 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2634 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2635 = f32[] add(%reduce_sum.2633, %reduce_sum.2634), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_612.703 (reduce_sum.2640: f32[], reduce_sum.2641: f32[]) -> f32[] {
  %reduce_sum.2640 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2641 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2642 = f32[] add(%reduce_sum.2640, %reduce_sum.2641), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_613.704 (reduce_sum.2647: f32[], reduce_sum.2648: f32[]) -> f32[] {
  %reduce_sum.2647 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2648 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2649 = f32[] add(%reduce_sum.2647, %reduce_sum.2648), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_614.705 (reduce_sum.2654: f32[], reduce_sum.2655: f32[]) -> f32[] {
  %reduce_sum.2654 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2655 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2656 = f32[] add(%reduce_sum.2654, %reduce_sum.2655), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_615.706 (reduce_sum.2661: f32[], reduce_sum.2662: f32[]) -> f32[] {
  %reduce_sum.2661 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2662 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2663 = f32[] add(%reduce_sum.2661, %reduce_sum.2662), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_616.707 (reduce_sum.2668: f32[], reduce_sum.2669: f32[]) -> f32[] {
  %reduce_sum.2668 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2669 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2670 = f32[] add(%reduce_sum.2668, %reduce_sum.2669), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_617.708 (reduce_sum.2675: f32[], reduce_sum.2676: f32[]) -> f32[] {
  %reduce_sum.2675 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2676 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2677 = f32[] add(%reduce_sum.2675, %reduce_sum.2676), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_618.709 (reduce_sum.2682: f32[], reduce_sum.2683: f32[]) -> f32[] {
  %reduce_sum.2682 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2683 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2684 = f32[] add(%reduce_sum.2682, %reduce_sum.2683), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_619.710 (reduce_sum.2689: f32[], reduce_sum.2690: f32[]) -> f32[] {
  %reduce_sum.2689 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2690 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2691 = f32[] add(%reduce_sum.2689, %reduce_sum.2690), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_620.711 (reduce_sum.2696: f32[], reduce_sum.2697: f32[]) -> f32[] {
  %reduce_sum.2696 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2697 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2698 = f32[] add(%reduce_sum.2696, %reduce_sum.2697), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_621.712 (reduce_sum.2703: f32[], reduce_sum.2704: f32[]) -> f32[] {
  %reduce_sum.2703 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2704 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2705 = f32[] add(%reduce_sum.2703, %reduce_sum.2704), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_622.713 (reduce_sum.2710: f32[], reduce_sum.2711: f32[]) -> f32[] {
  %reduce_sum.2710 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2711 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2712 = f32[] add(%reduce_sum.2710, %reduce_sum.2711), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_623.714 (reduce_sum.2717: f32[], reduce_sum.2718: f32[]) -> f32[] {
  %reduce_sum.2717 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2718 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2719 = f32[] add(%reduce_sum.2717, %reduce_sum.2718), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_624.715 (reduce_sum.2724: f32[], reduce_sum.2725: f32[]) -> f32[] {
  %reduce_sum.2724 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2725 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2726 = f32[] add(%reduce_sum.2724, %reduce_sum.2725), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_625.716 (reduce_sum.2731: f32[], reduce_sum.2732: f32[]) -> f32[] {
  %reduce_sum.2731 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2732 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2733 = f32[] add(%reduce_sum.2731, %reduce_sum.2732), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_626.717 (reduce_sum.2738: f32[], reduce_sum.2739: f32[]) -> f32[] {
  %reduce_sum.2738 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2739 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2740 = f32[] add(%reduce_sum.2738, %reduce_sum.2739), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_627.718 (reduce_sum.2745: f32[], reduce_sum.2746: f32[]) -> f32[] {
  %reduce_sum.2745 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2746 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2747 = f32[] add(%reduce_sum.2745, %reduce_sum.2746), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_628.719 (reduce_sum.2752: f32[], reduce_sum.2753: f32[]) -> f32[] {
  %reduce_sum.2752 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2753 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2754 = f32[] add(%reduce_sum.2752, %reduce_sum.2753), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_629.720 (reduce_sum.2759: f32[], reduce_sum.2760: f32[]) -> f32[] {
  %reduce_sum.2759 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2760 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2761 = f32[] add(%reduce_sum.2759, %reduce_sum.2760), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_630.721 (reduce_sum.2766: f32[], reduce_sum.2767: f32[]) -> f32[] {
  %reduce_sum.2766 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2767 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2768 = f32[] add(%reduce_sum.2766, %reduce_sum.2767), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_631.722 (reduce_sum.2773: f32[], reduce_sum.2774: f32[]) -> f32[] {
  %reduce_sum.2773 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2774 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2775 = f32[] add(%reduce_sum.2773, %reduce_sum.2774), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_632.723 (reduce_sum.2780: f32[], reduce_sum.2781: f32[]) -> f32[] {
  %reduce_sum.2780 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2781 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2782 = f32[] add(%reduce_sum.2780, %reduce_sum.2781), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_633.724 (reduce_sum.2787: f32[], reduce_sum.2788: f32[]) -> f32[] {
  %reduce_sum.2787 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2788 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2789 = f32[] add(%reduce_sum.2787, %reduce_sum.2788), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_634.725 (reduce_sum.2794: f32[], reduce_sum.2795: f32[]) -> f32[] {
  %reduce_sum.2794 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2795 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2796 = f32[] add(%reduce_sum.2794, %reduce_sum.2795), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_635.726 (reduce_sum.2801: f32[], reduce_sum.2802: f32[]) -> f32[] {
  %reduce_sum.2801 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2802 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2803 = f32[] add(%reduce_sum.2801, %reduce_sum.2802), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_636.727 (reduce_sum.2808: f32[], reduce_sum.2809: f32[]) -> f32[] {
  %reduce_sum.2808 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2809 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2810 = f32[] add(%reduce_sum.2808, %reduce_sum.2809), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_637.728 (reduce_sum.2815: f32[], reduce_sum.2816: f32[]) -> f32[] {
  %reduce_sum.2815 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2816 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2817 = f32[] add(%reduce_sum.2815, %reduce_sum.2816), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_638.729 (reduce_sum.2822: f32[], reduce_sum.2823: f32[]) -> f32[] {
  %reduce_sum.2822 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2823 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2824 = f32[] add(%reduce_sum.2822, %reduce_sum.2823), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_639.730 (reduce_sum.2829: f32[], reduce_sum.2830: f32[]) -> f32[] {
  %reduce_sum.2829 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2830 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2831 = f32[] add(%reduce_sum.2829, %reduce_sum.2830), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_640.731 (reduce_sum.2836: f32[], reduce_sum.2837: f32[]) -> f32[] {
  %reduce_sum.2836 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2837 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2838 = f32[] add(%reduce_sum.2836, %reduce_sum.2837), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_641.732 (reduce_sum.2843: f32[], reduce_sum.2844: f32[]) -> f32[] {
  %reduce_sum.2843 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2844 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2845 = f32[] add(%reduce_sum.2843, %reduce_sum.2844), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_642.733 (reduce_sum.2850: f32[], reduce_sum.2851: f32[]) -> f32[] {
  %reduce_sum.2850 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2851 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2852 = f32[] add(%reduce_sum.2850, %reduce_sum.2851), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_643.734 (reduce_sum.2857: f32[], reduce_sum.2858: f32[]) -> f32[] {
  %reduce_sum.2857 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2858 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2859 = f32[] add(%reduce_sum.2857, %reduce_sum.2858), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_644.735 (reduce_sum.2864: f32[], reduce_sum.2865: f32[]) -> f32[] {
  %reduce_sum.2864 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2865 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2866 = f32[] add(%reduce_sum.2864, %reduce_sum.2865), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_645.736 (reduce_sum.2871: f32[], reduce_sum.2872: f32[]) -> f32[] {
  %reduce_sum.2871 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2872 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2873 = f32[] add(%reduce_sum.2871, %reduce_sum.2872), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_646.737 (reduce_sum.2878: f32[], reduce_sum.2879: f32[]) -> f32[] {
  %reduce_sum.2878 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2879 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2880 = f32[] add(%reduce_sum.2878, %reduce_sum.2879), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_647.738 (reduce_sum.2885: f32[], reduce_sum.2886: f32[]) -> f32[] {
  %reduce_sum.2885 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2886 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2887 = f32[] add(%reduce_sum.2885, %reduce_sum.2886), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_648.739 (reduce_sum.2892: f32[], reduce_sum.2893: f32[]) -> f32[] {
  %reduce_sum.2892 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2893 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2894 = f32[] add(%reduce_sum.2892, %reduce_sum.2893), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_649.740 (reduce_sum.2899: f32[], reduce_sum.2900: f32[]) -> f32[] {
  %reduce_sum.2899 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2900 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2901 = f32[] add(%reduce_sum.2899, %reduce_sum.2900), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_650.741 (reduce_sum.2906: f32[], reduce_sum.2907: f32[]) -> f32[] {
  %reduce_sum.2906 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2907 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2908 = f32[] add(%reduce_sum.2906, %reduce_sum.2907), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_651.742 (reduce_sum.2913: f32[], reduce_sum.2914: f32[]) -> f32[] {
  %reduce_sum.2913 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2914 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2915 = f32[] add(%reduce_sum.2913, %reduce_sum.2914), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_652.743 (reduce_sum.2920: f32[], reduce_sum.2921: f32[]) -> f32[] {
  %reduce_sum.2920 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2921 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2922 = f32[] add(%reduce_sum.2920, %reduce_sum.2921), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_653.744 (reduce_sum.2927: f32[], reduce_sum.2928: f32[]) -> f32[] {
  %reduce_sum.2927 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2928 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2929 = f32[] add(%reduce_sum.2927, %reduce_sum.2928), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_654.745 (reduce_sum.2934: f32[], reduce_sum.2935: f32[]) -> f32[] {
  %reduce_sum.2934 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2935 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2936 = f32[] add(%reduce_sum.2934, %reduce_sum.2935), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_655.746 (reduce_sum.2941: f32[], reduce_sum.2942: f32[]) -> f32[] {
  %reduce_sum.2941 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2942 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2943 = f32[] add(%reduce_sum.2941, %reduce_sum.2942), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

%region_656.747 (reduce_sum.2948: f32[], reduce_sum.2949: f32[]) -> f32[] {
  %reduce_sum.2948 = f32[] parameter(0), metadata={op_name="reduce_sum"}
  %reduce_sum.2949 = f32[] parameter(1), metadata={op_name="reduce_sum"}
  ROOT %reduce_sum.2950 = f32[] add(%reduce_sum.2948, %reduce_sum.2949), metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
}

ENTRY %main.907 (state_step.1: s32[], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history2__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale2__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale2__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[1,1024], state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[1,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history2__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale2__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history2__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale2__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history2__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale2__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale2__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1: f32[2,1], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1: f32[2,1024], state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1: f32[2,1], state_params__params____decoder____decoder_norm____scale__.1: bf16[7168], state_params__params____decoder____dense_layers____mlp____wi_0____kernel__.1: bf16[7168,1,18432], state_params__params____decoder____dense_layers____mlp____wi_1____kernel__.1: bf16[7168,1,18432], state_params__params____decoder____dense_layers____mlp____wo____kernel__.1: bf16[18432,1,7168], state_params__params____decoder____dense_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,1], state_params__params____decoder____dense_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,1], state_params__params____decoder____dense_layers____self_attention____kv_norm____scale__.1: bf16[512,1], state_params__params____decoder____dense_layers____self_attention____out____kernel__.1: bf16[128,1,128,7168], state_params__params____decoder____dense_layers____self_attention____q_norm____scale__.1: bf16[1536,1], state_params__params____decoder____dense_layers____self_attention____wkv_a_kernel__.1: bf16[7168,1,576], state_params__params____decoder____dense_layers____self_attention____wkv_b____kernel__.1: bf16[512,1,128,256], state_params__params____decoder____dense_layers____self_attention____wq_a_kernel__.1: bf16[7168,1,1536], state_params__params____decoder____dense_layers____self_attention____wq_b____kernel__.1: bf16[1536,1,128,192], state_params__params____decoder____logits_dense____kernel__.1: bf16[7168,129280], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1: bf16[64,2], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1: bf16[7168,2,64], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1: bf16[64,2], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1: bf16[64,2,7168,2048], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1: bf16[64,2,7168,2048], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1: bf16[64,2,2048,7168], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1: bf16[7168,2,2048], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1: bf16[7168,2,2048], state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1: bf16[2048,2,7168], state_params__params____decoder____moe_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,2], state_params__params____decoder____moe_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,2], state_params__params____decoder____moe_layers____self_attention____kv_norm____scale__.1: bf16[512,2], state_params__params____decoder____moe_layers____self_attention____out____kernel__.1: bf16[128,2,128,7168], state_params__params____decoder____moe_layers____self_attention____q_norm____scale__.1: bf16[1536,2], state_params__params____decoder____moe_layers____self_attention____wkv_a_kernel__.1: bf16[7168,2,576], state_params__params____decoder____moe_layers____self_attention____wkv_b____kernel__.1: bf16[512,2,128,256], state_params__params____decoder____moe_layers____self_attention____wq_a_kernel__.1: bf16[7168,2,1536], state_params__params____decoder____moe_layers____self_attention____wq_b____kernel__.1: bf16[1536,2,128,192], state_params__params____token_embedder____embedding__.1: bf16[129280,7168], state_opt_state_0__count.1: s32[], state_opt_state_0__mu__decoder____decoder_norm____scale__.1: bf16[7168], state_opt_state_0__mu__decoder____dense_layers____mlp____wi_0____kernel__.1: bf16[7168,1,18432], state_opt_state_0__mu__decoder____dense_layers____mlp____wi_1____kernel__.1: bf16[7168,1,18432], state_opt_state_0__mu__decoder____dense_layers____mlp____wo____kernel__.1: bf16[18432,1,7168], state_opt_state_0__mu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,1], state_opt_state_0__mu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,1], state_opt_state_0__mu__decoder____dense_layers____self_attention____kv_norm____scale__.1: bf16[512,1], state_opt_state_0__mu__decoder____dense_layers____self_attention____out____kernel__.1: bf16[128,1,128,7168], state_opt_state_0__mu__decoder____dense_layers____self_attention____q_norm____scale__.1: bf16[1536,1], state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_a_kernel__.1: bf16[7168,1,576], state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_b____kernel__.1: bf16[512,1,128,256], state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_a_kernel__.1: bf16[7168,1,1536], state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_b____kernel__.1: bf16[1536,1,128,192], state_opt_state_0__mu__decoder____logits_dense____kernel__.1: bf16[7168,129280], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1: bf16[64,2], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1: bf16[7168,2,64], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1: bf16[64,2], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1: bf16[64,2,7168,2048], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1: bf16[64,2,7168,2048], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1: bf16[64,2,2048,7168], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1: bf16[7168,2,2048], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1: bf16[7168,2,2048], state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1: bf16[2048,2,7168], state_opt_state_0__mu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,2], state_opt_state_0__mu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,2], state_opt_state_0__mu__decoder____moe_layers____self_attention____kv_norm____scale__.1: bf16[512,2], state_opt_state_0__mu__decoder____moe_layers____self_attention____out____kernel__.1: bf16[128,2,128,7168], state_opt_state_0__mu__decoder____moe_layers____self_attention____q_norm____scale__.1: bf16[1536,2], state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_a_kernel__.1: bf16[7168,2,576], state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_b____kernel__.1: bf16[512,2,128,256], state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_a_kernel__.1: bf16[7168,2,1536], state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_b____kernel__.1: bf16[1536,2,128,192], state_opt_state_0__mu__token_embedder____embedding__.1: bf16[129280,7168], state_opt_state_0__nu__decoder____decoder_norm____scale__.1: bf16[7168], state_opt_state_0__nu__decoder____dense_layers____mlp____wi_0____kernel__.1: bf16[7168,1,18432], state_opt_state_0__nu__decoder____dense_layers____mlp____wi_1____kernel__.1: bf16[7168,1,18432], state_opt_state_0__nu__decoder____dense_layers____mlp____wo____kernel__.1: bf16[18432,1,7168], state_opt_state_0__nu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,1], state_opt_state_0__nu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,1], state_opt_state_0__nu__decoder____dense_layers____self_attention____kv_norm____scale__.1: bf16[512,1], state_opt_state_0__nu__decoder____dense_layers____self_attention____out____kernel__.1: bf16[128,1,128,7168], state_opt_state_0__nu__decoder____dense_layers____self_attention____q_norm____scale__.1: bf16[1536,1], state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_a_kernel__.1: bf16[7168,1,576], state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_b____kernel__.1: bf16[512,1,128,256], state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_a_kernel__.1: bf16[7168,1,1536], state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_b____kernel__.1: bf16[1536,1,128,192], state_opt_state_0__nu__decoder____logits_dense____kernel__.1: bf16[7168,129280], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1: bf16[64,2], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1: bf16[7168,2,64], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1: bf16[64,2], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1: bf16[64,2,7168,2048], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1: bf16[64,2,7168,2048], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1: bf16[64,2,2048,7168], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1: bf16[7168,2,2048], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1: bf16[7168,2,2048], state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1: bf16[2048,2,7168], state_opt_state_0__nu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1: bf16[7168,2], state_opt_state_0__nu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1: bf16[7168,2], state_opt_state_0__nu__decoder____moe_layers____self_attention____kv_norm____scale__.1: bf16[512,2], state_opt_state_0__nu__decoder____moe_layers____self_attention____out____kernel__.1: bf16[128,2,128,7168], state_opt_state_0__nu__decoder____moe_layers____self_attention____q_norm____scale__.1: bf16[1536,2], state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_a_kernel__.1: bf16[7168,2,576], state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_b____kernel__.1: bf16[512,2,128,256], state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_a_kernel__.1: bf16[7168,2,1536], state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_b____kernel__.1: bf16[1536,2,128,192], state_opt_state_0__nu__token_embedder____embedding__.1: bf16[129280,7168], state_opt_state_2__count.1: s32[], data__inputs__.1: s32[32,4096], data__inputs_position__.1: s32[32,4096], data__targets__.1: s32[32,4096], data__targets_segmentation__.1: s32[32,4096]) -> (s32[], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=5*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=10*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=15*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=20*/f32[1,1], f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], /*index=25*/f32[1,1024], f32[1,1024], f32[1,1], f32[1,1], f32[1,1024], /*index=30*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=35*/f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], /*index=40*/f32[1,1], f32[1,1024], f32[1,1], f32[1,1024], f32[1,1], /*index=45*/f32[1,1024], f32[1,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=50*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=55*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=60*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=65*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=70*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=75*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=80*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=85*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=90*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=95*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=100*/f32[2,1], f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], /*index=105*/f32[2,1024], f32[2,1024], f32[2,1], f32[2,1], f32[2,1024], /*index=110*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=115*/f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], /*index=120*/f32[2,1], f32[2,1024], f32[2,1], f32[2,1024], f32[2,1], /*index=125*/f32[2,1024], f32[2,1], bf16[7168], bf16[7168,1,18432], bf16[7168,1,18432], /*index=130*/bf16[18432,1,7168], bf16[7168,1], bf16[7168,1], bf16[512,1], bf16[128,1,128,7168], /*index=135*/bf16[1536,1], bf16[7168,1,576], bf16[512,1,128,256], bf16[7168,1,1536], bf16[1536,1,128,192], /*index=140*/bf16[7168,129280], bf16[64,2], bf16[7168,2,64], bf16[64,2], bf16[64,2,7168,2048], /*index=145*/bf16[64,2,7168,2048], bf16[64,2,2048,7168], bf16[7168,2,2048], bf16[7168,2,2048], bf16[2048,2,7168], /*index=150*/bf16[7168,2], bf16[7168,2], bf16[512,2], bf16[128,2,128,7168], bf16[1536,2], /*index=155*/bf16[7168,2,576], bf16[512,2,128,256], bf16[7168,2,1536], bf16[1536,2,128,192], bf16[129280,7168], /*index=160*/s32[], bf16[7168], bf16[7168,1,18432], bf16[7168,1,18432], bf16[18432,1,7168], /*index=165*/bf16[7168,1], bf16[7168,1], bf16[512,1], bf16[128,1,128,7168], bf16[1536,1], /*index=170*/bf16[7168,1,576], bf16[512,1,128,256], bf16[7168,1,1536], bf16[1536,1,128,192], bf16[7168,129280], /*index=175*/bf16[64,2], bf16[7168,2,64], bf16[64,2], bf16[64,2,7168,2048], bf16[64,2,7168,2048], /*index=180*/bf16[64,2,2048,7168], bf16[7168,2,2048], bf16[7168,2,2048], bf16[2048,2,7168], bf16[7168,2], /*index=185*/bf16[7168,2], bf16[512,2], bf16[128,2,128,7168], bf16[1536,2], bf16[7168,2,576], /*index=190*/bf16[512,2,128,256], bf16[7168,2,1536], bf16[1536,2,128,192], bf16[129280,7168], bf16[7168], /*index=195*/bf16[7168,1,18432], bf16[7168,1,18432], bf16[18432,1,7168], bf16[7168,1], bf16[7168,1], /*index=200*/bf16[512,1], bf16[128,1,128,7168], bf16[1536,1], bf16[7168,1,576], bf16[512,1,128,256], /*index=205*/bf16[7168,1,1536], bf16[1536,1,128,192], bf16[7168,129280], bf16[64,2], bf16[7168,2,64], /*index=210*/bf16[64,2], bf16[64,2,7168,2048], bf16[64,2,7168,2048], bf16[64,2,2048,7168], bf16[7168,2,2048], /*index=215*/bf16[7168,2,2048], bf16[2048,2,7168], bf16[7168,2], bf16[7168,2], bf16[512,2], /*index=220*/bf16[128,2,128,7168], bf16[1536,2], bf16[7168,2,576], bf16[512,2,128,256], bf16[7168,2,1536], /*index=225*/bf16[1536,2,128,192], bf16[129280,7168], s32[], f32[], f32[], /*index=230*/f32[], f32[], f32[], f32[], s32[]) {
  %constant.716 = s32[] constant(0)
  %state_params__params____token_embedder____embedding__.1 = bf16[129280,7168]{1,0} parameter(159), sharding={devices=[1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.params[\'params\'][\'token_embedder\'][\'embedding\']"}
  %data__inputs__.1 = s32[32,4096]{1,0} parameter(228), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}]>"}, metadata={op_name="data[\'inputs\']"}
  %constant.717 = s32[] constant(0)
  %broadcast.265 = s32[32,4096]{1,0} broadcast(%constant.717), dimensions={}
  %lt.21 = pred[32,4096]{1,0} compare(%data__inputs__.1, %broadcast.265), direction=LT, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/lt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %constant.695 = s32[] constant(129280)
  %add.834 = s32[32,4096]{1,0} broadcast(%constant.695), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %add.835 = s32[32,4096]{1,0} add(%data__inputs__.1, %add.834), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %select_n.103 = s32[32,4096]{1,0} select(%lt.21, %add.835, %data__inputs__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/select_n" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %broadcast_in_dim.1643 = s32[32,4096,1]{2,1,0} reshape(%select_n.103), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %gather.5 = bf16[32,4096,7168]{2,1,0} gather(%state_params__params____token_embedder____embedding__.1, %broadcast_in_dim.1643), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,7168}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/gather" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %sharding_constraint.192 = bf16[32,4096,7168]{2,1,0} custom-call(%gather.5), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %constant.686 = bf16[] constant(0)
  %broadcast.253 = bf16[1,32,4096,7168]{3,2,1,0} broadcast(%constant.686), dimensions={}
  %constant.685 = bf16[] constant(0)
  %broadcast_in_dim.1642 = bf16[1,32,4096,1536]{3,2,1,0} broadcast(%constant.685), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.684 = bf16[] constant(0)
  %broadcast_in_dim.1641 = bf16[1,32,4096,576]{3,2,1,0} broadcast(%constant.684), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.683 = bf16[] constant(0)
  %broadcast.252 = bf16[1,32,4096,18432]{3,2,1,0} broadcast(%constant.683), dimensions={}
  %state_params__params____decoder____dense_layers____mlp____wi_0____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(128), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'kernel\']"}
  %transpose.109 = bf16[1,7168,18432]{2,1,0} reshape(%state_params__params____decoder____dense_layers____mlp____wi_0____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____mlp____wi_1____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(129), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'kernel\']"}
  %transpose.110 = bf16[1,7168,18432]{2,1,0} reshape(%state_params__params____decoder____dense_layers____mlp____wi_1____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____mlp____wo____kernel__.1 = bf16[18432,1,7168]{2,1,0} parameter(130), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'kernel\']"}
  %transpose.111 = bf16[1,18432,7168]{2,1,0} reshape(%state_params__params____decoder____dense_layers____mlp____wo____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(131), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %transpose.112 = bf16[1,7168]{1,0} reshape(%state_params__params____decoder____dense_layers____post_self_attention_layer_norm____scale__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(132), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %transpose.113 = bf16[1,7168]{1,0} reshape(%state_params__params____decoder____dense_layers____pre_self_attention_layer_norm____scale__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____kv_norm____scale__.1 = bf16[512,1]{1,0} parameter(133), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %transpose.114 = bf16[1,512]{1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____kv_norm____scale__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____out____kernel__.1 = bf16[128,1,128,7168]{3,2,1,0} parameter(134), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %transpose.115 = bf16[1,128,128,7168]{3,2,1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____out____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____q_norm____scale__.1 = bf16[1536,1]{1,0} parameter(135), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %transpose.116 = bf16[1,1536]{1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____q_norm____scale__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,1,576]{2,1,0} parameter(136), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %transpose.117 = bf16[1,7168,576]{2,1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____wkv_a_kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____wkv_b____kernel__.1 = bf16[512,1,128,256]{3,2,1,0} parameter(137), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %transpose.118 = bf16[1,512,128,256]{3,2,1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____wkv_b____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____wq_a_kernel__.1 = bf16[7168,1,1536]{2,1,0} parameter(138), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %transpose.119 = bf16[1,7168,1536]{2,1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____wq_a_kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____dense_layers____self_attention____wq_b____kernel__.1 = bf16[1536,1,128,192]{3,2,1,0} parameter(139), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %transpose.120 = bf16[1,1536,128,192]{3,2,1,0} reshape(%state_params__params____decoder____dense_layers____self_attention____wq_b____kernel__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(1), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(2), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(3), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(4), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(7), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(8), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(9), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(10), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(13), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(14), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(15), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(16), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_amax_history__.1 = f32[1,1024]{1,0} parameter(19), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_scale__.1 = f32[1,1]{1,0} parameter(20), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(21), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history2__.1 = f32[1,1024]{1,0} parameter(22), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale__.1 = f32[1,1]{1,0} parameter(23), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale2__.1 = f32[1,1]{1,0} parameter(24), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(29), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(30), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(31), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(32), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(35), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(36), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(37), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(38), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[1,1024]{1,0} parameter(41), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[1,1]{1,0} parameter(42), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[1,1024]{1,0} parameter(43), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[1,1]{1,0} parameter(44), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %iota.50 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=622 source_end_line=622 source_column=8 source_end_column=67}
  %broadcast_in_dim.1644 = f32[163840,1]{1,0} reshape(%iota.50), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1549 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1644), dimensions={0,1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1550 = f32[163840]{0} reshape(%mul.1549), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1551 = f32[163840,32]{1,0} broadcast(%mul.1550), dimensions={0}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %constant.691 = f32[] constant(1)
  %broadcast.258 = f32[32]{0} broadcast(%constant.691), dimensions={}
  %constant.692 = f32[] constant(10000)
  %broadcast.259 = f32[32]{0} broadcast(%constant.692), dimensions={}
  %iota.48 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=45 source_end_column=87}
  %constant.694 = f32[] constant(2)
  %broadcast.261 = f32[32]{0} broadcast(%constant.694), dimensions={}
  %mul.1546 = f32[32]{0} multiply(%iota.48, %broadcast.261), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %constant.693 = f32[] constant(64)
  %broadcast.260 = f32[32]{0} broadcast(%constant.693), dimensions={}
  %div.1414 = f32[32]{0} divide(%mul.1546, %broadcast.260), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %pow.16 = f32[32]{0} power(%broadcast.259, %div.1414), metadata={op_name="jit(train_step)/dense_layers/self_attention/pow" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=19 source_end_column=110}
  %div.1415 = f32[32]{0} divide(%broadcast.258, %pow.16), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=12 source_end_column=111}
  %constant.688 = f32[] constant(40)
  %broadcast.255 = f32[32]{0} broadcast(%constant.688), dimensions={}
  %div.1417 = f32[32]{0} divide(%div.1415, %broadcast.255), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %iota.49 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %constant.690 = f32[] constant(10)
  %broadcast.257 = f32[32]{0} broadcast(%constant.690), dimensions={}
  %sub.65 = f32[32]{0} subtract(%iota.49, %broadcast.257), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %constant.689 = f32[] constant(13)
  %broadcast.256 = f32[32]{0} broadcast(%constant.689), dimensions={}
  %div.1416 = f32[32]{0} divide(%sub.65, %broadcast.256), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=18 source_end_column=86}
  %constant.714 = s32[] constant(1)
  %jit_clip_.221 = f32[32]{0} call(%div.1416, %constant.716, %constant.714), to_apply=%clip.1, metadata={op_name="jit(train_step)/dense_layers/self_attention/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %sub.66 = f32[32]{0} subtract(%broadcast.258, %jit_clip_.221), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=617 source_end_line=617 source_column=13 source_end_column=62}
  %sub.67 = f32[32]{0} subtract(%broadcast.258, %sub.66), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=40 source_end_column=50}
  %mul.1547 = f32[32]{0} multiply(%div.1417, %sub.67), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %mul.1548 = f32[32]{0} multiply(%div.1415, %sub.66), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=54 source_end_column=68}
  %add.836 = f32[32]{0} add(%mul.1547, %mul.1548), metadata={op_name="jit(train_step)/dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %broadcast_in_dim.1645 = f32[1,32]{1,0} reshape(%add.836), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1552 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1645), dimensions={0,1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1553 = f32[32]{0} reshape(%mul.1552), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1554 = f32[163840,32]{1,0} broadcast(%mul.1553), dimensions={1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1555 = f32[163840,32]{1,0} multiply(%mul.1551, %mul.1554), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %convert_element_type.1395 = c64[163840,32]{1,0} convert(%mul.1555), metadata={op_name="jit(train_step)/dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %constant.687 = c64[] constant((0, 1))
  %broadcast.254 = c64[163840,32]{1,0} broadcast(%constant.687), dimensions={}
  %mul.1556 = c64[163840,32]{1,0} multiply(%convert_element_type.1395, %broadcast.254), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %exp.241 = f32[163840,32]{1,0} real(%mul.1556), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.242 = f32[163840,32]{1,0} exponential(%exp.241), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %constant.698 = f32[] constant(inf)
  %broadcast.264 = f32[163840,32]{1,0} broadcast(%constant.698), dimensions={}
  %exp.243 = pred[163840,32]{1,0} compare(%exp.242, %broadcast.264), direction=EQ, metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %constant.697 = f32[] constant(0.5)
  %broadcast.263 = f32[163840,32]{1,0} broadcast(%constant.697), dimensions={}
  %exp.244 = f32[163840,32]{1,0} multiply(%exp.241, %broadcast.263), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.245 = f32[163840,32]{1,0} exponential(%exp.244), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.246 = f32[163840,32]{1,0} imag(%mul.1556), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.247 = f32[163840,32]{1,0} cosine(%exp.246), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.248 = f32[163840,32]{1,0} multiply(%exp.245, %exp.247), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.249 = f32[163840,32]{1,0} multiply(%exp.248, %exp.245), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.250 = f32[163840,32]{1,0} multiply(%exp.242, %exp.247), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.251 = f32[163840,32]{1,0} select(%exp.243, %exp.249, %exp.250), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %constant.696 = f32[] constant(0)
  %broadcast.262 = f32[163840,32]{1,0} broadcast(%constant.696), dimensions={}
  %exp.252 = pred[163840,32]{1,0} compare(%exp.246, %broadcast.262), direction=EQ, metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.253 = f32[163840,32]{1,0} sine(%exp.246), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.254 = f32[163840,32]{1,0} multiply(%exp.245, %exp.253), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.255 = f32[163840,32]{1,0} multiply(%exp.254, %exp.245), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.256 = f32[163840,32]{1,0} multiply(%exp.242, %exp.253), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.257 = f32[163840,32]{1,0} select(%exp.243, %exp.255, %exp.256), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.258 = f32[163840,32]{1,0} select(%exp.252, %broadcast.262, %exp.257), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.259 = c64[163840,32]{1,0} complex(%exp.251, %exp.258), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %data__inputs_position__.1 = s32[32,4096]{1,0} parameter(229), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}]>"}, metadata={op_name="data[\'inputs_position\']"}
  %jit__take_.12 = c64[32,4096,32]{2,1,0} call(%exp.259, %data__inputs_position__.1), to_apply=%_take.4, metadata={op_name="jit(train_step)/dense_layers/self_attention/jit(_take)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.1646 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.12), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=694 source_end_line=694 source_column=12 source_end_column=39}
  %iota.53 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=622 source_end_line=622 source_column=8 source_end_column=67}
  %broadcast_in_dim.1647 = f32[163840,1]{1,0} reshape(%iota.53), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1560 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1647), dimensions={0,1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1561 = f32[163840]{0} reshape(%mul.1560), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1562 = f32[163840,32]{1,0} broadcast(%mul.1561), dimensions={0}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %iota.51 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=45 source_end_column=87}
  %mul.1557 = f32[32]{0} multiply(%iota.51, %broadcast.261), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %div.1418 = f32[32]{0} divide(%mul.1557, %broadcast.260), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %pow.17 = f32[32]{0} power(%broadcast.259, %div.1418), metadata={op_name="jit(train_step)/dense_layers/self_attention/pow" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=19 source_end_column=110}
  %div.1419 = f32[32]{0} divide(%broadcast.258, %pow.17), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=12 source_end_column=111}
  %div.1421 = f32[32]{0} divide(%div.1419, %broadcast.255), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %iota.52 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/dense_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %sub.68 = f32[32]{0} subtract(%iota.52, %broadcast.257), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %div.1420 = f32[32]{0} divide(%sub.68, %broadcast.256), metadata={op_name="jit(train_step)/dense_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=18 source_end_column=86}
  %jit_clip_.222 = f32[32]{0} call(%div.1420, %constant.716, %constant.714), to_apply=%clip.1, metadata={op_name="jit(train_step)/dense_layers/self_attention/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %sub.69 = f32[32]{0} subtract(%broadcast.258, %jit_clip_.222), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=617 source_end_line=617 source_column=13 source_end_column=62}
  %sub.70 = f32[32]{0} subtract(%broadcast.258, %sub.69), metadata={op_name="jit(train_step)/dense_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=40 source_end_column=50}
  %mul.1558 = f32[32]{0} multiply(%div.1421, %sub.70), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %mul.1559 = f32[32]{0} multiply(%div.1419, %sub.69), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=54 source_end_column=68}
  %add.837 = f32[32]{0} add(%mul.1558, %mul.1559), metadata={op_name="jit(train_step)/dense_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %broadcast_in_dim.1648 = f32[1,32]{1,0} reshape(%add.837), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1563 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1648), dimensions={0,1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1564 = f32[32]{0} reshape(%mul.1563), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1565 = f32[163840,32]{1,0} broadcast(%mul.1564), dimensions={1}, metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1566 = f32[163840,32]{1,0} multiply(%mul.1562, %mul.1565), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %convert_element_type.1396 = c64[163840,32]{1,0} convert(%mul.1566), metadata={op_name="jit(train_step)/dense_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %mul.1567 = c64[163840,32]{1,0} multiply(%convert_element_type.1396, %broadcast.254), metadata={op_name="jit(train_step)/dense_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %exp.260 = f32[163840,32]{1,0} real(%mul.1567), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.261 = f32[163840,32]{1,0} exponential(%exp.260), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.262 = pred[163840,32]{1,0} compare(%exp.261, %broadcast.264), direction=EQ, metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.263 = f32[163840,32]{1,0} multiply(%exp.260, %broadcast.263), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.264 = f32[163840,32]{1,0} exponential(%exp.263), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.265 = f32[163840,32]{1,0} imag(%mul.1567), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.266 = f32[163840,32]{1,0} cosine(%exp.265), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.267 = f32[163840,32]{1,0} multiply(%exp.264, %exp.266), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.268 = f32[163840,32]{1,0} multiply(%exp.267, %exp.264), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.269 = f32[163840,32]{1,0} multiply(%exp.261, %exp.266), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.270 = f32[163840,32]{1,0} select(%exp.262, %exp.268, %exp.269), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.271 = pred[163840,32]{1,0} compare(%exp.265, %broadcast.262), direction=EQ, metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.272 = f32[163840,32]{1,0} sine(%exp.265), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.273 = f32[163840,32]{1,0} multiply(%exp.264, %exp.272), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.274 = f32[163840,32]{1,0} multiply(%exp.273, %exp.264), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.275 = f32[163840,32]{1,0} multiply(%exp.261, %exp.272), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.276 = f32[163840,32]{1,0} select(%exp.262, %exp.274, %exp.275), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.277 = f32[163840,32]{1,0} select(%exp.271, %broadcast.262, %exp.276), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.278 = c64[163840,32]{1,0} complex(%exp.270, %exp.277), metadata={op_name="jit(train_step)/dense_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %jit__take_.13 = c64[32,4096,32]{2,1,0} call(%exp.278, %data__inputs_position__.1), to_apply=%_take.4, metadata={op_name="jit(train_step)/dense_layers/self_attention/jit(_take)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.1649 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.13), metadata={op_name="jit(train_step)/dense_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=694 source_end_line=694 source_column=12 source_end_column=39}
  %while.185 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, /*index=5*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, /*index=10*/bf16[1,18432,7168]{2,1,0}, bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, /*index=15*/bf16[1,1536]{1,0}, bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=40*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/c64[32,4096,1,32]{3,2,1,0}, c64[32,4096,1,32]{3,2,1,0}) tuple(%constant.716, %sharding_constraint.192, %broadcast.253, %broadcast_in_dim.1642, %broadcast_in_dim.1641, /*index=5*/%broadcast.253, %broadcast.252, %broadcast.252, %transpose.109, %transpose.110, /*index=10*/%transpose.111, %transpose.112, %transpose.113, %transpose.114, %transpose.115, /*index=15*/%transpose.116, %transpose.117, %transpose.118, %transpose.119, %transpose.120, /*index=20*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1, /*index=25*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_scale__.1, /*index=30*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history__.1, /*index=35*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale2__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1, /*index=40*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=45*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=50*/%broadcast_in_dim.1646, %broadcast_in_dim.1649), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.186 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, /*index=5*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, /*index=10*/bf16[1,18432,7168]{2,1,0}, bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, /*index=15*/bf16[1,1536]{1,0}, bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=40*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/c64[32,4096,1,32]{3,2,1,0}, c64[32,4096,1,32]{3,2,1,0}) while(%while.185), condition=%region_21.41, body=%region_1.40, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.187 = s32[] get-tuple-element(%while.186), index=0, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.188 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%while.186), index=1, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.682 = bf16[] constant(0)
  %broadcast.251 = bf16[2,32,4096,7168]{3,2,1,0} broadcast(%constant.682), dimensions={}
  %constant.681 = bf16[] constant(0)
  %broadcast_in_dim.1640 = bf16[2,32,4096,1536]{3,2,1,0} broadcast(%constant.681), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.680 = bf16[] constant(0)
  %broadcast_in_dim.1639 = bf16[2,32,4096,576]{3,2,1,0} broadcast(%constant.680), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.679 = bf16[] constant(0)
  %broadcast.250 = bf16[2,64,32,512,2048]{4,3,2,1,0} broadcast(%constant.679), dimensions={}
  %constant.678 = bf16[] constant(0)
  %broadcast.249 = bf16[2,32,4096,2048]{3,2,1,0} broadcast(%constant.678), dimensions={}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1 = bf16[7168,2,64]{2,1,0} parameter(142), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'kernel\']"}
  %transpose.121 = bf16[2,7168,64]{2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1 = bf16[64,2]{1,0} parameter(143), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'router_bias\']"}
  %transpose.122 = bf16[2,64]{0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1), dimensions={1,0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(144), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_0\']"}
  %transpose.123 = bf16[2,64,7168,2048]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(145), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_1\']"}
  %transpose.124 = bf16[2,64,7168,2048]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1 = bf16[64,2,2048,7168]{3,2,1,0} parameter(146), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wo\']"}
  %transpose.125 = bf16[2,64,2048,7168]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(147), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'kernel\']"}
  %transpose.126 = bf16[2,7168,2048]{2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(148), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'kernel\']"}
  %transpose.127 = bf16[2,7168,2048]{2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1 = bf16[2048,2,7168]{2,1,0} parameter(149), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'kernel\']"}
  %transpose.128 = bf16[2,2048,7168]{2,0,1} transpose(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(150), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %transpose.129 = bf16[2,7168]{0,1} transpose(%state_params__params____decoder____moe_layers____post_self_attention_layer_norm____scale__.1), dimensions={1,0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(151), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %transpose.130 = bf16[2,7168]{0,1} transpose(%state_params__params____decoder____moe_layers____pre_self_attention_layer_norm____scale__.1), dimensions={1,0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____kv_norm____scale__.1 = bf16[512,2]{1,0} parameter(152), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %transpose.131 = bf16[2,512]{0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____kv_norm____scale__.1), dimensions={1,0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____out____kernel__.1 = bf16[128,2,128,7168]{3,2,1,0} parameter(153), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %transpose.132 = bf16[2,128,128,7168]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____out____kernel__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____q_norm____scale__.1 = bf16[1536,2]{1,0} parameter(154), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %transpose.133 = bf16[2,1536]{0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____q_norm____scale__.1), dimensions={1,0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,2,576]{2,1,0} parameter(155), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %transpose.134 = bf16[2,7168,576]{2,0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____wkv_a_kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____wkv_b____kernel__.1 = bf16[512,2,128,256]{3,2,1,0} parameter(156), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %transpose.135 = bf16[2,512,128,256]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____wkv_b____kernel__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____wq_a_kernel__.1 = bf16[7168,2,1536]{2,1,0} parameter(157), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %transpose.136 = bf16[2,7168,1536]{2,0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____wq_a_kernel__.1), dimensions={1,0,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params__params____decoder____moe_layers____self_attention____wq_b____kernel__.1 = bf16[1536,2,128,192]{3,2,1,0} parameter(158), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %transpose.137 = bf16[2,1536,128,192]{3,2,0,1} transpose(%state_params__params____decoder____moe_layers____self_attention____wq_b____kernel__.1), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(47), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(48), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(49), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(50), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_amax_history__.1 = f32[2,1024]{1,0} parameter(53), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_scale__.1 = f32[2,1]{1,0} parameter(54), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(55), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_scale__.1 = f32[2,1]{1,0} parameter(56), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_amax_history__.1 = f32[2,1024]{1,0} parameter(59), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_scale__.1 = f32[2,1]{1,0} parameter(60), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(61), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history2__.1 = f32[2,1024]{1,0} parameter(62), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'kernel_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale__.1 = f32[2,1]{1,0} parameter(63), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale2__.1 = f32[2,1]{1,0} parameter(64), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'kernel_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_amax_history__.1 = f32[2,1024]{1,0} parameter(69), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_scale__.1 = f32[2,1]{1,0} parameter(70), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(71), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_scale__.1 = f32[2,1]{1,0} parameter(72), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_amax_history__.1 = f32[2,1024]{1,0} parameter(75), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_scale__.1 = f32[2,1]{1,0} parameter(76), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(77), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_scale__.1 = f32[2,1]{1,0} parameter(78), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(81), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(82), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(83), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(84), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(87), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(88), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(89), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(90), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(93), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(94), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(95), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(96), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_amax_history__.1 = f32[2,1024]{1,0} parameter(99), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_scale__.1 = f32[2,1]{1,0} parameter(100), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(101), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history2__.1 = f32[2,1024]{1,0} parameter(102), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale__.1 = f32[2,1]{1,0} parameter(103), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale2__.1 = f32[2,1]{1,0} parameter(104), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'kernel_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(109), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(110), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(111), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(112), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(115), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(116), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(117), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(118), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1 = f32[2,1024]{1,0} parameter(121), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1 = f32[2,1]{1,0} parameter(122), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'input_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1 = f32[2,1024]{1,0} parameter(123), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1 = f32[2,1]{1,0} parameter(124), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'kernel_scale\']"}
  %iota.56 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=622 source_end_line=622 source_column=8 source_end_column=67}
  %broadcast_in_dim.1650 = f32[163840,1]{1,0} reshape(%iota.56), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1571 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1650), dimensions={0,1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1572 = f32[163840]{0} reshape(%mul.1571), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1573 = f32[163840,32]{1,0} broadcast(%mul.1572), dimensions={0}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %iota.54 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=45 source_end_column=87}
  %mul.1568 = f32[32]{0} multiply(%iota.54, %broadcast.261), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %div.1422 = f32[32]{0} divide(%mul.1568, %broadcast.260), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %pow.18 = f32[32]{0} power(%broadcast.259, %div.1422), metadata={op_name="jit(train_step)/moe_layers/self_attention/pow" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=19 source_end_column=110}
  %div.1423 = f32[32]{0} divide(%broadcast.258, %pow.18), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=12 source_end_column=111}
  %div.1425 = f32[32]{0} divide(%div.1423, %broadcast.255), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %iota.55 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %sub.71 = f32[32]{0} subtract(%iota.55, %broadcast.257), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %div.1424 = f32[32]{0} divide(%sub.71, %broadcast.256), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=18 source_end_column=86}
  %jit_clip_.223 = f32[32]{0} call(%div.1424, %constant.716, %constant.714), to_apply=%clip.1, metadata={op_name="jit(train_step)/moe_layers/self_attention/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %sub.72 = f32[32]{0} subtract(%broadcast.258, %jit_clip_.223), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=617 source_end_line=617 source_column=13 source_end_column=62}
  %sub.73 = f32[32]{0} subtract(%broadcast.258, %sub.72), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=40 source_end_column=50}
  %mul.1569 = f32[32]{0} multiply(%div.1425, %sub.73), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %mul.1570 = f32[32]{0} multiply(%div.1423, %sub.72), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=54 source_end_column=68}
  %add.838 = f32[32]{0} add(%mul.1569, %mul.1570), metadata={op_name="jit(train_step)/moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %broadcast_in_dim.1651 = f32[1,32]{1,0} reshape(%add.838), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1574 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1651), dimensions={0,1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1575 = f32[32]{0} reshape(%mul.1574), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1576 = f32[163840,32]{1,0} broadcast(%mul.1575), dimensions={1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1577 = f32[163840,32]{1,0} multiply(%mul.1573, %mul.1576), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %convert_element_type.1397 = c64[163840,32]{1,0} convert(%mul.1577), metadata={op_name="jit(train_step)/moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %mul.1578 = c64[163840,32]{1,0} multiply(%convert_element_type.1397, %broadcast.254), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %exp.279 = f32[163840,32]{1,0} real(%mul.1578), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.280 = f32[163840,32]{1,0} exponential(%exp.279), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.281 = pred[163840,32]{1,0} compare(%exp.280, %broadcast.264), direction=EQ, metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.282 = f32[163840,32]{1,0} multiply(%exp.279, %broadcast.263), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.283 = f32[163840,32]{1,0} exponential(%exp.282), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.284 = f32[163840,32]{1,0} imag(%mul.1578), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.285 = f32[163840,32]{1,0} cosine(%exp.284), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.286 = f32[163840,32]{1,0} multiply(%exp.283, %exp.285), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.287 = f32[163840,32]{1,0} multiply(%exp.286, %exp.283), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.288 = f32[163840,32]{1,0} multiply(%exp.280, %exp.285), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.289 = f32[163840,32]{1,0} select(%exp.281, %exp.287, %exp.288), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.290 = pred[163840,32]{1,0} compare(%exp.284, %broadcast.262), direction=EQ, metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.291 = f32[163840,32]{1,0} sine(%exp.284), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.292 = f32[163840,32]{1,0} multiply(%exp.283, %exp.291), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.293 = f32[163840,32]{1,0} multiply(%exp.292, %exp.283), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.294 = f32[163840,32]{1,0} multiply(%exp.280, %exp.291), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.295 = f32[163840,32]{1,0} select(%exp.281, %exp.293, %exp.294), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.296 = f32[163840,32]{1,0} select(%exp.290, %broadcast.262, %exp.295), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.297 = c64[163840,32]{1,0} complex(%exp.289, %exp.296), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %jit__take_.14 = c64[32,4096,32]{2,1,0} call(%exp.297, %data__inputs_position__.1), to_apply=%_take.4, metadata={op_name="jit(train_step)/moe_layers/self_attention/jit(_take)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.1652 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.14), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=694 source_end_line=694 source_column=12 source_end_column=39}
  %iota.59 = f32[163840]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=622 source_end_line=622 source_column=8 source_end_column=67}
  %broadcast_in_dim.1653 = f32[163840,1]{1,0} reshape(%iota.59), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1582 = f32[163840,1]{1,0} broadcast(%broadcast_in_dim.1653), dimensions={0,1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1583 = f32[163840]{0} reshape(%mul.1582), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1584 = f32[163840,32]{1,0} broadcast(%mul.1583), dimensions={0}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %iota.57 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=45 source_end_column=87}
  %mul.1579 = f32[32]{0} multiply(%iota.57, %broadcast.261), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %div.1426 = f32[32]{0} divide(%mul.1579, %broadcast.260), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=39 source_end_column=87}
  %pow.19 = f32[32]{0} power(%broadcast.259, %div.1426), metadata={op_name="jit(train_step)/moe_layers/self_attention/pow" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=19 source_end_column=110}
  %div.1427 = f32[32]{0} divide(%broadcast.258, %pow.19), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=607 source_end_line=607 source_column=12 source_end_column=111}
  %div.1429 = f32[32]{0} divide(%div.1427, %broadcast.255), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %iota.58 = f32[32]{0} iota(), iota_dimension=0, metadata={op_name="jit(train_step)/moe_layers/self_attention/iota" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %sub.74 = f32[32]{0} subtract(%iota.58, %broadcast.257), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=19 source_end_column=53}
  %div.1428 = f32[32]{0} divide(%sub.74, %broadcast.256), metadata={op_name="jit(train_step)/moe_layers/self_attention/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=665 source_end_line=665 source_column=18 source_end_column=86}
  %jit_clip_.224 = f32[32]{0} call(%div.1428, %constant.716, %constant.714), to_apply=%clip.1, metadata={op_name="jit(train_step)/moe_layers/self_attention/jit(clip)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=666 source_end_line=666 source_column=11 source_end_column=38}
  %sub.75 = f32[32]{0} subtract(%broadcast.258, %jit_clip_.224), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=617 source_end_line=617 source_column=13 source_end_column=62}
  %sub.76 = f32[32]{0} subtract(%broadcast.258, %sub.75), metadata={op_name="jit(train_step)/moe_layers/self_attention/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=40 source_end_column=50}
  %mul.1580 = f32[32]{0} multiply(%div.1429, %sub.76), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %mul.1581 = f32[32]{0} multiply(%div.1427, %sub.75), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=54 source_end_column=68}
  %add.839 = f32[32]{0} add(%mul.1580, %mul.1581), metadata={op_name="jit(train_step)/moe_layers/self_attention/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=619 source_end_line=619 source_column=12 source_end_column=36}
  %broadcast_in_dim.1654 = f32[1,32]{1,0} reshape(%add.839), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1585 = f32[1,32]{1,0} broadcast(%broadcast_in_dim.1654), dimensions={0,1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1586 = f32[32]{0} reshape(%mul.1585), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1587 = f32[163840,32]{1,0} broadcast(%mul.1586), dimensions={1}, metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %mul.1588 = f32[163840,32]{1,0} multiply(%mul.1584, %mul.1587), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=624 source_end_line=624 source_column=12 source_end_column=31}
  %convert_element_type.1398 = c64[163840,32]{1,0} convert(%mul.1588), metadata={op_name="jit(train_step)/moe_layers/self_attention/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %mul.1589 = c64[163840,32]{1,0} multiply(%convert_element_type.1398, %broadcast.254), metadata={op_name="jit(train_step)/moe_layers/self_attention/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=19 source_end_column=29}
  %exp.298 = f32[163840,32]{1,0} real(%mul.1589), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.299 = f32[163840,32]{1,0} exponential(%exp.298), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.300 = pred[163840,32]{1,0} compare(%exp.299, %broadcast.264), direction=EQ, metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.301 = f32[163840,32]{1,0} multiply(%exp.298, %broadcast.263), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.302 = f32[163840,32]{1,0} exponential(%exp.301), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.303 = f32[163840,32]{1,0} imag(%mul.1589), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.304 = f32[163840,32]{1,0} cosine(%exp.303), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.305 = f32[163840,32]{1,0} multiply(%exp.302, %exp.304), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.306 = f32[163840,32]{1,0} multiply(%exp.305, %exp.302), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.307 = f32[163840,32]{1,0} multiply(%exp.299, %exp.304), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.308 = f32[163840,32]{1,0} select(%exp.300, %exp.306, %exp.307), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.309 = pred[163840,32]{1,0} compare(%exp.303, %broadcast.262), direction=EQ, metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.310 = f32[163840,32]{1,0} sine(%exp.303), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.311 = f32[163840,32]{1,0} multiply(%exp.302, %exp.310), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.312 = f32[163840,32]{1,0} multiply(%exp.311, %exp.302), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.313 = f32[163840,32]{1,0} multiply(%exp.299, %exp.310), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.314 = f32[163840,32]{1,0} select(%exp.300, %exp.312, %exp.313), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.315 = f32[163840,32]{1,0} select(%exp.309, %broadcast.262, %exp.314), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %exp.316 = c64[163840,32]{1,0} complex(%exp.308, %exp.315), metadata={op_name="jit(train_step)/moe_layers/self_attention/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=627 source_end_line=627 source_column=11 source_end_column=30}
  %jit__take_.15 = c64[32,4096,32]{2,1,0} call(%exp.316, %data__inputs_position__.1), to_apply=%_take.4, metadata={op_name="jit(train_step)/moe_layers/self_attention/jit(_take)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=693 source_end_line=693 source_column=12 source_end_column=54}
  %broadcast_in_dim.1655 = c64[32,4096,1,32]{3,2,1,0} reshape(%jit__take_.15), metadata={op_name="jit(train_step)/moe_layers/self_attention/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=694 source_end_line=694 source_column=12 source_end_column=39}
  %jit__one_hot_.5 = s32[1,1,1,513]{3,2,1,0} call(), to_apply=%_one_hot.42, metadata={op_name="jit(train_step)/moe_layers/DeepSeekMoeBlock_0/jit(_one_hot)" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/moe.py" source_line=1400 source_end_line=1404 source_column=40 source_end_column=5}
  %while.195 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, /*index=5*/bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, /*index=10*/bf16[2,7168,64]{2,0,1}, bf16[2,64]{0,1}, bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,2048,7168]{3,2,0,1}, /*index=15*/bf16[2,7168,2048]{2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,2048,7168]{2,0,1}, bf16[2,7168]{0,1}, bf16[2,7168]{0,1}, /*index=20*/bf16[2,512]{0,1}, bf16[2,128,128,7168]{3,2,0,1}, bf16[2,1536]{0,1}, bf16[2,7168,576]{2,0,1}, bf16[2,512,128,256]{3,2,0,1}, /*index=25*/bf16[2,7168,1536]{2,0,1}, bf16[2,1536,128,192]{3,2,0,1}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=35*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=65*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, c64[32,4096,1,32]{3,2,1,0}, /*index=80*/c64[32,4096,1,32]{3,2,1,0}, s32[1,1,1,513]{3,2,1,0}) tuple(%constant.716, %while.188, %broadcast.251, %broadcast_in_dim.1640, %broadcast_in_dim.1639, /*index=5*/%broadcast.251, %broadcast.250, %broadcast.250, %broadcast.249, %broadcast.249, /*index=10*/%transpose.121, %transpose.122, %transpose.123, %transpose.124, %transpose.125, /*index=15*/%transpose.126, %transpose.127, %transpose.128, %transpose.129, %transpose.130, /*index=20*/%transpose.131, %transpose.132, %transpose.133, %transpose.134, %transpose.135, /*index=25*/%transpose.136, %transpose.137, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=30*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_scale__.1, /*index=35*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale__.1, /*index=40*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_scale__.1, /*index=45*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1, /*index=50*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1, /*index=55*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=60*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history2__.1, /*index=65*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=70*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=75*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %broadcast_in_dim.1652, /*index=80*/%broadcast_in_dim.1655, %jit__one_hot_.5), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.196 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, /*index=5*/bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, /*index=10*/bf16[2,7168,64]{2,0,1}, bf16[2,64]{0,1}, bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,2048,7168]{3,2,0,1}, /*index=15*/bf16[2,7168,2048]{2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,2048,7168]{2,0,1}, bf16[2,7168]{0,1}, bf16[2,7168]{0,1}, /*index=20*/bf16[2,512]{0,1}, bf16[2,128,128,7168]{3,2,0,1}, bf16[2,1536]{0,1}, bf16[2,7168,576]{2,0,1}, bf16[2,512,128,256]{3,2,0,1}, /*index=25*/bf16[2,7168,1536]{2,0,1}, bf16[2,1536,128,192]{3,2,0,1}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=35*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=65*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, c64[32,4096,1,32]{3,2,1,0}, /*index=80*/c64[32,4096,1,32]{3,2,1,0}, s32[1,1,1,513]{3,2,1,0}) while(%while.195), condition=%region_54.90, body=%region_22.89, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.197 = s32[] get-tuple-element(%while.196), index=0, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.715 = f32[] constant(1)
  %data__targets_segmentation__.1 = s32[32,4096]{1,0} parameter(231), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}]>"}, metadata={op_name="data[\'targets_segmentation\']"}
  %ne.3 = pred[32,4096]{1,0} compare(%data__targets_segmentation__.1, %broadcast.265), direction=NE, metadata={op_name="jit(train_step)/jvp()/ne" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=151 source_end_line=151 source_column=26 source_end_column=59}
  %convert_element_type.1403 = s32[32,4096]{1,0} convert(%ne.3), metadata={op_name="jit(train_step)/jvp()/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=151 source_end_line=151 source_column=18 source_end_column=60}
  %reduce_sum.4069 = s32[] reduce(%convert_element_type.1403, %constant.716), dimensions={0,1}, to_apply=%region_60.97, metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=151 source_end_line=151 source_column=18 source_end_column=60}
  %convert_element_type.1404 = f32[] convert(%reduce_sum.4069), metadata={op_name="jit(train_step)/jvp()/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=163 source_end_line=163 source_column=25 source_end_column=44}
  %constant.710 = f32[] constant(1e-08)
  %add.843 = f32[] add(%convert_element_type.1404, %constant.710), metadata={op_name="jit(train_step)/jvp()/add" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=163 source_end_line=163 source_column=25 source_end_column=44}
  %div.1433 = f32[] divide(%constant.715, %add.843), metadata={op_name="jit(train_step)/transpose(jvp())/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=163 source_end_line=163 source_column=11 source_end_column=45}
  %broadcast_in_dim.1660 = f32[32,4096]{1,0} broadcast(%div.1433), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp())/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=150 source_end_line=150 source_column=15 source_end_column=28}
  %ne.2 = pred[32,4096]{1,0} compare(%data__targets_segmentation__.1, %broadcast.265), direction=NE, metadata={op_name="jit(train_step)/jvp()/ne" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=149 source_end_line=149 source_column=17 source_end_column=50}
  %convert_element_type.1402 = f32[32,4096]{1,0} convert(%ne.2), metadata={op_name="jit(train_step)/jvp()/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=149 source_end_line=149 source_column=9 source_end_column=51}
  %mul.1603 = f32[32,4096]{1,0} multiply(%broadcast_in_dim.1660, %convert_element_type.1402), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=149 source_end_line=149 source_column=9 source_end_column=51}
  %sharding_constraint.195 = f32[32,4096]{1,0} custom-call(%mul.1603), custom_call_target="Sharding", sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}]>]>"}, metadata={op_name="jit(train_step)/transpose(jvp())/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %broadcast_in_dim.1662 = f32[32,4096,1]{2,1,0} reshape(%sharding_constraint.195), metadata={op_name="jit(train_step)/transpose(jvp())/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1609 = f32[32,4096,1]{2,1,0} broadcast(%broadcast_in_dim.1662), dimensions={0,1,2}, metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1610 = f32[32,4096]{1,0} reshape(%mul.1609), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1611 = f32[32,4096,129280]{2,1,0} broadcast(%mul.1610), dimensions={0,1}, metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %while.198 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%while.196), index=1, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %convert_element_type.1399 = f32[32,4096,7168]{2,1,0} convert(%while.198), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %square.510 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.1399, %convert_element_type.1399), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/square" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %constant.712 = f32[] constant(0)
  %reduce_sum.4065 = f32[32,4096]{1,0} reduce(%square.510, %constant.712), dimensions={2}, to_apply=%region_55.91, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.1656 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.4065), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.676 = f32[] constant(7168)
  %broadcast.248 = f32[32,4096,1]{2,1,0} broadcast(%constant.676), dimensions={}
  %div.1430 = f32[32,4096,1]{2,1,0} divide(%broadcast_in_dim.1656, %broadcast.248), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.675 = f32[] constant(1e-06)
  %add.833 = f32[32,4096,1]{2,1,0} broadcast(%constant.675), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %add.840 = f32[32,4096,1]{2,1,0} add(%div.1430, %add.833), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=34 source_end_column=54}
  %rsqrt.33 = f32[32,4096,1]{2,1,0} rsqrt(%add.840), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/rsqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.1592 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.33), dimensions={0,1,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1593 = f32[32,4096]{1,0} reshape(%mul.1592), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1594 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1593), dimensions={0,1}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1595 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.1399, %mul.1594), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %convert_element_type.1400 = bf16[32,4096,7168]{2,1,0} convert(%mul.1595), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %state_params__params____decoder____decoder_norm____scale__.1 = bf16[7168]{0} parameter(127), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'decoder_norm\'][\'scale\']"}
  %broadcast_in_dim.1657 = bf16[1,1,7168]{2,1,0} reshape(%state_params__params____decoder____decoder_norm____scale__.1), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1596 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1657), dimensions={0,1,2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1597 = bf16[7168]{0} reshape(%mul.1596), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1598 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1597), dimensions={2}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1599 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.1400, %mul.1598), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %state_params__params____decoder____logits_dense____kernel__.1 = bf16[7168,129280]{1,0} parameter(140), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'logits_dense\'][\'kernel\']"}
  %dot_general.147 = bf16[32,4096,129280]{2,1,0} dot(%mul.1599, %state_params__params____decoder____logits_dense____kernel__.1), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/logits_dense/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=88 source_end_line=88 source_column=9 source_end_column=98}
  %sharding_constraint.193 = bf16[32,4096,129280]{2,1,0} custom-call(%dot_general.147), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %convert_element_type.1401 = f32[32,4096,129280]{2,1,0} convert(%sharding_constraint.193), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/decoders.py" source_line=619 source_end_line=619 source_column=15 source_end_column=41}
  %constant.711 = f32[] constant(-inf)
  %reduce_max.1343 = f32[32,4096]{1,0} reduce(%convert_element_type.1401, %constant.711), dimensions={2}, to_apply=%region_56.93, metadata={op_name="jit(train_step)/jvp()/reduce_max" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=570 source_end_line=570 source_column=14 source_end_column=48}
  %broadcast_in_dim.1658 = f32[32,4096,1]{2,1,0} reshape(%reduce_max.1343), metadata={op_name="jit(train_step)/jvp()/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=570 source_end_line=570 source_column=14 source_end_column=48}
  %sub.77 = f32[32,4096,1]{2,1,0} broadcast(%broadcast_in_dim.1658), dimensions={0,1,2}, metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=571 source_end_line=571 source_column=12 source_end_column=30}
  %sub.78 = f32[32,4096]{1,0} reshape(%sub.77), metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=571 source_end_line=571 source_column=12 source_end_column=30}
  %sub.79 = f32[32,4096,129280]{2,1,0} broadcast(%sub.78), dimensions={0,1}, metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=571 source_end_line=571 source_column=12 source_end_column=30}
  %sub.80 = f32[32,4096,129280]{2,1,0} subtract(%convert_element_type.1401, %sub.79), metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=571 source_end_line=571 source_column=12 source_end_column=30}
  %exp.317 = f32[32,4096,129280]{2,1,0} exponential(%sub.80), metadata={op_name="jit(train_step)/jvp()/exp" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=572 source_end_line=572 source_column=16 source_end_column=32}
  %reduce_sum.4066 = f32[32,4096]{1,0} reduce(%exp.317, %constant.712), dimensions={2}, to_apply=%region_57.94, metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=573 source_end_line=573 source_column=12 source_end_column=56}
  %broadcast_in_dim.1659 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.4066), metadata={op_name="jit(train_step)/jvp()/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=573 source_end_line=573 source_column=12 source_end_column=56}
  %log.3 = f32[32,4096,1]{2,1,0} log(%broadcast_in_dim.1659), metadata={op_name="jit(train_step)/jvp()/log" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=577 source_end_line=577 source_column=22 source_end_column=38}
  %add.841 = f32[32,4096,1]{2,1,0} add(%log.3, %broadcast_in_dim.1658), metadata={op_name="jit(train_step)/jvp()/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=577 source_end_line=577 source_column=22 source_end_column=38}
  %squeeze.593 = f32[32,4096]{1,0} reshape(%add.841), metadata={op_name="jit(train_step)/jvp()/squeeze" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=577 source_end_line=577 source_column=10 source_end_column=60}
  %constant.673 = f32[] constant(0)
  %broadcast.247 = f32[32,4096]{1,0} broadcast(%constant.673), dimensions={}
  %mul.1604 = f32[32,4096]{1,0} multiply(%squeeze.593, %broadcast.247), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %constant.672 = f32[] constant(1)
  %add.832 = f32[32,4096]{1,0} broadcast(%constant.672), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp())/add" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %add.844 = f32[32,4096]{1,0} add(%mul.1604, %add.832), metadata={op_name="jit(train_step)/transpose(jvp())/add" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %broadcast_in_dim.1661 = f32[32,4096,1]{2,1,0} reshape(%add.844), metadata={op_name="jit(train_step)/transpose(jvp())/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1605 = f32[32,4096,1]{2,1,0} broadcast(%broadcast_in_dim.1661), dimensions={0,1,2}, metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1606 = f32[32,4096]{1,0} reshape(%mul.1605), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1607 = f32[32,4096,129280]{2,1,0} broadcast(%mul.1606), dimensions={0,1}, metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1608 = f32[32,4096,129280]{2,1,0} multiply(%mul.1607, %exp.317), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %div.1434 = f32[32,4096,1]{2,1,0} broadcast(%broadcast_in_dim.1659), dimensions={0,1,2}, metadata={op_name="jit(train_step)/transpose(jvp())/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %div.1435 = f32[32,4096]{1,0} reshape(%div.1434), metadata={op_name="jit(train_step)/transpose(jvp())/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %div.1436 = f32[32,4096,129280]{2,1,0} broadcast(%div.1435), dimensions={0,1}, metadata={op_name="jit(train_step)/transpose(jvp())/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %div.1437 = f32[32,4096,129280]{2,1,0} divide(%mul.1608, %div.1436), metadata={op_name="jit(train_step)/transpose(jvp())/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %data__targets__.1 = s32[32,4096]{1,0} parameter(230), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"tensor_sequence\", \"context\", \"sequence\"}]>"}, metadata={op_name="data[\'targets\']"}
  %jvp_jit__one_hot__.1 = f32[32,4096,129280]{2,1,0} call(%data__targets__.1), to_apply=%_one_hot_399.92, metadata={op_name="jit(train_step)/jvp(jit(_one_hot))" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=145 source_end_line=145 source_column=20 source_end_column=70}
  %sub.85 = f32[32,4096,129280]{2,1,0} subtract(%div.1437, %jvp_jit__one_hot__.1), metadata={op_name="jit(train_step)/transpose(jvp())/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %mul.1612 = f32[32,4096,129280]{2,1,0} multiply(%mul.1611, %sub.85), metadata={op_name="jit(train_step)/transpose(jvp())/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=146 source_end_line=146 source_column=12 source_end_column=77}
  %convert_element_type.1405 = bf16[32,4096,129280]{2,1,0} convert(%mul.1612), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/decoders.py" source_line=619 source_end_line=619 source_column=15 source_end_column=41}
  %sharding_constraint.196 = bf16[32,4096,129280]{2,1,0} custom-call(%convert_element_type.1405), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %dot_general.149 = bf16[32,4096,7168]{2,1,0} dot(%sharding_constraint.196, %state_params__params____decoder____logits_dense____kernel__.1), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/logits_dense/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=88 source_end_line=88 source_column=9 source_end_column=98}
  %mul.1614 = bf16[1,1,7168]{2,1,0} broadcast(%broadcast_in_dim.1657), dimensions={0,1,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1615 = bf16[7168]{0} reshape(%mul.1614), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1616 = bf16[32,4096,7168]{2,1,0} broadcast(%mul.1615), dimensions={2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1617 = bf16[32,4096,7168]{2,1,0} multiply(%dot_general.149, %mul.1616), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %convert_element_type.1406 = f32[32,4096,7168]{2,1,0} convert(%mul.1617), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=8 source_end_column=68}
  %mul.1619 = f32[32,4096,1]{2,1,0} broadcast(%rsqrt.33), dimensions={0,1,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1620 = f32[32,4096]{1,0} reshape(%mul.1619), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1621 = f32[32,4096,7168]{2,1,0} broadcast(%mul.1620), dimensions={0,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1622 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.1406, %mul.1621), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %mul.1618 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.1399, %convert_element_type.1406), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %reduce_sum.4072 = f32[32,4096]{1,0} reduce(%mul.1618, %constant.712), dimensions={2}, to_apply=%region_63.100, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %reshape.296 = f32[32,4096,1]{2,1,0} reshape(%reduce_sum.4072), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=20 source_end_column=55}
  %div.1431 = f32[32,4096,1]{2,1,0} divide(%rsqrt.33, %add.840), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %constant.674 = f32[] constant(-0.5)
  %mul.1544 = f32[32,4096,1]{2,1,0} broadcast(%constant.674), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.1591 = f32[32,4096,1]{2,1,0} multiply(%div.1431, %mul.1544), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %mul.1623 = f32[32,4096,1]{2,1,0} multiply(%reshape.296, %mul.1591), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=61 source_end_line=61 source_column=24 source_end_column=55}
  %div.1438 = f32[32,4096,1]{2,1,0} divide(%mul.1623, %broadcast.248), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/div" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %reduce_sum.4073 = f32[32,4096]{1,0} reduce(%div.1438, %constant.712), dimensions={2}, to_apply=%region_64.101, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %broadcast_in_dim.1663 = f32[32,4096,7168]{2,1,0} broadcast(%reduce_sum.4073), dimensions={0,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=12 source_end_column=59}
  %constant.677 = f32[] constant(2)
  %mul.1545 = f32[32,4096,7168]{2,1,0} broadcast(%constant.677), dimensions={}, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %mul.1590 = f32[32,4096,7168]{2,1,0} multiply(%convert_element_type.1399, %mul.1545), metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %mul.1624 = f32[32,4096,7168]{2,1,0} multiply(%broadcast_in_dim.1663, %mul.1590), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %add_any.61 = f32[32,4096,7168]{2,1,0} add(%mul.1622, %mul.1624), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/add_any" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=60 source_end_line=60 source_column=21 source_end_column=34}
  %convert_element_type.1407 = bf16[32,4096,7168]{2,1,0} convert(%add_any.61), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=59 source_end_line=59 source_column=8 source_end_column=35}
  %constant.671 = bf16[] constant(0)
  %broadcast_in_dim.1638 = bf16[2,7168,64]{2,1,0} broadcast(%constant.671), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.670 = bf16[] constant(0)
  %broadcast_in_dim.1637 = bf16[2,64]{1,0} broadcast(%constant.670), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.669 = bf16[] constant(0)
  %broadcast.246 = bf16[2,64,7168,2048]{3,2,1,0} broadcast(%constant.669), dimensions={}
  %constant.668 = bf16[] constant(0)
  %broadcast_in_dim.1636 = bf16[2,64,2048,7168]{3,2,1,0} broadcast(%constant.668), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.667 = bf16[] constant(0)
  %broadcast.245 = bf16[2,7168,2048]{2,1,0} broadcast(%constant.667), dimensions={}
  %constant.666 = bf16[] constant(0)
  %broadcast_in_dim.1635 = bf16[2,2048,7168]{2,1,0} broadcast(%constant.666), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.665 = bf16[] constant(0)
  %broadcast.244 = bf16[2,7168]{1,0} broadcast(%constant.665), dimensions={}
  %constant.664 = bf16[] constant(0)
  %broadcast_in_dim.1634 = bf16[2,512]{1,0} broadcast(%constant.664), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.663 = bf16[] constant(0)
  %broadcast_in_dim.1633 = bf16[2,128,128,7168]{3,2,1,0} broadcast(%constant.663), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.662 = bf16[] constant(0)
  %broadcast_in_dim.1632 = bf16[2,1536]{1,0} broadcast(%constant.662), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.661 = bf16[] constant(0)
  %broadcast_in_dim.1631 = bf16[2,7168,576]{2,1,0} broadcast(%constant.661), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.660 = bf16[] constant(0)
  %broadcast_in_dim.1630 = bf16[2,512,128,256]{3,2,1,0} broadcast(%constant.660), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.659 = bf16[] constant(0)
  %broadcast_in_dim.1629 = bf16[2,7168,1536]{2,1,0} broadcast(%constant.659), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.658 = bf16[] constant(0)
  %broadcast_in_dim.1628 = bf16[2,1536,128,192]{3,2,1,0} broadcast(%constant.658), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.657 = f32[] constant(0)
  %broadcast.243 = f32[2,1024]{1,0} broadcast(%constant.657), dimensions={}
  %constant.656 = f32[] constant(0)
  %broadcast.242 = f32[2,1]{1,0} broadcast(%constant.656), dimensions={}
  %while.199 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%while.196), index=2, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.200 = bf16[2,32,4096,1536]{3,2,1,0} get-tuple-element(%while.196), index=3, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.201 = bf16[2,32,4096,576]{3,2,1,0} get-tuple-element(%while.196), index=4, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.202 = bf16[2,32,4096,7168]{3,2,1,0} get-tuple-element(%while.196), index=5, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.203 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%while.196), index=6, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.204 = bf16[2,64,32,512,2048]{4,3,2,1,0} get-tuple-element(%while.196), index=7, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.205 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%while.196), index=8, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.206 = bf16[2,32,4096,2048]{3,2,1,0} get-tuple-element(%while.196), index=9, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(51), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(52), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(57), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_scale__.1 = f32[2,1]{1,0} parameter(58), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_0\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(65), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history2__.1 = f32[2,1024]{1,0} parameter(66), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'output_grad_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale__.1 = f32[2,1]{1,0} parameter(67), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale2__.1 = f32[2,1]{1,0} parameter(68), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_1\'][\'fp8_einsum\'][\'output_grad_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(73), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_scale__.1 = f32[2,1]{1,0} parameter(74), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_2\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(79), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_scale__.1 = f32[2,1]{1,0} parameter(80), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'_Fp8EinsumWrapper_3\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(85), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(86), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(91), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(92), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(97), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(98), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(105), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1 = f32[2,1024]{1,0} parameter(106), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale__.1 = f32[2,1]{1,0} parameter(107), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale2__.1 = f32[2,1]{1,0} parameter(108), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(113), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(114), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(119), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(120), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[2,1024]{1,0} parameter(125), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[2,1]{1,0} parameter(126), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %while.207 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=5*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=10*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=15*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, /*index=20*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=25*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=35*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=75*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,32,4096,7168]{3,2,1,0}, /*index=100*/bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, /*index=105*/bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=130*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=135*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=140*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=145*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=150*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=155*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=160*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=165*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=170*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=175*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=180*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=185*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,7168,64]{2,0,1}, bf16[2,64]{0,1}, bf16[2,64,7168,2048]{3,2,0,1}, /*index=190*/bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,2048,7168]{3,2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,2048,7168]{2,0,1}, /*index=195*/bf16[2,7168]{0,1}, bf16[2,7168]{0,1}, bf16[2,512]{0,1}, bf16[2,128,128,7168]{3,2,0,1}, bf16[2,1536]{0,1}, /*index=200*/bf16[2,7168,576]{2,0,1}, bf16[2,512,128,256]{3,2,0,1}, bf16[2,7168,1536]{2,0,1}, bf16[2,1536,128,192]{3,2,0,1}, s32[32,4096]{1,0}) tuple(%constant.716, %convert_element_type.1407, %broadcast_in_dim.1638, %broadcast_in_dim.1637, %broadcast.246, /*index=5*/%broadcast.246, %broadcast_in_dim.1636, %broadcast.245, %broadcast.245, %broadcast_in_dim.1635, /*index=10*/%broadcast.244, %broadcast.244, %broadcast_in_dim.1634, %broadcast_in_dim.1633, %broadcast_in_dim.1632, /*index=15*/%broadcast_in_dim.1631, %broadcast_in_dim.1630, %broadcast_in_dim.1629, %broadcast_in_dim.1628, %broadcast.243, /*index=20*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=25*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, /*index=30*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.243, /*index=35*/%broadcast.242, %broadcast.242, %broadcast.243, %broadcast.243, %broadcast.242, /*index=40*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=45*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, /*index=50*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=55*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, /*index=60*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=65*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, /*index=70*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.243, /*index=75*/%broadcast.242, %broadcast.242, %broadcast.243, %broadcast.243, %broadcast.242, /*index=80*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=85*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, /*index=90*/%broadcast.242, %broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, /*index=95*/%broadcast.243, %broadcast.242, %broadcast.243, %broadcast.242, %while.199, /*index=100*/%while.200, %while.201, %while.202, %while.203, %while.204, /*index=105*/%while.205, %while.206, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=110*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____input_scale__.1, /*index=115*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_0____fp8_einsum____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_amax_history__.1, /*index=120*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____kernel_scale2__.1, /*index=125*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_1____fp8_einsum____output_grad_scale2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_amax_history__.1, /*index=130*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_2____fp8_einsum____output_grad_scale__.1, /*index=135*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_amax_history__.1, /*index=140*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0_____Fp8EinsumWrapper_3____fp8_einsum____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=145*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=150*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____input_scale__.1, /*index=155*/%state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_amax_history__.1, /*index=160*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____kernel_scale2__.1, /*index=165*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____fp8_einsum____output_grad_scale2__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1, /*index=170*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, /*index=175*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, /*index=180*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=185*/%state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____moe_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %transpose.121, %transpose.122, %transpose.123, /*index=190*/%transpose.124, %transpose.125, %transpose.126, %transpose.127, %transpose.128, /*index=195*/%transpose.129, %transpose.130, %transpose.131, %transpose.132, %transpose.133, /*index=200*/%transpose.134, %transpose.135, %transpose.136, %transpose.137, %data__inputs_position__.1), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.208 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[2,7168,64]{2,1,0}, bf16[2,64]{1,0}, bf16[2,64,7168,2048]{3,2,1,0}, /*index=5*/bf16[2,64,7168,2048]{3,2,1,0}, bf16[2,64,2048,7168]{3,2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,7168,2048]{2,1,0}, bf16[2,2048,7168]{2,1,0}, /*index=10*/bf16[2,7168]{1,0}, bf16[2,7168]{1,0}, bf16[2,512]{1,0}, bf16[2,128,128,7168]{3,2,1,0}, bf16[2,1536]{1,0}, /*index=15*/bf16[2,7168,576]{2,1,0}, bf16[2,512,128,256]{3,2,1,0}, bf16[2,7168,1536]{2,1,0}, bf16[2,1536,128,192]{3,2,1,0}, f32[2,1024]{1,0}, /*index=20*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=25*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=30*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=35*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=40*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=45*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, /*index=75*/f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,32,4096,7168]{3,2,1,0}, /*index=100*/bf16[2,32,4096,1536]{3,2,1,0}, bf16[2,32,4096,576]{3,2,1,0}, bf16[2,32,4096,7168]{3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, bf16[2,64,32,512,2048]{4,3,2,1,0}, /*index=105*/bf16[2,32,4096,2048]{3,2,1,0}, bf16[2,32,4096,2048]{3,2,1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=130*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=135*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=140*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=145*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=150*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=155*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=160*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=165*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=170*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=175*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=180*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=185*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[2,7168,64]{2,0,1}, bf16[2,64]{0,1}, bf16[2,64,7168,2048]{3,2,0,1}, /*index=190*/bf16[2,64,7168,2048]{3,2,0,1}, bf16[2,64,2048,7168]{3,2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,7168,2048]{2,0,1}, bf16[2,2048,7168]{2,0,1}, /*index=195*/bf16[2,7168]{0,1}, bf16[2,7168]{0,1}, bf16[2,512]{0,1}, bf16[2,128,128,7168]{3,2,0,1}, bf16[2,1536]{0,1}, /*index=200*/bf16[2,7168,576]{2,0,1}, bf16[2,512,128,256]{3,2,0,1}, bf16[2,7168,1536]{2,0,1}, bf16[2,1536,128,192]{3,2,0,1}, s32[32,4096]{1,0}) while(%while.207), condition=%region_211.292, body=%region_65.291, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.209 = s32[] get-tuple-element(%while.208), index=0, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.210 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%while.208), index=1, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.655 = bf16[] constant(0)
  %broadcast.241 = bf16[1,7168,18432]{2,1,0} broadcast(%constant.655), dimensions={}
  %constant.654 = bf16[] constant(0)
  %broadcast_in_dim.1627 = bf16[1,18432,7168]{2,1,0} broadcast(%constant.654), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.653 = bf16[] constant(0)
  %broadcast.240 = bf16[1,7168]{1,0} broadcast(%constant.653), dimensions={}
  %constant.652 = bf16[] constant(0)
  %broadcast_in_dim.1626 = bf16[1,512]{1,0} broadcast(%constant.652), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.651 = bf16[] constant(0)
  %broadcast_in_dim.1625 = bf16[1,128,128,7168]{3,2,1,0} broadcast(%constant.651), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.650 = bf16[] constant(0)
  %broadcast_in_dim.1624 = bf16[1,1536]{1,0} broadcast(%constant.650), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.649 = bf16[] constant(0)
  %broadcast_in_dim.1623 = bf16[1,7168,576]{2,1,0} broadcast(%constant.649), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.648 = bf16[] constant(0)
  %broadcast_in_dim.1622 = bf16[1,512,128,256]{3,2,1,0} broadcast(%constant.648), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.647 = bf16[] constant(0)
  %broadcast_in_dim.1621 = bf16[1,7168,1536]{2,1,0} broadcast(%constant.647), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.646 = bf16[] constant(0)
  %broadcast_in_dim.1620 = bf16[1,1536,128,192]{3,2,1,0} broadcast(%constant.646), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/broadcast_in_dim" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %constant.645 = f32[] constant(0)
  %broadcast.239 = f32[1,1024]{1,0} broadcast(%constant.645), dimensions={}
  %constant.644 = f32[1,1]{1,0} constant({ {0} })
  %while.189 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%while.186), index=2, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.190 = bf16[1,32,4096,1536]{3,2,1,0} get-tuple-element(%while.186), index=3, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.191 = bf16[1,32,4096,576]{3,2,1,0} get-tuple-element(%while.186), index=4, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.192 = bf16[1,32,4096,7168]{3,2,1,0} get-tuple-element(%while.186), index=5, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.193 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%while.186), index=6, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.194 = bf16[1,32,4096,18432]{3,2,1,0} get-tuple-element(%while.186), index=7, metadata={op_name="jit(train_step)/jvp(TransformerLinenPure.apply)/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(5), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(6), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(11), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(12), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(17), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(18), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(25), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1 = f32[1,1024]{1,0} parameter(26), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_amax_history2\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale__.1 = f32[1,1]{1,0} parameter(27), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale2__.1 = f32[1,1]{1,0} parameter(28), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'fp8_einsum\'][\'output_grad_scale2\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(33), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(34), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(39), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(40), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1 = f32[1,1024]{1,0} parameter(45), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_amax_history\']"}
  %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1 = f32[1,1]{1,0} parameter(46), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'_overwrite_with_gradient\'][\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'Fp8DirectDotGeneralOp_0\'][\'output_grad_scale\']"}
  %while.308 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=5*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=10*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, f32[1,1024]{1,0}, /*index=15*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=55*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=60*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, /*index=65*/bf16[1,32,4096,18432]{3,2,1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=70*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=75*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=80*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=85*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=90*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=95*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=100*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=105*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=110*/f32[1,1024]{1,0}, f32[1,1]{1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=115*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=120*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) tuple(%constant.716, %while.210, %broadcast.241, %broadcast.241, %broadcast_in_dim.1627, /*index=5*/%broadcast.240, %broadcast.240, %broadcast_in_dim.1626, %broadcast_in_dim.1625, %broadcast_in_dim.1624, /*index=10*/%broadcast_in_dim.1623, %broadcast_in_dim.1622, %broadcast_in_dim.1621, %broadcast_in_dim.1620, %broadcast.239, /*index=15*/%constant.644, %broadcast.239, %constant.644, %broadcast.239, %constant.644, /*index=20*/%broadcast.239, %constant.644, %broadcast.239, %constant.644, %broadcast.239, /*index=25*/%constant.644, %broadcast.239, %constant.644, %broadcast.239, %constant.644, /*index=30*/%broadcast.239, %constant.644, %broadcast.239, %constant.644, %broadcast.239, /*index=35*/%broadcast.239, %constant.644, %constant.644, %broadcast.239, %broadcast.239, /*index=40*/%constant.644, %constant.644, %broadcast.239, %constant.644, %broadcast.239, /*index=45*/%constant.644, %broadcast.239, %constant.644, %broadcast.239, %constant.644, /*index=50*/%broadcast.239, %constant.644, %broadcast.239, %constant.644, %broadcast.239, /*index=55*/%constant.644, %broadcast.239, %constant.644, %broadcast.239, %constant.644, /*index=60*/%while.189, %while.190, %while.191, %while.192, %while.193, /*index=65*/%while.194, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=70*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_0____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, /*index=75*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wi_1____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____input_scale__.1, /*index=80*/%state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____mlp____wo____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_amax_history__.1, /*index=85*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____kernel_scale2__.1, /*index=90*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_amax_history2__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____fp8_einsum____output_grad_scale2__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_amax_history__.1, /*index=95*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____out____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, /*index=100*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, /*index=105*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wkv_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____input_scale__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____kernel_scale__.1, /*index=110*/%state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_amax_history__.1, %state_params___overwrite_with_gradient____decoder____dense_layers____self_attention____wq_b____Fp8DirectDotGeneralOp_0____output_grad_scale__.1, %transpose.109, %transpose.110, %transpose.111, /*index=115*/%transpose.112, %transpose.113, %transpose.114, %transpose.115, %transpose.116, /*index=120*/%transpose.117, %transpose.118, %transpose.119, %transpose.120, %data__inputs_position__.1), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.309 = (s32[], bf16[32,4096,7168]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=5*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=10*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, f32[1,1024]{1,0}, /*index=15*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=20*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=25*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=30*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=45*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=50*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=55*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=60*/bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,1536]{3,2,1,0}, bf16[1,32,4096,576]{3,2,1,0}, bf16[1,32,4096,7168]{3,2,1,0}, bf16[1,32,4096,18432]{3,2,1,0}, /*index=65*/bf16[1,32,4096,18432]{3,2,1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=70*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=75*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=80*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=85*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=90*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=95*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=100*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=105*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=110*/f32[1,1024]{1,0}, f32[1,1]{1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,7168,18432]{2,1,0}, bf16[1,18432,7168]{2,1,0}, /*index=115*/bf16[1,7168]{1,0}, bf16[1,7168]{1,0}, bf16[1,512]{1,0}, bf16[1,128,128,7168]{3,2,1,0}, bf16[1,1536]{1,0}, /*index=120*/bf16[1,7168,576]{2,1,0}, bf16[1,512,128,256]{3,2,1,0}, bf16[1,7168,1536]{2,1,0}, bf16[1,1536,128,192]{3,2,1,0}, s32[32,4096]{1,0}) while(%while.308), condition=%region_304.392, body=%region_212.391, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %while.310 = s32[] get-tuple-element(%while.309), index=0, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %state_step.1 = s32[] parameter(0), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, []>"}, metadata={op_name="state.step"}
  %add.1047 = s32[] add(%state_step.1, %constant.714), metadata={op_name="jit(train_step)/add" source_file="/opt/flax/flax/training/train_state.py" source_line=118 source_end_line=118 source_column=11 source_end_column=24}
  %custom-call.456 = s32[] custom-call(%add.1047), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.684 = s32[] custom-call(%custom-call.456), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, []>]>"}
  %reshape.297 = s32[] reshape(%custom-call.684), sharding={replicated}
  %while.324 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=14, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.457 = f32[1,1024]{1,0} custom-call(%while.324), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.685 = f32[1,1024]{1,0} custom-call(%custom-call.457), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.298 = f32[1,1024]{1,0} reshape(%custom-call.685), sharding={replicated}
  %while.325 = f32[1,1]{1,0} get-tuple-element(%while.309), index=15, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.458 = f32[1,1]{1,0} custom-call(%while.325), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.686 = f32[1,1]{1,0} custom-call(%custom-call.458), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.299 = f32[1,1]{1,0} reshape(%custom-call.686), sharding={replicated}
  %while.326 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=16, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.459 = f32[1,1024]{1,0} custom-call(%while.326), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.687 = f32[1,1024]{1,0} custom-call(%custom-call.459), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.300 = f32[1,1024]{1,0} reshape(%custom-call.687), sharding={replicated}
  %while.327 = f32[1,1]{1,0} get-tuple-element(%while.309), index=17, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.460 = f32[1,1]{1,0} custom-call(%while.327), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.688 = f32[1,1]{1,0} custom-call(%custom-call.460), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.301 = f32[1,1]{1,0} reshape(%custom-call.688), sharding={replicated}
  %while.328 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=18, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.461 = f32[1,1024]{1,0} custom-call(%while.328), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.689 = f32[1,1024]{1,0} custom-call(%custom-call.461), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.302 = f32[1,1024]{1,0} reshape(%custom-call.689), sharding={replicated}
  %while.329 = f32[1,1]{1,0} get-tuple-element(%while.309), index=19, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.462 = f32[1,1]{1,0} custom-call(%while.329), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.690 = f32[1,1]{1,0} custom-call(%custom-call.462), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.303 = f32[1,1]{1,0} reshape(%custom-call.690), sharding={replicated}
  %while.330 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=20, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.463 = f32[1,1024]{1,0} custom-call(%while.330), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.691 = f32[1,1024]{1,0} custom-call(%custom-call.463), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.304 = f32[1,1024]{1,0} reshape(%custom-call.691), sharding={replicated}
  %while.331 = f32[1,1]{1,0} get-tuple-element(%while.309), index=21, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.464 = f32[1,1]{1,0} custom-call(%while.331), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.692 = f32[1,1]{1,0} custom-call(%custom-call.464), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.305 = f32[1,1]{1,0} reshape(%custom-call.692), sharding={replicated}
  %while.332 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=22, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.465 = f32[1,1024]{1,0} custom-call(%while.332), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.693 = f32[1,1024]{1,0} custom-call(%custom-call.465), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.306 = f32[1,1024]{1,0} reshape(%custom-call.693), sharding={replicated}
  %while.333 = f32[1,1]{1,0} get-tuple-element(%while.309), index=23, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.466 = f32[1,1]{1,0} custom-call(%while.333), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.694 = f32[1,1]{1,0} custom-call(%custom-call.466), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.307 = f32[1,1]{1,0} reshape(%custom-call.694), sharding={replicated}
  %while.334 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=24, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.467 = f32[1,1024]{1,0} custom-call(%while.334), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.695 = f32[1,1024]{1,0} custom-call(%custom-call.467), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.308 = f32[1,1024]{1,0} reshape(%custom-call.695), sharding={replicated}
  %while.335 = f32[1,1]{1,0} get-tuple-element(%while.309), index=25, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.468 = f32[1,1]{1,0} custom-call(%while.335), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.696 = f32[1,1]{1,0} custom-call(%custom-call.468), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.309 = f32[1,1]{1,0} reshape(%custom-call.696), sharding={replicated}
  %while.336 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=26, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.469 = f32[1,1024]{1,0} custom-call(%while.336), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.697 = f32[1,1024]{1,0} custom-call(%custom-call.469), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.310 = f32[1,1024]{1,0} reshape(%custom-call.697), sharding={replicated}
  %while.337 = f32[1,1]{1,0} get-tuple-element(%while.309), index=27, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.470 = f32[1,1]{1,0} custom-call(%while.337), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.698 = f32[1,1]{1,0} custom-call(%custom-call.470), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.311 = f32[1,1]{1,0} reshape(%custom-call.698), sharding={replicated}
  %while.338 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=28, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.471 = f32[1,1024]{1,0} custom-call(%while.338), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.699 = f32[1,1024]{1,0} custom-call(%custom-call.471), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.312 = f32[1,1024]{1,0} reshape(%custom-call.699), sharding={replicated}
  %while.339 = f32[1,1]{1,0} get-tuple-element(%while.309), index=29, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.472 = f32[1,1]{1,0} custom-call(%while.339), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.700 = f32[1,1]{1,0} custom-call(%custom-call.472), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.313 = f32[1,1]{1,0} reshape(%custom-call.700), sharding={replicated}
  %while.340 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=30, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.473 = f32[1,1024]{1,0} custom-call(%while.340), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.701 = f32[1,1024]{1,0} custom-call(%custom-call.473), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.314 = f32[1,1024]{1,0} reshape(%custom-call.701), sharding={replicated}
  %while.341 = f32[1,1]{1,0} get-tuple-element(%while.309), index=31, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.474 = f32[1,1]{1,0} custom-call(%while.341), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.702 = f32[1,1]{1,0} custom-call(%custom-call.474), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.315 = f32[1,1]{1,0} reshape(%custom-call.702), sharding={replicated}
  %while.342 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=32, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.475 = f32[1,1024]{1,0} custom-call(%while.342), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.703 = f32[1,1024]{1,0} custom-call(%custom-call.475), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.316 = f32[1,1024]{1,0} reshape(%custom-call.703), sharding={replicated}
  %while.343 = f32[1,1]{1,0} get-tuple-element(%while.309), index=33, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.476 = f32[1,1]{1,0} custom-call(%while.343), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.704 = f32[1,1]{1,0} custom-call(%custom-call.476), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.317 = f32[1,1]{1,0} reshape(%custom-call.704), sharding={replicated}
  %while.344 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=34, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.477 = f32[1,1024]{1,0} custom-call(%while.344), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.705 = f32[1,1024]{1,0} custom-call(%custom-call.477), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.318 = f32[1,1024]{1,0} reshape(%custom-call.705), sharding={replicated}
  %while.345 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=35, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.478 = f32[1,1024]{1,0} custom-call(%while.345), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.706 = f32[1,1024]{1,0} custom-call(%custom-call.478), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.319 = f32[1,1024]{1,0} reshape(%custom-call.706), sharding={replicated}
  %while.346 = f32[1,1]{1,0} get-tuple-element(%while.309), index=36, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.479 = f32[1,1]{1,0} custom-call(%while.346), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.707 = f32[1,1]{1,0} custom-call(%custom-call.479), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.320 = f32[1,1]{1,0} reshape(%custom-call.707), sharding={replicated}
  %while.347 = f32[1,1]{1,0} get-tuple-element(%while.309), index=37, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.480 = f32[1,1]{1,0} custom-call(%while.347), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.708 = f32[1,1]{1,0} custom-call(%custom-call.480), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.321 = f32[1,1]{1,0} reshape(%custom-call.708), sharding={replicated}
  %while.348 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=38, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.481 = f32[1,1024]{1,0} custom-call(%while.348), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.709 = f32[1,1024]{1,0} custom-call(%custom-call.481), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.322 = f32[1,1024]{1,0} reshape(%custom-call.709), sharding={replicated}
  %while.349 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=39, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.482 = f32[1,1024]{1,0} custom-call(%while.349), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.710 = f32[1,1024]{1,0} custom-call(%custom-call.482), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.323 = f32[1,1024]{1,0} reshape(%custom-call.710), sharding={replicated}
  %while.350 = f32[1,1]{1,0} get-tuple-element(%while.309), index=40, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.483 = f32[1,1]{1,0} custom-call(%while.350), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.711 = f32[1,1]{1,0} custom-call(%custom-call.483), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.324 = f32[1,1]{1,0} reshape(%custom-call.711), sharding={replicated}
  %while.351 = f32[1,1]{1,0} get-tuple-element(%while.309), index=41, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.484 = f32[1,1]{1,0} custom-call(%while.351), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.712 = f32[1,1]{1,0} custom-call(%custom-call.484), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.325 = f32[1,1]{1,0} reshape(%custom-call.712), sharding={replicated}
  %while.352 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=42, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.485 = f32[1,1024]{1,0} custom-call(%while.352), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.713 = f32[1,1024]{1,0} custom-call(%custom-call.485), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.326 = f32[1,1024]{1,0} reshape(%custom-call.713), sharding={replicated}
  %while.353 = f32[1,1]{1,0} get-tuple-element(%while.309), index=43, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.486 = f32[1,1]{1,0} custom-call(%while.353), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.714 = f32[1,1]{1,0} custom-call(%custom-call.486), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.327 = f32[1,1]{1,0} reshape(%custom-call.714), sharding={replicated}
  %while.354 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=44, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.487 = f32[1,1024]{1,0} custom-call(%while.354), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.715 = f32[1,1024]{1,0} custom-call(%custom-call.487), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.328 = f32[1,1024]{1,0} reshape(%custom-call.715), sharding={replicated}
  %while.355 = f32[1,1]{1,0} get-tuple-element(%while.309), index=45, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.488 = f32[1,1]{1,0} custom-call(%while.355), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.716 = f32[1,1]{1,0} custom-call(%custom-call.488), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.329 = f32[1,1]{1,0} reshape(%custom-call.716), sharding={replicated}
  %while.356 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=46, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.489 = f32[1,1024]{1,0} custom-call(%while.356), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.717 = f32[1,1024]{1,0} custom-call(%custom-call.489), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.330 = f32[1,1024]{1,0} reshape(%custom-call.717), sharding={replicated}
  %while.357 = f32[1,1]{1,0} get-tuple-element(%while.309), index=47, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.490 = f32[1,1]{1,0} custom-call(%while.357), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.718 = f32[1,1]{1,0} custom-call(%custom-call.490), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.331 = f32[1,1]{1,0} reshape(%custom-call.718), sharding={replicated}
  %while.358 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=48, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.491 = f32[1,1024]{1,0} custom-call(%while.358), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.719 = f32[1,1024]{1,0} custom-call(%custom-call.491), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.332 = f32[1,1024]{1,0} reshape(%custom-call.719), sharding={replicated}
  %while.359 = f32[1,1]{1,0} get-tuple-element(%while.309), index=49, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.492 = f32[1,1]{1,0} custom-call(%while.359), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.720 = f32[1,1]{1,0} custom-call(%custom-call.492), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.333 = f32[1,1]{1,0} reshape(%custom-call.720), sharding={replicated}
  %while.360 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=50, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.493 = f32[1,1024]{1,0} custom-call(%while.360), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.721 = f32[1,1024]{1,0} custom-call(%custom-call.493), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.334 = f32[1,1024]{1,0} reshape(%custom-call.721), sharding={replicated}
  %while.361 = f32[1,1]{1,0} get-tuple-element(%while.309), index=51, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.494 = f32[1,1]{1,0} custom-call(%while.361), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.722 = f32[1,1]{1,0} custom-call(%custom-call.494), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.335 = f32[1,1]{1,0} reshape(%custom-call.722), sharding={replicated}
  %while.362 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=52, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.495 = f32[1,1024]{1,0} custom-call(%while.362), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.723 = f32[1,1024]{1,0} custom-call(%custom-call.495), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.336 = f32[1,1024]{1,0} reshape(%custom-call.723), sharding={replicated}
  %while.363 = f32[1,1]{1,0} get-tuple-element(%while.309), index=53, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.496 = f32[1,1]{1,0} custom-call(%while.363), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.724 = f32[1,1]{1,0} custom-call(%custom-call.496), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.337 = f32[1,1]{1,0} reshape(%custom-call.724), sharding={replicated}
  %while.364 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=54, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.497 = f32[1,1024]{1,0} custom-call(%while.364), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.725 = f32[1,1024]{1,0} custom-call(%custom-call.497), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.338 = f32[1,1024]{1,0} reshape(%custom-call.725), sharding={replicated}
  %while.365 = f32[1,1]{1,0} get-tuple-element(%while.309), index=55, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.498 = f32[1,1]{1,0} custom-call(%while.365), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.726 = f32[1,1]{1,0} custom-call(%custom-call.498), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.339 = f32[1,1]{1,0} reshape(%custom-call.726), sharding={replicated}
  %while.366 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=56, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.499 = f32[1,1024]{1,0} custom-call(%while.366), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.727 = f32[1,1024]{1,0} custom-call(%custom-call.499), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.340 = f32[1,1024]{1,0} reshape(%custom-call.727), sharding={replicated}
  %while.367 = f32[1,1]{1,0} get-tuple-element(%while.309), index=57, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.500 = f32[1,1]{1,0} custom-call(%while.367), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.728 = f32[1,1]{1,0} custom-call(%custom-call.500), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.341 = f32[1,1]{1,0} reshape(%custom-call.728), sharding={replicated}
  %while.368 = f32[1,1024]{1,0} get-tuple-element(%while.309), index=58, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.501 = f32[1,1024]{1,0} custom-call(%while.368), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.729 = f32[1,1024]{1,0} custom-call(%custom-call.501), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.342 = f32[1,1024]{1,0} reshape(%custom-call.729), sharding={replicated}
  %while.369 = f32[1,1]{1,0} get-tuple-element(%while.309), index=59, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.502 = f32[1,1]{1,0} custom-call(%while.369), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.730 = f32[1,1]{1,0} custom-call(%custom-call.502), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.343 = f32[1,1]{1,0} reshape(%custom-call.730), sharding={replicated}
  %while.228 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=19, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.503 = f32[2,1024]{1,0} custom-call(%while.228), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.731 = f32[2,1024]{1,0} custom-call(%custom-call.503), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.344 = f32[2,1024]{1,0} reshape(%custom-call.731), sharding={replicated}
  %while.229 = f32[2,1]{1,0} get-tuple-element(%while.208), index=20, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.504 = f32[2,1]{1,0} custom-call(%while.229), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.732 = f32[2,1]{1,0} custom-call(%custom-call.504), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.345 = f32[2,1]{1,0} reshape(%custom-call.732), sharding={replicated}
  %while.230 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=21, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.505 = f32[2,1024]{1,0} custom-call(%while.230), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.733 = f32[2,1024]{1,0} custom-call(%custom-call.505), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.346 = f32[2,1024]{1,0} reshape(%custom-call.733), sharding={replicated}
  %while.231 = f32[2,1]{1,0} get-tuple-element(%while.208), index=22, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.506 = f32[2,1]{1,0} custom-call(%while.231), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.734 = f32[2,1]{1,0} custom-call(%custom-call.506), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.347 = f32[2,1]{1,0} reshape(%custom-call.734), sharding={replicated}
  %while.232 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=23, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.507 = f32[2,1024]{1,0} custom-call(%while.232), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.735 = f32[2,1024]{1,0} custom-call(%custom-call.507), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.348 = f32[2,1024]{1,0} reshape(%custom-call.735), sharding={replicated}
  %while.233 = f32[2,1]{1,0} get-tuple-element(%while.208), index=24, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.508 = f32[2,1]{1,0} custom-call(%while.233), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.736 = f32[2,1]{1,0} custom-call(%custom-call.508), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.349 = f32[2,1]{1,0} reshape(%custom-call.736), sharding={replicated}
  %while.234 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=25, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.509 = f32[2,1024]{1,0} custom-call(%while.234), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.737 = f32[2,1024]{1,0} custom-call(%custom-call.509), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.350 = f32[2,1024]{1,0} reshape(%custom-call.737), sharding={replicated}
  %while.235 = f32[2,1]{1,0} get-tuple-element(%while.208), index=26, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.510 = f32[2,1]{1,0} custom-call(%while.235), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.738 = f32[2,1]{1,0} custom-call(%custom-call.510), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.351 = f32[2,1]{1,0} reshape(%custom-call.738), sharding={replicated}
  %while.236 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=27, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.511 = f32[2,1024]{1,0} custom-call(%while.236), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.739 = f32[2,1024]{1,0} custom-call(%custom-call.511), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.352 = f32[2,1024]{1,0} reshape(%custom-call.739), sharding={replicated}
  %while.237 = f32[2,1]{1,0} get-tuple-element(%while.208), index=28, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.512 = f32[2,1]{1,0} custom-call(%while.237), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.740 = f32[2,1]{1,0} custom-call(%custom-call.512), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.353 = f32[2,1]{1,0} reshape(%custom-call.740), sharding={replicated}
  %while.238 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=29, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.513 = f32[2,1024]{1,0} custom-call(%while.238), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.741 = f32[2,1024]{1,0} custom-call(%custom-call.513), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.354 = f32[2,1024]{1,0} reshape(%custom-call.741), sharding={replicated}
  %while.239 = f32[2,1]{1,0} get-tuple-element(%while.208), index=30, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.514 = f32[2,1]{1,0} custom-call(%while.239), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.742 = f32[2,1]{1,0} custom-call(%custom-call.514), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.355 = f32[2,1]{1,0} reshape(%custom-call.742), sharding={replicated}
  %while.240 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=31, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.515 = f32[2,1024]{1,0} custom-call(%while.240), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.743 = f32[2,1024]{1,0} custom-call(%custom-call.515), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.356 = f32[2,1024]{1,0} reshape(%custom-call.743), sharding={replicated}
  %while.241 = f32[2,1]{1,0} get-tuple-element(%while.208), index=32, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.516 = f32[2,1]{1,0} custom-call(%while.241), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.744 = f32[2,1]{1,0} custom-call(%custom-call.516), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.357 = f32[2,1]{1,0} reshape(%custom-call.744), sharding={replicated}
  %while.242 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=33, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.517 = f32[2,1024]{1,0} custom-call(%while.242), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.745 = f32[2,1024]{1,0} custom-call(%custom-call.517), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.358 = f32[2,1024]{1,0} reshape(%custom-call.745), sharding={replicated}
  %while.243 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=34, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.518 = f32[2,1024]{1,0} custom-call(%while.243), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.746 = f32[2,1024]{1,0} custom-call(%custom-call.518), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.359 = f32[2,1024]{1,0} reshape(%custom-call.746), sharding={replicated}
  %while.244 = f32[2,1]{1,0} get-tuple-element(%while.208), index=35, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.519 = f32[2,1]{1,0} custom-call(%while.244), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.747 = f32[2,1]{1,0} custom-call(%custom-call.519), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.360 = f32[2,1]{1,0} reshape(%custom-call.747), sharding={replicated}
  %while.245 = f32[2,1]{1,0} get-tuple-element(%while.208), index=36, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.520 = f32[2,1]{1,0} custom-call(%while.245), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.748 = f32[2,1]{1,0} custom-call(%custom-call.520), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.361 = f32[2,1]{1,0} reshape(%custom-call.748), sharding={replicated}
  %while.246 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=37, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.521 = f32[2,1024]{1,0} custom-call(%while.246), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.749 = f32[2,1024]{1,0} custom-call(%custom-call.521), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.362 = f32[2,1024]{1,0} reshape(%custom-call.749), sharding={replicated}
  %while.247 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=38, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.522 = f32[2,1024]{1,0} custom-call(%while.247), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.750 = f32[2,1024]{1,0} custom-call(%custom-call.522), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.363 = f32[2,1024]{1,0} reshape(%custom-call.750), sharding={replicated}
  %while.248 = f32[2,1]{1,0} get-tuple-element(%while.208), index=39, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.523 = f32[2,1]{1,0} custom-call(%while.248), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.751 = f32[2,1]{1,0} custom-call(%custom-call.523), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.364 = f32[2,1]{1,0} reshape(%custom-call.751), sharding={replicated}
  %while.249 = f32[2,1]{1,0} get-tuple-element(%while.208), index=40, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.524 = f32[2,1]{1,0} custom-call(%while.249), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.752 = f32[2,1]{1,0} custom-call(%custom-call.524), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.365 = f32[2,1]{1,0} reshape(%custom-call.752), sharding={replicated}
  %while.250 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=41, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.525 = f32[2,1024]{1,0} custom-call(%while.250), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.753 = f32[2,1024]{1,0} custom-call(%custom-call.525), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.366 = f32[2,1024]{1,0} reshape(%custom-call.753), sharding={replicated}
  %while.251 = f32[2,1]{1,0} get-tuple-element(%while.208), index=42, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.526 = f32[2,1]{1,0} custom-call(%while.251), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.754 = f32[2,1]{1,0} custom-call(%custom-call.526), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.367 = f32[2,1]{1,0} reshape(%custom-call.754), sharding={replicated}
  %while.252 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=43, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.527 = f32[2,1024]{1,0} custom-call(%while.252), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.755 = f32[2,1024]{1,0} custom-call(%custom-call.527), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.368 = f32[2,1024]{1,0} reshape(%custom-call.755), sharding={replicated}
  %while.253 = f32[2,1]{1,0} get-tuple-element(%while.208), index=44, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.528 = f32[2,1]{1,0} custom-call(%while.253), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.756 = f32[2,1]{1,0} custom-call(%custom-call.528), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.369 = f32[2,1]{1,0} reshape(%custom-call.756), sharding={replicated}
  %while.254 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=45, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.529 = f32[2,1024]{1,0} custom-call(%while.254), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.757 = f32[2,1024]{1,0} custom-call(%custom-call.529), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.370 = f32[2,1024]{1,0} reshape(%custom-call.757), sharding={replicated}
  %while.255 = f32[2,1]{1,0} get-tuple-element(%while.208), index=46, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.530 = f32[2,1]{1,0} custom-call(%while.255), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.758 = f32[2,1]{1,0} custom-call(%custom-call.530), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.371 = f32[2,1]{1,0} reshape(%custom-call.758), sharding={replicated}
  %while.256 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=47, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.531 = f32[2,1024]{1,0} custom-call(%while.256), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.759 = f32[2,1024]{1,0} custom-call(%custom-call.531), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.372 = f32[2,1024]{1,0} reshape(%custom-call.759), sharding={replicated}
  %while.257 = f32[2,1]{1,0} get-tuple-element(%while.208), index=48, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.532 = f32[2,1]{1,0} custom-call(%while.257), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.760 = f32[2,1]{1,0} custom-call(%custom-call.532), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.373 = f32[2,1]{1,0} reshape(%custom-call.760), sharding={replicated}
  %while.258 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=49, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.533 = f32[2,1024]{1,0} custom-call(%while.258), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.761 = f32[2,1024]{1,0} custom-call(%custom-call.533), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.374 = f32[2,1024]{1,0} reshape(%custom-call.761), sharding={replicated}
  %while.259 = f32[2,1]{1,0} get-tuple-element(%while.208), index=50, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.534 = f32[2,1]{1,0} custom-call(%while.259), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.762 = f32[2,1]{1,0} custom-call(%custom-call.534), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.375 = f32[2,1]{1,0} reshape(%custom-call.762), sharding={replicated}
  %while.260 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=51, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.535 = f32[2,1024]{1,0} custom-call(%while.260), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.763 = f32[2,1024]{1,0} custom-call(%custom-call.535), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.376 = f32[2,1024]{1,0} reshape(%custom-call.763), sharding={replicated}
  %while.261 = f32[2,1]{1,0} get-tuple-element(%while.208), index=52, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.536 = f32[2,1]{1,0} custom-call(%while.261), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.764 = f32[2,1]{1,0} custom-call(%custom-call.536), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.377 = f32[2,1]{1,0} reshape(%custom-call.764), sharding={replicated}
  %while.262 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=53, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.537 = f32[2,1024]{1,0} custom-call(%while.262), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.765 = f32[2,1024]{1,0} custom-call(%custom-call.537), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.378 = f32[2,1024]{1,0} reshape(%custom-call.765), sharding={replicated}
  %while.263 = f32[2,1]{1,0} get-tuple-element(%while.208), index=54, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.538 = f32[2,1]{1,0} custom-call(%while.263), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.766 = f32[2,1]{1,0} custom-call(%custom-call.538), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.379 = f32[2,1]{1,0} reshape(%custom-call.766), sharding={replicated}
  %while.264 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=55, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.539 = f32[2,1024]{1,0} custom-call(%while.264), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.767 = f32[2,1024]{1,0} custom-call(%custom-call.539), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.380 = f32[2,1024]{1,0} reshape(%custom-call.767), sharding={replicated}
  %while.265 = f32[2,1]{1,0} get-tuple-element(%while.208), index=56, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.540 = f32[2,1]{1,0} custom-call(%while.265), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.768 = f32[2,1]{1,0} custom-call(%custom-call.540), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.381 = f32[2,1]{1,0} reshape(%custom-call.768), sharding={replicated}
  %while.266 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=57, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.541 = f32[2,1024]{1,0} custom-call(%while.266), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.769 = f32[2,1024]{1,0} custom-call(%custom-call.541), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.382 = f32[2,1024]{1,0} reshape(%custom-call.769), sharding={replicated}
  %while.267 = f32[2,1]{1,0} get-tuple-element(%while.208), index=58, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.542 = f32[2,1]{1,0} custom-call(%while.267), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.770 = f32[2,1]{1,0} custom-call(%custom-call.542), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.383 = f32[2,1]{1,0} reshape(%custom-call.770), sharding={replicated}
  %while.268 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=59, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.543 = f32[2,1024]{1,0} custom-call(%while.268), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.771 = f32[2,1024]{1,0} custom-call(%custom-call.543), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.384 = f32[2,1024]{1,0} reshape(%custom-call.771), sharding={replicated}
  %while.269 = f32[2,1]{1,0} get-tuple-element(%while.208), index=60, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.544 = f32[2,1]{1,0} custom-call(%while.269), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.772 = f32[2,1]{1,0} custom-call(%custom-call.544), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.385 = f32[2,1]{1,0} reshape(%custom-call.772), sharding={replicated}
  %while.270 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=61, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.545 = f32[2,1024]{1,0} custom-call(%while.270), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.773 = f32[2,1024]{1,0} custom-call(%custom-call.545), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.386 = f32[2,1024]{1,0} reshape(%custom-call.773), sharding={replicated}
  %while.271 = f32[2,1]{1,0} get-tuple-element(%while.208), index=62, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.546 = f32[2,1]{1,0} custom-call(%while.271), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.774 = f32[2,1]{1,0} custom-call(%custom-call.546), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.387 = f32[2,1]{1,0} reshape(%custom-call.774), sharding={replicated}
  %while.272 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=63, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.547 = f32[2,1024]{1,0} custom-call(%while.272), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.775 = f32[2,1024]{1,0} custom-call(%custom-call.547), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.388 = f32[2,1024]{1,0} reshape(%custom-call.775), sharding={replicated}
  %while.273 = f32[2,1]{1,0} get-tuple-element(%while.208), index=64, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.548 = f32[2,1]{1,0} custom-call(%while.273), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.776 = f32[2,1]{1,0} custom-call(%custom-call.548), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.389 = f32[2,1]{1,0} reshape(%custom-call.776), sharding={replicated}
  %while.274 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=65, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.549 = f32[2,1024]{1,0} custom-call(%while.274), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.777 = f32[2,1024]{1,0} custom-call(%custom-call.549), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.390 = f32[2,1024]{1,0} reshape(%custom-call.777), sharding={replicated}
  %while.275 = f32[2,1]{1,0} get-tuple-element(%while.208), index=66, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.550 = f32[2,1]{1,0} custom-call(%while.275), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.778 = f32[2,1]{1,0} custom-call(%custom-call.550), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.391 = f32[2,1]{1,0} reshape(%custom-call.778), sharding={replicated}
  %while.276 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=67, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.551 = f32[2,1024]{1,0} custom-call(%while.276), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.779 = f32[2,1024]{1,0} custom-call(%custom-call.551), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.392 = f32[2,1024]{1,0} reshape(%custom-call.779), sharding={replicated}
  %while.277 = f32[2,1]{1,0} get-tuple-element(%while.208), index=68, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.552 = f32[2,1]{1,0} custom-call(%while.277), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.780 = f32[2,1]{1,0} custom-call(%custom-call.552), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.393 = f32[2,1]{1,0} reshape(%custom-call.780), sharding={replicated}
  %while.278 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=69, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.553 = f32[2,1024]{1,0} custom-call(%while.278), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.781 = f32[2,1024]{1,0} custom-call(%custom-call.553), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.394 = f32[2,1024]{1,0} reshape(%custom-call.781), sharding={replicated}
  %while.279 = f32[2,1]{1,0} get-tuple-element(%while.208), index=70, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.554 = f32[2,1]{1,0} custom-call(%while.279), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.782 = f32[2,1]{1,0} custom-call(%custom-call.554), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.395 = f32[2,1]{1,0} reshape(%custom-call.782), sharding={replicated}
  %while.280 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=71, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.555 = f32[2,1024]{1,0} custom-call(%while.280), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.783 = f32[2,1024]{1,0} custom-call(%custom-call.555), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.396 = f32[2,1024]{1,0} reshape(%custom-call.783), sharding={replicated}
  %while.281 = f32[2,1]{1,0} get-tuple-element(%while.208), index=72, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.556 = f32[2,1]{1,0} custom-call(%while.281), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.784 = f32[2,1]{1,0} custom-call(%custom-call.556), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.397 = f32[2,1]{1,0} reshape(%custom-call.784), sharding={replicated}
  %while.282 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=73, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.557 = f32[2,1024]{1,0} custom-call(%while.282), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.785 = f32[2,1024]{1,0} custom-call(%custom-call.557), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.398 = f32[2,1024]{1,0} reshape(%custom-call.785), sharding={replicated}
  %while.283 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=74, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.558 = f32[2,1024]{1,0} custom-call(%while.283), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.786 = f32[2,1024]{1,0} custom-call(%custom-call.558), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.399 = f32[2,1024]{1,0} reshape(%custom-call.786), sharding={replicated}
  %while.284 = f32[2,1]{1,0} get-tuple-element(%while.208), index=75, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.559 = f32[2,1]{1,0} custom-call(%while.284), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.787 = f32[2,1]{1,0} custom-call(%custom-call.559), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.400 = f32[2,1]{1,0} reshape(%custom-call.787), sharding={replicated}
  %while.285 = f32[2,1]{1,0} get-tuple-element(%while.208), index=76, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.560 = f32[2,1]{1,0} custom-call(%while.285), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.788 = f32[2,1]{1,0} custom-call(%custom-call.560), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.401 = f32[2,1]{1,0} reshape(%custom-call.788), sharding={replicated}
  %while.286 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=77, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.561 = f32[2,1024]{1,0} custom-call(%while.286), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.789 = f32[2,1024]{1,0} custom-call(%custom-call.561), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.402 = f32[2,1024]{1,0} reshape(%custom-call.789), sharding={replicated}
  %while.287 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=78, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.562 = f32[2,1024]{1,0} custom-call(%while.287), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.790 = f32[2,1024]{1,0} custom-call(%custom-call.562), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.403 = f32[2,1024]{1,0} reshape(%custom-call.790), sharding={replicated}
  %while.288 = f32[2,1]{1,0} get-tuple-element(%while.208), index=79, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.563 = f32[2,1]{1,0} custom-call(%while.288), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.791 = f32[2,1]{1,0} custom-call(%custom-call.563), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.404 = f32[2,1]{1,0} reshape(%custom-call.791), sharding={replicated}
  %while.289 = f32[2,1]{1,0} get-tuple-element(%while.208), index=80, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.564 = f32[2,1]{1,0} custom-call(%while.289), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.792 = f32[2,1]{1,0} custom-call(%custom-call.564), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.405 = f32[2,1]{1,0} reshape(%custom-call.792), sharding={replicated}
  %while.290 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=81, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.565 = f32[2,1024]{1,0} custom-call(%while.290), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.793 = f32[2,1024]{1,0} custom-call(%custom-call.565), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.406 = f32[2,1024]{1,0} reshape(%custom-call.793), sharding={replicated}
  %while.291 = f32[2,1]{1,0} get-tuple-element(%while.208), index=82, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.566 = f32[2,1]{1,0} custom-call(%while.291), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.794 = f32[2,1]{1,0} custom-call(%custom-call.566), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.407 = f32[2,1]{1,0} reshape(%custom-call.794), sharding={replicated}
  %while.292 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=83, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.567 = f32[2,1024]{1,0} custom-call(%while.292), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.795 = f32[2,1024]{1,0} custom-call(%custom-call.567), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.408 = f32[2,1024]{1,0} reshape(%custom-call.795), sharding={replicated}
  %while.293 = f32[2,1]{1,0} get-tuple-element(%while.208), index=84, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.568 = f32[2,1]{1,0} custom-call(%while.293), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.796 = f32[2,1]{1,0} custom-call(%custom-call.568), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.409 = f32[2,1]{1,0} reshape(%custom-call.796), sharding={replicated}
  %while.294 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=85, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.569 = f32[2,1024]{1,0} custom-call(%while.294), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.797 = f32[2,1024]{1,0} custom-call(%custom-call.569), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.410 = f32[2,1024]{1,0} reshape(%custom-call.797), sharding={replicated}
  %while.295 = f32[2,1]{1,0} get-tuple-element(%while.208), index=86, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.570 = f32[2,1]{1,0} custom-call(%while.295), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.798 = f32[2,1]{1,0} custom-call(%custom-call.570), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.411 = f32[2,1]{1,0} reshape(%custom-call.798), sharding={replicated}
  %while.296 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=87, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.571 = f32[2,1024]{1,0} custom-call(%while.296), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.799 = f32[2,1024]{1,0} custom-call(%custom-call.571), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.412 = f32[2,1024]{1,0} reshape(%custom-call.799), sharding={replicated}
  %while.297 = f32[2,1]{1,0} get-tuple-element(%while.208), index=88, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.572 = f32[2,1]{1,0} custom-call(%while.297), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.800 = f32[2,1]{1,0} custom-call(%custom-call.572), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.413 = f32[2,1]{1,0} reshape(%custom-call.800), sharding={replicated}
  %while.298 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=89, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.573 = f32[2,1024]{1,0} custom-call(%while.298), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.801 = f32[2,1024]{1,0} custom-call(%custom-call.573), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.414 = f32[2,1024]{1,0} reshape(%custom-call.801), sharding={replicated}
  %while.299 = f32[2,1]{1,0} get-tuple-element(%while.208), index=90, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.574 = f32[2,1]{1,0} custom-call(%while.299), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.802 = f32[2,1]{1,0} custom-call(%custom-call.574), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.415 = f32[2,1]{1,0} reshape(%custom-call.802), sharding={replicated}
  %while.300 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=91, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.575 = f32[2,1024]{1,0} custom-call(%while.300), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.803 = f32[2,1024]{1,0} custom-call(%custom-call.575), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.416 = f32[2,1024]{1,0} reshape(%custom-call.803), sharding={replicated}
  %while.301 = f32[2,1]{1,0} get-tuple-element(%while.208), index=92, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.576 = f32[2,1]{1,0} custom-call(%while.301), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.804 = f32[2,1]{1,0} custom-call(%custom-call.576), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.417 = f32[2,1]{1,0} reshape(%custom-call.804), sharding={replicated}
  %while.302 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=93, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.577 = f32[2,1024]{1,0} custom-call(%while.302), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.805 = f32[2,1024]{1,0} custom-call(%custom-call.577), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.418 = f32[2,1024]{1,0} reshape(%custom-call.805), sharding={replicated}
  %while.303 = f32[2,1]{1,0} get-tuple-element(%while.208), index=94, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.578 = f32[2,1]{1,0} custom-call(%while.303), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.806 = f32[2,1]{1,0} custom-call(%custom-call.578), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.419 = f32[2,1]{1,0} reshape(%custom-call.806), sharding={replicated}
  %while.304 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=95, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.579 = f32[2,1024]{1,0} custom-call(%while.304), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.807 = f32[2,1024]{1,0} custom-call(%custom-call.579), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.420 = f32[2,1024]{1,0} reshape(%custom-call.807), sharding={replicated}
  %while.305 = f32[2,1]{1,0} get-tuple-element(%while.208), index=96, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.580 = f32[2,1]{1,0} custom-call(%while.305), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.808 = f32[2,1]{1,0} custom-call(%custom-call.580), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.421 = f32[2,1]{1,0} reshape(%custom-call.808), sharding={replicated}
  %while.306 = f32[2,1024]{1,0} get-tuple-element(%while.208), index=97, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.581 = f32[2,1024]{1,0} custom-call(%while.306), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.809 = f32[2,1024]{1,0} custom-call(%custom-call.581), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.422 = f32[2,1024]{1,0} reshape(%custom-call.809), sharding={replicated}
  %while.307 = f32[2,1]{1,0} get-tuple-element(%while.208), index=98, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %custom-call.582 = f32[2,1]{1,0} custom-call(%while.307), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.810 = f32[2,1]{1,0} custom-call(%custom-call.582), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.423 = f32[2,1]{1,0} reshape(%custom-call.810), sharding={replicated}
  %state_opt_state_2__count.1 = s32[] parameter(227), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, []>"}, metadata={op_name="state.opt_state[2].count"}
  %lt.24 = pred[] compare(%state_opt_state_2__count.1, %constant.714), direction=LT, metadata={op_name="jit(train_step)/lt" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_join.py" source_line=43 source_end_line=43 source_column=25 source_end_column=40}
  %sub.88 = s32[] subtract(%state_opt_state_2__count.1, %constant.716), metadata={op_name="jit(train_step)/sub" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=143 source_end_line=143 source_column=21 source_end_column=45}
  %jit_clip_.225 = s32[] call(%sub.88, %constant.716, %constant.714), to_apply=%clip_1183.428, metadata={op_name="jit(train_step)/jit(clip)" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=143 source_end_line=143 source_column=12 source_end_column=67}
  %convert_element_type.1539 = f32[] convert(%jit_clip_.225), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=144 source_end_line=144 source_column=15 source_end_column=39}
  %div.1670 = f32[] divide(%convert_element_type.1539, %constant.715), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=144 source_end_line=144 source_column=15 source_end_column=39}
  %sub.89 = f32[] subtract(%constant.715, %div.1670), metadata={op_name="jit(train_step)/sub" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=144 source_end_line=144 source_column=11 source_end_column=39}
  %constant.705 = f32[] constant(-3e-05)
  %mul.1822 = f32[] multiply(%sub.89, %constant.705), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=145 source_end_line=145 source_column=11 source_end_column=51}
  %constant.704 = f32[] constant(3e-05)
  %add.1010 = f32[] add(%mul.1822, %constant.704), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_schedule.py" source_line=145 source_end_line=145 source_column=11 source_end_column=51}
  %sub.90 = s32[] subtract(%state_opt_state_2__count.1, %constant.714), metadata={op_name="jit(train_step)/sub" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_join.py" source_line=43 source_end_line=43 source_column=59 source_end_column=74}
  %convert_element_type.1540 = f32[] convert(%sub.90), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1238 source_end_line=1238 source_column=12 source_end_column=30}
  %constant.703 = f32[] constant(14)
  %div.1671 = f32[] divide(%convert_element_type.1540, %constant.703), metadata={op_name="jit(train_step)/div" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1238 source_end_line=1238 source_column=12 source_end_column=30}
  %constant.702 = f32[] constant(3.14159274)
  %mul.1823 = f32[] multiply(%div.1671, %constant.702), metadata={op_name="jit(train_step)/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1239 source_end_line=1239 source_column=25 source_end_column=37}
  %cos.1 = f32[] cosine(%mul.1823), metadata={op_name="jit(train_step)/cos" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1239 source_end_line=1239 source_column=17 source_end_column=38}
  %add.1011 = f32[] add(%cos.1, %constant.715), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1239 source_end_line=1239 source_column=17 source_end_column=38}
  %constant.701 = f32[] constant(0.5)
  %mul.1824 = f32[] multiply(%add.1011, %constant.701), metadata={op_name="jit(train_step)/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1239 source_end_line=1239 source_column=10 source_end_column=43}
  %mul.1825 = f32[] multiply(%mul.1824, %constant.704), metadata={op_name="jit(train_step)/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1240 source_end_line=1240 source_column=11 source_end_column=22}
  %sub.91 = f32[] subtract(%constant.715, %mul.1824), metadata={op_name="jit(train_step)/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1240 source_end_line=1240 source_column=37 source_end_column=42}
  %constant.700 = f32[] constant(3e-06)
  %mul.1826 = f32[] multiply(%sub.91, %constant.700), metadata={op_name="jit(train_step)/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1240 source_end_line=1240 source_column=25 source_end_column=43}
  %add.1012 = f32[] add(%mul.1825, %mul.1826), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/maxtext_utils.py" source_line=1240 source_end_line=1240 source_column=11 source_end_column=22}
  %jit__where_.424 = f32[] call(%lt.24, %add.1010, %add.1012), to_apply=%_where_1191.429, metadata={op_name="jit(train_step)/jit(_where)" source_file="/usr/local/lib/python3.12/dist-packages/optax/schedules/_join.py" source_line=43 source_end_line=43 source_column=15 source_end_column=76}
  %constant.699 = f32[] constant(-1)
  %mul.1827 = f32[] multiply(%jit__where_.424, %constant.699), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=964 source_end_line=964 source_column=43 source_end_column=67}
  %convert_element_type.1541 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1828 = bf16[7168]{0} broadcast(%convert_element_type.1541), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1613 = bf16[32,4096,7168]{2,1,0} multiply(%convert_element_type.1400, %dot_general.149), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %constant.713 = bf16[] constant(0)
  %reduce_sum.4070 = bf16[7168]{0} reduce(%mul.1613, %constant.713), dimensions={0,1}, to_apply=%region_61.98, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %reshape.295 = bf16[1,1,7168]{2,1,0} reshape(%reduce_sum.4070), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reshape" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %reduce_sum.4071 = bf16[7168]{0} reduce(%reshape.295, %constant.713), dimensions={0,1}, to_apply=%region_62.99, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/decoder_norm/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/normalizations.py" source_line=69 source_end_line=69 source_column=11 source_end_column=20}
  %mul.1625 = bf16[7168]{0} multiply(%reduce_sum.4071, %reduce_sum.4071), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1408 = f32[7168]{0} convert(%mul.1625), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4074 = f32[] reduce(%convert_element_type.1408, %constant.712), dimensions={0}, to_apply=%region_306.394, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1409 = bf16[] convert(%reduce_sum.4074), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %while.312 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%while.309), index=2, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.167 = bf16[7168,1,18432]{2,1,0} reshape(%while.312), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1626 = bf16[7168,1,18432]{2,1,0} multiply(%transpose.167, %transpose.167), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1410 = f32[7168,1,18432]{2,1,0} convert(%mul.1626), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4075 = f32[] reduce(%convert_element_type.1410, %constant.712), dimensions={0,1,2}, to_apply=%region_307.395, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1411 = bf16[] convert(%reduce_sum.4075), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.845 = bf16[] add(%convert_element_type.1409, %convert_element_type.1411), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.313 = bf16[1,7168,18432]{2,1,0} get-tuple-element(%while.309), index=3, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.166 = bf16[7168,1,18432]{2,1,0} reshape(%while.313), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1627 = bf16[7168,1,18432]{2,1,0} multiply(%transpose.166, %transpose.166), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1412 = f32[7168,1,18432]{2,1,0} convert(%mul.1627), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4076 = f32[] reduce(%convert_element_type.1412, %constant.712), dimensions={0,1,2}, to_apply=%region_308.396, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1413 = bf16[] convert(%reduce_sum.4076), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.846 = bf16[] add(%add.845, %convert_element_type.1413), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.314 = bf16[1,18432,7168]{2,1,0} get-tuple-element(%while.309), index=4, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.165 = bf16[18432,1,7168]{2,1,0} reshape(%while.314), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1628 = bf16[18432,1,7168]{2,1,0} multiply(%transpose.165, %transpose.165), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1414 = f32[18432,1,7168]{2,1,0} convert(%mul.1628), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4077 = f32[] reduce(%convert_element_type.1414, %constant.712), dimensions={0,1,2}, to_apply=%region_309.397, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1415 = bf16[] convert(%reduce_sum.4077), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.847 = bf16[] add(%add.846, %convert_element_type.1415), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.315 = bf16[1,7168]{1,0} get-tuple-element(%while.309), index=5, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.164 = bf16[7168,1]{1,0} reshape(%while.315), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1629 = bf16[7168,1]{1,0} multiply(%transpose.164, %transpose.164), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1416 = f32[7168,1]{1,0} convert(%mul.1629), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4078 = f32[] reduce(%convert_element_type.1416, %constant.712), dimensions={0,1}, to_apply=%region_310.398, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1417 = bf16[] convert(%reduce_sum.4078), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.848 = bf16[] add(%add.847, %convert_element_type.1417), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.316 = bf16[1,7168]{1,0} get-tuple-element(%while.309), index=6, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.163 = bf16[7168,1]{1,0} reshape(%while.316), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1630 = bf16[7168,1]{1,0} multiply(%transpose.163, %transpose.163), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1418 = f32[7168,1]{1,0} convert(%mul.1630), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4079 = f32[] reduce(%convert_element_type.1418, %constant.712), dimensions={0,1}, to_apply=%region_311.399, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1419 = bf16[] convert(%reduce_sum.4079), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.849 = bf16[] add(%add.848, %convert_element_type.1419), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.317 = bf16[1,512]{1,0} get-tuple-element(%while.309), index=7, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.162 = bf16[512,1]{1,0} reshape(%while.317), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1631 = bf16[512,1]{1,0} multiply(%transpose.162, %transpose.162), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1420 = f32[512,1]{1,0} convert(%mul.1631), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4080 = f32[] reduce(%convert_element_type.1420, %constant.712), dimensions={0,1}, to_apply=%region_312.400, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1421 = bf16[] convert(%reduce_sum.4080), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.850 = bf16[] add(%add.849, %convert_element_type.1421), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.318 = bf16[1,128,128,7168]{3,2,1,0} get-tuple-element(%while.309), index=8, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.161 = bf16[128,1,128,7168]{3,2,1,0} reshape(%while.318), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1632 = bf16[128,1,128,7168]{3,2,1,0} multiply(%transpose.161, %transpose.161), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1422 = f32[128,1,128,7168]{3,2,1,0} convert(%mul.1632), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4081 = f32[] reduce(%convert_element_type.1422, %constant.712), dimensions={0,1,2,3}, to_apply=%region_313.401, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1423 = bf16[] convert(%reduce_sum.4081), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.851 = bf16[] add(%add.850, %convert_element_type.1423), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.319 = bf16[1,1536]{1,0} get-tuple-element(%while.309), index=9, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.160 = bf16[1536,1]{1,0} reshape(%while.319), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1633 = bf16[1536,1]{1,0} multiply(%transpose.160, %transpose.160), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1424 = f32[1536,1]{1,0} convert(%mul.1633), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4082 = f32[] reduce(%convert_element_type.1424, %constant.712), dimensions={0,1}, to_apply=%region_314.402, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1425 = bf16[] convert(%reduce_sum.4082), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.852 = bf16[] add(%add.851, %convert_element_type.1425), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.320 = bf16[1,7168,576]{2,1,0} get-tuple-element(%while.309), index=10, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.159 = bf16[7168,1,576]{2,1,0} reshape(%while.320), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1634 = bf16[7168,1,576]{2,1,0} multiply(%transpose.159, %transpose.159), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1426 = f32[7168,1,576]{2,1,0} convert(%mul.1634), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4083 = f32[] reduce(%convert_element_type.1426, %constant.712), dimensions={0,1,2}, to_apply=%region_315.403, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1427 = bf16[] convert(%reduce_sum.4083), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.853 = bf16[] add(%add.852, %convert_element_type.1427), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.321 = bf16[1,512,128,256]{3,2,1,0} get-tuple-element(%while.309), index=11, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.158 = bf16[512,1,128,256]{3,2,1,0} reshape(%while.321), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1635 = bf16[512,1,128,256]{3,2,1,0} multiply(%transpose.158, %transpose.158), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1428 = f32[512,1,128,256]{3,2,1,0} convert(%mul.1635), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4084 = f32[] reduce(%convert_element_type.1428, %constant.712), dimensions={0,1,2,3}, to_apply=%region_316.404, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1429 = bf16[] convert(%reduce_sum.4084), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.854 = bf16[] add(%add.853, %convert_element_type.1429), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.322 = bf16[1,7168,1536]{2,1,0} get-tuple-element(%while.309), index=12, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.157 = bf16[7168,1,1536]{2,1,0} reshape(%while.322), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1636 = bf16[7168,1,1536]{2,1,0} multiply(%transpose.157, %transpose.157), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1430 = f32[7168,1,1536]{2,1,0} convert(%mul.1636), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4085 = f32[] reduce(%convert_element_type.1430, %constant.712), dimensions={0,1,2}, to_apply=%region_317.405, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1431 = bf16[] convert(%reduce_sum.4085), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.855 = bf16[] add(%add.854, %convert_element_type.1431), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.323 = bf16[1,1536,128,192]{3,2,1,0} get-tuple-element(%while.309), index=13, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.156 = bf16[1536,1,128,192]{3,2,1,0} reshape(%while.323), metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1637 = bf16[1536,1,128,192]{3,2,1,0} multiply(%transpose.156, %transpose.156), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1432 = f32[1536,1,128,192]{3,2,1,0} convert(%mul.1637), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4086 = f32[] reduce(%convert_element_type.1432, %constant.712), dimensions={0,1,2,3}, to_apply=%region_318.406, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1433 = bf16[] convert(%reduce_sum.4086), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.856 = bf16[] add(%add.855, %convert_element_type.1433), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %dot_general.148 = bf16[129280,7168]{1,0} dot(%sharding_constraint.196, %mul.1599), lhs_contracting_dims={0,1}, rhs_contracting_dims={0,1}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/logits_dense/dot_general" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=88 source_end_line=88 source_column=9 source_end_column=98}
  %transpose.138 = bf16[7168,129280]{0,1} transpose(%dot_general.148), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_output_head/logits_dense/transpose" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/linears.py" source_line=88 source_end_line=88 source_column=9 source_end_column=98}
  %mul.1638 = bf16[7168,129280]{0,1} multiply(%transpose.138, %transpose.138), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1434 = f32[7168,129280]{0,1} convert(%mul.1638), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4087 = f32[] reduce(%convert_element_type.1434, %constant.712), dimensions={0,1}, to_apply=%region_319.407, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1435 = bf16[] convert(%reduce_sum.4087), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.857 = bf16[] add(%add.856, %convert_element_type.1435), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %constant.641 = f32[] constant(0)
  %broadcast.238 = f32[64,2]{1,0} broadcast(%constant.641), dimensions={}
  %reduce_sum.4088 = f32[] reduce(%broadcast.238, %constant.712), dimensions={0,1}, to_apply=%region_320.408, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1436 = bf16[] convert(%reduce_sum.4088), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.858 = bf16[] add(%add.857, %convert_element_type.1436), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.211 = bf16[2,7168,64]{2,1,0} get-tuple-element(%while.208), index=2, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.155 = bf16[7168,2,64]{2,0,1} transpose(%while.211), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1639 = bf16[7168,2,64]{2,0,1} multiply(%transpose.155, %transpose.155), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1437 = f32[7168,2,64]{2,0,1} convert(%mul.1639), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4089 = f32[] reduce(%convert_element_type.1437, %constant.712), dimensions={0,1,2}, to_apply=%region_321.409, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1438 = bf16[] convert(%reduce_sum.4089), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.859 = bf16[] add(%add.858, %convert_element_type.1438), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.212 = bf16[2,64]{1,0} get-tuple-element(%while.208), index=3, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.154 = bf16[64,2]{0,1} transpose(%while.212), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1640 = bf16[64,2]{0,1} multiply(%transpose.154, %transpose.154), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1439 = f32[64,2]{0,1} convert(%mul.1640), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4090 = f32[] reduce(%convert_element_type.1439, %constant.712), dimensions={0,1}, to_apply=%region_322.410, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1440 = bf16[] convert(%reduce_sum.4090), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.860 = bf16[] add(%add.859, %convert_element_type.1440), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.213 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%while.208), index=4, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.153 = bf16[64,2,7168,2048]{3,2,0,1} transpose(%while.213), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1641 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%transpose.153, %transpose.153), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1441 = f32[64,2,7168,2048]{3,2,0,1} convert(%mul.1641), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4091 = f32[] reduce(%convert_element_type.1441, %constant.712), dimensions={0,1,2,3}, to_apply=%region_323.411, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1442 = bf16[] convert(%reduce_sum.4091), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.861 = bf16[] add(%add.860, %convert_element_type.1442), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.214 = bf16[2,64,7168,2048]{3,2,1,0} get-tuple-element(%while.208), index=5, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.152 = bf16[64,2,7168,2048]{3,2,0,1} transpose(%while.214), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1642 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%transpose.152, %transpose.152), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1443 = f32[64,2,7168,2048]{3,2,0,1} convert(%mul.1642), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4092 = f32[] reduce(%convert_element_type.1443, %constant.712), dimensions={0,1,2,3}, to_apply=%region_324.412, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1444 = bf16[] convert(%reduce_sum.4092), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.862 = bf16[] add(%add.861, %convert_element_type.1444), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.215 = bf16[2,64,2048,7168]{3,2,1,0} get-tuple-element(%while.208), index=6, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.151 = bf16[64,2,2048,7168]{3,2,0,1} transpose(%while.215), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1643 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%transpose.151, %transpose.151), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1445 = f32[64,2,2048,7168]{3,2,0,1} convert(%mul.1643), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4093 = f32[] reduce(%convert_element_type.1445, %constant.712), dimensions={0,1,2,3}, to_apply=%region_325.413, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1446 = bf16[] convert(%reduce_sum.4093), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.863 = bf16[] add(%add.862, %convert_element_type.1446), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.216 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%while.208), index=7, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.150 = bf16[7168,2,2048]{2,0,1} transpose(%while.216), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1644 = bf16[7168,2,2048]{2,0,1} multiply(%transpose.150, %transpose.150), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1447 = f32[7168,2,2048]{2,0,1} convert(%mul.1644), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4094 = f32[] reduce(%convert_element_type.1447, %constant.712), dimensions={0,1,2}, to_apply=%region_326.414, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1448 = bf16[] convert(%reduce_sum.4094), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.864 = bf16[] add(%add.863, %convert_element_type.1448), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.217 = bf16[2,7168,2048]{2,1,0} get-tuple-element(%while.208), index=8, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.149 = bf16[7168,2,2048]{2,0,1} transpose(%while.217), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1645 = bf16[7168,2,2048]{2,0,1} multiply(%transpose.149, %transpose.149), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1449 = f32[7168,2,2048]{2,0,1} convert(%mul.1645), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4095 = f32[] reduce(%convert_element_type.1449, %constant.712), dimensions={0,1,2}, to_apply=%region_327.415, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1450 = bf16[] convert(%reduce_sum.4095), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.865 = bf16[] add(%add.864, %convert_element_type.1450), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.218 = bf16[2,2048,7168]{2,1,0} get-tuple-element(%while.208), index=9, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.148 = bf16[2048,2,7168]{2,0,1} transpose(%while.218), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1646 = bf16[2048,2,7168]{2,0,1} multiply(%transpose.148, %transpose.148), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1451 = f32[2048,2,7168]{2,0,1} convert(%mul.1646), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4096 = f32[] reduce(%convert_element_type.1451, %constant.712), dimensions={0,1,2}, to_apply=%region_328.416, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1452 = bf16[] convert(%reduce_sum.4096), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.866 = bf16[] add(%add.865, %convert_element_type.1452), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.219 = bf16[2,7168]{1,0} get-tuple-element(%while.208), index=10, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.147 = bf16[7168,2]{0,1} transpose(%while.219), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1647 = bf16[7168,2]{0,1} multiply(%transpose.147, %transpose.147), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1453 = f32[7168,2]{0,1} convert(%mul.1647), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4097 = f32[] reduce(%convert_element_type.1453, %constant.712), dimensions={0,1}, to_apply=%region_329.417, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1454 = bf16[] convert(%reduce_sum.4097), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.867 = bf16[] add(%add.866, %convert_element_type.1454), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.220 = bf16[2,7168]{1,0} get-tuple-element(%while.208), index=11, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.146 = bf16[7168,2]{0,1} transpose(%while.220), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1648 = bf16[7168,2]{0,1} multiply(%transpose.146, %transpose.146), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1455 = f32[7168,2]{0,1} convert(%mul.1648), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4098 = f32[] reduce(%convert_element_type.1455, %constant.712), dimensions={0,1}, to_apply=%region_330.418, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1456 = bf16[] convert(%reduce_sum.4098), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.868 = bf16[] add(%add.867, %convert_element_type.1456), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.221 = bf16[2,512]{1,0} get-tuple-element(%while.208), index=12, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.145 = bf16[512,2]{0,1} transpose(%while.221), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1649 = bf16[512,2]{0,1} multiply(%transpose.145, %transpose.145), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1457 = f32[512,2]{0,1} convert(%mul.1649), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4099 = f32[] reduce(%convert_element_type.1457, %constant.712), dimensions={0,1}, to_apply=%region_331.419, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1458 = bf16[] convert(%reduce_sum.4099), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.869 = bf16[] add(%add.868, %convert_element_type.1458), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.222 = bf16[2,128,128,7168]{3,2,1,0} get-tuple-element(%while.208), index=13, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.144 = bf16[128,2,128,7168]{3,2,0,1} transpose(%while.222), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1650 = bf16[128,2,128,7168]{3,2,0,1} multiply(%transpose.144, %transpose.144), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1459 = f32[128,2,128,7168]{3,2,0,1} convert(%mul.1650), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4100 = f32[] reduce(%convert_element_type.1459, %constant.712), dimensions={0,1,2,3}, to_apply=%region_332.420, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1460 = bf16[] convert(%reduce_sum.4100), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.870 = bf16[] add(%add.869, %convert_element_type.1460), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.223 = bf16[2,1536]{1,0} get-tuple-element(%while.208), index=14, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.143 = bf16[1536,2]{0,1} transpose(%while.223), dimensions={1,0}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1651 = bf16[1536,2]{0,1} multiply(%transpose.143, %transpose.143), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1461 = f32[1536,2]{0,1} convert(%mul.1651), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4101 = f32[] reduce(%convert_element_type.1461, %constant.712), dimensions={0,1}, to_apply=%region_333.421, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1462 = bf16[] convert(%reduce_sum.4101), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.871 = bf16[] add(%add.870, %convert_element_type.1462), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.224 = bf16[2,7168,576]{2,1,0} get-tuple-element(%while.208), index=15, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.142 = bf16[7168,2,576]{2,0,1} transpose(%while.224), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1652 = bf16[7168,2,576]{2,0,1} multiply(%transpose.142, %transpose.142), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1463 = f32[7168,2,576]{2,0,1} convert(%mul.1652), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4102 = f32[] reduce(%convert_element_type.1463, %constant.712), dimensions={0,1,2}, to_apply=%region_334.422, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1464 = bf16[] convert(%reduce_sum.4102), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.872 = bf16[] add(%add.871, %convert_element_type.1464), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.225 = bf16[2,512,128,256]{3,2,1,0} get-tuple-element(%while.208), index=16, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.141 = bf16[512,2,128,256]{3,2,0,1} transpose(%while.225), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1653 = bf16[512,2,128,256]{3,2,0,1} multiply(%transpose.141, %transpose.141), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1465 = f32[512,2,128,256]{3,2,0,1} convert(%mul.1653), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4103 = f32[] reduce(%convert_element_type.1465, %constant.712), dimensions={0,1,2,3}, to_apply=%region_335.423, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1466 = bf16[] convert(%reduce_sum.4103), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.873 = bf16[] add(%add.872, %convert_element_type.1466), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.226 = bf16[2,7168,1536]{2,1,0} get-tuple-element(%while.208), index=17, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.140 = bf16[7168,2,1536]{2,0,1} transpose(%while.226), dimensions={1,0,2}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1654 = bf16[7168,2,1536]{2,0,1} multiply(%transpose.140, %transpose.140), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1467 = f32[7168,2,1536]{2,0,1} convert(%mul.1654), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4104 = f32[] reduce(%convert_element_type.1467, %constant.712), dimensions={0,1,2}, to_apply=%region_336.424, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1468 = bf16[] convert(%reduce_sum.4104), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.874 = bf16[] add(%add.873, %convert_element_type.1468), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %while.227 = bf16[2,1536,128,192]{3,2,1,0} get-tuple-element(%while.208), index=18, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %transpose.139 = bf16[1536,2,128,192]{3,2,0,1} transpose(%while.227), dimensions={1,0,2,3}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/moe_layers.wrapped_fn/transpose" source_file="/opt/flax/flax/core/axes_scan.py" source_line=123 source_end_line=123 source_column=13 source_end_column=35}
  %mul.1655 = bf16[1536,2,128,192]{3,2,0,1} multiply(%transpose.139, %transpose.139), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1469 = f32[1536,2,128,192]{3,2,0,1} convert(%mul.1655), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4105 = f32[] reduce(%convert_element_type.1469, %constant.712), dimensions={0,1,2,3}, to_apply=%region_337.425, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1470 = bf16[] convert(%reduce_sum.4105), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.875 = bf16[] add(%add.874, %convert_element_type.1470), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %constant.643 = bf16[] constant(0)
  %broadcast_in_dim.1619 = bf16[129280,7168]{1,0} broadcast(%constant.643), dimensions={}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %while.311 = bf16[32,4096,7168]{2,1,0} get-tuple-element(%while.309), index=1, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/dense_layers.wrapped_fn/while" source_file="/opt/flax/flax/core/axes_scan.py" source_line=199 source_end_line=202 source_column=14 source_end_column=7}
  %sharding_constraint.197 = bf16[32,4096,7168]{2,1,0} custom-call(%while.311), custom_call_target="Sharding", sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {\"sequence\", \"context\"}, {\"tensor\", \"tensor_transpose\"}]>]>"}, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %scatter-add.5 = bf16[129280,7168]{1,0} scatter(%broadcast_in_dim.1619, %broadcast_in_dim.1643, %sharding_constraint.197), update_window_dims={2}, inserted_window_dims={0}, scatter_dims_to_operand_dims={0}, index_vector_dim=2, to_apply=%region_305.393, metadata={op_name="jit(train_step)/transpose(jvp(TransformerLinenPure.apply))/TransformerLinenPure/decoder/decoder._apply_embedding/token_embedder/scatter-add" source_file="/maxtext_workspace/maxtext/src/MaxText/layers/embeddings.py" source_line=152 source_end_line=152 source_column=15 source_end_column=57}
  %mul.1656 = bf16[129280,7168]{1,0} multiply(%scatter-add.5, %scatter-add.5), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=45 source_end_line=45 source_column=10 source_end_column=22}
  %convert_element_type.1471 = f32[129280,7168]{1,0} convert(%mul.1656), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %reduce_sum.4106 = f32[] reduce(%convert_element_type.1471, %constant.712), dimensions={0,1}, to_apply=%region_338.426, metadata={op_name="jit(train_step)/reduce_sum" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %convert_element_type.1472 = bf16[] convert(%reduce_sum.4106), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=10 source_end_column=37}
  %add.876 = bf16[] add(%add.875, %convert_element_type.1472), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=38 source_end_line=38 source_column=6 source_end_column=72}
  %sqrt.37 = bf16[] sqrt(%add.876), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/linear_algebra.py" source_line=37 source_end_line=39 source_column=9 source_end_column=3}
  %constant.709 = bf16[] constant(1)
  %lt.22 = pred[] compare(%sqrt.37, %constant.709), direction=LT, metadata={op_name="jit(train_step)/lt" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=98 source_end_line=98 source_column=26 source_end_column=43}
  %select_n.104 = pred[7168]{0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1439 = bf16[7168]{0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1440 = bf16[7168]{0} divide(%reduce_sum.4071, %div.1439), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.105 = bf16[7168]{0} select(%select_n.104, %reduce_sum.4071, %div.1440), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.640 = bf16[] constant(0.1001)
  %broadcast.237 = bf16[7168]{0} broadcast(%constant.640), dimensions={}
  %mul.1657 = bf16[7168]{0} multiply(%select_n.105, %broadcast.237), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____decoder_norm____scale__.1 = bf16[7168]{0} parameter(161), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'decoder_norm\'][\'scale\']"}
  %constant.639 = bf16[] constant(0.8984)
  %mul.1543 = bf16[7168]{0} broadcast(%constant.639), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1658 = bf16[7168]{0} multiply(%state_opt_state_0__mu__decoder____decoder_norm____scale__.1, %mul.1543), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.877 = bf16[7168]{0} add(%mul.1657, %mul.1658), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %constant.707 = f32[] constant(0.9)
  %state_opt_state_0__count.1 = s32[] parameter(160), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, []>"}, metadata={op_name="state.opt_state[0].count"}
  %constant.708 = s32[] constant(2147483647)
  %lt.23 = pred[] compare(%state_opt_state_0__count.1, %constant.708), direction=LT, metadata={op_name="jit(train_step)/lt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=19 source_end_column=36}
  %add.943 = s32[] add(%state_opt_state_0__count.1, %constant.714), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=38 source_end_column=49}
  %jit__where_.423 = s32[] call(%lt.23, %add.943, %constant.708), to_apply=%_where_1097.427, metadata={op_name="jit(train_step)/jit(_where)" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=9 source_end_column=61}
  %pow.20 = f32[] convert(%jit__where_.423), metadata={op_name="jit(train_step)/pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %pow.21 = f32[] power(%constant.707, %pow.20), metadata={op_name="jit(train_step)/pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %sub.86 = f32[] subtract(%constant.715, %pow.21), metadata={op_name="jit(train_step)/sub" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %convert_element_type.1473 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1505 = bf16[7168]{0} broadcast(%convert_element_type.1473), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1506 = bf16[7168]{0} divide(%add.877, %div.1505), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.33 = bf16[7168]{0} multiply(%select_n.105, %select_n.105), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.586 = bf16[] constant(0.05005)
  %mul.1522 = bf16[7168]{0} broadcast(%constant.586), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1723 = bf16[7168]{0} multiply(%integer_pow.33, %mul.1522), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____decoder_norm____scale__.1 = bf16[7168]{0} parameter(194), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'decoder_norm\'][\'scale\']"}
  %constant.585 = bf16[] constant(0.9492)
  %mul.1521 = bf16[7168]{0} broadcast(%constant.585), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1724 = bf16[7168]{0} multiply(%state_opt_state_0__nu__decoder____decoder_norm____scale__.1, %mul.1521), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.910 = bf16[7168]{0} add(%mul.1723, %mul.1724), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %constant.706 = f32[] constant(0.95)
  %pow.22 = f32[] convert(%jit__where_.423), metadata={op_name="jit(train_step)/pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %pow.23 = f32[] power(%constant.706, %pow.22), metadata={op_name="jit(train_step)/pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sub.87 = f32[] subtract(%constant.715, %pow.23), metadata={op_name="jit(train_step)/sub" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %convert_element_type.1506 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1571 = bf16[7168]{0} broadcast(%convert_element_type.1506), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1572 = bf16[7168]{0} divide(%add.910, %div.1571), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.38 = bf16[7168]{0} sqrt(%div.1572), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.532 = bf16[] constant(1.001e-08)
  %add.831 = bf16[7168]{0} broadcast(%constant.532), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.944 = bf16[7168]{0} add(%sqrt.38, %add.831), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1637 = bf16[7168]{0} divide(%div.1506, %add.944), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1789 = bf16[7168]{0} multiply(%state_params__params____decoder____decoder_norm____scale__.1, %broadcast.237), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.977 = bf16[7168]{0} add(%div.1637, %mul.1789), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1829 = bf16[7168]{0} multiply(%mul.1828, %add.977), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1014 = bf16[7168]{0} add(%state_params__params____decoder____decoder_norm____scale__.1, %mul.1829), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.583 = bf16[7168]{0} custom-call(%add.1014), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.811 = bf16[7168]{0} custom-call(%custom-call.583), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}]>]>"}
  %reshape.424 = bf16[7168]{0} reshape(%custom-call.811), sharding={replicated}
  %convert_element_type.1542 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1830 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1542), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.106 = pred[7168,1,18432]{2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1441 = bf16[7168,1,18432]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1442 = bf16[7168,1,18432]{2,1,0} divide(%transpose.167, %div.1441), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.107 = bf16[7168,1,18432]{2,1,0} select(%select_n.106, %transpose.167, %div.1442), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.638 = bf16[] constant(0.1001)
  %broadcast.236 = bf16[7168,1,18432]{2,1,0} broadcast(%constant.638), dimensions={}
  %mul.1659 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.107, %broadcast.236), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____mlp____wi_0____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(162), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'kernel\']"}
  %constant.637 = bf16[] constant(0.8984)
  %broadcast.235 = bf16[7168,1,18432]{2,1,0} broadcast(%constant.637), dimensions={}
  %mul.1660 = bf16[7168,1,18432]{2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____mlp____wi_0____kernel__.1, %broadcast.235), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.878 = bf16[7168,1,18432]{2,1,0} add(%mul.1659, %mul.1660), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1474 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1507 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1474), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1508 = bf16[7168,1,18432]{2,1,0} divide(%add.878, %div.1507), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.34 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.107, %select_n.107), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.584 = bf16[] constant(0.05005)
  %broadcast.204 = bf16[7168,1,18432]{2,1,0} broadcast(%constant.584), dimensions={}
  %mul.1725 = bf16[7168,1,18432]{2,1,0} multiply(%integer_pow.34, %broadcast.204), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____mlp____wi_0____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(195), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_0\'][\'kernel\']"}
  %constant.583 = bf16[] constant(0.9492)
  %broadcast.203 = bf16[7168,1,18432]{2,1,0} broadcast(%constant.583), dimensions={}
  %mul.1726 = bf16[7168,1,18432]{2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____mlp____wi_0____kernel__.1, %broadcast.203), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.911 = bf16[7168,1,18432]{2,1,0} add(%mul.1725, %mul.1726), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1507 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1573 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1507), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1574 = bf16[7168,1,18432]{2,1,0} divide(%add.911, %div.1573), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.39 = bf16[7168,1,18432]{2,1,0} sqrt(%div.1574), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.531 = bf16[] constant(1.001e-08)
  %broadcast.192 = bf16[7168,1,18432]{2,1,0} broadcast(%constant.531), dimensions={}
  %add.945 = bf16[7168,1,18432]{2,1,0} add(%sqrt.39, %broadcast.192), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1638 = bf16[7168,1,18432]{2,1,0} divide(%div.1508, %add.945), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1790 = bf16[7168,1,18432]{2,1,0} multiply(%state_params__params____decoder____dense_layers____mlp____wi_0____kernel__.1, %broadcast.236), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.978 = bf16[7168,1,18432]{2,1,0} add(%div.1638, %mul.1790), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1831 = bf16[7168,1,18432]{2,1,0} multiply(%mul.1830, %add.978), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1015 = bf16[7168,1,18432]{2,1,0} add(%state_params__params____decoder____dense_layers____mlp____wi_0____kernel__.1, %mul.1831), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.584 = bf16[7168,1,18432]{2,1,0} custom-call(%add.1015), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.812 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.584), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.425 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.812), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1543 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1832 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1543), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.108 = pred[7168,1,18432]{2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1443 = bf16[7168,1,18432]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1444 = bf16[7168,1,18432]{2,1,0} divide(%transpose.166, %div.1443), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.109 = bf16[7168,1,18432]{2,1,0} select(%select_n.108, %transpose.166, %div.1444), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1661 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.109, %broadcast.236), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____mlp____wi_1____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(163), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'kernel\']"}
  %mul.1662 = bf16[7168,1,18432]{2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____mlp____wi_1____kernel__.1, %broadcast.235), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.879 = bf16[7168,1,18432]{2,1,0} add(%mul.1661, %mul.1662), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1475 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1509 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1475), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1510 = bf16[7168,1,18432]{2,1,0} divide(%add.879, %div.1509), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.35 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.109, %select_n.109), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1727 = bf16[7168,1,18432]{2,1,0} multiply(%integer_pow.35, %broadcast.204), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____mlp____wi_1____kernel__.1 = bf16[7168,1,18432]{2,1,0} parameter(196), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wi_1\'][\'kernel\']"}
  %mul.1728 = bf16[7168,1,18432]{2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____mlp____wi_1____kernel__.1, %broadcast.203), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.912 = bf16[7168,1,18432]{2,1,0} add(%mul.1727, %mul.1728), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1508 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1575 = bf16[7168,1,18432]{2,1,0} broadcast(%convert_element_type.1508), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1576 = bf16[7168,1,18432]{2,1,0} divide(%add.912, %div.1575), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.40 = bf16[7168,1,18432]{2,1,0} sqrt(%div.1576), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.946 = bf16[7168,1,18432]{2,1,0} add(%sqrt.40, %broadcast.192), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1639 = bf16[7168,1,18432]{2,1,0} divide(%div.1510, %add.946), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1791 = bf16[7168,1,18432]{2,1,0} multiply(%state_params__params____decoder____dense_layers____mlp____wi_1____kernel__.1, %broadcast.236), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.979 = bf16[7168,1,18432]{2,1,0} add(%div.1639, %mul.1791), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1833 = bf16[7168,1,18432]{2,1,0} multiply(%mul.1832, %add.979), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1016 = bf16[7168,1,18432]{2,1,0} add(%state_params__params____decoder____dense_layers____mlp____wi_1____kernel__.1, %mul.1833), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.585 = bf16[7168,1,18432]{2,1,0} custom-call(%add.1016), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.813 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.585), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.426 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.813), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1544 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1834 = bf16[18432,1,7168]{2,1,0} broadcast(%convert_element_type.1544), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.110 = pred[18432,1,7168]{2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1445 = bf16[18432,1,7168]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1446 = bf16[18432,1,7168]{2,1,0} divide(%transpose.165, %div.1445), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.111 = bf16[18432,1,7168]{2,1,0} select(%select_n.110, %transpose.165, %div.1446), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.636 = bf16[] constant(0.1001)
  %broadcast.234 = bf16[18432,1,7168]{2,1,0} broadcast(%constant.636), dimensions={}
  %mul.1663 = bf16[18432,1,7168]{2,1,0} multiply(%select_n.111, %broadcast.234), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____mlp____wo____kernel__.1 = bf16[18432,1,7168]{2,1,0} parameter(164), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'kernel\']"}
  %constant.635 = bf16[] constant(0.8984)
  %mul.1542 = bf16[18432,1,7168]{2,1,0} broadcast(%constant.635), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1664 = bf16[18432,1,7168]{2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____mlp____wo____kernel__.1, %mul.1542), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.880 = bf16[18432,1,7168]{2,1,0} add(%mul.1663, %mul.1664), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1476 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1511 = bf16[18432,1,7168]{2,1,0} broadcast(%convert_element_type.1476), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1512 = bf16[18432,1,7168]{2,1,0} divide(%add.880, %div.1511), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.36 = bf16[18432,1,7168]{2,1,0} multiply(%select_n.111, %select_n.111), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.582 = bf16[] constant(0.05005)
  %mul.1520 = bf16[18432,1,7168]{2,1,0} broadcast(%constant.582), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1729 = bf16[18432,1,7168]{2,1,0} multiply(%integer_pow.36, %mul.1520), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____mlp____wo____kernel__.1 = bf16[18432,1,7168]{2,1,0} parameter(197), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'mlp\'][\'wo\'][\'kernel\']"}
  %constant.581 = bf16[] constant(0.9492)
  %mul.1519 = bf16[18432,1,7168]{2,1,0} broadcast(%constant.581), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1730 = bf16[18432,1,7168]{2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____mlp____wo____kernel__.1, %mul.1519), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.913 = bf16[18432,1,7168]{2,1,0} add(%mul.1729, %mul.1730), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1509 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1577 = bf16[18432,1,7168]{2,1,0} broadcast(%convert_element_type.1509), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1578 = bf16[18432,1,7168]{2,1,0} divide(%add.913, %div.1577), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.41 = bf16[18432,1,7168]{2,1,0} sqrt(%div.1578), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.530 = bf16[] constant(1.001e-08)
  %add.830 = bf16[18432,1,7168]{2,1,0} broadcast(%constant.530), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.947 = bf16[18432,1,7168]{2,1,0} add(%sqrt.41, %add.830), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1640 = bf16[18432,1,7168]{2,1,0} divide(%div.1512, %add.947), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1792 = bf16[18432,1,7168]{2,1,0} multiply(%state_params__params____decoder____dense_layers____mlp____wo____kernel__.1, %broadcast.234), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.980 = bf16[18432,1,7168]{2,1,0} add(%div.1640, %mul.1792), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1835 = bf16[18432,1,7168]{2,1,0} multiply(%mul.1834, %add.980), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1017 = bf16[18432,1,7168]{2,1,0} add(%state_params__params____decoder____dense_layers____mlp____wo____kernel__.1, %mul.1835), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.586 = bf16[18432,1,7168]{2,1,0} custom-call(%add.1017), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.814 = bf16[18432,1,7168]{2,1,0} custom-call(%custom-call.586), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.427 = bf16[18432,1,7168]{2,1,0} reshape(%custom-call.814), sharding={devices=[1,1,4]<=[4]}
  %convert_element_type.1545 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1836 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1545), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.112 = pred[7168,1]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1447 = bf16[7168,1]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1448 = bf16[7168,1]{1,0} divide(%transpose.164, %div.1447), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.113 = bf16[7168,1]{1,0} select(%select_n.112, %transpose.164, %div.1448), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.634 = bf16[] constant(0.1001)
  %broadcast.233 = bf16[7168,1]{1,0} broadcast(%constant.634), dimensions={}
  %mul.1665 = bf16[7168,1]{1,0} multiply(%select_n.113, %broadcast.233), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(165), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %constant.633 = bf16[] constant(0.8984)
  %broadcast.232 = bf16[7168,1]{1,0} broadcast(%constant.633), dimensions={}
  %mul.1666 = bf16[7168,1]{1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1, %broadcast.232), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.881 = bf16[7168,1]{1,0} add(%mul.1665, %mul.1666), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1477 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1513 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1477), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1514 = bf16[7168,1]{1,0} divide(%add.881, %div.1513), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.37 = bf16[7168,1]{1,0} multiply(%select_n.113, %select_n.113), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.580 = bf16[] constant(0.05005)
  %broadcast.202 = bf16[7168,1]{1,0} broadcast(%constant.580), dimensions={}
  %mul.1731 = bf16[7168,1]{1,0} multiply(%integer_pow.37, %broadcast.202), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(198), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %constant.579 = bf16[] constant(0.9492)
  %broadcast.201 = bf16[7168,1]{1,0} broadcast(%constant.579), dimensions={}
  %mul.1732 = bf16[7168,1]{1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____post_self_attention_layer_norm____scale__.1, %broadcast.201), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.914 = bf16[7168,1]{1,0} add(%mul.1731, %mul.1732), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1510 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1579 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1510), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1580 = bf16[7168,1]{1,0} divide(%add.914, %div.1579), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.42 = bf16[7168,1]{1,0} sqrt(%div.1580), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.529 = bf16[] constant(1.001e-08)
  %broadcast.191 = bf16[7168,1]{1,0} broadcast(%constant.529), dimensions={}
  %add.948 = bf16[7168,1]{1,0} add(%sqrt.42, %broadcast.191), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1641 = bf16[7168,1]{1,0} divide(%div.1514, %add.948), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1793 = bf16[7168,1]{1,0} multiply(%state_params__params____decoder____dense_layers____post_self_attention_layer_norm____scale__.1, %broadcast.233), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.981 = bf16[7168,1]{1,0} add(%div.1641, %mul.1793), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1837 = bf16[7168,1]{1,0} multiply(%mul.1836, %add.981), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1018 = bf16[7168,1]{1,0} add(%state_params__params____decoder____dense_layers____post_self_attention_layer_norm____scale__.1, %mul.1837), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.587 = bf16[7168,1]{1,0} custom-call(%add.1018), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.815 = bf16[7168,1]{1,0} custom-call(%custom-call.587), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.428 = bf16[7168,1]{1,0} reshape(%custom-call.815), sharding={replicated}
  %convert_element_type.1546 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1838 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1546), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.114 = pred[7168,1]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1449 = bf16[7168,1]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1450 = bf16[7168,1]{1,0} divide(%transpose.163, %div.1449), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.115 = bf16[7168,1]{1,0} select(%select_n.114, %transpose.163, %div.1450), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1667 = bf16[7168,1]{1,0} multiply(%select_n.115, %broadcast.233), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(166), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %mul.1668 = bf16[7168,1]{1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.232), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.882 = bf16[7168,1]{1,0} add(%mul.1667, %mul.1668), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1478 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1515 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1478), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1516 = bf16[7168,1]{1,0} divide(%add.882, %div.1515), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.38 = bf16[7168,1]{1,0} multiply(%select_n.115, %select_n.115), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1733 = bf16[7168,1]{1,0} multiply(%integer_pow.38, %broadcast.202), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,1]{1,0} parameter(199), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %mul.1734 = bf16[7168,1]{1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.201), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.915 = bf16[7168,1]{1,0} add(%mul.1733, %mul.1734), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1511 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1581 = bf16[7168,1]{1,0} broadcast(%convert_element_type.1511), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1582 = bf16[7168,1]{1,0} divide(%add.915, %div.1581), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.43 = bf16[7168,1]{1,0} sqrt(%div.1582), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.949 = bf16[7168,1]{1,0} add(%sqrt.43, %broadcast.191), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1642 = bf16[7168,1]{1,0} divide(%div.1516, %add.949), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1794 = bf16[7168,1]{1,0} multiply(%state_params__params____decoder____dense_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.233), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.982 = bf16[7168,1]{1,0} add(%div.1642, %mul.1794), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1839 = bf16[7168,1]{1,0} multiply(%mul.1838, %add.982), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1019 = bf16[7168,1]{1,0} add(%state_params__params____decoder____dense_layers____pre_self_attention_layer_norm____scale__.1, %mul.1839), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.588 = bf16[7168,1]{1,0} custom-call(%add.1019), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.816 = bf16[7168,1]{1,0} custom-call(%custom-call.588), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.429 = bf16[7168,1]{1,0} reshape(%custom-call.816), sharding={replicated}
  %convert_element_type.1547 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1840 = bf16[512,1]{1,0} broadcast(%convert_element_type.1547), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.116 = pred[512,1]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1451 = bf16[512,1]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1452 = bf16[512,1]{1,0} divide(%transpose.162, %div.1451), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.117 = bf16[512,1]{1,0} select(%select_n.116, %transpose.162, %div.1452), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.632 = bf16[] constant(0.1001)
  %broadcast.231 = bf16[512,1]{1,0} broadcast(%constant.632), dimensions={}
  %mul.1669 = bf16[512,1]{1,0} multiply(%select_n.117, %broadcast.231), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____kv_norm____scale__.1 = bf16[512,1]{1,0} parameter(167), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %constant.631 = bf16[] constant(0.8984)
  %mul.1541 = bf16[512,1]{1,0} broadcast(%constant.631), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1670 = bf16[512,1]{1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____kv_norm____scale__.1, %mul.1541), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.883 = bf16[512,1]{1,0} add(%mul.1669, %mul.1670), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1479 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1517 = bf16[512,1]{1,0} broadcast(%convert_element_type.1479), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1518 = bf16[512,1]{1,0} divide(%add.883, %div.1517), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.39 = bf16[512,1]{1,0} multiply(%select_n.117, %select_n.117), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.578 = bf16[] constant(0.05005)
  %mul.1518 = bf16[512,1]{1,0} broadcast(%constant.578), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1735 = bf16[512,1]{1,0} multiply(%integer_pow.39, %mul.1518), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____kv_norm____scale__.1 = bf16[512,1]{1,0} parameter(200), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %constant.577 = bf16[] constant(0.9492)
  %mul.1517 = bf16[512,1]{1,0} broadcast(%constant.577), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1736 = bf16[512,1]{1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____kv_norm____scale__.1, %mul.1517), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.916 = bf16[512,1]{1,0} add(%mul.1735, %mul.1736), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1512 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1583 = bf16[512,1]{1,0} broadcast(%convert_element_type.1512), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1584 = bf16[512,1]{1,0} divide(%add.916, %div.1583), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.44 = bf16[512,1]{1,0} sqrt(%div.1584), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.528 = bf16[] constant(1.001e-08)
  %add.829 = bf16[512,1]{1,0} broadcast(%constant.528), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.950 = bf16[512,1]{1,0} add(%sqrt.44, %add.829), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1643 = bf16[512,1]{1,0} divide(%div.1518, %add.950), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1795 = bf16[512,1]{1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____kv_norm____scale__.1, %broadcast.231), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.983 = bf16[512,1]{1,0} add(%div.1643, %mul.1795), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1841 = bf16[512,1]{1,0} multiply(%mul.1840, %add.983), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1020 = bf16[512,1]{1,0} add(%state_params__params____decoder____dense_layers____self_attention____kv_norm____scale__.1, %mul.1841), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.589 = bf16[512,1]{1,0} custom-call(%add.1020), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.817 = bf16[512,1]{1,0} custom-call(%custom-call.589), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.430 = bf16[512,1]{1,0} reshape(%custom-call.817), sharding={replicated}
  %convert_element_type.1548 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1842 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%convert_element_type.1548), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.118 = pred[128,1,128,7168]{3,2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1453 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1454 = bf16[128,1,128,7168]{3,2,1,0} divide(%transpose.161, %div.1453), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.119 = bf16[128,1,128,7168]{3,2,1,0} select(%select_n.118, %transpose.161, %div.1454), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.630 = bf16[] constant(0.1001)
  %broadcast.230 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%constant.630), dimensions={}
  %mul.1671 = bf16[128,1,128,7168]{3,2,1,0} multiply(%select_n.119, %broadcast.230), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____out____kernel__.1 = bf16[128,1,128,7168]{3,2,1,0} parameter(168), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %constant.629 = bf16[] constant(0.8984)
  %mul.1540 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%constant.629), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1672 = bf16[128,1,128,7168]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____out____kernel__.1, %mul.1540), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.884 = bf16[128,1,128,7168]{3,2,1,0} add(%mul.1671, %mul.1672), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1480 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1519 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%convert_element_type.1480), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1520 = bf16[128,1,128,7168]{3,2,1,0} divide(%add.884, %div.1519), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.40 = bf16[128,1,128,7168]{3,2,1,0} multiply(%select_n.119, %select_n.119), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.576 = bf16[] constant(0.05005)
  %mul.1516 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%constant.576), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1737 = bf16[128,1,128,7168]{3,2,1,0} multiply(%integer_pow.40, %mul.1516), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____out____kernel__.1 = bf16[128,1,128,7168]{3,2,1,0} parameter(201), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %constant.575 = bf16[] constant(0.9492)
  %mul.1515 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%constant.575), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1738 = bf16[128,1,128,7168]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____out____kernel__.1, %mul.1515), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.917 = bf16[128,1,128,7168]{3,2,1,0} add(%mul.1737, %mul.1738), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1513 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1585 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%convert_element_type.1513), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1586 = bf16[128,1,128,7168]{3,2,1,0} divide(%add.917, %div.1585), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.45 = bf16[128,1,128,7168]{3,2,1,0} sqrt(%div.1586), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.527 = bf16[] constant(1.001e-08)
  %add.828 = bf16[128,1,128,7168]{3,2,1,0} broadcast(%constant.527), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.951 = bf16[128,1,128,7168]{3,2,1,0} add(%sqrt.45, %add.828), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1644 = bf16[128,1,128,7168]{3,2,1,0} divide(%div.1520, %add.951), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1796 = bf16[128,1,128,7168]{3,2,1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____out____kernel__.1, %broadcast.230), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.984 = bf16[128,1,128,7168]{3,2,1,0} add(%div.1644, %mul.1796), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1843 = bf16[128,1,128,7168]{3,2,1,0} multiply(%mul.1842, %add.984), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1021 = bf16[128,1,128,7168]{3,2,1,0} add(%state_params__params____decoder____dense_layers____self_attention____out____kernel__.1, %mul.1843), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.590 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%add.1021), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.818 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%custom-call.590), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.431 = bf16[128,1,128,7168]{3,2,1,0} reshape(%custom-call.818), sharding={devices=[1,1,1,4]<=[4]}
  %convert_element_type.1549 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1844 = bf16[1536,1]{1,0} broadcast(%convert_element_type.1549), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.120 = pred[1536,1]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1455 = bf16[1536,1]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1456 = bf16[1536,1]{1,0} divide(%transpose.160, %div.1455), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.121 = bf16[1536,1]{1,0} select(%select_n.120, %transpose.160, %div.1456), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.628 = bf16[] constant(0.1001)
  %broadcast.229 = bf16[1536,1]{1,0} broadcast(%constant.628), dimensions={}
  %mul.1673 = bf16[1536,1]{1,0} multiply(%select_n.121, %broadcast.229), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____q_norm____scale__.1 = bf16[1536,1]{1,0} parameter(169), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %constant.627 = bf16[] constant(0.8984)
  %mul.1539 = bf16[1536,1]{1,0} broadcast(%constant.627), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1674 = bf16[1536,1]{1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____q_norm____scale__.1, %mul.1539), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.885 = bf16[1536,1]{1,0} add(%mul.1673, %mul.1674), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1481 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1521 = bf16[1536,1]{1,0} broadcast(%convert_element_type.1481), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1522 = bf16[1536,1]{1,0} divide(%add.885, %div.1521), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.41 = bf16[1536,1]{1,0} multiply(%select_n.121, %select_n.121), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.574 = bf16[] constant(0.05005)
  %mul.1514 = bf16[1536,1]{1,0} broadcast(%constant.574), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1739 = bf16[1536,1]{1,0} multiply(%integer_pow.41, %mul.1514), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____q_norm____scale__.1 = bf16[1536,1]{1,0} parameter(202), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %constant.573 = bf16[] constant(0.9492)
  %mul.1513 = bf16[1536,1]{1,0} broadcast(%constant.573), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1740 = bf16[1536,1]{1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____q_norm____scale__.1, %mul.1513), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.918 = bf16[1536,1]{1,0} add(%mul.1739, %mul.1740), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1514 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1587 = bf16[1536,1]{1,0} broadcast(%convert_element_type.1514), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1588 = bf16[1536,1]{1,0} divide(%add.918, %div.1587), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.46 = bf16[1536,1]{1,0} sqrt(%div.1588), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.526 = bf16[] constant(1.001e-08)
  %add.827 = bf16[1536,1]{1,0} broadcast(%constant.526), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.952 = bf16[1536,1]{1,0} add(%sqrt.46, %add.827), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1645 = bf16[1536,1]{1,0} divide(%div.1522, %add.952), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1797 = bf16[1536,1]{1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____q_norm____scale__.1, %broadcast.229), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.985 = bf16[1536,1]{1,0} add(%div.1645, %mul.1797), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1845 = bf16[1536,1]{1,0} multiply(%mul.1844, %add.985), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1022 = bf16[1536,1]{1,0} add(%state_params__params____decoder____dense_layers____self_attention____q_norm____scale__.1, %mul.1845), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.591 = bf16[1536,1]{1,0} custom-call(%add.1022), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.819 = bf16[1536,1]{1,0} custom-call(%custom-call.591), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.432 = bf16[1536,1]{1,0} reshape(%custom-call.819), sharding={replicated}
  %convert_element_type.1550 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1846 = bf16[7168,1,576]{2,1,0} broadcast(%convert_element_type.1550), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.122 = pred[7168,1,576]{2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1457 = bf16[7168,1,576]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1458 = bf16[7168,1,576]{2,1,0} divide(%transpose.159, %div.1457), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.123 = bf16[7168,1,576]{2,1,0} select(%select_n.122, %transpose.159, %div.1458), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.626 = bf16[] constant(0.1001)
  %broadcast.228 = bf16[7168,1,576]{2,1,0} broadcast(%constant.626), dimensions={}
  %mul.1675 = bf16[7168,1,576]{2,1,0} multiply(%select_n.123, %broadcast.228), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,1,576]{2,1,0} parameter(170), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %constant.625 = bf16[] constant(0.8984)
  %mul.1538 = bf16[7168,1,576]{2,1,0} broadcast(%constant.625), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1676 = bf16[7168,1,576]{2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_a_kernel__.1, %mul.1538), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.886 = bf16[7168,1,576]{2,1,0} add(%mul.1675, %mul.1676), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1482 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1523 = bf16[7168,1,576]{2,1,0} broadcast(%convert_element_type.1482), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1524 = bf16[7168,1,576]{2,1,0} divide(%add.886, %div.1523), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.42 = bf16[7168,1,576]{2,1,0} multiply(%select_n.123, %select_n.123), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.572 = bf16[] constant(0.05005)
  %mul.1512 = bf16[7168,1,576]{2,1,0} broadcast(%constant.572), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1741 = bf16[7168,1,576]{2,1,0} multiply(%integer_pow.42, %mul.1512), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,1,576]{2,1,0} parameter(203), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %constant.571 = bf16[] constant(0.9492)
  %mul.1511 = bf16[7168,1,576]{2,1,0} broadcast(%constant.571), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1742 = bf16[7168,1,576]{2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_a_kernel__.1, %mul.1511), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.919 = bf16[7168,1,576]{2,1,0} add(%mul.1741, %mul.1742), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1515 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1589 = bf16[7168,1,576]{2,1,0} broadcast(%convert_element_type.1515), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1590 = bf16[7168,1,576]{2,1,0} divide(%add.919, %div.1589), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.47 = bf16[7168,1,576]{2,1,0} sqrt(%div.1590), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.525 = bf16[] constant(1.001e-08)
  %add.826 = bf16[7168,1,576]{2,1,0} broadcast(%constant.525), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.953 = bf16[7168,1,576]{2,1,0} add(%sqrt.47, %add.826), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1646 = bf16[7168,1,576]{2,1,0} divide(%div.1524, %add.953), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1798 = bf16[7168,1,576]{2,1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____wkv_a_kernel__.1, %broadcast.228), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.986 = bf16[7168,1,576]{2,1,0} add(%div.1646, %mul.1798), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1847 = bf16[7168,1,576]{2,1,0} multiply(%mul.1846, %add.986), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1023 = bf16[7168,1,576]{2,1,0} add(%state_params__params____decoder____dense_layers____self_attention____wkv_a_kernel__.1, %mul.1847), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.592 = bf16[7168,1,576]{2,1,0} custom-call(%add.1023), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.820 = bf16[7168,1,576]{2,1,0} custom-call(%custom-call.592), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.433 = bf16[7168,1,576]{2,1,0} reshape(%custom-call.820), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1551 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1848 = bf16[512,1,128,256]{3,2,1,0} broadcast(%convert_element_type.1551), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.124 = pred[512,1,128,256]{3,2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1459 = bf16[512,1,128,256]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1460 = bf16[512,1,128,256]{3,2,1,0} divide(%transpose.158, %div.1459), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.125 = bf16[512,1,128,256]{3,2,1,0} select(%select_n.124, %transpose.158, %div.1460), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.624 = bf16[] constant(0.1001)
  %broadcast.227 = bf16[512,1,128,256]{3,2,1,0} broadcast(%constant.624), dimensions={}
  %mul.1677 = bf16[512,1,128,256]{3,2,1,0} multiply(%select_n.125, %broadcast.227), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_b____kernel__.1 = bf16[512,1,128,256]{3,2,1,0} parameter(171), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %constant.623 = bf16[] constant(0.8984)
  %mul.1537 = bf16[512,1,128,256]{3,2,1,0} broadcast(%constant.623), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1678 = bf16[512,1,128,256]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____wkv_b____kernel__.1, %mul.1537), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.887 = bf16[512,1,128,256]{3,2,1,0} add(%mul.1677, %mul.1678), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1483 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1525 = bf16[512,1,128,256]{3,2,1,0} broadcast(%convert_element_type.1483), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1526 = bf16[512,1,128,256]{3,2,1,0} divide(%add.887, %div.1525), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.43 = bf16[512,1,128,256]{3,2,1,0} multiply(%select_n.125, %select_n.125), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.570 = bf16[] constant(0.05005)
  %mul.1510 = bf16[512,1,128,256]{3,2,1,0} broadcast(%constant.570), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1743 = bf16[512,1,128,256]{3,2,1,0} multiply(%integer_pow.43, %mul.1510), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_b____kernel__.1 = bf16[512,1,128,256]{3,2,1,0} parameter(204), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %constant.569 = bf16[] constant(0.9492)
  %mul.1509 = bf16[512,1,128,256]{3,2,1,0} broadcast(%constant.569), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1744 = bf16[512,1,128,256]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____wkv_b____kernel__.1, %mul.1509), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.920 = bf16[512,1,128,256]{3,2,1,0} add(%mul.1743, %mul.1744), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1516 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1591 = bf16[512,1,128,256]{3,2,1,0} broadcast(%convert_element_type.1516), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1592 = bf16[512,1,128,256]{3,2,1,0} divide(%add.920, %div.1591), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.48 = bf16[512,1,128,256]{3,2,1,0} sqrt(%div.1592), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.524 = bf16[] constant(1.001e-08)
  %add.825 = bf16[512,1,128,256]{3,2,1,0} broadcast(%constant.524), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.954 = bf16[512,1,128,256]{3,2,1,0} add(%sqrt.48, %add.825), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1647 = bf16[512,1,128,256]{3,2,1,0} divide(%div.1526, %add.954), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1799 = bf16[512,1,128,256]{3,2,1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____wkv_b____kernel__.1, %broadcast.227), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.987 = bf16[512,1,128,256]{3,2,1,0} add(%div.1647, %mul.1799), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1849 = bf16[512,1,128,256]{3,2,1,0} multiply(%mul.1848, %add.987), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1024 = bf16[512,1,128,256]{3,2,1,0} add(%state_params__params____decoder____dense_layers____self_attention____wkv_b____kernel__.1, %mul.1849), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.593 = bf16[512,1,128,256]{3,2,1,0} custom-call(%add.1024), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.821 = bf16[512,1,128,256]{3,2,1,0} custom-call(%custom-call.593), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.434 = bf16[512,1,128,256]{3,2,1,0} reshape(%custom-call.821), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1552 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1850 = bf16[7168,1,1536]{2,1,0} broadcast(%convert_element_type.1552), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.126 = pred[7168,1,1536]{2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1461 = bf16[7168,1,1536]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1462 = bf16[7168,1,1536]{2,1,0} divide(%transpose.157, %div.1461), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.127 = bf16[7168,1,1536]{2,1,0} select(%select_n.126, %transpose.157, %div.1462), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.622 = bf16[] constant(0.1001)
  %broadcast.226 = bf16[7168,1,1536]{2,1,0} broadcast(%constant.622), dimensions={}
  %mul.1679 = bf16[7168,1,1536]{2,1,0} multiply(%select_n.127, %broadcast.226), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_a_kernel__.1 = bf16[7168,1,1536]{2,1,0} parameter(172), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %constant.621 = bf16[] constant(0.8984)
  %mul.1536 = bf16[7168,1,1536]{2,1,0} broadcast(%constant.621), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1680 = bf16[7168,1,1536]{2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_a_kernel__.1, %mul.1536), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.888 = bf16[7168,1,1536]{2,1,0} add(%mul.1679, %mul.1680), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1484 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1527 = bf16[7168,1,1536]{2,1,0} broadcast(%convert_element_type.1484), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1528 = bf16[7168,1,1536]{2,1,0} divide(%add.888, %div.1527), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.44 = bf16[7168,1,1536]{2,1,0} multiply(%select_n.127, %select_n.127), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.568 = bf16[] constant(0.05005)
  %mul.1508 = bf16[7168,1,1536]{2,1,0} broadcast(%constant.568), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1745 = bf16[7168,1,1536]{2,1,0} multiply(%integer_pow.44, %mul.1508), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_a_kernel__.1 = bf16[7168,1,1536]{2,1,0} parameter(205), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %constant.567 = bf16[] constant(0.9492)
  %mul.1507 = bf16[7168,1,1536]{2,1,0} broadcast(%constant.567), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1746 = bf16[7168,1,1536]{2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_a_kernel__.1, %mul.1507), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.921 = bf16[7168,1,1536]{2,1,0} add(%mul.1745, %mul.1746), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1517 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1593 = bf16[7168,1,1536]{2,1,0} broadcast(%convert_element_type.1517), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1594 = bf16[7168,1,1536]{2,1,0} divide(%add.921, %div.1593), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.49 = bf16[7168,1,1536]{2,1,0} sqrt(%div.1594), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.523 = bf16[] constant(1.001e-08)
  %add.824 = bf16[7168,1,1536]{2,1,0} broadcast(%constant.523), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.955 = bf16[7168,1,1536]{2,1,0} add(%sqrt.49, %add.824), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1648 = bf16[7168,1,1536]{2,1,0} divide(%div.1528, %add.955), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1800 = bf16[7168,1,1536]{2,1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____wq_a_kernel__.1, %broadcast.226), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.988 = bf16[7168,1,1536]{2,1,0} add(%div.1648, %mul.1800), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1851 = bf16[7168,1,1536]{2,1,0} multiply(%mul.1850, %add.988), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1025 = bf16[7168,1,1536]{2,1,0} add(%state_params__params____decoder____dense_layers____self_attention____wq_a_kernel__.1, %mul.1851), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.594 = bf16[7168,1,1536]{2,1,0} custom-call(%add.1025), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.822 = bf16[7168,1,1536]{2,1,0} custom-call(%custom-call.594), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.435 = bf16[7168,1,1536]{2,1,0} reshape(%custom-call.822), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1553 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1852 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%convert_element_type.1553), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.128 = pred[1536,1,128,192]{3,2,1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1463 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1464 = bf16[1536,1,128,192]{3,2,1,0} divide(%transpose.156, %div.1463), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.129 = bf16[1536,1,128,192]{3,2,1,0} select(%select_n.128, %transpose.156, %div.1464), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.620 = bf16[] constant(0.1001)
  %broadcast.225 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%constant.620), dimensions={}
  %mul.1681 = bf16[1536,1,128,192]{3,2,1,0} multiply(%select_n.129, %broadcast.225), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_b____kernel__.1 = bf16[1536,1,128,192]{3,2,1,0} parameter(173), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %constant.619 = bf16[] constant(0.8984)
  %mul.1535 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%constant.619), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1682 = bf16[1536,1,128,192]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____dense_layers____self_attention____wq_b____kernel__.1, %mul.1535), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.889 = bf16[1536,1,128,192]{3,2,1,0} add(%mul.1681, %mul.1682), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1485 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1529 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%convert_element_type.1485), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1530 = bf16[1536,1,128,192]{3,2,1,0} divide(%add.889, %div.1529), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.45 = bf16[1536,1,128,192]{3,2,1,0} multiply(%select_n.129, %select_n.129), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.566 = bf16[] constant(0.05005)
  %mul.1506 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%constant.566), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1747 = bf16[1536,1,128,192]{3,2,1,0} multiply(%integer_pow.45, %mul.1506), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_b____kernel__.1 = bf16[1536,1,128,192]{3,2,1,0} parameter(206), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'dense_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %constant.565 = bf16[] constant(0.9492)
  %mul.1505 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%constant.565), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1748 = bf16[1536,1,128,192]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____dense_layers____self_attention____wq_b____kernel__.1, %mul.1505), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.922 = bf16[1536,1,128,192]{3,2,1,0} add(%mul.1747, %mul.1748), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1518 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1595 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%convert_element_type.1518), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1596 = bf16[1536,1,128,192]{3,2,1,0} divide(%add.922, %div.1595), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.50 = bf16[1536,1,128,192]{3,2,1,0} sqrt(%div.1596), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.522 = bf16[] constant(1.001e-08)
  %add.823 = bf16[1536,1,128,192]{3,2,1,0} broadcast(%constant.522), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.956 = bf16[1536,1,128,192]{3,2,1,0} add(%sqrt.50, %add.823), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1649 = bf16[1536,1,128,192]{3,2,1,0} divide(%div.1530, %add.956), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1801 = bf16[1536,1,128,192]{3,2,1,0} multiply(%state_params__params____decoder____dense_layers____self_attention____wq_b____kernel__.1, %broadcast.225), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.989 = bf16[1536,1,128,192]{3,2,1,0} add(%div.1649, %mul.1801), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1853 = bf16[1536,1,128,192]{3,2,1,0} multiply(%mul.1852, %add.989), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1026 = bf16[1536,1,128,192]{3,2,1,0} add(%state_params__params____decoder____dense_layers____self_attention____wq_b____kernel__.1, %mul.1853), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.595 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%add.1026), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.823 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%custom-call.595), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.436 = bf16[1536,1,128,192]{3,2,1,0} reshape(%custom-call.823), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1554 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1854 = bf16[7168,129280]{1,0} broadcast(%convert_element_type.1554), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.130 = pred[7168,129280]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1465 = bf16[7168,129280]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1466 = bf16[7168,129280]{0,1} divide(%transpose.138, %div.1465), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.131 = bf16[7168,129280]{0,1} select(%select_n.130, %transpose.138, %div.1466), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.618 = bf16[] constant(0.1001)
  %broadcast.224 = bf16[7168,129280]{1,0} broadcast(%constant.618), dimensions={}
  %mul.1683 = bf16[7168,129280]{0,1} multiply(%select_n.131, %broadcast.224), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____logits_dense____kernel__.1 = bf16[7168,129280]{1,0} parameter(174), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'logits_dense\'][\'kernel\']"}
  %constant.617 = bf16[] constant(0.8984)
  %mul.1534 = bf16[7168,129280]{1,0} broadcast(%constant.617), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1684 = bf16[7168,129280]{1,0} multiply(%state_opt_state_0__mu__decoder____logits_dense____kernel__.1, %mul.1534), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.890 = bf16[7168,129280]{0,1} add(%mul.1683, %mul.1684), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1486 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1531 = bf16[7168,129280]{1,0} broadcast(%convert_element_type.1486), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1532 = bf16[7168,129280]{0,1} divide(%add.890, %div.1531), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.46 = bf16[7168,129280]{0,1} multiply(%select_n.131, %select_n.131), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.564 = bf16[] constant(0.05005)
  %mul.1504 = bf16[7168,129280]{1,0} broadcast(%constant.564), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1749 = bf16[7168,129280]{0,1} multiply(%integer_pow.46, %mul.1504), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____logits_dense____kernel__.1 = bf16[7168,129280]{1,0} parameter(207), sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'logits_dense\'][\'kernel\']"}
  %constant.563 = bf16[] constant(0.9492)
  %mul.1503 = bf16[7168,129280]{1,0} broadcast(%constant.563), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1750 = bf16[7168,129280]{1,0} multiply(%state_opt_state_0__nu__decoder____logits_dense____kernel__.1, %mul.1503), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.923 = bf16[7168,129280]{0,1} add(%mul.1749, %mul.1750), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1519 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1597 = bf16[7168,129280]{1,0} broadcast(%convert_element_type.1519), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1598 = bf16[7168,129280]{0,1} divide(%add.923, %div.1597), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.51 = bf16[7168,129280]{0,1} sqrt(%div.1598), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.521 = bf16[] constant(1.001e-08)
  %add.822 = bf16[7168,129280]{1,0} broadcast(%constant.521), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.957 = bf16[7168,129280]{0,1} add(%sqrt.51, %add.822), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1650 = bf16[7168,129280]{0,1} divide(%div.1532, %add.957), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1802 = bf16[7168,129280]{1,0} multiply(%state_params__params____decoder____logits_dense____kernel__.1, %broadcast.224), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.990 = bf16[7168,129280]{0,1} add(%div.1650, %mul.1802), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1855 = bf16[7168,129280]{1,0} multiply(%mul.1854, %add.990), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1027 = bf16[7168,129280]{1,0} add(%state_params__params____decoder____logits_dense____kernel__.1, %mul.1855), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.596 = bf16[7168,129280]{1,0} custom-call(%add.1027), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.824 = bf16[7168,129280]{1,0} custom-call(%custom-call.596), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.437 = bf16[7168,129280]{1,0} reshape(%custom-call.824), sharding={devices=[4,1]<=[4]}
  %state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1 = bf16[64,2]{1,0} parameter(141), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.params[\'params\'][\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'bias\']"}
  %convert_element_type.1555 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1856 = bf16[64,2]{1,0} broadcast(%convert_element_type.1555), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.132 = pred[64,2]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.642 = bf16[] constant(0)
  %broadcast_in_dim.1618 = bf16[64,2]{1,0} broadcast(%constant.642), dimensions={}, metadata={op_name="jit(train_step)/broadcast_in_dim" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=259 source_end_line=259 source_column=29 source_end_column=118}
  %div.1467 = bf16[64,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1468 = bf16[64,2]{1,0} divide(%broadcast_in_dim.1618, %div.1467), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.133 = bf16[64,2]{1,0} select(%select_n.132, %broadcast_in_dim.1618, %div.1468), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.616 = bf16[] constant(0.1001)
  %broadcast.223 = bf16[64,2]{1,0} broadcast(%constant.616), dimensions={}
  %mul.1685 = bf16[64,2]{1,0} multiply(%select_n.133, %broadcast.223), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1 = bf16[64,2]{1,0} parameter(175), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'bias\']"}
  %constant.615 = bf16[] constant(0.8984)
  %broadcast.222 = bf16[64,2]{1,0} broadcast(%constant.615), dimensions={}
  %mul.1686 = bf16[64,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1, %broadcast.222), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.891 = bf16[64,2]{1,0} add(%mul.1685, %mul.1686), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1487 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1533 = bf16[64,2]{1,0} broadcast(%convert_element_type.1487), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1534 = bf16[64,2]{1,0} divide(%add.891, %div.1533), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.47 = bf16[64,2]{1,0} multiply(%select_n.133, %select_n.133), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.562 = bf16[] constant(0.05005)
  %broadcast.200 = bf16[64,2]{1,0} broadcast(%constant.562), dimensions={}
  %mul.1751 = bf16[64,2]{1,0} multiply(%integer_pow.47, %broadcast.200), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1 = bf16[64,2]{1,0} parameter(208), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'bias\']"}
  %constant.561 = bf16[] constant(0.9492)
  %broadcast.199 = bf16[64,2]{1,0} broadcast(%constant.561), dimensions={}
  %mul.1752 = bf16[64,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1, %broadcast.199), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.924 = bf16[64,2]{1,0} add(%mul.1751, %mul.1752), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1520 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1599 = bf16[64,2]{1,0} broadcast(%convert_element_type.1520), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1600 = bf16[64,2]{1,0} divide(%add.924, %div.1599), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.52 = bf16[64,2]{1,0} sqrt(%div.1600), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.520 = bf16[] constant(1.001e-08)
  %broadcast.190 = bf16[64,2]{1,0} broadcast(%constant.520), dimensions={}
  %add.958 = bf16[64,2]{1,0} add(%sqrt.52, %broadcast.190), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1651 = bf16[64,2]{1,0} divide(%div.1534, %add.958), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1803 = bf16[64,2]{1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1, %broadcast.223), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.991 = bf16[64,2]{1,0} add(%div.1651, %mul.1803), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1857 = bf16[64,2]{1,0} multiply(%mul.1856, %add.991), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1028 = bf16[64,2]{1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____bias__.1, %mul.1857), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.597 = bf16[64,2]{1,0} custom-call(%add.1028), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.825 = bf16[64,2]{1,0} custom-call(%custom-call.597), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.438 = bf16[64,2]{1,0} reshape(%custom-call.825), sharding={replicated}
  %convert_element_type.1556 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1858 = bf16[7168,2,64]{2,1,0} broadcast(%convert_element_type.1556), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.134 = pred[7168,2,64]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1469 = bf16[7168,2,64]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1470 = bf16[7168,2,64]{2,0,1} divide(%transpose.155, %div.1469), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.135 = bf16[7168,2,64]{2,0,1} select(%select_n.134, %transpose.155, %div.1470), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.614 = bf16[] constant(0.1001)
  %broadcast.221 = bf16[7168,2,64]{2,1,0} broadcast(%constant.614), dimensions={}
  %mul.1687 = bf16[7168,2,64]{2,0,1} multiply(%select_n.135, %broadcast.221), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1 = bf16[7168,2,64]{2,1,0} parameter(176), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'kernel\']"}
  %constant.613 = bf16[] constant(0.8984)
  %mul.1533 = bf16[7168,2,64]{2,1,0} broadcast(%constant.613), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1688 = bf16[7168,2,64]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1, %mul.1533), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.892 = bf16[7168,2,64]{2,0,1} add(%mul.1687, %mul.1688), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1488 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1535 = bf16[7168,2,64]{2,1,0} broadcast(%convert_element_type.1488), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1536 = bf16[7168,2,64]{2,0,1} divide(%add.892, %div.1535), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.48 = bf16[7168,2,64]{2,0,1} multiply(%select_n.135, %select_n.135), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.560 = bf16[] constant(0.05005)
  %mul.1502 = bf16[7168,2,64]{2,1,0} broadcast(%constant.560), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1753 = bf16[7168,2,64]{2,0,1} multiply(%integer_pow.48, %mul.1502), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1 = bf16[7168,2,64]{2,1,0} parameter(209), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'gate\'][\'kernel\']"}
  %constant.559 = bf16[] constant(0.9492)
  %mul.1501 = bf16[7168,2,64]{2,1,0} broadcast(%constant.559), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1754 = bf16[7168,2,64]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1, %mul.1501), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.925 = bf16[7168,2,64]{2,0,1} add(%mul.1753, %mul.1754), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1521 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1601 = bf16[7168,2,64]{2,1,0} broadcast(%convert_element_type.1521), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1602 = bf16[7168,2,64]{2,0,1} divide(%add.925, %div.1601), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.53 = bf16[7168,2,64]{2,0,1} sqrt(%div.1602), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.519 = bf16[] constant(1.001e-08)
  %add.821 = bf16[7168,2,64]{2,1,0} broadcast(%constant.519), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.959 = bf16[7168,2,64]{2,0,1} add(%sqrt.53, %add.821), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1652 = bf16[7168,2,64]{2,0,1} divide(%div.1536, %add.959), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1804 = bf16[7168,2,64]{2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1, %broadcast.221), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.992 = bf16[7168,2,64]{2,0,1} add(%div.1652, %mul.1804), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1859 = bf16[7168,2,64]{2,1,0} multiply(%mul.1858, %add.992), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1029 = bf16[7168,2,64]{2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____gate____kernel__.1, %mul.1859), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.598 = bf16[7168,2,64]{2,1,0} custom-call(%add.1029), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.826 = bf16[7168,2,64]{2,1,0} custom-call(%custom-call.598), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.439 = bf16[7168,2,64]{2,1,0} reshape(%custom-call.826), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1557 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1860 = bf16[64,2]{1,0} broadcast(%convert_element_type.1557), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.136 = pred[64,2]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1471 = bf16[64,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1472 = bf16[64,2]{0,1} divide(%transpose.154, %div.1471), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.137 = bf16[64,2]{0,1} select(%select_n.136, %transpose.154, %div.1472), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1689 = bf16[64,2]{0,1} multiply(%select_n.137, %broadcast.223), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1 = bf16[64,2]{1,0} parameter(177), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'router_bias\']"}
  %mul.1690 = bf16[64,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1, %broadcast.222), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.893 = bf16[64,2]{0,1} add(%mul.1689, %mul.1690), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1489 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1537 = bf16[64,2]{1,0} broadcast(%convert_element_type.1489), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1538 = bf16[64,2]{0,1} divide(%add.893, %div.1537), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.49 = bf16[64,2]{0,1} multiply(%select_n.137, %select_n.137), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1755 = bf16[64,2]{0,1} multiply(%integer_pow.49, %broadcast.200), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1 = bf16[64,2]{1,0} parameter(210), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'router_bias\']"}
  %mul.1756 = bf16[64,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1, %broadcast.199), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.926 = bf16[64,2]{0,1} add(%mul.1755, %mul.1756), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1522 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1603 = bf16[64,2]{1,0} broadcast(%convert_element_type.1522), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1604 = bf16[64,2]{0,1} divide(%add.926, %div.1603), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.54 = bf16[64,2]{0,1} sqrt(%div.1604), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.960 = bf16[64,2]{0,1} add(%sqrt.54, %broadcast.190), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1653 = bf16[64,2]{0,1} divide(%div.1538, %add.960), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1805 = bf16[64,2]{1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1, %broadcast.223), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.993 = bf16[64,2]{0,1} add(%div.1653, %mul.1805), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1861 = bf16[64,2]{1,0} multiply(%mul.1860, %add.993), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1030 = bf16[64,2]{1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____router_bias__.1, %mul.1861), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.599 = bf16[64,2]{1,0} custom-call(%add.1030), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.827 = bf16[64,2]{1,0} custom-call(%custom-call.599), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.440 = bf16[64,2]{1,0} reshape(%custom-call.827), sharding={replicated}
  %convert_element_type.1558 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1862 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1558), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.138 = pred[64,2,7168,2048]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1473 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1474 = bf16[64,2,7168,2048]{3,2,0,1} divide(%transpose.153, %div.1473), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.139 = bf16[64,2,7168,2048]{3,2,0,1} select(%select_n.138, %transpose.153, %div.1474), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.612 = bf16[] constant(0.1001)
  %broadcast.220 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%constant.612), dimensions={}
  %mul.1691 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.139, %broadcast.220), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(178), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_0\']"}
  %constant.611 = bf16[] constant(0.8984)
  %broadcast.219 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%constant.611), dimensions={}
  %mul.1692 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1, %broadcast.219), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.894 = bf16[64,2,7168,2048]{3,2,0,1} add(%mul.1691, %mul.1692), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1490 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1539 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1490), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1540 = bf16[64,2,7168,2048]{3,2,0,1} divide(%add.894, %div.1539), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.50 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.139, %select_n.139), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.558 = bf16[] constant(0.05005)
  %broadcast.198 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%constant.558), dimensions={}
  %mul.1757 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%integer_pow.50, %broadcast.198), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(211), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_0\']"}
  %constant.557 = bf16[] constant(0.9492)
  %broadcast.197 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%constant.557), dimensions={}
  %mul.1758 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1, %broadcast.197), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.927 = bf16[64,2,7168,2048]{3,2,0,1} add(%mul.1757, %mul.1758), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1523 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1605 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1523), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1606 = bf16[64,2,7168,2048]{3,2,0,1} divide(%add.927, %div.1605), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.55 = bf16[64,2,7168,2048]{3,2,0,1} sqrt(%div.1606), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.518 = bf16[] constant(1.001e-08)
  %broadcast.189 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%constant.518), dimensions={}
  %add.961 = bf16[64,2,7168,2048]{3,2,0,1} add(%sqrt.55, %broadcast.189), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1654 = bf16[64,2,7168,2048]{3,2,0,1} divide(%div.1540, %add.961), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1806 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1, %broadcast.220), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.994 = bf16[64,2,7168,2048]{3,2,0,1} add(%div.1654, %mul.1806), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1863 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%mul.1862, %add.994), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1031 = bf16[64,2,7168,2048]{3,2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_0__.1, %mul.1863), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.600 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.1031), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.828 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.600), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.441 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.828), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1559 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1864 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1559), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.140 = pred[64,2,7168,2048]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1475 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1476 = bf16[64,2,7168,2048]{3,2,0,1} divide(%transpose.152, %div.1475), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.141 = bf16[64,2,7168,2048]{3,2,0,1} select(%select_n.140, %transpose.152, %div.1476), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1693 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.141, %broadcast.220), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(179), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_1\']"}
  %mul.1694 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1, %broadcast.219), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.895 = bf16[64,2,7168,2048]{3,2,0,1} add(%mul.1693, %mul.1694), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1491 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1541 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1491), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1542 = bf16[64,2,7168,2048]{3,2,0,1} divide(%add.895, %div.1541), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.51 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.141, %select_n.141), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1759 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%integer_pow.51, %broadcast.198), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1 = bf16[64,2,7168,2048]{3,2,1,0} parameter(212), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wi_1\']"}
  %mul.1760 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1, %broadcast.197), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.928 = bf16[64,2,7168,2048]{3,2,0,1} add(%mul.1759, %mul.1760), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1524 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1607 = bf16[64,2,7168,2048]{3,2,1,0} broadcast(%convert_element_type.1524), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1608 = bf16[64,2,7168,2048]{3,2,0,1} divide(%add.928, %div.1607), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.56 = bf16[64,2,7168,2048]{3,2,0,1} sqrt(%div.1608), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.962 = bf16[64,2,7168,2048]{3,2,0,1} add(%sqrt.56, %broadcast.189), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1655 = bf16[64,2,7168,2048]{3,2,0,1} divide(%div.1542, %add.962), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1807 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1, %broadcast.220), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.995 = bf16[64,2,7168,2048]{3,2,0,1} add(%div.1655, %mul.1807), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1865 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%mul.1864, %add.995), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1032 = bf16[64,2,7168,2048]{3,2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wi_1__.1, %mul.1865), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.601 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.1032), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.829 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.601), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.442 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.829), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1560 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1866 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%convert_element_type.1560), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.142 = pred[64,2,2048,7168]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1477 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1478 = bf16[64,2,2048,7168]{3,2,0,1} divide(%transpose.151, %div.1477), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.143 = bf16[64,2,2048,7168]{3,2,0,1} select(%select_n.142, %transpose.151, %div.1478), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.610 = bf16[] constant(0.1001)
  %broadcast.218 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%constant.610), dimensions={}
  %mul.1695 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%select_n.143, %broadcast.218), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1 = bf16[64,2,2048,7168]{3,2,1,0} parameter(180), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wo\']"}
  %constant.609 = bf16[] constant(0.8984)
  %mul.1532 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%constant.609), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1696 = bf16[64,2,2048,7168]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1, %mul.1532), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.896 = bf16[64,2,2048,7168]{3,2,0,1} add(%mul.1695, %mul.1696), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1492 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1543 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%convert_element_type.1492), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1544 = bf16[64,2,2048,7168]{3,2,0,1} divide(%add.896, %div.1543), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.52 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%select_n.143, %select_n.143), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.556 = bf16[] constant(0.05005)
  %mul.1500 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%constant.556), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1761 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%integer_pow.52, %mul.1500), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1 = bf16[64,2,2048,7168]{3,2,1,0} parameter(213), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'MoeBlock_0\'][\'wo\']"}
  %constant.555 = bf16[] constant(0.9492)
  %mul.1499 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%constant.555), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1762 = bf16[64,2,2048,7168]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1, %mul.1499), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.929 = bf16[64,2,2048,7168]{3,2,0,1} add(%mul.1761, %mul.1762), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1525 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1609 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%convert_element_type.1525), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1610 = bf16[64,2,2048,7168]{3,2,0,1} divide(%add.929, %div.1609), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.57 = bf16[64,2,2048,7168]{3,2,0,1} sqrt(%div.1610), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.517 = bf16[] constant(1.001e-08)
  %add.820 = bf16[64,2,2048,7168]{3,2,1,0} broadcast(%constant.517), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.963 = bf16[64,2,2048,7168]{3,2,0,1} add(%sqrt.57, %add.820), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1656 = bf16[64,2,2048,7168]{3,2,0,1} divide(%div.1544, %add.963), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1808 = bf16[64,2,2048,7168]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1, %broadcast.218), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.996 = bf16[64,2,2048,7168]{3,2,0,1} add(%div.1656, %mul.1808), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1867 = bf16[64,2,2048,7168]{3,2,1,0} multiply(%mul.1866, %add.996), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1033 = bf16[64,2,2048,7168]{3,2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____MoeBlock_0____wo__.1, %mul.1867), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.602 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%add.1033), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.830 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%custom-call.602), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>]>"}
  %reshape.443 = bf16[64,2,2048,7168]{3,2,1,0} reshape(%custom-call.830), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1561 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1868 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1561), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.144 = pred[7168,2,2048]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1479 = bf16[7168,2,2048]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1480 = bf16[7168,2,2048]{2,0,1} divide(%transpose.150, %div.1479), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.145 = bf16[7168,2,2048]{2,0,1} select(%select_n.144, %transpose.150, %div.1480), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.608 = bf16[] constant(0.1001)
  %broadcast.217 = bf16[7168,2,2048]{2,1,0} broadcast(%constant.608), dimensions={}
  %mul.1697 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.145, %broadcast.217), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(181), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'kernel\']"}
  %constant.607 = bf16[] constant(0.8984)
  %broadcast.216 = bf16[7168,2,2048]{2,1,0} broadcast(%constant.607), dimensions={}
  %mul.1698 = bf16[7168,2,2048]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1, %broadcast.216), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.897 = bf16[7168,2,2048]{2,0,1} add(%mul.1697, %mul.1698), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1493 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1545 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1493), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1546 = bf16[7168,2,2048]{2,0,1} divide(%add.897, %div.1545), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.53 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.145, %select_n.145), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.554 = bf16[] constant(0.05005)
  %broadcast.196 = bf16[7168,2,2048]{2,1,0} broadcast(%constant.554), dimensions={}
  %mul.1763 = bf16[7168,2,2048]{2,0,1} multiply(%integer_pow.53, %broadcast.196), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(214), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_0\'][\'kernel\']"}
  %constant.553 = bf16[] constant(0.9492)
  %broadcast.195 = bf16[7168,2,2048]{2,1,0} broadcast(%constant.553), dimensions={}
  %mul.1764 = bf16[7168,2,2048]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1, %broadcast.195), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.930 = bf16[7168,2,2048]{2,0,1} add(%mul.1763, %mul.1764), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1526 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1611 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1526), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1612 = bf16[7168,2,2048]{2,0,1} divide(%add.930, %div.1611), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.58 = bf16[7168,2,2048]{2,0,1} sqrt(%div.1612), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.516 = bf16[] constant(1.001e-08)
  %broadcast.188 = bf16[7168,2,2048]{2,1,0} broadcast(%constant.516), dimensions={}
  %add.964 = bf16[7168,2,2048]{2,0,1} add(%sqrt.58, %broadcast.188), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1657 = bf16[7168,2,2048]{2,0,1} divide(%div.1546, %add.964), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1809 = bf16[7168,2,2048]{2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1, %broadcast.217), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.997 = bf16[7168,2,2048]{2,0,1} add(%div.1657, %mul.1809), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1869 = bf16[7168,2,2048]{2,1,0} multiply(%mul.1868, %add.997), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1034 = bf16[7168,2,2048]{2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_0____kernel__.1, %mul.1869), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.603 = bf16[7168,2,2048]{2,1,0} custom-call(%add.1034), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.831 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.603), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.444 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.831), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1562 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1870 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1562), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.146 = pred[7168,2,2048]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1481 = bf16[7168,2,2048]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1482 = bf16[7168,2,2048]{2,0,1} divide(%transpose.149, %div.1481), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.147 = bf16[7168,2,2048]{2,0,1} select(%select_n.146, %transpose.149, %div.1482), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1699 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.147, %broadcast.217), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(182), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'kernel\']"}
  %mul.1700 = bf16[7168,2,2048]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1, %broadcast.216), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.898 = bf16[7168,2,2048]{2,0,1} add(%mul.1699, %mul.1700), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1494 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1547 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1494), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1548 = bf16[7168,2,2048]{2,0,1} divide(%add.898, %div.1547), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.54 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.147, %select_n.147), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1765 = bf16[7168,2,2048]{2,0,1} multiply(%integer_pow.54, %broadcast.196), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1 = bf16[7168,2,2048]{2,1,0} parameter(215), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wi_1\'][\'kernel\']"}
  %mul.1766 = bf16[7168,2,2048]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1, %broadcast.195), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.931 = bf16[7168,2,2048]{2,0,1} add(%mul.1765, %mul.1766), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1527 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1613 = bf16[7168,2,2048]{2,1,0} broadcast(%convert_element_type.1527), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1614 = bf16[7168,2,2048]{2,0,1} divide(%add.931, %div.1613), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.59 = bf16[7168,2,2048]{2,0,1} sqrt(%div.1614), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.965 = bf16[7168,2,2048]{2,0,1} add(%sqrt.59, %broadcast.188), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1658 = bf16[7168,2,2048]{2,0,1} divide(%div.1548, %add.965), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1810 = bf16[7168,2,2048]{2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1, %broadcast.217), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.998 = bf16[7168,2,2048]{2,0,1} add(%div.1658, %mul.1810), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1871 = bf16[7168,2,2048]{2,1,0} multiply(%mul.1870, %add.998), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1035 = bf16[7168,2,2048]{2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wi_1____kernel__.1, %mul.1871), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.604 = bf16[7168,2,2048]{2,1,0} custom-call(%add.1035), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.832 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.604), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.445 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.832), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1563 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1872 = bf16[2048,2,7168]{2,1,0} broadcast(%convert_element_type.1563), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.148 = pred[2048,2,7168]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1483 = bf16[2048,2,7168]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1484 = bf16[2048,2,7168]{2,0,1} divide(%transpose.148, %div.1483), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.149 = bf16[2048,2,7168]{2,0,1} select(%select_n.148, %transpose.148, %div.1484), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.606 = bf16[] constant(0.1001)
  %broadcast.215 = bf16[2048,2,7168]{2,1,0} broadcast(%constant.606), dimensions={}
  %mul.1701 = bf16[2048,2,7168]{2,0,1} multiply(%select_n.149, %broadcast.215), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1 = bf16[2048,2,7168]{2,1,0} parameter(183), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'kernel\']"}
  %constant.605 = bf16[] constant(0.8984)
  %mul.1531 = bf16[2048,2,7168]{2,1,0} broadcast(%constant.605), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1702 = bf16[2048,2,7168]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1, %mul.1531), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.899 = bf16[2048,2,7168]{2,0,1} add(%mul.1701, %mul.1702), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1495 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1549 = bf16[2048,2,7168]{2,1,0} broadcast(%convert_element_type.1495), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1550 = bf16[2048,2,7168]{2,0,1} divide(%add.899, %div.1549), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.55 = bf16[2048,2,7168]{2,0,1} multiply(%select_n.149, %select_n.149), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.552 = bf16[] constant(0.05005)
  %mul.1498 = bf16[2048,2,7168]{2,1,0} broadcast(%constant.552), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1767 = bf16[2048,2,7168]{2,0,1} multiply(%integer_pow.55, %mul.1498), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1 = bf16[2048,2,7168]{2,1,0} parameter(216), sharding={devices=[1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'DeepSeekMoeBlock_0\'][\'shared_experts\'][\'wo\'][\'kernel\']"}
  %constant.551 = bf16[] constant(0.9492)
  %mul.1497 = bf16[2048,2,7168]{2,1,0} broadcast(%constant.551), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1768 = bf16[2048,2,7168]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1, %mul.1497), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.932 = bf16[2048,2,7168]{2,0,1} add(%mul.1767, %mul.1768), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1528 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1615 = bf16[2048,2,7168]{2,1,0} broadcast(%convert_element_type.1528), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1616 = bf16[2048,2,7168]{2,0,1} divide(%add.932, %div.1615), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.60 = bf16[2048,2,7168]{2,0,1} sqrt(%div.1616), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.515 = bf16[] constant(1.001e-08)
  %add.819 = bf16[2048,2,7168]{2,1,0} broadcast(%constant.515), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.966 = bf16[2048,2,7168]{2,0,1} add(%sqrt.60, %add.819), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1659 = bf16[2048,2,7168]{2,0,1} divide(%div.1550, %add.966), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1811 = bf16[2048,2,7168]{2,1,0} multiply(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1, %broadcast.215), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.999 = bf16[2048,2,7168]{2,0,1} add(%div.1659, %mul.1811), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1873 = bf16[2048,2,7168]{2,1,0} multiply(%mul.1872, %add.999), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1036 = bf16[2048,2,7168]{2,1,0} add(%state_params__params____decoder____moe_layers____DeepSeekMoeBlock_0____shared_experts____wo____kernel__.1, %mul.1873), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.605 = bf16[2048,2,7168]{2,1,0} custom-call(%add.1036), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.833 = bf16[2048,2,7168]{2,1,0} custom-call(%custom-call.605), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.446 = bf16[2048,2,7168]{2,1,0} reshape(%custom-call.833), sharding={devices=[1,1,4]<=[4]}
  %convert_element_type.1564 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1874 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1564), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.150 = pred[7168,2]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1485 = bf16[7168,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1486 = bf16[7168,2]{0,1} divide(%transpose.147, %div.1485), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.151 = bf16[7168,2]{0,1} select(%select_n.150, %transpose.147, %div.1486), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.604 = bf16[] constant(0.1001)
  %broadcast.214 = bf16[7168,2]{1,0} broadcast(%constant.604), dimensions={}
  %mul.1703 = bf16[7168,2]{0,1} multiply(%select_n.151, %broadcast.214), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(184), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %constant.603 = bf16[] constant(0.8984)
  %broadcast.213 = bf16[7168,2]{1,0} broadcast(%constant.603), dimensions={}
  %mul.1704 = bf16[7168,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1, %broadcast.213), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.900 = bf16[7168,2]{0,1} add(%mul.1703, %mul.1704), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1496 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1551 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1496), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1552 = bf16[7168,2]{0,1} divide(%add.900, %div.1551), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.56 = bf16[7168,2]{0,1} multiply(%select_n.151, %select_n.151), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.550 = bf16[] constant(0.05005)
  %broadcast.194 = bf16[7168,2]{1,0} broadcast(%constant.550), dimensions={}
  %mul.1769 = bf16[7168,2]{0,1} multiply(%integer_pow.56, %broadcast.194), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(217), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'post_self_attention_layer_norm\'][\'scale\']"}
  %constant.549 = bf16[] constant(0.9492)
  %broadcast.193 = bf16[7168,2]{1,0} broadcast(%constant.549), dimensions={}
  %mul.1770 = bf16[7168,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____post_self_attention_layer_norm____scale__.1, %broadcast.193), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.933 = bf16[7168,2]{0,1} add(%mul.1769, %mul.1770), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1529 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1617 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1529), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1618 = bf16[7168,2]{0,1} divide(%add.933, %div.1617), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.61 = bf16[7168,2]{0,1} sqrt(%div.1618), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.514 = bf16[] constant(1.001e-08)
  %broadcast.187 = bf16[7168,2]{1,0} broadcast(%constant.514), dimensions={}
  %add.967 = bf16[7168,2]{0,1} add(%sqrt.61, %broadcast.187), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1660 = bf16[7168,2]{0,1} divide(%div.1552, %add.967), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1812 = bf16[7168,2]{1,0} multiply(%state_params__params____decoder____moe_layers____post_self_attention_layer_norm____scale__.1, %broadcast.214), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1000 = bf16[7168,2]{0,1} add(%div.1660, %mul.1812), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1875 = bf16[7168,2]{1,0} multiply(%mul.1874, %add.1000), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1037 = bf16[7168,2]{1,0} add(%state_params__params____decoder____moe_layers____post_self_attention_layer_norm____scale__.1, %mul.1875), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.606 = bf16[7168,2]{1,0} custom-call(%add.1037), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.834 = bf16[7168,2]{1,0} custom-call(%custom-call.606), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.447 = bf16[7168,2]{1,0} reshape(%custom-call.834), sharding={replicated}
  %convert_element_type.1565 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1876 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1565), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.152 = pred[7168,2]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1487 = bf16[7168,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1488 = bf16[7168,2]{0,1} divide(%transpose.146, %div.1487), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.153 = bf16[7168,2]{0,1} select(%select_n.152, %transpose.146, %div.1488), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %mul.1705 = bf16[7168,2]{0,1} multiply(%select_n.153, %broadcast.214), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(185), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %mul.1706 = bf16[7168,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.213), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.901 = bf16[7168,2]{0,1} add(%mul.1705, %mul.1706), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1497 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1553 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1497), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1554 = bf16[7168,2]{0,1} divide(%add.901, %div.1553), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.57 = bf16[7168,2]{0,1} multiply(%select_n.153, %select_n.153), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %mul.1771 = bf16[7168,2]{0,1} multiply(%integer_pow.57, %broadcast.194), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1 = bf16[7168,2]{1,0} parameter(218), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'pre_self_attention_layer_norm\'][\'scale\']"}
  %mul.1772 = bf16[7168,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.193), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.934 = bf16[7168,2]{0,1} add(%mul.1771, %mul.1772), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1530 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1619 = bf16[7168,2]{1,0} broadcast(%convert_element_type.1530), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1620 = bf16[7168,2]{0,1} divide(%add.934, %div.1619), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.62 = bf16[7168,2]{0,1} sqrt(%div.1620), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.968 = bf16[7168,2]{0,1} add(%sqrt.62, %broadcast.187), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1661 = bf16[7168,2]{0,1} divide(%div.1554, %add.968), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1813 = bf16[7168,2]{1,0} multiply(%state_params__params____decoder____moe_layers____pre_self_attention_layer_norm____scale__.1, %broadcast.214), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1001 = bf16[7168,2]{0,1} add(%div.1661, %mul.1813), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1877 = bf16[7168,2]{1,0} multiply(%mul.1876, %add.1001), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1038 = bf16[7168,2]{1,0} add(%state_params__params____decoder____moe_layers____pre_self_attention_layer_norm____scale__.1, %mul.1877), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.607 = bf16[7168,2]{1,0} custom-call(%add.1038), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.835 = bf16[7168,2]{1,0} custom-call(%custom-call.607), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.448 = bf16[7168,2]{1,0} reshape(%custom-call.835), sharding={replicated}
  %convert_element_type.1566 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1878 = bf16[512,2]{1,0} broadcast(%convert_element_type.1566), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.154 = pred[512,2]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1489 = bf16[512,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1490 = bf16[512,2]{0,1} divide(%transpose.145, %div.1489), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.155 = bf16[512,2]{0,1} select(%select_n.154, %transpose.145, %div.1490), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.602 = bf16[] constant(0.1001)
  %broadcast.212 = bf16[512,2]{1,0} broadcast(%constant.602), dimensions={}
  %mul.1707 = bf16[512,2]{0,1} multiply(%select_n.155, %broadcast.212), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____kv_norm____scale__.1 = bf16[512,2]{1,0} parameter(186), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %constant.601 = bf16[] constant(0.8984)
  %mul.1530 = bf16[512,2]{1,0} broadcast(%constant.601), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1708 = bf16[512,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____kv_norm____scale__.1, %mul.1530), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.902 = bf16[512,2]{0,1} add(%mul.1707, %mul.1708), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1498 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1555 = bf16[512,2]{1,0} broadcast(%convert_element_type.1498), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1556 = bf16[512,2]{0,1} divide(%add.902, %div.1555), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.58 = bf16[512,2]{0,1} multiply(%select_n.155, %select_n.155), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.548 = bf16[] constant(0.05005)
  %mul.1496 = bf16[512,2]{1,0} broadcast(%constant.548), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1773 = bf16[512,2]{0,1} multiply(%integer_pow.58, %mul.1496), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____kv_norm____scale__.1 = bf16[512,2]{1,0} parameter(219), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'kv_norm\'][\'scale\']"}
  %constant.547 = bf16[] constant(0.9492)
  %mul.1495 = bf16[512,2]{1,0} broadcast(%constant.547), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1774 = bf16[512,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____kv_norm____scale__.1, %mul.1495), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.935 = bf16[512,2]{0,1} add(%mul.1773, %mul.1774), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1531 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1621 = bf16[512,2]{1,0} broadcast(%convert_element_type.1531), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1622 = bf16[512,2]{0,1} divide(%add.935, %div.1621), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.63 = bf16[512,2]{0,1} sqrt(%div.1622), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.513 = bf16[] constant(1.001e-08)
  %add.818 = bf16[512,2]{1,0} broadcast(%constant.513), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.969 = bf16[512,2]{0,1} add(%sqrt.63, %add.818), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1662 = bf16[512,2]{0,1} divide(%div.1556, %add.969), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1814 = bf16[512,2]{1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____kv_norm____scale__.1, %broadcast.212), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1002 = bf16[512,2]{0,1} add(%div.1662, %mul.1814), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1879 = bf16[512,2]{1,0} multiply(%mul.1878, %add.1002), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1039 = bf16[512,2]{1,0} add(%state_params__params____decoder____moe_layers____self_attention____kv_norm____scale__.1, %mul.1879), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.608 = bf16[512,2]{1,0} custom-call(%add.1039), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.836 = bf16[512,2]{1,0} custom-call(%custom-call.608), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.449 = bf16[512,2]{1,0} reshape(%custom-call.836), sharding={replicated}
  %convert_element_type.1567 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1880 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%convert_element_type.1567), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.156 = pred[128,2,128,7168]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1491 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1492 = bf16[128,2,128,7168]{3,2,0,1} divide(%transpose.144, %div.1491), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.157 = bf16[128,2,128,7168]{3,2,0,1} select(%select_n.156, %transpose.144, %div.1492), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.600 = bf16[] constant(0.1001)
  %broadcast.211 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%constant.600), dimensions={}
  %mul.1709 = bf16[128,2,128,7168]{3,2,0,1} multiply(%select_n.157, %broadcast.211), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____out____kernel__.1 = bf16[128,2,128,7168]{3,2,1,0} parameter(187), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %constant.599 = bf16[] constant(0.8984)
  %mul.1529 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%constant.599), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1710 = bf16[128,2,128,7168]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____out____kernel__.1, %mul.1529), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.903 = bf16[128,2,128,7168]{3,2,0,1} add(%mul.1709, %mul.1710), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1499 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1557 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%convert_element_type.1499), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1558 = bf16[128,2,128,7168]{3,2,0,1} divide(%add.903, %div.1557), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.59 = bf16[128,2,128,7168]{3,2,0,1} multiply(%select_n.157, %select_n.157), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.546 = bf16[] constant(0.05005)
  %mul.1494 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%constant.546), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1775 = bf16[128,2,128,7168]{3,2,0,1} multiply(%integer_pow.59, %mul.1494), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____out____kernel__.1 = bf16[128,2,128,7168]{3,2,1,0} parameter(220), sharding={devices=[1,1,1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'out\'][\'kernel\']"}
  %constant.545 = bf16[] constant(0.9492)
  %mul.1493 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%constant.545), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1776 = bf16[128,2,128,7168]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____out____kernel__.1, %mul.1493), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.936 = bf16[128,2,128,7168]{3,2,0,1} add(%mul.1775, %mul.1776), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1532 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1623 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%convert_element_type.1532), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1624 = bf16[128,2,128,7168]{3,2,0,1} divide(%add.936, %div.1623), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.64 = bf16[128,2,128,7168]{3,2,0,1} sqrt(%div.1624), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.512 = bf16[] constant(1.001e-08)
  %add.817 = bf16[128,2,128,7168]{3,2,1,0} broadcast(%constant.512), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.970 = bf16[128,2,128,7168]{3,2,0,1} add(%sqrt.64, %add.817), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1663 = bf16[128,2,128,7168]{3,2,0,1} divide(%div.1558, %add.970), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1815 = bf16[128,2,128,7168]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____out____kernel__.1, %broadcast.211), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1003 = bf16[128,2,128,7168]{3,2,0,1} add(%div.1663, %mul.1815), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1881 = bf16[128,2,128,7168]{3,2,1,0} multiply(%mul.1880, %add.1003), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1040 = bf16[128,2,128,7168]{3,2,1,0} add(%state_params__params____decoder____moe_layers____self_attention____out____kernel__.1, %mul.1881), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.609 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%add.1040), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.837 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%custom-call.609), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.450 = bf16[128,2,128,7168]{3,2,1,0} reshape(%custom-call.837), sharding={devices=[1,1,1,4]<=[4]}
  %convert_element_type.1568 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1882 = bf16[1536,2]{1,0} broadcast(%convert_element_type.1568), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.158 = pred[1536,2]{0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1493 = bf16[1536,2]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1494 = bf16[1536,2]{0,1} divide(%transpose.143, %div.1493), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.159 = bf16[1536,2]{0,1} select(%select_n.158, %transpose.143, %div.1494), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.598 = bf16[] constant(0.1001)
  %broadcast.210 = bf16[1536,2]{1,0} broadcast(%constant.598), dimensions={}
  %mul.1711 = bf16[1536,2]{0,1} multiply(%select_n.159, %broadcast.210), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____q_norm____scale__.1 = bf16[1536,2]{1,0} parameter(188), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %constant.597 = bf16[] constant(0.8984)
  %mul.1528 = bf16[1536,2]{1,0} broadcast(%constant.597), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1712 = bf16[1536,2]{1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____q_norm____scale__.1, %mul.1528), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.904 = bf16[1536,2]{0,1} add(%mul.1711, %mul.1712), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1500 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1559 = bf16[1536,2]{1,0} broadcast(%convert_element_type.1500), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1560 = bf16[1536,2]{0,1} divide(%add.904, %div.1559), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.60 = bf16[1536,2]{0,1} multiply(%select_n.159, %select_n.159), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.544 = bf16[] constant(0.05005)
  %mul.1492 = bf16[1536,2]{1,0} broadcast(%constant.544), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1777 = bf16[1536,2]{0,1} multiply(%integer_pow.60, %mul.1492), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____q_norm____scale__.1 = bf16[1536,2]{1,0} parameter(221), sharding={replicated}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'q_norm\'][\'scale\']"}
  %constant.543 = bf16[] constant(0.9492)
  %mul.1491 = bf16[1536,2]{1,0} broadcast(%constant.543), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1778 = bf16[1536,2]{1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____q_norm____scale__.1, %mul.1491), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.937 = bf16[1536,2]{0,1} add(%mul.1777, %mul.1778), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1533 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1625 = bf16[1536,2]{1,0} broadcast(%convert_element_type.1533), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1626 = bf16[1536,2]{0,1} divide(%add.937, %div.1625), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.65 = bf16[1536,2]{0,1} sqrt(%div.1626), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.511 = bf16[] constant(1.001e-08)
  %add.816 = bf16[1536,2]{1,0} broadcast(%constant.511), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.971 = bf16[1536,2]{0,1} add(%sqrt.65, %add.816), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1664 = bf16[1536,2]{0,1} divide(%div.1560, %add.971), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1816 = bf16[1536,2]{1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____q_norm____scale__.1, %broadcast.210), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1004 = bf16[1536,2]{0,1} add(%div.1664, %mul.1816), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1883 = bf16[1536,2]{1,0} multiply(%mul.1882, %add.1004), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1041 = bf16[1536,2]{1,0} add(%state_params__params____decoder____moe_layers____self_attention____q_norm____scale__.1, %mul.1883), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.610 = bf16[1536,2]{1,0} custom-call(%add.1041), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.838 = bf16[1536,2]{1,0} custom-call(%custom-call.610), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.451 = bf16[1536,2]{1,0} reshape(%custom-call.838), sharding={replicated}
  %convert_element_type.1569 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1884 = bf16[7168,2,576]{2,1,0} broadcast(%convert_element_type.1569), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.160 = pred[7168,2,576]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1495 = bf16[7168,2,576]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1496 = bf16[7168,2,576]{2,0,1} divide(%transpose.142, %div.1495), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.161 = bf16[7168,2,576]{2,0,1} select(%select_n.160, %transpose.142, %div.1496), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.596 = bf16[] constant(0.1001)
  %broadcast.209 = bf16[7168,2,576]{2,1,0} broadcast(%constant.596), dimensions={}
  %mul.1713 = bf16[7168,2,576]{2,0,1} multiply(%select_n.161, %broadcast.209), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,2,576]{2,1,0} parameter(189), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %constant.595 = bf16[] constant(0.8984)
  %mul.1527 = bf16[7168,2,576]{2,1,0} broadcast(%constant.595), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1714 = bf16[7168,2,576]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_a_kernel__.1, %mul.1527), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.905 = bf16[7168,2,576]{2,0,1} add(%mul.1713, %mul.1714), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1501 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1561 = bf16[7168,2,576]{2,1,0} broadcast(%convert_element_type.1501), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1562 = bf16[7168,2,576]{2,0,1} divide(%add.905, %div.1561), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.61 = bf16[7168,2,576]{2,0,1} multiply(%select_n.161, %select_n.161), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.542 = bf16[] constant(0.05005)
  %mul.1490 = bf16[7168,2,576]{2,1,0} broadcast(%constant.542), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1779 = bf16[7168,2,576]{2,0,1} multiply(%integer_pow.61, %mul.1490), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_a_kernel__.1 = bf16[7168,2,576]{2,1,0} parameter(222), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_a_kernel\']"}
  %constant.541 = bf16[] constant(0.9492)
  %mul.1489 = bf16[7168,2,576]{2,1,0} broadcast(%constant.541), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1780 = bf16[7168,2,576]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_a_kernel__.1, %mul.1489), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.938 = bf16[7168,2,576]{2,0,1} add(%mul.1779, %mul.1780), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1534 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1627 = bf16[7168,2,576]{2,1,0} broadcast(%convert_element_type.1534), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1628 = bf16[7168,2,576]{2,0,1} divide(%add.938, %div.1627), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.66 = bf16[7168,2,576]{2,0,1} sqrt(%div.1628), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.510 = bf16[] constant(1.001e-08)
  %add.815 = bf16[7168,2,576]{2,1,0} broadcast(%constant.510), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.972 = bf16[7168,2,576]{2,0,1} add(%sqrt.66, %add.815), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1665 = bf16[7168,2,576]{2,0,1} divide(%div.1562, %add.972), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1817 = bf16[7168,2,576]{2,1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____wkv_a_kernel__.1, %broadcast.209), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1005 = bf16[7168,2,576]{2,0,1} add(%div.1665, %mul.1817), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1885 = bf16[7168,2,576]{2,1,0} multiply(%mul.1884, %add.1005), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1042 = bf16[7168,2,576]{2,1,0} add(%state_params__params____decoder____moe_layers____self_attention____wkv_a_kernel__.1, %mul.1885), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.611 = bf16[7168,2,576]{2,1,0} custom-call(%add.1042), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.839 = bf16[7168,2,576]{2,1,0} custom-call(%custom-call.611), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.452 = bf16[7168,2,576]{2,1,0} reshape(%custom-call.839), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1570 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1886 = bf16[512,2,128,256]{3,2,1,0} broadcast(%convert_element_type.1570), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.162 = pred[512,2,128,256]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1497 = bf16[512,2,128,256]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1498 = bf16[512,2,128,256]{3,2,0,1} divide(%transpose.141, %div.1497), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.163 = bf16[512,2,128,256]{3,2,0,1} select(%select_n.162, %transpose.141, %div.1498), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.594 = bf16[] constant(0.1001)
  %broadcast.208 = bf16[512,2,128,256]{3,2,1,0} broadcast(%constant.594), dimensions={}
  %mul.1715 = bf16[512,2,128,256]{3,2,0,1} multiply(%select_n.163, %broadcast.208), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_b____kernel__.1 = bf16[512,2,128,256]{3,2,1,0} parameter(190), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %constant.593 = bf16[] constant(0.8984)
  %mul.1526 = bf16[512,2,128,256]{3,2,1,0} broadcast(%constant.593), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1716 = bf16[512,2,128,256]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____wkv_b____kernel__.1, %mul.1526), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.906 = bf16[512,2,128,256]{3,2,0,1} add(%mul.1715, %mul.1716), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1502 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1563 = bf16[512,2,128,256]{3,2,1,0} broadcast(%convert_element_type.1502), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1564 = bf16[512,2,128,256]{3,2,0,1} divide(%add.906, %div.1563), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.62 = bf16[512,2,128,256]{3,2,0,1} multiply(%select_n.163, %select_n.163), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.540 = bf16[] constant(0.05005)
  %mul.1488 = bf16[512,2,128,256]{3,2,1,0} broadcast(%constant.540), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1781 = bf16[512,2,128,256]{3,2,0,1} multiply(%integer_pow.62, %mul.1488), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_b____kernel__.1 = bf16[512,2,128,256]{3,2,1,0} parameter(223), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wkv_b\'][\'kernel\']"}
  %constant.539 = bf16[] constant(0.9492)
  %mul.1487 = bf16[512,2,128,256]{3,2,1,0} broadcast(%constant.539), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1782 = bf16[512,2,128,256]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____wkv_b____kernel__.1, %mul.1487), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.939 = bf16[512,2,128,256]{3,2,0,1} add(%mul.1781, %mul.1782), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1535 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1629 = bf16[512,2,128,256]{3,2,1,0} broadcast(%convert_element_type.1535), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1630 = bf16[512,2,128,256]{3,2,0,1} divide(%add.939, %div.1629), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.67 = bf16[512,2,128,256]{3,2,0,1} sqrt(%div.1630), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.509 = bf16[] constant(1.001e-08)
  %add.814 = bf16[512,2,128,256]{3,2,1,0} broadcast(%constant.509), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.973 = bf16[512,2,128,256]{3,2,0,1} add(%sqrt.67, %add.814), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1666 = bf16[512,2,128,256]{3,2,0,1} divide(%div.1564, %add.973), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1818 = bf16[512,2,128,256]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____wkv_b____kernel__.1, %broadcast.208), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1006 = bf16[512,2,128,256]{3,2,0,1} add(%div.1666, %mul.1818), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1887 = bf16[512,2,128,256]{3,2,1,0} multiply(%mul.1886, %add.1006), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1043 = bf16[512,2,128,256]{3,2,1,0} add(%state_params__params____decoder____moe_layers____self_attention____wkv_b____kernel__.1, %mul.1887), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.612 = bf16[512,2,128,256]{3,2,1,0} custom-call(%add.1043), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.840 = bf16[512,2,128,256]{3,2,1,0} custom-call(%custom-call.612), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.453 = bf16[512,2,128,256]{3,2,1,0} reshape(%custom-call.840), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1571 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1888 = bf16[7168,2,1536]{2,1,0} broadcast(%convert_element_type.1571), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.164 = pred[7168,2,1536]{2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1499 = bf16[7168,2,1536]{2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1500 = bf16[7168,2,1536]{2,0,1} divide(%transpose.140, %div.1499), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.165 = bf16[7168,2,1536]{2,0,1} select(%select_n.164, %transpose.140, %div.1500), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.592 = bf16[] constant(0.1001)
  %broadcast.207 = bf16[7168,2,1536]{2,1,0} broadcast(%constant.592), dimensions={}
  %mul.1717 = bf16[7168,2,1536]{2,0,1} multiply(%select_n.165, %broadcast.207), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_a_kernel__.1 = bf16[7168,2,1536]{2,1,0} parameter(191), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %constant.591 = bf16[] constant(0.8984)
  %mul.1525 = bf16[7168,2,1536]{2,1,0} broadcast(%constant.591), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1718 = bf16[7168,2,1536]{2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_a_kernel__.1, %mul.1525), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.907 = bf16[7168,2,1536]{2,0,1} add(%mul.1717, %mul.1718), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1503 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1565 = bf16[7168,2,1536]{2,1,0} broadcast(%convert_element_type.1503), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1566 = bf16[7168,2,1536]{2,0,1} divide(%add.907, %div.1565), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.63 = bf16[7168,2,1536]{2,0,1} multiply(%select_n.165, %select_n.165), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.538 = bf16[] constant(0.05005)
  %mul.1486 = bf16[7168,2,1536]{2,1,0} broadcast(%constant.538), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1783 = bf16[7168,2,1536]{2,0,1} multiply(%integer_pow.63, %mul.1486), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_a_kernel__.1 = bf16[7168,2,1536]{2,1,0} parameter(224), sharding={devices=[4,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_a_kernel\']"}
  %constant.537 = bf16[] constant(0.9492)
  %mul.1485 = bf16[7168,2,1536]{2,1,0} broadcast(%constant.537), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1784 = bf16[7168,2,1536]{2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_a_kernel__.1, %mul.1485), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.940 = bf16[7168,2,1536]{2,0,1} add(%mul.1783, %mul.1784), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1536 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1631 = bf16[7168,2,1536]{2,1,0} broadcast(%convert_element_type.1536), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1632 = bf16[7168,2,1536]{2,0,1} divide(%add.940, %div.1631), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.68 = bf16[7168,2,1536]{2,0,1} sqrt(%div.1632), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.508 = bf16[] constant(1.001e-08)
  %add.813 = bf16[7168,2,1536]{2,1,0} broadcast(%constant.508), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.974 = bf16[7168,2,1536]{2,0,1} add(%sqrt.68, %add.813), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1667 = bf16[7168,2,1536]{2,0,1} divide(%div.1566, %add.974), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1819 = bf16[7168,2,1536]{2,1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____wq_a_kernel__.1, %broadcast.207), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1007 = bf16[7168,2,1536]{2,0,1} add(%div.1667, %mul.1819), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1889 = bf16[7168,2,1536]{2,1,0} multiply(%mul.1888, %add.1007), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1044 = bf16[7168,2,1536]{2,1,0} add(%state_params__params____decoder____moe_layers____self_attention____wq_a_kernel__.1, %mul.1889), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.613 = bf16[7168,2,1536]{2,1,0} custom-call(%add.1044), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.841 = bf16[7168,2,1536]{2,1,0} custom-call(%custom-call.613), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.454 = bf16[7168,2,1536]{2,1,0} reshape(%custom-call.841), sharding={devices=[4,1,1]<=[4]}
  %convert_element_type.1572 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1890 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%convert_element_type.1572), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.166 = pred[1536,2,128,192]{3,2,0,1} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1501 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1502 = bf16[1536,2,128,192]{3,2,0,1} divide(%transpose.139, %div.1501), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.167 = bf16[1536,2,128,192]{3,2,0,1} select(%select_n.166, %transpose.139, %div.1502), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.590 = bf16[] constant(0.1001)
  %broadcast.206 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%constant.590), dimensions={}
  %mul.1719 = bf16[1536,2,128,192]{3,2,0,1} multiply(%select_n.167, %broadcast.206), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_b____kernel__.1 = bf16[1536,2,128,192]{3,2,1,0} parameter(192), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].mu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %constant.589 = bf16[] constant(0.8984)
  %mul.1524 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%constant.589), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1720 = bf16[1536,2,128,192]{3,2,1,0} multiply(%state_opt_state_0__mu__decoder____moe_layers____self_attention____wq_b____kernel__.1, %mul.1524), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.908 = bf16[1536,2,128,192]{3,2,0,1} add(%mul.1719, %mul.1720), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1504 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1567 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%convert_element_type.1504), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1568 = bf16[1536,2,128,192]{3,2,0,1} divide(%add.908, %div.1567), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.64 = bf16[1536,2,128,192]{3,2,0,1} multiply(%select_n.167, %select_n.167), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.536 = bf16[] constant(0.05005)
  %mul.1484 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%constant.536), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1785 = bf16[1536,2,128,192]{3,2,0,1} multiply(%integer_pow.64, %mul.1484), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_b____kernel__.1 = bf16[1536,2,128,192]{3,2,1,0} parameter(225), sharding={devices=[4,1,1,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>"}, metadata={op_name="state.opt_state[0].nu[\'decoder\'][\'moe_layers\'][\'self_attention\'][\'wq_b\'][\'kernel\']"}
  %constant.535 = bf16[] constant(0.9492)
  %mul.1483 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%constant.535), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1786 = bf16[1536,2,128,192]{3,2,1,0} multiply(%state_opt_state_0__nu__decoder____moe_layers____self_attention____wq_b____kernel__.1, %mul.1483), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.941 = bf16[1536,2,128,192]{3,2,0,1} add(%mul.1785, %mul.1786), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1537 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1633 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%convert_element_type.1537), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1634 = bf16[1536,2,128,192]{3,2,0,1} divide(%add.941, %div.1633), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.69 = bf16[1536,2,128,192]{3,2,0,1} sqrt(%div.1634), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.507 = bf16[] constant(1.001e-08)
  %add.812 = bf16[1536,2,128,192]{3,2,1,0} broadcast(%constant.507), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.975 = bf16[1536,2,128,192]{3,2,0,1} add(%sqrt.69, %add.812), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1668 = bf16[1536,2,128,192]{3,2,0,1} divide(%div.1568, %add.975), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1820 = bf16[1536,2,128,192]{3,2,1,0} multiply(%state_params__params____decoder____moe_layers____self_attention____wq_b____kernel__.1, %broadcast.206), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1008 = bf16[1536,2,128,192]{3,2,0,1} add(%div.1668, %mul.1820), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1891 = bf16[1536,2,128,192]{3,2,1,0} multiply(%mul.1890, %add.1008), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1045 = bf16[1536,2,128,192]{3,2,1,0} add(%state_params__params____decoder____moe_layers____self_attention____wq_b____kernel__.1, %mul.1891), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.614 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%add.1045), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.842 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%custom-call.614), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.455 = bf16[1536,2,128,192]{3,2,1,0} reshape(%custom-call.842), sharding={devices=[4,1,1,1]<=[4]}
  %convert_element_type.1573 = bf16[] convert(%mul.1827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %mul.1892 = bf16[129280,7168]{1,0} broadcast(%convert_element_type.1573), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %select_n.168 = pred[129280,7168]{1,0} broadcast(%lt.22), dimensions={}, metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %div.1503 = bf16[129280,7168]{1,0} broadcast(%sqrt.37), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %div.1504 = bf16[129280,7168]{1,0} divide(%scatter-add.5, %div.1503), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=41 source_end_column=67}
  %select_n.169 = bf16[129280,7168]{1,0} select(%select_n.168, %scatter-add.5, %div.1504), metadata={op_name="jit(train_step)/select_n" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_clipping.py" source_line=102 source_end_line=102 source_column=13 source_end_column=80}
  %constant.588 = bf16[] constant(0.1001)
  %broadcast.205 = bf16[129280,7168]{1,0} broadcast(%constant.588), dimensions={}
  %mul.1721 = bf16[129280,7168]{1,0} multiply(%select_n.169, %broadcast.205), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %state_opt_state_0__mu__token_embedder____embedding__.1 = bf16[129280,7168]{1,0} parameter(193), sharding={devices=[1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].mu[\'token_embedder\'][\'embedding\']"}
  %constant.587 = bf16[] constant(0.8984)
  %mul.1523 = bf16[129280,7168]{1,0} broadcast(%constant.587), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %mul.1722 = bf16[129280,7168]{1,0} multiply(%state_opt_state_0__mu__token_embedder____embedding__.1, %mul.1523), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=37 source_end_column=46}
  %add.909 = bf16[129280,7168]{1,0} add(%mul.1721, %mul.1722), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=357 source_end_line=357 source_column=10 source_end_column=34}
  %convert_element_type.1505 = bf16[] convert(%sub.86), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1569 = bf16[129280,7168]{1,0} broadcast(%convert_element_type.1505), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %div.1570 = bf16[129280,7168]{1,0} divide(%add.909, %div.1569), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=294 source_end_line=294 source_column=15 source_end_column=60}
  %integer_pow.65 = bf16[129280,7168]{1,0} multiply(%select_n.169, %select_n.169), metadata={op_name="jit(train_step)/integer_pow" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=382 source_end_line=382 source_column=13 source_end_column=23}
  %constant.534 = bf16[] constant(0.05005)
  %mul.1482 = bf16[129280,7168]{1,0} broadcast(%constant.534), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %mul.1787 = bf16[129280,7168]{1,0} multiply(%integer_pow.65, %mul.1482), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %state_opt_state_0__nu__token_embedder____embedding__.1 = bf16[129280,7168]{1,0} parameter(226), sharding={devices=[1,4]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>"}, metadata={op_name="state.opt_state[0].nu[\'token_embedder\'][\'embedding\']"}
  %constant.533 = bf16[] constant(0.9492)
  %mul.1481 = bf16[129280,7168]{1,0} broadcast(%constant.533), dimensions={}, metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %mul.1788 = bf16[129280,7168]{1,0} multiply(%state_opt_state_0__nu__token_embedder____embedding__.1, %mul.1481), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=42 source_end_column=51}
  %add.942 = bf16[129280,7168]{1,0} add(%mul.1787, %mul.1788), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/tree_utils/_tree_math.py" source_line=392 source_end_line=392 source_column=10 source_end_column=39}
  %convert_element_type.1538 = bf16[] convert(%sub.87), metadata={op_name="jit(train_step)/convert_element_type" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1635 = bf16[129280,7168]{1,0} broadcast(%convert_element_type.1538), dimensions={}, metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %div.1636 = bf16[129280,7168]{1,0} divide(%add.942, %div.1635), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=298 source_end_line=298 source_column=13 source_end_column=58}
  %sqrt.70 = bf16[129280,7168]{1,0} sqrt(%div.1636), metadata={op_name="jit(train_step)/sqrt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %constant.506 = bf16[] constant(1.001e-08)
  %add.811 = bf16[129280,7168]{1,0} broadcast(%constant.506), dimensions={}, metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %add.976 = bf16[129280,7168]{1,0} add(%sqrt.70, %add.811), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=49 source_end_column=77}
  %div.1669 = bf16[129280,7168]{1,0} divide(%div.1570, %add.976), metadata={op_name="jit(train_step)/div" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=300 source_end_line=300 source_column=44 source_end_column=78}
  %mul.1821 = bf16[129280,7168]{1,0} multiply(%state_params__params____token_embedder____embedding__.1, %broadcast.205), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=48 source_end_column=53}
  %add.1009 = bf16[129280,7168]{1,0} add(%div.1669, %mul.1821), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/transforms/_adding.py" source_line=65 source_end_line=65 source_column=44 source_end_column=53}
  %mul.1893 = bf16[129280,7168]{1,0} multiply(%mul.1892, %add.1009), metadata={op_name="jit(train_step)/mul" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/transform.py" source_line=989 source_end_line=989 source_column=18 source_end_column=53}
  %add.1046 = bf16[129280,7168]{1,0} add(%state_params__params____token_embedder____embedding__.1, %mul.1893), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/update.py" source_line=43 source_end_line=43 source_column=45 source_end_column=50}
  %custom-call.615 = bf16[129280,7168]{1,0} custom-call(%add.1046), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.843 = bf16[129280,7168]{1,0} custom-call(%custom-call.615), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.456 = bf16[129280,7168]{1,0} reshape(%custom-call.843), sharding={devices=[1,4]<=[4]}
  %custom-call.616 = s32[] custom-call(%jit__where_.423), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.844 = s32[] custom-call(%custom-call.616), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, []>]>"}
  %reshape.457 = s32[] reshape(%custom-call.844), sharding={replicated}
  %custom-call.617 = bf16[7168]{0} custom-call(%add.877), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.845 = bf16[7168]{0} custom-call(%custom-call.617), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}]>]>"}
  %reshape.458 = bf16[7168]{0} reshape(%custom-call.845), sharding={replicated}
  %custom-call.618 = bf16[7168,1,18432]{2,1,0} custom-call(%add.878), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.846 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.618), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.459 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.846), sharding={devices=[4,1,1]<=[4]}
  %custom-call.619 = bf16[7168,1,18432]{2,1,0} custom-call(%add.879), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.847 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.619), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.460 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.847), sharding={devices=[4,1,1]<=[4]}
  %custom-call.620 = bf16[18432,1,7168]{2,1,0} custom-call(%add.880), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.848 = bf16[18432,1,7168]{2,1,0} custom-call(%custom-call.620), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.461 = bf16[18432,1,7168]{2,1,0} reshape(%custom-call.848), sharding={devices=[1,1,4]<=[4]}
  %custom-call.621 = bf16[7168,1]{1,0} custom-call(%add.881), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.849 = bf16[7168,1]{1,0} custom-call(%custom-call.621), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.462 = bf16[7168,1]{1,0} reshape(%custom-call.849), sharding={replicated}
  %custom-call.622 = bf16[7168,1]{1,0} custom-call(%add.882), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.850 = bf16[7168,1]{1,0} custom-call(%custom-call.622), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.463 = bf16[7168,1]{1,0} reshape(%custom-call.850), sharding={replicated}
  %custom-call.623 = bf16[512,1]{1,0} custom-call(%add.883), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.851 = bf16[512,1]{1,0} custom-call(%custom-call.623), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.464 = bf16[512,1]{1,0} reshape(%custom-call.851), sharding={replicated}
  %custom-call.624 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%add.884), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.852 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%custom-call.624), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.465 = bf16[128,1,128,7168]{3,2,1,0} reshape(%custom-call.852), sharding={devices=[1,1,1,4]<=[4]}
  %custom-call.625 = bf16[1536,1]{1,0} custom-call(%add.885), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.853 = bf16[1536,1]{1,0} custom-call(%custom-call.625), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.466 = bf16[1536,1]{1,0} reshape(%custom-call.853), sharding={replicated}
  %custom-call.626 = bf16[7168,1,576]{2,1,0} custom-call(%add.886), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.854 = bf16[7168,1,576]{2,1,0} custom-call(%custom-call.626), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.467 = bf16[7168,1,576]{2,1,0} reshape(%custom-call.854), sharding={devices=[4,1,1]<=[4]}
  %custom-call.627 = bf16[512,1,128,256]{3,2,1,0} custom-call(%add.887), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.855 = bf16[512,1,128,256]{3,2,1,0} custom-call(%custom-call.627), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.468 = bf16[512,1,128,256]{3,2,1,0} reshape(%custom-call.855), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.628 = bf16[7168,1,1536]{2,1,0} custom-call(%add.888), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.856 = bf16[7168,1,1536]{2,1,0} custom-call(%custom-call.628), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.469 = bf16[7168,1,1536]{2,1,0} reshape(%custom-call.856), sharding={devices=[4,1,1]<=[4]}
  %custom-call.629 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%add.889), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.857 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%custom-call.629), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.470 = bf16[1536,1,128,192]{3,2,1,0} reshape(%custom-call.857), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.630 = bf16[7168,129280]{1,0} custom-call(%add.890), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.858 = bf16[7168,129280]{1,0} custom-call(%custom-call.630), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.471 = bf16[7168,129280]{1,0} reshape(%custom-call.858), sharding={devices=[4,1]<=[4]}
  %custom-call.631 = bf16[64,2]{1,0} custom-call(%add.891), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.859 = bf16[64,2]{1,0} custom-call(%custom-call.631), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.472 = bf16[64,2]{1,0} reshape(%custom-call.859), sharding={replicated}
  %custom-call.632 = bf16[7168,2,64]{2,1,0} custom-call(%add.892), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.860 = bf16[7168,2,64]{2,1,0} custom-call(%custom-call.632), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.473 = bf16[7168,2,64]{2,1,0} reshape(%custom-call.860), sharding={devices=[4,1,1]<=[4]}
  %custom-call.633 = bf16[64,2]{1,0} custom-call(%add.893), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.861 = bf16[64,2]{1,0} custom-call(%custom-call.633), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.474 = bf16[64,2]{1,0} reshape(%custom-call.861), sharding={replicated}
  %custom-call.634 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.894), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.862 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.634), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.475 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.862), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.635 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.895), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.863 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.635), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.476 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.863), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.636 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%add.896), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.864 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%custom-call.636), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>]>"}
  %reshape.477 = bf16[64,2,2048,7168]{3,2,1,0} reshape(%custom-call.864), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.637 = bf16[7168,2,2048]{2,1,0} custom-call(%add.897), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.865 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.637), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.478 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.865), sharding={devices=[4,1,1]<=[4]}
  %custom-call.638 = bf16[7168,2,2048]{2,1,0} custom-call(%add.898), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.866 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.638), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.479 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.866), sharding={devices=[4,1,1]<=[4]}
  %custom-call.639 = bf16[2048,2,7168]{2,1,0} custom-call(%add.899), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.867 = bf16[2048,2,7168]{2,1,0} custom-call(%custom-call.639), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.480 = bf16[2048,2,7168]{2,1,0} reshape(%custom-call.867), sharding={devices=[1,1,4]<=[4]}
  %custom-call.640 = bf16[7168,2]{1,0} custom-call(%add.900), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.868 = bf16[7168,2]{1,0} custom-call(%custom-call.640), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.481 = bf16[7168,2]{1,0} reshape(%custom-call.868), sharding={replicated}
  %custom-call.641 = bf16[7168,2]{1,0} custom-call(%add.901), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.869 = bf16[7168,2]{1,0} custom-call(%custom-call.641), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.482 = bf16[7168,2]{1,0} reshape(%custom-call.869), sharding={replicated}
  %custom-call.642 = bf16[512,2]{1,0} custom-call(%add.902), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.870 = bf16[512,2]{1,0} custom-call(%custom-call.642), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.483 = bf16[512,2]{1,0} reshape(%custom-call.870), sharding={replicated}
  %custom-call.643 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%add.903), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.871 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%custom-call.643), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.484 = bf16[128,2,128,7168]{3,2,1,0} reshape(%custom-call.871), sharding={devices=[1,1,1,4]<=[4]}
  %custom-call.644 = bf16[1536,2]{1,0} custom-call(%add.904), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.872 = bf16[1536,2]{1,0} custom-call(%custom-call.644), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.485 = bf16[1536,2]{1,0} reshape(%custom-call.872), sharding={replicated}
  %custom-call.645 = bf16[7168,2,576]{2,1,0} custom-call(%add.905), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.873 = bf16[7168,2,576]{2,1,0} custom-call(%custom-call.645), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.486 = bf16[7168,2,576]{2,1,0} reshape(%custom-call.873), sharding={devices=[4,1,1]<=[4]}
  %custom-call.646 = bf16[512,2,128,256]{3,2,1,0} custom-call(%add.906), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.874 = bf16[512,2,128,256]{3,2,1,0} custom-call(%custom-call.646), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.487 = bf16[512,2,128,256]{3,2,1,0} reshape(%custom-call.874), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.647 = bf16[7168,2,1536]{2,1,0} custom-call(%add.907), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.875 = bf16[7168,2,1536]{2,1,0} custom-call(%custom-call.647), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.488 = bf16[7168,2,1536]{2,1,0} reshape(%custom-call.875), sharding={devices=[4,1,1]<=[4]}
  %custom-call.648 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%add.908), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.876 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%custom-call.648), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.489 = bf16[1536,2,128,192]{3,2,1,0} reshape(%custom-call.876), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.649 = bf16[129280,7168]{1,0} custom-call(%add.909), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.877 = bf16[129280,7168]{1,0} custom-call(%custom-call.649), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.490 = bf16[129280,7168]{1,0} reshape(%custom-call.877), sharding={devices=[1,4]<=[4]}
  %custom-call.650 = bf16[7168]{0} custom-call(%add.910), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.878 = bf16[7168]{0} custom-call(%custom-call.650), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}]>]>"}
  %reshape.491 = bf16[7168]{0} reshape(%custom-call.878), sharding={replicated}
  %custom-call.651 = bf16[7168,1,18432]{2,1,0} custom-call(%add.911), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.879 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.651), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.492 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.879), sharding={devices=[4,1,1]<=[4]}
  %custom-call.652 = bf16[7168,1,18432]{2,1,0} custom-call(%add.912), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.880 = bf16[7168,1,18432]{2,1,0} custom-call(%custom-call.652), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.493 = bf16[7168,1,18432]{2,1,0} reshape(%custom-call.880), sharding={devices=[4,1,1]<=[4]}
  %custom-call.653 = bf16[18432,1,7168]{2,1,0} custom-call(%add.913), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.881 = bf16[18432,1,7168]{2,1,0} custom-call(%custom-call.653), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.494 = bf16[18432,1,7168]{2,1,0} reshape(%custom-call.881), sharding={devices=[1,1,4]<=[4]}
  %custom-call.654 = bf16[7168,1]{1,0} custom-call(%add.914), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.882 = bf16[7168,1]{1,0} custom-call(%custom-call.654), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.495 = bf16[7168,1]{1,0} reshape(%custom-call.882), sharding={replicated}
  %custom-call.655 = bf16[7168,1]{1,0} custom-call(%add.915), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.883 = bf16[7168,1]{1,0} custom-call(%custom-call.655), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.496 = bf16[7168,1]{1,0} reshape(%custom-call.883), sharding={replicated}
  %custom-call.656 = bf16[512,1]{1,0} custom-call(%add.916), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.884 = bf16[512,1]{1,0} custom-call(%custom-call.656), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.497 = bf16[512,1]{1,0} reshape(%custom-call.884), sharding={replicated}
  %custom-call.657 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%add.917), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.885 = bf16[128,1,128,7168]{3,2,1,0} custom-call(%custom-call.657), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.498 = bf16[128,1,128,7168]{3,2,1,0} reshape(%custom-call.885), sharding={devices=[1,1,1,4]<=[4]}
  %custom-call.658 = bf16[1536,1]{1,0} custom-call(%add.918), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.886 = bf16[1536,1]{1,0} custom-call(%custom-call.658), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.499 = bf16[1536,1]{1,0} reshape(%custom-call.886), sharding={replicated}
  %custom-call.659 = bf16[7168,1,576]{2,1,0} custom-call(%add.919), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.887 = bf16[7168,1,576]{2,1,0} custom-call(%custom-call.659), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.500 = bf16[7168,1,576]{2,1,0} reshape(%custom-call.887), sharding={devices=[4,1,1]<=[4]}
  %custom-call.660 = bf16[512,1,128,256]{3,2,1,0} custom-call(%add.920), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.888 = bf16[512,1,128,256]{3,2,1,0} custom-call(%custom-call.660), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.501 = bf16[512,1,128,256]{3,2,1,0} reshape(%custom-call.888), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.661 = bf16[7168,1,1536]{2,1,0} custom-call(%add.921), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.889 = bf16[7168,1,1536]{2,1,0} custom-call(%custom-call.661), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.502 = bf16[7168,1,1536]{2,1,0} reshape(%custom-call.889), sharding={devices=[4,1,1]<=[4]}
  %custom-call.662 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%add.922), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.890 = bf16[1536,1,128,192]{3,2,1,0} custom-call(%custom-call.662), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.503 = bf16[1536,1,128,192]{3,2,1,0} reshape(%custom-call.890), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.663 = bf16[7168,129280]{1,0} custom-call(%add.923), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.891 = bf16[7168,129280]{1,0} custom-call(%custom-call.663), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.504 = bf16[7168,129280]{1,0} reshape(%custom-call.891), sharding={devices=[4,1]<=[4]}
  %custom-call.664 = bf16[64,2]{1,0} custom-call(%add.924), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.892 = bf16[64,2]{1,0} custom-call(%custom-call.664), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.505 = bf16[64,2]{1,0} reshape(%custom-call.892), sharding={replicated}
  %custom-call.665 = bf16[7168,2,64]{2,1,0} custom-call(%add.925), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.893 = bf16[7168,2,64]{2,1,0} custom-call(%custom-call.665), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.506 = bf16[7168,2,64]{2,1,0} reshape(%custom-call.893), sharding={devices=[4,1,1]<=[4]}
  %custom-call.666 = bf16[64,2]{1,0} custom-call(%add.926), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.894 = bf16[64,2]{1,0} custom-call(%custom-call.666), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{}, {}]>]>"}
  %reshape.507 = bf16[64,2]{1,0} reshape(%custom-call.894), sharding={replicated}
  %custom-call.667 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.927), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.895 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.667), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.508 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.895), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.668 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%add.928), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.896 = bf16[64,2,7168,2048]{3,2,1,0} custom-call(%custom-call.668), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.509 = bf16[64,2,7168,2048]{3,2,1,0} reshape(%custom-call.896), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.669 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%add.929), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.897 = bf16[64,2,2048,7168]{3,2,1,0} custom-call(%custom-call.669), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\"}]>]>"}
  %reshape.510 = bf16[64,2,2048,7168]{3,2,1,0} reshape(%custom-call.897), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.670 = bf16[7168,2,2048]{2,1,0} custom-call(%add.930), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.898 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.670), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.511 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.898), sharding={devices=[4,1,1]<=[4]}
  %custom-call.671 = bf16[7168,2,2048]{2,1,0} custom-call(%add.931), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.899 = bf16[7168,2,2048]{2,1,0} custom-call(%custom-call.671), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}]>]>"}
  %reshape.512 = bf16[7168,2,2048]{2,1,0} reshape(%custom-call.899), sharding={devices=[4,1,1]<=[4]}
  %custom-call.672 = bf16[2048,2,7168]{2,1,0} custom-call(%add.932), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.900 = bf16[2048,2,7168]{2,1,0} custom-call(%custom-call.672), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp_transpose\", \"tensor\", \"tensor_sequence\", \"autoregressive\"}, {}, {\"fsdp\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}]>]>"}
  %reshape.513 = bf16[2048,2,7168]{2,1,0} reshape(%custom-call.900), sharding={devices=[1,1,4]<=[4]}
  %custom-call.673 = bf16[7168,2]{1,0} custom-call(%add.933), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.901 = bf16[7168,2]{1,0} custom-call(%custom-call.673), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.514 = bf16[7168,2]{1,0} reshape(%custom-call.901), sharding={replicated}
  %custom-call.674 = bf16[7168,2]{1,0} custom-call(%add.934), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.902 = bf16[7168,2]{1,0} custom-call(%custom-call.674), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.515 = bf16[7168,2]{1,0} reshape(%custom-call.902), sharding={replicated}
  %custom-call.675 = bf16[512,2]{1,0} custom-call(%add.935), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.903 = bf16[512,2]{1,0} custom-call(%custom-call.675), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.516 = bf16[512,2]{1,0} reshape(%custom-call.903), sharding={replicated}
  %custom-call.676 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%add.936), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.904 = bf16[128,2,128,7168]{3,2,1,0} custom-call(%custom-call.676), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}, {}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.517 = bf16[128,2,128,7168]{3,2,1,0} reshape(%custom-call.904), sharding={devices=[1,1,1,4]<=[4]}
  %custom-call.677 = bf16[1536,2]{1,0} custom-call(%add.937), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.905 = bf16[1536,2]{1,0} custom-call(%custom-call.677), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\"}, {}]>]>"}
  %reshape.518 = bf16[1536,2]{1,0} reshape(%custom-call.905), sharding={replicated}
  %custom-call.678 = bf16[7168,2,576]{2,1,0} custom-call(%add.938), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.906 = bf16[7168,2,576]{2,1,0} custom-call(%custom-call.678), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.519 = bf16[7168,2,576]{2,1,0} reshape(%custom-call.906), sharding={devices=[4,1,1]<=[4]}
  %custom-call.679 = bf16[512,2,128,256]{3,2,1,0} custom-call(%add.939), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.907 = bf16[512,2,128,256]{3,2,1,0} custom-call(%custom-call.679), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.520 = bf16[512,2,128,256]{3,2,1,0} reshape(%custom-call.907), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.680 = bf16[7168,2,1536]{2,1,0} custom-call(%add.940), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.908 = bf16[7168,2,1536]{2,1,0} custom-call(%custom-call.680), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"tensor_transpose\", \"context\", \"expert\"}, {}, {}]>]>"}
  %reshape.521 = bf16[7168,2,1536]{2,1,0} reshape(%custom-call.908), sharding={devices=[4,1,1]<=[4]}
  %custom-call.681 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%add.941), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.909 = bf16[1536,2,128,192]{3,2,1,0} custom-call(%custom-call.681), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}, {}, {\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {}]>]>"}
  %reshape.522 = bf16[1536,2,128,192]{3,2,1,0} reshape(%custom-call.909), sharding={devices=[4,1,1,1]<=[4]}
  %custom-call.682 = bf16[129280,7168]{1,0} custom-call(%add.942), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.910 = bf16[129280,7168]{1,0} custom-call(%custom-call.682), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"tensor\", \"tensor_transpose\", \"tensor_sequence\", \"autoregressive\"}, {\"fsdp\", \"fsdp_transpose\", \"sequence\", \"context\", \"expert\"}]>]>"}
  %reshape.523 = bf16[129280,7168]{1,0} reshape(%custom-call.910), sharding={devices=[1,4]<=[4]}
  %lt.25 = pred[] compare(%state_opt_state_2__count.1, %constant.708), direction=LT, metadata={op_name="jit(train_step)/lt" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=19 source_end_column=36}
  %add.1013 = s32[] add(%state_opt_state_2__count.1, %constant.714), metadata={op_name="jit(train_step)/add" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=38 source_end_column=49}
  %jit__where_.425 = s32[] call(%lt.25, %add.1013, %constant.708), to_apply=%_where_1097.427, metadata={op_name="jit(train_step)/jit(_where)" source_file="/usr/local/lib/python3.12/dist-packages/optax/_src/numerics.py" source_line=142 source_end_line=142 source_column=9 source_end_column=61}
  %custom-call.683 = s32[] custom-call(%jit__where_.425), custom_call_target="annotate_device_placement", custom_call_has_side_effect=true, frontend_attributes={_xla_buffer_placement="device"}
  %custom-call.911 = s32[] custom-call(%custom-call.683), custom_call_target="xla.sdy.FuncResultSharding", custom_call_has_side_effect=true, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, []>]>"}
  %reshape.524 = s32[] reshape(%custom-call.911), sharding={replicated}
  %square.512 = f32[1,1024]{1,0} multiply(%while.324, %while.324), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4107 = f32[] reduce(%square.512, %constant.712), dimensions={0,1}, to_apply=%region_339.430, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %square.513 = f32[1,1]{1,0} multiply(%while.325, %while.325), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4108 = f32[] reduce(%square.513, %constant.712), dimensions={0,1}, to_apply=%region_340.431, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1048 = f32[] add(%reduce_sum.4107, %reduce_sum.4108), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.514 = f32[1,1024]{1,0} multiply(%while.326, %while.326), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4109 = f32[] reduce(%square.514, %constant.712), dimensions={0,1}, to_apply=%region_341.432, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1049 = f32[] add(%add.1048, %reduce_sum.4109), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.515 = f32[1,1]{1,0} multiply(%while.327, %while.327), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4110 = f32[] reduce(%square.515, %constant.712), dimensions={0,1}, to_apply=%region_342.433, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1050 = f32[] add(%add.1049, %reduce_sum.4110), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.516 = f32[1,1024]{1,0} multiply(%while.328, %while.328), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4111 = f32[] reduce(%square.516, %constant.712), dimensions={0,1}, to_apply=%region_343.434, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1051 = f32[] add(%add.1050, %reduce_sum.4111), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.517 = f32[1,1]{1,0} multiply(%while.329, %while.329), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4112 = f32[] reduce(%square.517, %constant.712), dimensions={0,1}, to_apply=%region_344.435, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1052 = f32[] add(%add.1051, %reduce_sum.4112), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.518 = f32[1,1024]{1,0} multiply(%while.330, %while.330), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4113 = f32[] reduce(%square.518, %constant.712), dimensions={0,1}, to_apply=%region_345.436, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1053 = f32[] add(%add.1052, %reduce_sum.4113), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.519 = f32[1,1]{1,0} multiply(%while.331, %while.331), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4114 = f32[] reduce(%square.519, %constant.712), dimensions={0,1}, to_apply=%region_346.437, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1054 = f32[] add(%add.1053, %reduce_sum.4114), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.520 = f32[1,1024]{1,0} multiply(%while.332, %while.332), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4115 = f32[] reduce(%square.520, %constant.712), dimensions={0,1}, to_apply=%region_347.438, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1055 = f32[] add(%add.1054, %reduce_sum.4115), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.521 = f32[1,1]{1,0} multiply(%while.333, %while.333), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4116 = f32[] reduce(%square.521, %constant.712), dimensions={0,1}, to_apply=%region_348.439, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1056 = f32[] add(%add.1055, %reduce_sum.4116), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.522 = f32[1,1024]{1,0} multiply(%while.334, %while.334), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4117 = f32[] reduce(%square.522, %constant.712), dimensions={0,1}, to_apply=%region_349.440, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1057 = f32[] add(%add.1056, %reduce_sum.4117), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.523 = f32[1,1]{1,0} multiply(%while.335, %while.335), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4118 = f32[] reduce(%square.523, %constant.712), dimensions={0,1}, to_apply=%region_350.441, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1058 = f32[] add(%add.1057, %reduce_sum.4118), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.524 = f32[1,1024]{1,0} multiply(%while.336, %while.336), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4119 = f32[] reduce(%square.524, %constant.712), dimensions={0,1}, to_apply=%region_351.442, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1059 = f32[] add(%add.1058, %reduce_sum.4119), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.525 = f32[1,1]{1,0} multiply(%while.337, %while.337), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4120 = f32[] reduce(%square.525, %constant.712), dimensions={0,1}, to_apply=%region_352.443, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1060 = f32[] add(%add.1059, %reduce_sum.4120), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.526 = f32[1,1024]{1,0} multiply(%while.338, %while.338), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4121 = f32[] reduce(%square.526, %constant.712), dimensions={0,1}, to_apply=%region_353.444, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1061 = f32[] add(%add.1060, %reduce_sum.4121), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.527 = f32[1,1]{1,0} multiply(%while.339, %while.339), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4122 = f32[] reduce(%square.527, %constant.712), dimensions={0,1}, to_apply=%region_354.445, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1062 = f32[] add(%add.1061, %reduce_sum.4122), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.528 = f32[1,1024]{1,0} multiply(%while.340, %while.340), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4123 = f32[] reduce(%square.528, %constant.712), dimensions={0,1}, to_apply=%region_355.446, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1063 = f32[] add(%add.1062, %reduce_sum.4123), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.529 = f32[1,1]{1,0} multiply(%while.341, %while.341), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4124 = f32[] reduce(%square.529, %constant.712), dimensions={0,1}, to_apply=%region_356.447, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1064 = f32[] add(%add.1063, %reduce_sum.4124), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.530 = f32[1,1024]{1,0} multiply(%while.342, %while.342), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4125 = f32[] reduce(%square.530, %constant.712), dimensions={0,1}, to_apply=%region_357.448, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1065 = f32[] add(%add.1064, %reduce_sum.4125), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.531 = f32[1,1]{1,0} multiply(%while.343, %while.343), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4126 = f32[] reduce(%square.531, %constant.712), dimensions={0,1}, to_apply=%region_358.449, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1066 = f32[] add(%add.1065, %reduce_sum.4126), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.532 = f32[1,1024]{1,0} multiply(%while.344, %while.344), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4127 = f32[] reduce(%square.532, %constant.712), dimensions={0,1}, to_apply=%region_359.450, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1067 = f32[] add(%add.1066, %reduce_sum.4127), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.533 = f32[1,1024]{1,0} multiply(%while.345, %while.345), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4128 = f32[] reduce(%square.533, %constant.712), dimensions={0,1}, to_apply=%region_360.451, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1068 = f32[] add(%add.1067, %reduce_sum.4128), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.534 = f32[1,1]{1,0} multiply(%while.346, %while.346), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4129 = f32[] reduce(%square.534, %constant.712), dimensions={0,1}, to_apply=%region_361.452, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1069 = f32[] add(%add.1068, %reduce_sum.4129), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.535 = f32[1,1]{1,0} multiply(%while.347, %while.347), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4130 = f32[] reduce(%square.535, %constant.712), dimensions={0,1}, to_apply=%region_362.453, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1070 = f32[] add(%add.1069, %reduce_sum.4130), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.536 = f32[1,1024]{1,0} multiply(%while.348, %while.348), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4131 = f32[] reduce(%square.536, %constant.712), dimensions={0,1}, to_apply=%region_363.454, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1071 = f32[] add(%add.1070, %reduce_sum.4131), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.537 = f32[1,1024]{1,0} multiply(%while.349, %while.349), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4132 = f32[] reduce(%square.537, %constant.712), dimensions={0,1}, to_apply=%region_364.455, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1072 = f32[] add(%add.1071, %reduce_sum.4132), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.538 = f32[1,1]{1,0} multiply(%while.350, %while.350), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4133 = f32[] reduce(%square.538, %constant.712), dimensions={0,1}, to_apply=%region_365.456, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1073 = f32[] add(%add.1072, %reduce_sum.4133), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.539 = f32[1,1]{1,0} multiply(%while.351, %while.351), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4134 = f32[] reduce(%square.539, %constant.712), dimensions={0,1}, to_apply=%region_366.457, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1074 = f32[] add(%add.1073, %reduce_sum.4134), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.540 = f32[1,1024]{1,0} multiply(%while.352, %while.352), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4135 = f32[] reduce(%square.540, %constant.712), dimensions={0,1}, to_apply=%region_367.458, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1075 = f32[] add(%add.1074, %reduce_sum.4135), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.541 = f32[1,1]{1,0} multiply(%while.353, %while.353), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4136 = f32[] reduce(%square.541, %constant.712), dimensions={0,1}, to_apply=%region_368.459, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1076 = f32[] add(%add.1075, %reduce_sum.4136), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.542 = f32[1,1024]{1,0} multiply(%while.354, %while.354), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4137 = f32[] reduce(%square.542, %constant.712), dimensions={0,1}, to_apply=%region_369.460, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1077 = f32[] add(%add.1076, %reduce_sum.4137), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.543 = f32[1,1]{1,0} multiply(%while.355, %while.355), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4138 = f32[] reduce(%square.543, %constant.712), dimensions={0,1}, to_apply=%region_370.461, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1078 = f32[] add(%add.1077, %reduce_sum.4138), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.544 = f32[1,1024]{1,0} multiply(%while.356, %while.356), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4139 = f32[] reduce(%square.544, %constant.712), dimensions={0,1}, to_apply=%region_371.462, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1079 = f32[] add(%add.1078, %reduce_sum.4139), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.545 = f32[1,1]{1,0} multiply(%while.357, %while.357), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4140 = f32[] reduce(%square.545, %constant.712), dimensions={0,1}, to_apply=%region_372.463, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1080 = f32[] add(%add.1079, %reduce_sum.4140), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.546 = f32[1,1024]{1,0} multiply(%while.358, %while.358), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4141 = f32[] reduce(%square.546, %constant.712), dimensions={0,1}, to_apply=%region_373.464, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1081 = f32[] add(%add.1080, %reduce_sum.4141), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.547 = f32[1,1]{1,0} multiply(%while.359, %while.359), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4142 = f32[] reduce(%square.547, %constant.712), dimensions={0,1}, to_apply=%region_374.465, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1082 = f32[] add(%add.1081, %reduce_sum.4142), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.548 = f32[1,1024]{1,0} multiply(%while.360, %while.360), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4143 = f32[] reduce(%square.548, %constant.712), dimensions={0,1}, to_apply=%region_375.466, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1083 = f32[] add(%add.1082, %reduce_sum.4143), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.549 = f32[1,1]{1,0} multiply(%while.361, %while.361), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4144 = f32[] reduce(%square.549, %constant.712), dimensions={0,1}, to_apply=%region_376.467, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1084 = f32[] add(%add.1083, %reduce_sum.4144), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.550 = f32[1,1024]{1,0} multiply(%while.362, %while.362), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4145 = f32[] reduce(%square.550, %constant.712), dimensions={0,1}, to_apply=%region_377.468, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1085 = f32[] add(%add.1084, %reduce_sum.4145), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.551 = f32[1,1]{1,0} multiply(%while.363, %while.363), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4146 = f32[] reduce(%square.551, %constant.712), dimensions={0,1}, to_apply=%region_378.469, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1086 = f32[] add(%add.1085, %reduce_sum.4146), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.552 = f32[1,1024]{1,0} multiply(%while.364, %while.364), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4147 = f32[] reduce(%square.552, %constant.712), dimensions={0,1}, to_apply=%region_379.470, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1087 = f32[] add(%add.1086, %reduce_sum.4147), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.553 = f32[1,1]{1,0} multiply(%while.365, %while.365), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4148 = f32[] reduce(%square.553, %constant.712), dimensions={0,1}, to_apply=%region_380.471, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1088 = f32[] add(%add.1087, %reduce_sum.4148), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.554 = f32[1,1024]{1,0} multiply(%while.366, %while.366), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4149 = f32[] reduce(%square.554, %constant.712), dimensions={0,1}, to_apply=%region_381.472, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1089 = f32[] add(%add.1088, %reduce_sum.4149), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.555 = f32[1,1]{1,0} multiply(%while.367, %while.367), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4150 = f32[] reduce(%square.555, %constant.712), dimensions={0,1}, to_apply=%region_382.473, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1090 = f32[] add(%add.1089, %reduce_sum.4150), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.556 = f32[1,1024]{1,0} multiply(%while.368, %while.368), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4151 = f32[] reduce(%square.556, %constant.712), dimensions={0,1}, to_apply=%region_383.474, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1091 = f32[] add(%add.1090, %reduce_sum.4151), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.557 = f32[1,1]{1,0} multiply(%while.369, %while.369), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4152 = f32[] reduce(%square.557, %constant.712), dimensions={0,1}, to_apply=%region_384.475, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1092 = f32[] add(%add.1091, %reduce_sum.4152), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.558 = f32[2,1024]{1,0} multiply(%while.228, %while.228), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4153 = f32[] reduce(%square.558, %constant.712), dimensions={0,1}, to_apply=%region_385.476, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1093 = f32[] add(%add.1092, %reduce_sum.4153), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.559 = f32[2,1]{1,0} multiply(%while.229, %while.229), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4154 = f32[] reduce(%square.559, %constant.712), dimensions={0,1}, to_apply=%region_386.477, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1094 = f32[] add(%add.1093, %reduce_sum.4154), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.560 = f32[2,1024]{1,0} multiply(%while.230, %while.230), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4155 = f32[] reduce(%square.560, %constant.712), dimensions={0,1}, to_apply=%region_387.478, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1095 = f32[] add(%add.1094, %reduce_sum.4155), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.561 = f32[2,1]{1,0} multiply(%while.231, %while.231), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4156 = f32[] reduce(%square.561, %constant.712), dimensions={0,1}, to_apply=%region_388.479, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1096 = f32[] add(%add.1095, %reduce_sum.4156), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.562 = f32[2,1024]{1,0} multiply(%while.232, %while.232), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4157 = f32[] reduce(%square.562, %constant.712), dimensions={0,1}, to_apply=%region_389.480, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1097 = f32[] add(%add.1096, %reduce_sum.4157), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.563 = f32[2,1]{1,0} multiply(%while.233, %while.233), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4158 = f32[] reduce(%square.563, %constant.712), dimensions={0,1}, to_apply=%region_390.481, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1098 = f32[] add(%add.1097, %reduce_sum.4158), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.564 = f32[2,1024]{1,0} multiply(%while.234, %while.234), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4159 = f32[] reduce(%square.564, %constant.712), dimensions={0,1}, to_apply=%region_391.482, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1099 = f32[] add(%add.1098, %reduce_sum.4159), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.565 = f32[2,1]{1,0} multiply(%while.235, %while.235), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4160 = f32[] reduce(%square.565, %constant.712), dimensions={0,1}, to_apply=%region_392.483, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1100 = f32[] add(%add.1099, %reduce_sum.4160), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.566 = f32[2,1024]{1,0} multiply(%while.236, %while.236), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4161 = f32[] reduce(%square.566, %constant.712), dimensions={0,1}, to_apply=%region_393.484, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1101 = f32[] add(%add.1100, %reduce_sum.4161), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.567 = f32[2,1]{1,0} multiply(%while.237, %while.237), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4162 = f32[] reduce(%square.567, %constant.712), dimensions={0,1}, to_apply=%region_394.485, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1102 = f32[] add(%add.1101, %reduce_sum.4162), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.568 = f32[2,1024]{1,0} multiply(%while.238, %while.238), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4163 = f32[] reduce(%square.568, %constant.712), dimensions={0,1}, to_apply=%region_395.486, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1103 = f32[] add(%add.1102, %reduce_sum.4163), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.569 = f32[2,1]{1,0} multiply(%while.239, %while.239), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4164 = f32[] reduce(%square.569, %constant.712), dimensions={0,1}, to_apply=%region_396.487, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1104 = f32[] add(%add.1103, %reduce_sum.4164), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.570 = f32[2,1024]{1,0} multiply(%while.240, %while.240), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4165 = f32[] reduce(%square.570, %constant.712), dimensions={0,1}, to_apply=%region_397.488, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1105 = f32[] add(%add.1104, %reduce_sum.4165), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.571 = f32[2,1]{1,0} multiply(%while.241, %while.241), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4166 = f32[] reduce(%square.571, %constant.712), dimensions={0,1}, to_apply=%region_398.489, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1106 = f32[] add(%add.1105, %reduce_sum.4166), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.572 = f32[2,1024]{1,0} multiply(%while.242, %while.242), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4167 = f32[] reduce(%square.572, %constant.712), dimensions={0,1}, to_apply=%region_399.490, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1107 = f32[] add(%add.1106, %reduce_sum.4167), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.573 = f32[2,1024]{1,0} multiply(%while.243, %while.243), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4168 = f32[] reduce(%square.573, %constant.712), dimensions={0,1}, to_apply=%region_400.491, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1108 = f32[] add(%add.1107, %reduce_sum.4168), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.574 = f32[2,1]{1,0} multiply(%while.244, %while.244), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4169 = f32[] reduce(%square.574, %constant.712), dimensions={0,1}, to_apply=%region_401.492, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1109 = f32[] add(%add.1108, %reduce_sum.4169), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.575 = f32[2,1]{1,0} multiply(%while.245, %while.245), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4170 = f32[] reduce(%square.575, %constant.712), dimensions={0,1}, to_apply=%region_402.493, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1110 = f32[] add(%add.1109, %reduce_sum.4170), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.576 = f32[2,1024]{1,0} multiply(%while.246, %while.246), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4171 = f32[] reduce(%square.576, %constant.712), dimensions={0,1}, to_apply=%region_403.494, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1111 = f32[] add(%add.1110, %reduce_sum.4171), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.577 = f32[2,1024]{1,0} multiply(%while.247, %while.247), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4172 = f32[] reduce(%square.577, %constant.712), dimensions={0,1}, to_apply=%region_404.495, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1112 = f32[] add(%add.1111, %reduce_sum.4172), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.578 = f32[2,1]{1,0} multiply(%while.248, %while.248), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4173 = f32[] reduce(%square.578, %constant.712), dimensions={0,1}, to_apply=%region_405.496, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1113 = f32[] add(%add.1112, %reduce_sum.4173), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.579 = f32[2,1]{1,0} multiply(%while.249, %while.249), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4174 = f32[] reduce(%square.579, %constant.712), dimensions={0,1}, to_apply=%region_406.497, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1114 = f32[] add(%add.1113, %reduce_sum.4174), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.580 = f32[2,1024]{1,0} multiply(%while.250, %while.250), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4175 = f32[] reduce(%square.580, %constant.712), dimensions={0,1}, to_apply=%region_407.498, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1115 = f32[] add(%add.1114, %reduce_sum.4175), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.581 = f32[2,1]{1,0} multiply(%while.251, %while.251), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4176 = f32[] reduce(%square.581, %constant.712), dimensions={0,1}, to_apply=%region_408.499, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1116 = f32[] add(%add.1115, %reduce_sum.4176), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.582 = f32[2,1024]{1,0} multiply(%while.252, %while.252), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4177 = f32[] reduce(%square.582, %constant.712), dimensions={0,1}, to_apply=%region_409.500, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1117 = f32[] add(%add.1116, %reduce_sum.4177), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.583 = f32[2,1]{1,0} multiply(%while.253, %while.253), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4178 = f32[] reduce(%square.583, %constant.712), dimensions={0,1}, to_apply=%region_410.501, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1118 = f32[] add(%add.1117, %reduce_sum.4178), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.584 = f32[2,1024]{1,0} multiply(%while.254, %while.254), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4179 = f32[] reduce(%square.584, %constant.712), dimensions={0,1}, to_apply=%region_411.502, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1119 = f32[] add(%add.1118, %reduce_sum.4179), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.585 = f32[2,1]{1,0} multiply(%while.255, %while.255), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4180 = f32[] reduce(%square.585, %constant.712), dimensions={0,1}, to_apply=%region_412.503, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1120 = f32[] add(%add.1119, %reduce_sum.4180), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.586 = f32[2,1024]{1,0} multiply(%while.256, %while.256), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4181 = f32[] reduce(%square.586, %constant.712), dimensions={0,1}, to_apply=%region_413.504, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1121 = f32[] add(%add.1120, %reduce_sum.4181), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.587 = f32[2,1]{1,0} multiply(%while.257, %while.257), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4182 = f32[] reduce(%square.587, %constant.712), dimensions={0,1}, to_apply=%region_414.505, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1122 = f32[] add(%add.1121, %reduce_sum.4182), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.588 = f32[2,1024]{1,0} multiply(%while.258, %while.258), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4183 = f32[] reduce(%square.588, %constant.712), dimensions={0,1}, to_apply=%region_415.506, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1123 = f32[] add(%add.1122, %reduce_sum.4183), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.589 = f32[2,1]{1,0} multiply(%while.259, %while.259), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4184 = f32[] reduce(%square.589, %constant.712), dimensions={0,1}, to_apply=%region_416.507, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1124 = f32[] add(%add.1123, %reduce_sum.4184), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.590 = f32[2,1024]{1,0} multiply(%while.260, %while.260), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4185 = f32[] reduce(%square.590, %constant.712), dimensions={0,1}, to_apply=%region_417.508, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1125 = f32[] add(%add.1124, %reduce_sum.4185), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.591 = f32[2,1]{1,0} multiply(%while.261, %while.261), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4186 = f32[] reduce(%square.591, %constant.712), dimensions={0,1}, to_apply=%region_418.509, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1126 = f32[] add(%add.1125, %reduce_sum.4186), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.592 = f32[2,1024]{1,0} multiply(%while.262, %while.262), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4187 = f32[] reduce(%square.592, %constant.712), dimensions={0,1}, to_apply=%region_419.510, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1127 = f32[] add(%add.1126, %reduce_sum.4187), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.593 = f32[2,1]{1,0} multiply(%while.263, %while.263), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4188 = f32[] reduce(%square.593, %constant.712), dimensions={0,1}, to_apply=%region_420.511, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1128 = f32[] add(%add.1127, %reduce_sum.4188), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.594 = f32[2,1024]{1,0} multiply(%while.264, %while.264), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4189 = f32[] reduce(%square.594, %constant.712), dimensions={0,1}, to_apply=%region_421.512, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1129 = f32[] add(%add.1128, %reduce_sum.4189), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.595 = f32[2,1]{1,0} multiply(%while.265, %while.265), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4190 = f32[] reduce(%square.595, %constant.712), dimensions={0,1}, to_apply=%region_422.513, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1130 = f32[] add(%add.1129, %reduce_sum.4190), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.596 = f32[2,1024]{1,0} multiply(%while.266, %while.266), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4191 = f32[] reduce(%square.596, %constant.712), dimensions={0,1}, to_apply=%region_423.514, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1131 = f32[] add(%add.1130, %reduce_sum.4191), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.597 = f32[2,1]{1,0} multiply(%while.267, %while.267), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4192 = f32[] reduce(%square.597, %constant.712), dimensions={0,1}, to_apply=%region_424.515, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1132 = f32[] add(%add.1131, %reduce_sum.4192), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.598 = f32[2,1024]{1,0} multiply(%while.268, %while.268), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4193 = f32[] reduce(%square.598, %constant.712), dimensions={0,1}, to_apply=%region_425.516, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1133 = f32[] add(%add.1132, %reduce_sum.4193), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.599 = f32[2,1]{1,0} multiply(%while.269, %while.269), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4194 = f32[] reduce(%square.599, %constant.712), dimensions={0,1}, to_apply=%region_426.517, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1134 = f32[] add(%add.1133, %reduce_sum.4194), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.600 = f32[2,1024]{1,0} multiply(%while.270, %while.270), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4195 = f32[] reduce(%square.600, %constant.712), dimensions={0,1}, to_apply=%region_427.518, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1135 = f32[] add(%add.1134, %reduce_sum.4195), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.601 = f32[2,1]{1,0} multiply(%while.271, %while.271), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4196 = f32[] reduce(%square.601, %constant.712), dimensions={0,1}, to_apply=%region_428.519, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1136 = f32[] add(%add.1135, %reduce_sum.4196), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.602 = f32[2,1024]{1,0} multiply(%while.272, %while.272), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4197 = f32[] reduce(%square.602, %constant.712), dimensions={0,1}, to_apply=%region_429.520, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1137 = f32[] add(%add.1136, %reduce_sum.4197), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.603 = f32[2,1]{1,0} multiply(%while.273, %while.273), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4198 = f32[] reduce(%square.603, %constant.712), dimensions={0,1}, to_apply=%region_430.521, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1138 = f32[] add(%add.1137, %reduce_sum.4198), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.604 = f32[2,1024]{1,0} multiply(%while.274, %while.274), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4199 = f32[] reduce(%square.604, %constant.712), dimensions={0,1}, to_apply=%region_431.522, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1139 = f32[] add(%add.1138, %reduce_sum.4199), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.605 = f32[2,1]{1,0} multiply(%while.275, %while.275), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4200 = f32[] reduce(%square.605, %constant.712), dimensions={0,1}, to_apply=%region_432.523, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1140 = f32[] add(%add.1139, %reduce_sum.4200), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.606 = f32[2,1024]{1,0} multiply(%while.276, %while.276), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4201 = f32[] reduce(%square.606, %constant.712), dimensions={0,1}, to_apply=%region_433.524, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1141 = f32[] add(%add.1140, %reduce_sum.4201), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.607 = f32[2,1]{1,0} multiply(%while.277, %while.277), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4202 = f32[] reduce(%square.607, %constant.712), dimensions={0,1}, to_apply=%region_434.525, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1142 = f32[] add(%add.1141, %reduce_sum.4202), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.608 = f32[2,1024]{1,0} multiply(%while.278, %while.278), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4203 = f32[] reduce(%square.608, %constant.712), dimensions={0,1}, to_apply=%region_435.526, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1143 = f32[] add(%add.1142, %reduce_sum.4203), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.609 = f32[2,1]{1,0} multiply(%while.279, %while.279), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4204 = f32[] reduce(%square.609, %constant.712), dimensions={0,1}, to_apply=%region_436.527, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1144 = f32[] add(%add.1143, %reduce_sum.4204), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.610 = f32[2,1024]{1,0} multiply(%while.280, %while.280), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4205 = f32[] reduce(%square.610, %constant.712), dimensions={0,1}, to_apply=%region_437.528, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1145 = f32[] add(%add.1144, %reduce_sum.4205), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.611 = f32[2,1]{1,0} multiply(%while.281, %while.281), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4206 = f32[] reduce(%square.611, %constant.712), dimensions={0,1}, to_apply=%region_438.529, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1146 = f32[] add(%add.1145, %reduce_sum.4206), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.612 = f32[2,1024]{1,0} multiply(%while.282, %while.282), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4207 = f32[] reduce(%square.612, %constant.712), dimensions={0,1}, to_apply=%region_439.530, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1147 = f32[] add(%add.1146, %reduce_sum.4207), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.613 = f32[2,1024]{1,0} multiply(%while.283, %while.283), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4208 = f32[] reduce(%square.613, %constant.712), dimensions={0,1}, to_apply=%region_440.531, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1148 = f32[] add(%add.1147, %reduce_sum.4208), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.614 = f32[2,1]{1,0} multiply(%while.284, %while.284), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4209 = f32[] reduce(%square.614, %constant.712), dimensions={0,1}, to_apply=%region_441.532, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1149 = f32[] add(%add.1148, %reduce_sum.4209), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.615 = f32[2,1]{1,0} multiply(%while.285, %while.285), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4210 = f32[] reduce(%square.615, %constant.712), dimensions={0,1}, to_apply=%region_442.533, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1150 = f32[] add(%add.1149, %reduce_sum.4210), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.616 = f32[2,1024]{1,0} multiply(%while.286, %while.286), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4211 = f32[] reduce(%square.616, %constant.712), dimensions={0,1}, to_apply=%region_443.534, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1151 = f32[] add(%add.1150, %reduce_sum.4211), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.617 = f32[2,1024]{1,0} multiply(%while.287, %while.287), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4212 = f32[] reduce(%square.617, %constant.712), dimensions={0,1}, to_apply=%region_444.535, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1152 = f32[] add(%add.1151, %reduce_sum.4212), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.618 = f32[2,1]{1,0} multiply(%while.288, %while.288), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4213 = f32[] reduce(%square.618, %constant.712), dimensions={0,1}, to_apply=%region_445.536, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1153 = f32[] add(%add.1152, %reduce_sum.4213), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.619 = f32[2,1]{1,0} multiply(%while.289, %while.289), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4214 = f32[] reduce(%square.619, %constant.712), dimensions={0,1}, to_apply=%region_446.537, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1154 = f32[] add(%add.1153, %reduce_sum.4214), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.620 = f32[2,1024]{1,0} multiply(%while.290, %while.290), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4215 = f32[] reduce(%square.620, %constant.712), dimensions={0,1}, to_apply=%region_447.538, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1155 = f32[] add(%add.1154, %reduce_sum.4215), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.621 = f32[2,1]{1,0} multiply(%while.291, %while.291), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4216 = f32[] reduce(%square.621, %constant.712), dimensions={0,1}, to_apply=%region_448.539, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1156 = f32[] add(%add.1155, %reduce_sum.4216), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.622 = f32[2,1024]{1,0} multiply(%while.292, %while.292), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4217 = f32[] reduce(%square.622, %constant.712), dimensions={0,1}, to_apply=%region_449.540, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1157 = f32[] add(%add.1156, %reduce_sum.4217), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.623 = f32[2,1]{1,0} multiply(%while.293, %while.293), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4218 = f32[] reduce(%square.623, %constant.712), dimensions={0,1}, to_apply=%region_450.541, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1158 = f32[] add(%add.1157, %reduce_sum.4218), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.624 = f32[2,1024]{1,0} multiply(%while.294, %while.294), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4219 = f32[] reduce(%square.624, %constant.712), dimensions={0,1}, to_apply=%region_451.542, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1159 = f32[] add(%add.1158, %reduce_sum.4219), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.625 = f32[2,1]{1,0} multiply(%while.295, %while.295), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4220 = f32[] reduce(%square.625, %constant.712), dimensions={0,1}, to_apply=%region_452.543, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1160 = f32[] add(%add.1159, %reduce_sum.4220), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.626 = f32[2,1024]{1,0} multiply(%while.296, %while.296), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4221 = f32[] reduce(%square.626, %constant.712), dimensions={0,1}, to_apply=%region_453.544, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1161 = f32[] add(%add.1160, %reduce_sum.4221), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.627 = f32[2,1]{1,0} multiply(%while.297, %while.297), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4222 = f32[] reduce(%square.627, %constant.712), dimensions={0,1}, to_apply=%region_454.545, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1162 = f32[] add(%add.1161, %reduce_sum.4222), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.628 = f32[2,1024]{1,0} multiply(%while.298, %while.298), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4223 = f32[] reduce(%square.628, %constant.712), dimensions={0,1}, to_apply=%region_455.546, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1163 = f32[] add(%add.1162, %reduce_sum.4223), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.629 = f32[2,1]{1,0} multiply(%while.299, %while.299), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4224 = f32[] reduce(%square.629, %constant.712), dimensions={0,1}, to_apply=%region_456.547, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1164 = f32[] add(%add.1163, %reduce_sum.4224), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.630 = f32[2,1024]{1,0} multiply(%while.300, %while.300), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4225 = f32[] reduce(%square.630, %constant.712), dimensions={0,1}, to_apply=%region_457.548, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1165 = f32[] add(%add.1164, %reduce_sum.4225), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.631 = f32[2,1]{1,0} multiply(%while.301, %while.301), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4226 = f32[] reduce(%square.631, %constant.712), dimensions={0,1}, to_apply=%region_458.549, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1166 = f32[] add(%add.1165, %reduce_sum.4226), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.632 = f32[2,1024]{1,0} multiply(%while.302, %while.302), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4227 = f32[] reduce(%square.632, %constant.712), dimensions={0,1}, to_apply=%region_459.550, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1167 = f32[] add(%add.1166, %reduce_sum.4227), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.633 = f32[2,1]{1,0} multiply(%while.303, %while.303), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4228 = f32[] reduce(%square.633, %constant.712), dimensions={0,1}, to_apply=%region_460.551, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1168 = f32[] add(%add.1167, %reduce_sum.4228), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.634 = f32[2,1024]{1,0} multiply(%while.304, %while.304), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4229 = f32[] reduce(%square.634, %constant.712), dimensions={0,1}, to_apply=%region_461.552, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1169 = f32[] add(%add.1168, %reduce_sum.4229), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.635 = f32[2,1]{1,0} multiply(%while.305, %while.305), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4230 = f32[] reduce(%square.635, %constant.712), dimensions={0,1}, to_apply=%region_462.553, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1170 = f32[] add(%add.1169, %reduce_sum.4230), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.636 = f32[2,1024]{1,0} multiply(%while.306, %while.306), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4231 = f32[] reduce(%square.636, %constant.712), dimensions={0,1}, to_apply=%region_463.554, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1171 = f32[] add(%add.1170, %reduce_sum.4231), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.637 = f32[2,1]{1,0} multiply(%while.307, %while.307), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4232 = f32[] reduce(%square.637, %constant.712), dimensions={0,1}, to_apply=%region_464.555, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1172 = f32[] add(%add.1171, %reduce_sum.4232), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.638 = bf16[7168]{0} multiply(%select_n.105, %select_n.105), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1574 = f32[7168]{0} convert(%square.638), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4233 = f32[] reduce(%convert_element_type.1574, %constant.712), dimensions={0}, to_apply=%region_465.556, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1575 = bf16[] convert(%reduce_sum.4233), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1576 = f32[] convert(%convert_element_type.1575), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1173 = f32[] add(%add.1172, %convert_element_type.1576), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.639 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.107, %select_n.107), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1577 = f32[7168,1,18432]{2,1,0} convert(%square.639), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4234 = f32[] reduce(%convert_element_type.1577, %constant.712), dimensions={0,1,2}, to_apply=%region_466.557, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1578 = bf16[] convert(%reduce_sum.4234), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1579 = f32[] convert(%convert_element_type.1578), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1174 = f32[] add(%add.1173, %convert_element_type.1579), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.640 = bf16[7168,1,18432]{2,1,0} multiply(%select_n.109, %select_n.109), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1580 = f32[7168,1,18432]{2,1,0} convert(%square.640), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4235 = f32[] reduce(%convert_element_type.1580, %constant.712), dimensions={0,1,2}, to_apply=%region_467.558, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1581 = bf16[] convert(%reduce_sum.4235), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1582 = f32[] convert(%convert_element_type.1581), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1175 = f32[] add(%add.1174, %convert_element_type.1582), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.641 = bf16[18432,1,7168]{2,1,0} multiply(%select_n.111, %select_n.111), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1583 = f32[18432,1,7168]{2,1,0} convert(%square.641), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4236 = f32[] reduce(%convert_element_type.1583, %constant.712), dimensions={0,1,2}, to_apply=%region_468.559, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1584 = bf16[] convert(%reduce_sum.4236), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1585 = f32[] convert(%convert_element_type.1584), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1176 = f32[] add(%add.1175, %convert_element_type.1585), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.642 = bf16[7168,1]{1,0} multiply(%select_n.113, %select_n.113), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1586 = f32[7168,1]{1,0} convert(%square.642), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4237 = f32[] reduce(%convert_element_type.1586, %constant.712), dimensions={0,1}, to_apply=%region_469.560, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1587 = bf16[] convert(%reduce_sum.4237), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1588 = f32[] convert(%convert_element_type.1587), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1177 = f32[] add(%add.1176, %convert_element_type.1588), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.643 = bf16[7168,1]{1,0} multiply(%select_n.115, %select_n.115), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1589 = f32[7168,1]{1,0} convert(%square.643), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4238 = f32[] reduce(%convert_element_type.1589, %constant.712), dimensions={0,1}, to_apply=%region_470.561, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1590 = bf16[] convert(%reduce_sum.4238), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1591 = f32[] convert(%convert_element_type.1590), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1178 = f32[] add(%add.1177, %convert_element_type.1591), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.644 = bf16[512,1]{1,0} multiply(%select_n.117, %select_n.117), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1592 = f32[512,1]{1,0} convert(%square.644), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4239 = f32[] reduce(%convert_element_type.1592, %constant.712), dimensions={0,1}, to_apply=%region_471.562, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1593 = bf16[] convert(%reduce_sum.4239), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1594 = f32[] convert(%convert_element_type.1593), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1179 = f32[] add(%add.1178, %convert_element_type.1594), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.645 = bf16[128,1,128,7168]{3,2,1,0} multiply(%select_n.119, %select_n.119), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1595 = f32[128,1,128,7168]{3,2,1,0} convert(%square.645), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4240 = f32[] reduce(%convert_element_type.1595, %constant.712), dimensions={0,1,2,3}, to_apply=%region_472.563, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1596 = bf16[] convert(%reduce_sum.4240), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1597 = f32[] convert(%convert_element_type.1596), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1180 = f32[] add(%add.1179, %convert_element_type.1597), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.646 = bf16[1536,1]{1,0} multiply(%select_n.121, %select_n.121), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1598 = f32[1536,1]{1,0} convert(%square.646), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4241 = f32[] reduce(%convert_element_type.1598, %constant.712), dimensions={0,1}, to_apply=%region_473.564, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1599 = bf16[] convert(%reduce_sum.4241), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1600 = f32[] convert(%convert_element_type.1599), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1181 = f32[] add(%add.1180, %convert_element_type.1600), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.647 = bf16[7168,1,576]{2,1,0} multiply(%select_n.123, %select_n.123), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1601 = f32[7168,1,576]{2,1,0} convert(%square.647), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4242 = f32[] reduce(%convert_element_type.1601, %constant.712), dimensions={0,1,2}, to_apply=%region_474.565, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1602 = bf16[] convert(%reduce_sum.4242), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1603 = f32[] convert(%convert_element_type.1602), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1182 = f32[] add(%add.1181, %convert_element_type.1603), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.648 = bf16[512,1,128,256]{3,2,1,0} multiply(%select_n.125, %select_n.125), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1604 = f32[512,1,128,256]{3,2,1,0} convert(%square.648), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4243 = f32[] reduce(%convert_element_type.1604, %constant.712), dimensions={0,1,2,3}, to_apply=%region_475.566, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1605 = bf16[] convert(%reduce_sum.4243), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1606 = f32[] convert(%convert_element_type.1605), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1183 = f32[] add(%add.1182, %convert_element_type.1606), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.649 = bf16[7168,1,1536]{2,1,0} multiply(%select_n.127, %select_n.127), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1607 = f32[7168,1,1536]{2,1,0} convert(%square.649), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4244 = f32[] reduce(%convert_element_type.1607, %constant.712), dimensions={0,1,2}, to_apply=%region_476.567, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1608 = bf16[] convert(%reduce_sum.4244), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1609 = f32[] convert(%convert_element_type.1608), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1184 = f32[] add(%add.1183, %convert_element_type.1609), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.650 = bf16[1536,1,128,192]{3,2,1,0} multiply(%select_n.129, %select_n.129), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1610 = f32[1536,1,128,192]{3,2,1,0} convert(%square.650), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4245 = f32[] reduce(%convert_element_type.1610, %constant.712), dimensions={0,1,2,3}, to_apply=%region_477.568, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1611 = bf16[] convert(%reduce_sum.4245), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1612 = f32[] convert(%convert_element_type.1611), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1185 = f32[] add(%add.1184, %convert_element_type.1612), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.651 = bf16[7168,129280]{0,1} multiply(%select_n.131, %select_n.131), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1613 = f32[7168,129280]{0,1} convert(%square.651), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4246 = f32[] reduce(%convert_element_type.1613, %constant.712), dimensions={0,1}, to_apply=%region_478.569, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1614 = bf16[] convert(%reduce_sum.4246), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1615 = f32[] convert(%convert_element_type.1614), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1186 = f32[] add(%add.1185, %convert_element_type.1615), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.652 = bf16[64,2]{1,0} multiply(%select_n.133, %select_n.133), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1616 = f32[64,2]{1,0} convert(%square.652), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4247 = f32[] reduce(%convert_element_type.1616, %constant.712), dimensions={0,1}, to_apply=%region_479.570, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1617 = bf16[] convert(%reduce_sum.4247), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1618 = f32[] convert(%convert_element_type.1617), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1187 = f32[] add(%add.1186, %convert_element_type.1618), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.653 = bf16[7168,2,64]{2,0,1} multiply(%select_n.135, %select_n.135), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1619 = f32[7168,2,64]{2,0,1} convert(%square.653), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4248 = f32[] reduce(%convert_element_type.1619, %constant.712), dimensions={0,1,2}, to_apply=%region_480.571, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1620 = bf16[] convert(%reduce_sum.4248), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1621 = f32[] convert(%convert_element_type.1620), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1188 = f32[] add(%add.1187, %convert_element_type.1621), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.654 = bf16[64,2]{0,1} multiply(%select_n.137, %select_n.137), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1622 = f32[64,2]{0,1} convert(%square.654), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4249 = f32[] reduce(%convert_element_type.1622, %constant.712), dimensions={0,1}, to_apply=%region_481.572, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1623 = bf16[] convert(%reduce_sum.4249), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1624 = f32[] convert(%convert_element_type.1623), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1189 = f32[] add(%add.1188, %convert_element_type.1624), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.655 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.139, %select_n.139), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1625 = f32[64,2,7168,2048]{3,2,0,1} convert(%square.655), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4250 = f32[] reduce(%convert_element_type.1625, %constant.712), dimensions={0,1,2,3}, to_apply=%region_482.573, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1626 = bf16[] convert(%reduce_sum.4250), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1627 = f32[] convert(%convert_element_type.1626), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1190 = f32[] add(%add.1189, %convert_element_type.1627), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.656 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%select_n.141, %select_n.141), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1628 = f32[64,2,7168,2048]{3,2,0,1} convert(%square.656), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4251 = f32[] reduce(%convert_element_type.1628, %constant.712), dimensions={0,1,2,3}, to_apply=%region_483.574, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1629 = bf16[] convert(%reduce_sum.4251), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1630 = f32[] convert(%convert_element_type.1629), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1191 = f32[] add(%add.1190, %convert_element_type.1630), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.657 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%select_n.143, %select_n.143), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1631 = f32[64,2,2048,7168]{3,2,0,1} convert(%square.657), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4252 = f32[] reduce(%convert_element_type.1631, %constant.712), dimensions={0,1,2,3}, to_apply=%region_484.575, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1632 = bf16[] convert(%reduce_sum.4252), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1633 = f32[] convert(%convert_element_type.1632), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1192 = f32[] add(%add.1191, %convert_element_type.1633), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.658 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.145, %select_n.145), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1634 = f32[7168,2,2048]{2,0,1} convert(%square.658), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4253 = f32[] reduce(%convert_element_type.1634, %constant.712), dimensions={0,1,2}, to_apply=%region_485.576, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1635 = bf16[] convert(%reduce_sum.4253), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1636 = f32[] convert(%convert_element_type.1635), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1193 = f32[] add(%add.1192, %convert_element_type.1636), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.659 = bf16[7168,2,2048]{2,0,1} multiply(%select_n.147, %select_n.147), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1637 = f32[7168,2,2048]{2,0,1} convert(%square.659), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4254 = f32[] reduce(%convert_element_type.1637, %constant.712), dimensions={0,1,2}, to_apply=%region_486.577, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1638 = bf16[] convert(%reduce_sum.4254), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1639 = f32[] convert(%convert_element_type.1638), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1194 = f32[] add(%add.1193, %convert_element_type.1639), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.660 = bf16[2048,2,7168]{2,0,1} multiply(%select_n.149, %select_n.149), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1640 = f32[2048,2,7168]{2,0,1} convert(%square.660), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4255 = f32[] reduce(%convert_element_type.1640, %constant.712), dimensions={0,1,2}, to_apply=%region_487.578, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1641 = bf16[] convert(%reduce_sum.4255), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1642 = f32[] convert(%convert_element_type.1641), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1195 = f32[] add(%add.1194, %convert_element_type.1642), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.661 = bf16[7168,2]{0,1} multiply(%select_n.151, %select_n.151), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1643 = f32[7168,2]{0,1} convert(%square.661), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4256 = f32[] reduce(%convert_element_type.1643, %constant.712), dimensions={0,1}, to_apply=%region_488.579, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1644 = bf16[] convert(%reduce_sum.4256), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1645 = f32[] convert(%convert_element_type.1644), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1196 = f32[] add(%add.1195, %convert_element_type.1645), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.662 = bf16[7168,2]{0,1} multiply(%select_n.153, %select_n.153), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1646 = f32[7168,2]{0,1} convert(%square.662), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4257 = f32[] reduce(%convert_element_type.1646, %constant.712), dimensions={0,1}, to_apply=%region_489.580, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1647 = bf16[] convert(%reduce_sum.4257), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1648 = f32[] convert(%convert_element_type.1647), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1197 = f32[] add(%add.1196, %convert_element_type.1648), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.663 = bf16[512,2]{0,1} multiply(%select_n.155, %select_n.155), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1649 = f32[512,2]{0,1} convert(%square.663), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4258 = f32[] reduce(%convert_element_type.1649, %constant.712), dimensions={0,1}, to_apply=%region_490.581, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1650 = bf16[] convert(%reduce_sum.4258), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1651 = f32[] convert(%convert_element_type.1650), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1198 = f32[] add(%add.1197, %convert_element_type.1651), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.664 = bf16[128,2,128,7168]{3,2,0,1} multiply(%select_n.157, %select_n.157), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1652 = f32[128,2,128,7168]{3,2,0,1} convert(%square.664), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4259 = f32[] reduce(%convert_element_type.1652, %constant.712), dimensions={0,1,2,3}, to_apply=%region_491.582, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1653 = bf16[] convert(%reduce_sum.4259), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1654 = f32[] convert(%convert_element_type.1653), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1199 = f32[] add(%add.1198, %convert_element_type.1654), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.665 = bf16[1536,2]{0,1} multiply(%select_n.159, %select_n.159), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1655 = f32[1536,2]{0,1} convert(%square.665), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4260 = f32[] reduce(%convert_element_type.1655, %constant.712), dimensions={0,1}, to_apply=%region_492.583, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1656 = bf16[] convert(%reduce_sum.4260), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1657 = f32[] convert(%convert_element_type.1656), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1200 = f32[] add(%add.1199, %convert_element_type.1657), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.666 = bf16[7168,2,576]{2,0,1} multiply(%select_n.161, %select_n.161), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1658 = f32[7168,2,576]{2,0,1} convert(%square.666), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4261 = f32[] reduce(%convert_element_type.1658, %constant.712), dimensions={0,1,2}, to_apply=%region_493.584, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1659 = bf16[] convert(%reduce_sum.4261), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1660 = f32[] convert(%convert_element_type.1659), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1201 = f32[] add(%add.1200, %convert_element_type.1660), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.667 = bf16[512,2,128,256]{3,2,0,1} multiply(%select_n.163, %select_n.163), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1661 = f32[512,2,128,256]{3,2,0,1} convert(%square.667), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4262 = f32[] reduce(%convert_element_type.1661, %constant.712), dimensions={0,1,2,3}, to_apply=%region_494.585, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1662 = bf16[] convert(%reduce_sum.4262), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1663 = f32[] convert(%convert_element_type.1662), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1202 = f32[] add(%add.1201, %convert_element_type.1663), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.668 = bf16[7168,2,1536]{2,0,1} multiply(%select_n.165, %select_n.165), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1664 = f32[7168,2,1536]{2,0,1} convert(%square.668), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4263 = f32[] reduce(%convert_element_type.1664, %constant.712), dimensions={0,1,2}, to_apply=%region_495.586, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1665 = bf16[] convert(%reduce_sum.4263), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1666 = f32[] convert(%convert_element_type.1665), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1203 = f32[] add(%add.1202, %convert_element_type.1666), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.669 = bf16[1536,2,128,192]{3,2,0,1} multiply(%select_n.167, %select_n.167), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1667 = f32[1536,2,128,192]{3,2,0,1} convert(%square.669), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4264 = f32[] reduce(%convert_element_type.1667, %constant.712), dimensions={0,1,2,3}, to_apply=%region_496.587, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1668 = bf16[] convert(%reduce_sum.4264), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1669 = f32[] convert(%convert_element_type.1668), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1204 = f32[] add(%add.1203, %convert_element_type.1669), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.670 = bf16[129280,7168]{1,0} multiply(%select_n.169, %select_n.169), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1670 = f32[129280,7168]{1,0} convert(%square.670), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4265 = f32[] reduce(%convert_element_type.1670, %constant.712), dimensions={0,1}, to_apply=%region_497.588, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1671 = bf16[] convert(%reduce_sum.4265), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1672 = f32[] convert(%convert_element_type.1671), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1205 = f32[] add(%add.1204, %convert_element_type.1672), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %sqrt.71 = f32[] sqrt(%add.1205), metadata={op_name="jit(train_step)/sqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=9 source_end_column=105}
  %reshape.525 = f32[] reshape(%sqrt.71)
  %log.2 = f32[32,4096,1]{2,1,0} log(%broadcast_in_dim.1659), metadata={op_name="jit(train_step)/jvp()/log" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=574 source_end_line=574 source_column=26 source_end_column=42}
  %sub.81 = f32[32,4096,1]{2,1,0} broadcast(%log.2), dimensions={0,1,2}, metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=574 source_end_line=574 source_column=16 source_end_column=42}
  %sub.82 = f32[32,4096]{1,0} reshape(%sub.81), metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=574 source_end_line=574 source_column=16 source_end_column=42}
  %sub.83 = f32[32,4096,129280]{2,1,0} broadcast(%sub.82), dimensions={0,1}, metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=574 source_end_line=574 source_column=16 source_end_column=42}
  %sub.84 = f32[32,4096,129280]{2,1,0} subtract(%sub.80, %sub.83), metadata={op_name="jit(train_step)/jvp()/sub" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=574 source_end_line=574 source_column=16 source_end_column=42}
  %mul.1600 = f32[32,4096,129280]{2,1,0} multiply(%jvp_jit__one_hot__.1, %sub.84), metadata={op_name="jit(train_step)/jvp()/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=575 source_end_line=575 source_column=18 source_end_column=39}
  %reduce_sum.4067 = f32[32,4096]{1,0} reduce(%mul.1600, %constant.712), dimensions={2}, to_apply=%region_58.95, metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=575 source_end_line=575 source_column=10 source_end_column=49}
  %neg.21 = f32[32,4096]{1,0} negate(%reduce_sum.4067), metadata={op_name="jit(train_step)/jvp()/neg" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=575 source_end_line=575 source_column=9 source_end_column=49}
  %square.511 = f32[32,4096]{1,0} multiply(%squeeze.593, %squeeze.593), metadata={op_name="jit(train_step)/jvp()/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=578 source_end_line=578 source_column=26 source_end_column=47}
  %mul.1601 = f32[32,4096]{1,0} multiply(%square.511, %broadcast.247), metadata={op_name="jit(train_step)/jvp()/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=578 source_end_line=578 source_column=17 source_end_column=47}
  %add.842 = f32[32,4096]{1,0} add(%neg.21, %mul.1601), metadata={op_name="jit(train_step)/jvp()/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=579 source_end_line=579 source_column=2 source_end_column=22}
  %sharding_constraint.194 = f32[32,4096]{1,0} custom-call(%add.842), custom_call_target="Sharding", sharding={devices=[4,1]<=[4]}, frontend_attributes={xla.sdy.sharding="#sdy.sharding_per_value<[<@mesh, [{\"data\", \"stage\", \"fsdp\", \"fsdp_transpose\", \"expert\"}, {}]>]>"}, metadata={op_name="jit(train_step)/jvp()/sharding_constraint" source_file="/opt/flax/flax/linen/spmd.py" source_line=201 source_end_line=201 source_column=11 source_end_column=58}
  %mul.1602 = f32[32,4096]{1,0} multiply(%sharding_constraint.194, %convert_element_type.1402), metadata={op_name="jit(train_step)/jvp()/mul" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=149 source_end_line=149 source_column=9 source_end_column=51}
  %reduce_sum.4068 = f32[] reduce(%mul.1602, %constant.712), dimensions={0,1}, to_apply=%region_59.96, metadata={op_name="jit(train_step)/jvp()/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=150 source_end_line=150 source_column=15 source_end_column=28}
  %div.1432 = f32[] divide(%reduce_sum.4068, %add.843), metadata={op_name="jit(train_step)/jvp()/div" source_file="/maxtext_workspace/maxtext/src/MaxText/train.py" source_line=163 source_end_line=163 source_column=11 source_end_column=45}
  %reshape.526 = f32[] reshape(%div.1432)
  %reshape.527 = f32[] reshape(%constant.712)
  %reshape.528 = f32[] reshape(%constant.712)
  %square.829 = f32[1,1024]{1,0} multiply(%while.324, %while.324), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4425 = f32[] reduce(%square.829, %constant.712), dimensions={0,1}, to_apply=%region_657.748, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %square.830 = f32[1,1]{1,0} multiply(%while.325, %while.325), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4426 = f32[] reduce(%square.830, %constant.712), dimensions={0,1}, to_apply=%region_658.749, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1364 = f32[] add(%reduce_sum.4425, %reduce_sum.4426), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.831 = f32[1,1024]{1,0} multiply(%while.326, %while.326), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4427 = f32[] reduce(%square.831, %constant.712), dimensions={0,1}, to_apply=%region_659.750, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1365 = f32[] add(%add.1364, %reduce_sum.4427), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.832 = f32[1,1]{1,0} multiply(%while.327, %while.327), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4428 = f32[] reduce(%square.832, %constant.712), dimensions={0,1}, to_apply=%region_660.751, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1366 = f32[] add(%add.1365, %reduce_sum.4428), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.833 = f32[1,1024]{1,0} multiply(%while.328, %while.328), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4429 = f32[] reduce(%square.833, %constant.712), dimensions={0,1}, to_apply=%region_661.752, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1367 = f32[] add(%add.1366, %reduce_sum.4429), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.834 = f32[1,1]{1,0} multiply(%while.329, %while.329), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4430 = f32[] reduce(%square.834, %constant.712), dimensions={0,1}, to_apply=%region_662.753, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1368 = f32[] add(%add.1367, %reduce_sum.4430), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.835 = f32[1,1024]{1,0} multiply(%while.330, %while.330), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4431 = f32[] reduce(%square.835, %constant.712), dimensions={0,1}, to_apply=%region_663.754, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1369 = f32[] add(%add.1368, %reduce_sum.4431), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.836 = f32[1,1]{1,0} multiply(%while.331, %while.331), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4432 = f32[] reduce(%square.836, %constant.712), dimensions={0,1}, to_apply=%region_664.755, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1370 = f32[] add(%add.1369, %reduce_sum.4432), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.837 = f32[1,1024]{1,0} multiply(%while.332, %while.332), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4433 = f32[] reduce(%square.837, %constant.712), dimensions={0,1}, to_apply=%region_665.756, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1371 = f32[] add(%add.1370, %reduce_sum.4433), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.838 = f32[1,1]{1,0} multiply(%while.333, %while.333), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4434 = f32[] reduce(%square.838, %constant.712), dimensions={0,1}, to_apply=%region_666.757, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1372 = f32[] add(%add.1371, %reduce_sum.4434), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.839 = f32[1,1024]{1,0} multiply(%while.334, %while.334), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4435 = f32[] reduce(%square.839, %constant.712), dimensions={0,1}, to_apply=%region_667.758, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1373 = f32[] add(%add.1372, %reduce_sum.4435), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.840 = f32[1,1]{1,0} multiply(%while.335, %while.335), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4436 = f32[] reduce(%square.840, %constant.712), dimensions={0,1}, to_apply=%region_668.759, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1374 = f32[] add(%add.1373, %reduce_sum.4436), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.841 = f32[1,1024]{1,0} multiply(%while.336, %while.336), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4437 = f32[] reduce(%square.841, %constant.712), dimensions={0,1}, to_apply=%region_669.760, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1375 = f32[] add(%add.1374, %reduce_sum.4437), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.842 = f32[1,1]{1,0} multiply(%while.337, %while.337), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4438 = f32[] reduce(%square.842, %constant.712), dimensions={0,1}, to_apply=%region_670.761, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1376 = f32[] add(%add.1375, %reduce_sum.4438), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.843 = f32[1,1024]{1,0} multiply(%while.338, %while.338), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4439 = f32[] reduce(%square.843, %constant.712), dimensions={0,1}, to_apply=%region_671.762, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1377 = f32[] add(%add.1376, %reduce_sum.4439), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.844 = f32[1,1]{1,0} multiply(%while.339, %while.339), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4440 = f32[] reduce(%square.844, %constant.712), dimensions={0,1}, to_apply=%region_672.763, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1378 = f32[] add(%add.1377, %reduce_sum.4440), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.845 = f32[1,1024]{1,0} multiply(%while.340, %while.340), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4441 = f32[] reduce(%square.845, %constant.712), dimensions={0,1}, to_apply=%region_673.764, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1379 = f32[] add(%add.1378, %reduce_sum.4441), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.846 = f32[1,1]{1,0} multiply(%while.341, %while.341), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4442 = f32[] reduce(%square.846, %constant.712), dimensions={0,1}, to_apply=%region_674.765, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1380 = f32[] add(%add.1379, %reduce_sum.4442), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.847 = f32[1,1024]{1,0} multiply(%while.342, %while.342), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4443 = f32[] reduce(%square.847, %constant.712), dimensions={0,1}, to_apply=%region_675.766, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1381 = f32[] add(%add.1380, %reduce_sum.4443), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.848 = f32[1,1]{1,0} multiply(%while.343, %while.343), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4444 = f32[] reduce(%square.848, %constant.712), dimensions={0,1}, to_apply=%region_676.767, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1382 = f32[] add(%add.1381, %reduce_sum.4444), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.849 = f32[1,1024]{1,0} multiply(%while.344, %while.344), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4445 = f32[] reduce(%square.849, %constant.712), dimensions={0,1}, to_apply=%region_677.768, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1383 = f32[] add(%add.1382, %reduce_sum.4445), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.850 = f32[1,1024]{1,0} multiply(%while.345, %while.345), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4446 = f32[] reduce(%square.850, %constant.712), dimensions={0,1}, to_apply=%region_678.769, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1384 = f32[] add(%add.1383, %reduce_sum.4446), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.851 = f32[1,1]{1,0} multiply(%while.346, %while.346), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4447 = f32[] reduce(%square.851, %constant.712), dimensions={0,1}, to_apply=%region_679.770, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1385 = f32[] add(%add.1384, %reduce_sum.4447), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.852 = f32[1,1]{1,0} multiply(%while.347, %while.347), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4448 = f32[] reduce(%square.852, %constant.712), dimensions={0,1}, to_apply=%region_680.771, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1386 = f32[] add(%add.1385, %reduce_sum.4448), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.853 = f32[1,1024]{1,0} multiply(%while.348, %while.348), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4449 = f32[] reduce(%square.853, %constant.712), dimensions={0,1}, to_apply=%region_681.772, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1387 = f32[] add(%add.1386, %reduce_sum.4449), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.854 = f32[1,1024]{1,0} multiply(%while.349, %while.349), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4450 = f32[] reduce(%square.854, %constant.712), dimensions={0,1}, to_apply=%region_682.773, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1388 = f32[] add(%add.1387, %reduce_sum.4450), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.855 = f32[1,1]{1,0} multiply(%while.350, %while.350), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4451 = f32[] reduce(%square.855, %constant.712), dimensions={0,1}, to_apply=%region_683.774, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1389 = f32[] add(%add.1388, %reduce_sum.4451), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.856 = f32[1,1]{1,0} multiply(%while.351, %while.351), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4452 = f32[] reduce(%square.856, %constant.712), dimensions={0,1}, to_apply=%region_684.775, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1390 = f32[] add(%add.1389, %reduce_sum.4452), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.857 = f32[1,1024]{1,0} multiply(%while.352, %while.352), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4453 = f32[] reduce(%square.857, %constant.712), dimensions={0,1}, to_apply=%region_685.776, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1391 = f32[] add(%add.1390, %reduce_sum.4453), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.858 = f32[1,1]{1,0} multiply(%while.353, %while.353), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4454 = f32[] reduce(%square.858, %constant.712), dimensions={0,1}, to_apply=%region_686.777, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1392 = f32[] add(%add.1391, %reduce_sum.4454), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.859 = f32[1,1024]{1,0} multiply(%while.354, %while.354), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4455 = f32[] reduce(%square.859, %constant.712), dimensions={0,1}, to_apply=%region_687.778, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1393 = f32[] add(%add.1392, %reduce_sum.4455), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.860 = f32[1,1]{1,0} multiply(%while.355, %while.355), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4456 = f32[] reduce(%square.860, %constant.712), dimensions={0,1}, to_apply=%region_688.779, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1394 = f32[] add(%add.1393, %reduce_sum.4456), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.861 = f32[1,1024]{1,0} multiply(%while.356, %while.356), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4457 = f32[] reduce(%square.861, %constant.712), dimensions={0,1}, to_apply=%region_689.780, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1395 = f32[] add(%add.1394, %reduce_sum.4457), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.862 = f32[1,1]{1,0} multiply(%while.357, %while.357), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4458 = f32[] reduce(%square.862, %constant.712), dimensions={0,1}, to_apply=%region_690.781, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1396 = f32[] add(%add.1395, %reduce_sum.4458), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.863 = f32[1,1024]{1,0} multiply(%while.358, %while.358), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4459 = f32[] reduce(%square.863, %constant.712), dimensions={0,1}, to_apply=%region_691.782, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1397 = f32[] add(%add.1396, %reduce_sum.4459), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.864 = f32[1,1]{1,0} multiply(%while.359, %while.359), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4460 = f32[] reduce(%square.864, %constant.712), dimensions={0,1}, to_apply=%region_692.783, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1398 = f32[] add(%add.1397, %reduce_sum.4460), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.865 = f32[1,1024]{1,0} multiply(%while.360, %while.360), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4461 = f32[] reduce(%square.865, %constant.712), dimensions={0,1}, to_apply=%region_693.784, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1399 = f32[] add(%add.1398, %reduce_sum.4461), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.866 = f32[1,1]{1,0} multiply(%while.361, %while.361), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4462 = f32[] reduce(%square.866, %constant.712), dimensions={0,1}, to_apply=%region_694.785, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1400 = f32[] add(%add.1399, %reduce_sum.4462), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.867 = f32[1,1024]{1,0} multiply(%while.362, %while.362), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4463 = f32[] reduce(%square.867, %constant.712), dimensions={0,1}, to_apply=%region_695.786, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1401 = f32[] add(%add.1400, %reduce_sum.4463), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.868 = f32[1,1]{1,0} multiply(%while.363, %while.363), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4464 = f32[] reduce(%square.868, %constant.712), dimensions={0,1}, to_apply=%region_696.787, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1402 = f32[] add(%add.1401, %reduce_sum.4464), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.869 = f32[1,1024]{1,0} multiply(%while.364, %while.364), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4465 = f32[] reduce(%square.869, %constant.712), dimensions={0,1}, to_apply=%region_697.788, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1403 = f32[] add(%add.1402, %reduce_sum.4465), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.870 = f32[1,1]{1,0} multiply(%while.365, %while.365), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4466 = f32[] reduce(%square.870, %constant.712), dimensions={0,1}, to_apply=%region_698.789, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1404 = f32[] add(%add.1403, %reduce_sum.4466), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.871 = f32[1,1024]{1,0} multiply(%while.366, %while.366), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4467 = f32[] reduce(%square.871, %constant.712), dimensions={0,1}, to_apply=%region_699.790, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1405 = f32[] add(%add.1404, %reduce_sum.4467), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.872 = f32[1,1]{1,0} multiply(%while.367, %while.367), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4468 = f32[] reduce(%square.872, %constant.712), dimensions={0,1}, to_apply=%region_700.791, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1406 = f32[] add(%add.1405, %reduce_sum.4468), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.873 = f32[1,1024]{1,0} multiply(%while.368, %while.368), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4469 = f32[] reduce(%square.873, %constant.712), dimensions={0,1}, to_apply=%region_701.792, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1407 = f32[] add(%add.1406, %reduce_sum.4469), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.874 = f32[1,1]{1,0} multiply(%while.369, %while.369), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4470 = f32[] reduce(%square.874, %constant.712), dimensions={0,1}, to_apply=%region_702.793, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1408 = f32[] add(%add.1407, %reduce_sum.4470), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.875 = f32[2,1024]{1,0} multiply(%while.228, %while.228), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4471 = f32[] reduce(%square.875, %constant.712), dimensions={0,1}, to_apply=%region_703.794, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1409 = f32[] add(%add.1408, %reduce_sum.4471), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.876 = f32[2,1]{1,0} multiply(%while.229, %while.229), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4472 = f32[] reduce(%square.876, %constant.712), dimensions={0,1}, to_apply=%region_704.795, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1410 = f32[] add(%add.1409, %reduce_sum.4472), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.877 = f32[2,1024]{1,0} multiply(%while.230, %while.230), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4473 = f32[] reduce(%square.877, %constant.712), dimensions={0,1}, to_apply=%region_705.796, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1411 = f32[] add(%add.1410, %reduce_sum.4473), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.878 = f32[2,1]{1,0} multiply(%while.231, %while.231), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4474 = f32[] reduce(%square.878, %constant.712), dimensions={0,1}, to_apply=%region_706.797, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1412 = f32[] add(%add.1411, %reduce_sum.4474), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.879 = f32[2,1024]{1,0} multiply(%while.232, %while.232), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4475 = f32[] reduce(%square.879, %constant.712), dimensions={0,1}, to_apply=%region_707.798, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1413 = f32[] add(%add.1412, %reduce_sum.4475), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.880 = f32[2,1]{1,0} multiply(%while.233, %while.233), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4476 = f32[] reduce(%square.880, %constant.712), dimensions={0,1}, to_apply=%region_708.799, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1414 = f32[] add(%add.1413, %reduce_sum.4476), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.881 = f32[2,1024]{1,0} multiply(%while.234, %while.234), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4477 = f32[] reduce(%square.881, %constant.712), dimensions={0,1}, to_apply=%region_709.800, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1415 = f32[] add(%add.1414, %reduce_sum.4477), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.882 = f32[2,1]{1,0} multiply(%while.235, %while.235), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4478 = f32[] reduce(%square.882, %constant.712), dimensions={0,1}, to_apply=%region_710.801, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1416 = f32[] add(%add.1415, %reduce_sum.4478), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.883 = f32[2,1024]{1,0} multiply(%while.236, %while.236), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4479 = f32[] reduce(%square.883, %constant.712), dimensions={0,1}, to_apply=%region_711.802, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1417 = f32[] add(%add.1416, %reduce_sum.4479), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.884 = f32[2,1]{1,0} multiply(%while.237, %while.237), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4480 = f32[] reduce(%square.884, %constant.712), dimensions={0,1}, to_apply=%region_712.803, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1418 = f32[] add(%add.1417, %reduce_sum.4480), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.885 = f32[2,1024]{1,0} multiply(%while.238, %while.238), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4481 = f32[] reduce(%square.885, %constant.712), dimensions={0,1}, to_apply=%region_713.804, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1419 = f32[] add(%add.1418, %reduce_sum.4481), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.886 = f32[2,1]{1,0} multiply(%while.239, %while.239), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4482 = f32[] reduce(%square.886, %constant.712), dimensions={0,1}, to_apply=%region_714.805, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1420 = f32[] add(%add.1419, %reduce_sum.4482), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.887 = f32[2,1024]{1,0} multiply(%while.240, %while.240), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4483 = f32[] reduce(%square.887, %constant.712), dimensions={0,1}, to_apply=%region_715.806, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1421 = f32[] add(%add.1420, %reduce_sum.4483), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.888 = f32[2,1]{1,0} multiply(%while.241, %while.241), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4484 = f32[] reduce(%square.888, %constant.712), dimensions={0,1}, to_apply=%region_716.807, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1422 = f32[] add(%add.1421, %reduce_sum.4484), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.889 = f32[2,1024]{1,0} multiply(%while.242, %while.242), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4485 = f32[] reduce(%square.889, %constant.712), dimensions={0,1}, to_apply=%region_717.808, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1423 = f32[] add(%add.1422, %reduce_sum.4485), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.890 = f32[2,1024]{1,0} multiply(%while.243, %while.243), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4486 = f32[] reduce(%square.890, %constant.712), dimensions={0,1}, to_apply=%region_718.809, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1424 = f32[] add(%add.1423, %reduce_sum.4486), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.891 = f32[2,1]{1,0} multiply(%while.244, %while.244), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4487 = f32[] reduce(%square.891, %constant.712), dimensions={0,1}, to_apply=%region_719.810, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1425 = f32[] add(%add.1424, %reduce_sum.4487), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.892 = f32[2,1]{1,0} multiply(%while.245, %while.245), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4488 = f32[] reduce(%square.892, %constant.712), dimensions={0,1}, to_apply=%region_720.811, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1426 = f32[] add(%add.1425, %reduce_sum.4488), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.893 = f32[2,1024]{1,0} multiply(%while.246, %while.246), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4489 = f32[] reduce(%square.893, %constant.712), dimensions={0,1}, to_apply=%region_721.812, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1427 = f32[] add(%add.1426, %reduce_sum.4489), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.894 = f32[2,1024]{1,0} multiply(%while.247, %while.247), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4490 = f32[] reduce(%square.894, %constant.712), dimensions={0,1}, to_apply=%region_722.813, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1428 = f32[] add(%add.1427, %reduce_sum.4490), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.895 = f32[2,1]{1,0} multiply(%while.248, %while.248), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4491 = f32[] reduce(%square.895, %constant.712), dimensions={0,1}, to_apply=%region_723.814, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1429 = f32[] add(%add.1428, %reduce_sum.4491), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.896 = f32[2,1]{1,0} multiply(%while.249, %while.249), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4492 = f32[] reduce(%square.896, %constant.712), dimensions={0,1}, to_apply=%region_724.815, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1430 = f32[] add(%add.1429, %reduce_sum.4492), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.897 = f32[2,1024]{1,0} multiply(%while.250, %while.250), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4493 = f32[] reduce(%square.897, %constant.712), dimensions={0,1}, to_apply=%region_725.816, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1431 = f32[] add(%add.1430, %reduce_sum.4493), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.898 = f32[2,1]{1,0} multiply(%while.251, %while.251), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4494 = f32[] reduce(%square.898, %constant.712), dimensions={0,1}, to_apply=%region_726.817, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1432 = f32[] add(%add.1431, %reduce_sum.4494), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.899 = f32[2,1024]{1,0} multiply(%while.252, %while.252), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4495 = f32[] reduce(%square.899, %constant.712), dimensions={0,1}, to_apply=%region_727.818, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1433 = f32[] add(%add.1432, %reduce_sum.4495), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.900 = f32[2,1]{1,0} multiply(%while.253, %while.253), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4496 = f32[] reduce(%square.900, %constant.712), dimensions={0,1}, to_apply=%region_728.819, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1434 = f32[] add(%add.1433, %reduce_sum.4496), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.901 = f32[2,1024]{1,0} multiply(%while.254, %while.254), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4497 = f32[] reduce(%square.901, %constant.712), dimensions={0,1}, to_apply=%region_729.820, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1435 = f32[] add(%add.1434, %reduce_sum.4497), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.902 = f32[2,1]{1,0} multiply(%while.255, %while.255), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4498 = f32[] reduce(%square.902, %constant.712), dimensions={0,1}, to_apply=%region_730.821, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1436 = f32[] add(%add.1435, %reduce_sum.4498), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.903 = f32[2,1024]{1,0} multiply(%while.256, %while.256), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4499 = f32[] reduce(%square.903, %constant.712), dimensions={0,1}, to_apply=%region_731.822, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1437 = f32[] add(%add.1436, %reduce_sum.4499), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.904 = f32[2,1]{1,0} multiply(%while.257, %while.257), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4500 = f32[] reduce(%square.904, %constant.712), dimensions={0,1}, to_apply=%region_732.823, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1438 = f32[] add(%add.1437, %reduce_sum.4500), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.905 = f32[2,1024]{1,0} multiply(%while.258, %while.258), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4501 = f32[] reduce(%square.905, %constant.712), dimensions={0,1}, to_apply=%region_733.824, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1439 = f32[] add(%add.1438, %reduce_sum.4501), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.906 = f32[2,1]{1,0} multiply(%while.259, %while.259), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4502 = f32[] reduce(%square.906, %constant.712), dimensions={0,1}, to_apply=%region_734.825, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1440 = f32[] add(%add.1439, %reduce_sum.4502), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.907 = f32[2,1024]{1,0} multiply(%while.260, %while.260), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4503 = f32[] reduce(%square.907, %constant.712), dimensions={0,1}, to_apply=%region_735.826, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1441 = f32[] add(%add.1440, %reduce_sum.4503), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.908 = f32[2,1]{1,0} multiply(%while.261, %while.261), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4504 = f32[] reduce(%square.908, %constant.712), dimensions={0,1}, to_apply=%region_736.827, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1442 = f32[] add(%add.1441, %reduce_sum.4504), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.909 = f32[2,1024]{1,0} multiply(%while.262, %while.262), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4505 = f32[] reduce(%square.909, %constant.712), dimensions={0,1}, to_apply=%region_737.828, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1443 = f32[] add(%add.1442, %reduce_sum.4505), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.910 = f32[2,1]{1,0} multiply(%while.263, %while.263), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4506 = f32[] reduce(%square.910, %constant.712), dimensions={0,1}, to_apply=%region_738.829, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1444 = f32[] add(%add.1443, %reduce_sum.4506), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.911 = f32[2,1024]{1,0} multiply(%while.264, %while.264), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4507 = f32[] reduce(%square.911, %constant.712), dimensions={0,1}, to_apply=%region_739.830, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1445 = f32[] add(%add.1444, %reduce_sum.4507), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.912 = f32[2,1]{1,0} multiply(%while.265, %while.265), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4508 = f32[] reduce(%square.912, %constant.712), dimensions={0,1}, to_apply=%region_740.831, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1446 = f32[] add(%add.1445, %reduce_sum.4508), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.913 = f32[2,1024]{1,0} multiply(%while.266, %while.266), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4509 = f32[] reduce(%square.913, %constant.712), dimensions={0,1}, to_apply=%region_741.832, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1447 = f32[] add(%add.1446, %reduce_sum.4509), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.914 = f32[2,1]{1,0} multiply(%while.267, %while.267), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4510 = f32[] reduce(%square.914, %constant.712), dimensions={0,1}, to_apply=%region_742.833, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1448 = f32[] add(%add.1447, %reduce_sum.4510), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.915 = f32[2,1024]{1,0} multiply(%while.268, %while.268), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4511 = f32[] reduce(%square.915, %constant.712), dimensions={0,1}, to_apply=%region_743.834, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1449 = f32[] add(%add.1448, %reduce_sum.4511), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.916 = f32[2,1]{1,0} multiply(%while.269, %while.269), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4512 = f32[] reduce(%square.916, %constant.712), dimensions={0,1}, to_apply=%region_744.835, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1450 = f32[] add(%add.1449, %reduce_sum.4512), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.917 = f32[2,1024]{1,0} multiply(%while.270, %while.270), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4513 = f32[] reduce(%square.917, %constant.712), dimensions={0,1}, to_apply=%region_745.836, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1451 = f32[] add(%add.1450, %reduce_sum.4513), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.918 = f32[2,1]{1,0} multiply(%while.271, %while.271), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4514 = f32[] reduce(%square.918, %constant.712), dimensions={0,1}, to_apply=%region_746.837, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1452 = f32[] add(%add.1451, %reduce_sum.4514), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.919 = f32[2,1024]{1,0} multiply(%while.272, %while.272), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4515 = f32[] reduce(%square.919, %constant.712), dimensions={0,1}, to_apply=%region_747.838, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1453 = f32[] add(%add.1452, %reduce_sum.4515), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.920 = f32[2,1]{1,0} multiply(%while.273, %while.273), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4516 = f32[] reduce(%square.920, %constant.712), dimensions={0,1}, to_apply=%region_748.839, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1454 = f32[] add(%add.1453, %reduce_sum.4516), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.921 = f32[2,1024]{1,0} multiply(%while.274, %while.274), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4517 = f32[] reduce(%square.921, %constant.712), dimensions={0,1}, to_apply=%region_749.840, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1455 = f32[] add(%add.1454, %reduce_sum.4517), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.922 = f32[2,1]{1,0} multiply(%while.275, %while.275), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4518 = f32[] reduce(%square.922, %constant.712), dimensions={0,1}, to_apply=%region_750.841, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1456 = f32[] add(%add.1455, %reduce_sum.4518), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.923 = f32[2,1024]{1,0} multiply(%while.276, %while.276), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4519 = f32[] reduce(%square.923, %constant.712), dimensions={0,1}, to_apply=%region_751.842, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1457 = f32[] add(%add.1456, %reduce_sum.4519), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.924 = f32[2,1]{1,0} multiply(%while.277, %while.277), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4520 = f32[] reduce(%square.924, %constant.712), dimensions={0,1}, to_apply=%region_752.843, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1458 = f32[] add(%add.1457, %reduce_sum.4520), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.925 = f32[2,1024]{1,0} multiply(%while.278, %while.278), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4521 = f32[] reduce(%square.925, %constant.712), dimensions={0,1}, to_apply=%region_753.844, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1459 = f32[] add(%add.1458, %reduce_sum.4521), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.926 = f32[2,1]{1,0} multiply(%while.279, %while.279), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4522 = f32[] reduce(%square.926, %constant.712), dimensions={0,1}, to_apply=%region_754.845, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1460 = f32[] add(%add.1459, %reduce_sum.4522), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.927 = f32[2,1024]{1,0} multiply(%while.280, %while.280), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4523 = f32[] reduce(%square.927, %constant.712), dimensions={0,1}, to_apply=%region_755.846, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1461 = f32[] add(%add.1460, %reduce_sum.4523), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.928 = f32[2,1]{1,0} multiply(%while.281, %while.281), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4524 = f32[] reduce(%square.928, %constant.712), dimensions={0,1}, to_apply=%region_756.847, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1462 = f32[] add(%add.1461, %reduce_sum.4524), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.929 = f32[2,1024]{1,0} multiply(%while.282, %while.282), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4525 = f32[] reduce(%square.929, %constant.712), dimensions={0,1}, to_apply=%region_757.848, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1463 = f32[] add(%add.1462, %reduce_sum.4525), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.930 = f32[2,1024]{1,0} multiply(%while.283, %while.283), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4526 = f32[] reduce(%square.930, %constant.712), dimensions={0,1}, to_apply=%region_758.849, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1464 = f32[] add(%add.1463, %reduce_sum.4526), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.931 = f32[2,1]{1,0} multiply(%while.284, %while.284), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4527 = f32[] reduce(%square.931, %constant.712), dimensions={0,1}, to_apply=%region_759.850, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1465 = f32[] add(%add.1464, %reduce_sum.4527), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.932 = f32[2,1]{1,0} multiply(%while.285, %while.285), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4528 = f32[] reduce(%square.932, %constant.712), dimensions={0,1}, to_apply=%region_760.851, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1466 = f32[] add(%add.1465, %reduce_sum.4528), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.933 = f32[2,1024]{1,0} multiply(%while.286, %while.286), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4529 = f32[] reduce(%square.933, %constant.712), dimensions={0,1}, to_apply=%region_761.852, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1467 = f32[] add(%add.1466, %reduce_sum.4529), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.934 = f32[2,1024]{1,0} multiply(%while.287, %while.287), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4530 = f32[] reduce(%square.934, %constant.712), dimensions={0,1}, to_apply=%region_762.853, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1468 = f32[] add(%add.1467, %reduce_sum.4530), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.935 = f32[2,1]{1,0} multiply(%while.288, %while.288), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4531 = f32[] reduce(%square.935, %constant.712), dimensions={0,1}, to_apply=%region_763.854, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1469 = f32[] add(%add.1468, %reduce_sum.4531), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.936 = f32[2,1]{1,0} multiply(%while.289, %while.289), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4532 = f32[] reduce(%square.936, %constant.712), dimensions={0,1}, to_apply=%region_764.855, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1470 = f32[] add(%add.1469, %reduce_sum.4532), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.937 = f32[2,1024]{1,0} multiply(%while.290, %while.290), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4533 = f32[] reduce(%square.937, %constant.712), dimensions={0,1}, to_apply=%region_765.856, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1471 = f32[] add(%add.1470, %reduce_sum.4533), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.938 = f32[2,1]{1,0} multiply(%while.291, %while.291), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4534 = f32[] reduce(%square.938, %constant.712), dimensions={0,1}, to_apply=%region_766.857, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1472 = f32[] add(%add.1471, %reduce_sum.4534), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.939 = f32[2,1024]{1,0} multiply(%while.292, %while.292), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4535 = f32[] reduce(%square.939, %constant.712), dimensions={0,1}, to_apply=%region_767.858, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1473 = f32[] add(%add.1472, %reduce_sum.4535), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.940 = f32[2,1]{1,0} multiply(%while.293, %while.293), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4536 = f32[] reduce(%square.940, %constant.712), dimensions={0,1}, to_apply=%region_768.859, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1474 = f32[] add(%add.1473, %reduce_sum.4536), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.941 = f32[2,1024]{1,0} multiply(%while.294, %while.294), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4537 = f32[] reduce(%square.941, %constant.712), dimensions={0,1}, to_apply=%region_769.860, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1475 = f32[] add(%add.1474, %reduce_sum.4537), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.942 = f32[2,1]{1,0} multiply(%while.295, %while.295), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4538 = f32[] reduce(%square.942, %constant.712), dimensions={0,1}, to_apply=%region_770.861, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1476 = f32[] add(%add.1475, %reduce_sum.4538), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.943 = f32[2,1024]{1,0} multiply(%while.296, %while.296), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4539 = f32[] reduce(%square.943, %constant.712), dimensions={0,1}, to_apply=%region_771.862, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1477 = f32[] add(%add.1476, %reduce_sum.4539), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.944 = f32[2,1]{1,0} multiply(%while.297, %while.297), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4540 = f32[] reduce(%square.944, %constant.712), dimensions={0,1}, to_apply=%region_772.863, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1478 = f32[] add(%add.1477, %reduce_sum.4540), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.945 = f32[2,1024]{1,0} multiply(%while.298, %while.298), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4541 = f32[] reduce(%square.945, %constant.712), dimensions={0,1}, to_apply=%region_773.864, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1479 = f32[] add(%add.1478, %reduce_sum.4541), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.946 = f32[2,1]{1,0} multiply(%while.299, %while.299), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4542 = f32[] reduce(%square.946, %constant.712), dimensions={0,1}, to_apply=%region_774.865, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1480 = f32[] add(%add.1479, %reduce_sum.4542), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.947 = f32[2,1024]{1,0} multiply(%while.300, %while.300), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4543 = f32[] reduce(%square.947, %constant.712), dimensions={0,1}, to_apply=%region_775.866, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1481 = f32[] add(%add.1480, %reduce_sum.4543), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.948 = f32[2,1]{1,0} multiply(%while.301, %while.301), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4544 = f32[] reduce(%square.948, %constant.712), dimensions={0,1}, to_apply=%region_776.867, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1482 = f32[] add(%add.1481, %reduce_sum.4544), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.949 = f32[2,1024]{1,0} multiply(%while.302, %while.302), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4545 = f32[] reduce(%square.949, %constant.712), dimensions={0,1}, to_apply=%region_777.868, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1483 = f32[] add(%add.1482, %reduce_sum.4545), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.950 = f32[2,1]{1,0} multiply(%while.303, %while.303), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4546 = f32[] reduce(%square.950, %constant.712), dimensions={0,1}, to_apply=%region_778.869, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1484 = f32[] add(%add.1483, %reduce_sum.4546), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.951 = f32[2,1024]{1,0} multiply(%while.304, %while.304), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4547 = f32[] reduce(%square.951, %constant.712), dimensions={0,1}, to_apply=%region_779.870, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1485 = f32[] add(%add.1484, %reduce_sum.4547), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.952 = f32[2,1]{1,0} multiply(%while.305, %while.305), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4548 = f32[] reduce(%square.952, %constant.712), dimensions={0,1}, to_apply=%region_780.871, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1486 = f32[] add(%add.1485, %reduce_sum.4548), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.953 = f32[2,1024]{1,0} multiply(%while.306, %while.306), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4549 = f32[] reduce(%square.953, %constant.712), dimensions={0,1}, to_apply=%region_781.872, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1487 = f32[] add(%add.1486, %reduce_sum.4549), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.954 = f32[2,1]{1,0} multiply(%while.307, %while.307), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4550 = f32[] reduce(%square.954, %constant.712), dimensions={0,1}, to_apply=%region_782.873, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1488 = f32[] add(%add.1487, %reduce_sum.4550), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.955 = bf16[7168]{0} multiply(%add.1014, %add.1014), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1771 = f32[7168]{0} convert(%square.955), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4551 = f32[] reduce(%convert_element_type.1771, %constant.712), dimensions={0}, to_apply=%region_783.874, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1772 = bf16[] convert(%reduce_sum.4551), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1773 = f32[] convert(%convert_element_type.1772), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1489 = f32[] add(%add.1488, %convert_element_type.1773), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.956 = bf16[7168,1,18432]{2,1,0} multiply(%add.1015, %add.1015), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1774 = f32[7168,1,18432]{2,1,0} convert(%square.956), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4552 = f32[] reduce(%convert_element_type.1774, %constant.712), dimensions={0,1,2}, to_apply=%region_784.875, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1775 = bf16[] convert(%reduce_sum.4552), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1776 = f32[] convert(%convert_element_type.1775), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1490 = f32[] add(%add.1489, %convert_element_type.1776), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.957 = bf16[7168,1,18432]{2,1,0} multiply(%add.1016, %add.1016), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1777 = f32[7168,1,18432]{2,1,0} convert(%square.957), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4553 = f32[] reduce(%convert_element_type.1777, %constant.712), dimensions={0,1,2}, to_apply=%region_785.876, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1778 = bf16[] convert(%reduce_sum.4553), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1779 = f32[] convert(%convert_element_type.1778), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1491 = f32[] add(%add.1490, %convert_element_type.1779), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.958 = bf16[18432,1,7168]{2,1,0} multiply(%add.1017, %add.1017), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1780 = f32[18432,1,7168]{2,1,0} convert(%square.958), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4554 = f32[] reduce(%convert_element_type.1780, %constant.712), dimensions={0,1,2}, to_apply=%region_786.877, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1781 = bf16[] convert(%reduce_sum.4554), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1782 = f32[] convert(%convert_element_type.1781), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1492 = f32[] add(%add.1491, %convert_element_type.1782), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.959 = bf16[7168,1]{1,0} multiply(%add.1018, %add.1018), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1783 = f32[7168,1]{1,0} convert(%square.959), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4555 = f32[] reduce(%convert_element_type.1783, %constant.712), dimensions={0,1}, to_apply=%region_787.878, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1784 = bf16[] convert(%reduce_sum.4555), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1785 = f32[] convert(%convert_element_type.1784), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1493 = f32[] add(%add.1492, %convert_element_type.1785), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.960 = bf16[7168,1]{1,0} multiply(%add.1019, %add.1019), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1786 = f32[7168,1]{1,0} convert(%square.960), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4556 = f32[] reduce(%convert_element_type.1786, %constant.712), dimensions={0,1}, to_apply=%region_788.879, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1787 = bf16[] convert(%reduce_sum.4556), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1788 = f32[] convert(%convert_element_type.1787), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1494 = f32[] add(%add.1493, %convert_element_type.1788), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.961 = bf16[512,1]{1,0} multiply(%add.1020, %add.1020), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1789 = f32[512,1]{1,0} convert(%square.961), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4557 = f32[] reduce(%convert_element_type.1789, %constant.712), dimensions={0,1}, to_apply=%region_789.880, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1790 = bf16[] convert(%reduce_sum.4557), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1791 = f32[] convert(%convert_element_type.1790), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1495 = f32[] add(%add.1494, %convert_element_type.1791), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.962 = bf16[128,1,128,7168]{3,2,1,0} multiply(%add.1021, %add.1021), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1792 = f32[128,1,128,7168]{3,2,1,0} convert(%square.962), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4558 = f32[] reduce(%convert_element_type.1792, %constant.712), dimensions={0,1,2,3}, to_apply=%region_790.881, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1793 = bf16[] convert(%reduce_sum.4558), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1794 = f32[] convert(%convert_element_type.1793), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1496 = f32[] add(%add.1495, %convert_element_type.1794), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.963 = bf16[1536,1]{1,0} multiply(%add.1022, %add.1022), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1795 = f32[1536,1]{1,0} convert(%square.963), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4559 = f32[] reduce(%convert_element_type.1795, %constant.712), dimensions={0,1}, to_apply=%region_791.882, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1796 = bf16[] convert(%reduce_sum.4559), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1797 = f32[] convert(%convert_element_type.1796), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1497 = f32[] add(%add.1496, %convert_element_type.1797), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.964 = bf16[7168,1,576]{2,1,0} multiply(%add.1023, %add.1023), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1798 = f32[7168,1,576]{2,1,0} convert(%square.964), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4560 = f32[] reduce(%convert_element_type.1798, %constant.712), dimensions={0,1,2}, to_apply=%region_792.883, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1799 = bf16[] convert(%reduce_sum.4560), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1800 = f32[] convert(%convert_element_type.1799), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1498 = f32[] add(%add.1497, %convert_element_type.1800), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.965 = bf16[512,1,128,256]{3,2,1,0} multiply(%add.1024, %add.1024), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1801 = f32[512,1,128,256]{3,2,1,0} convert(%square.965), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4561 = f32[] reduce(%convert_element_type.1801, %constant.712), dimensions={0,1,2,3}, to_apply=%region_793.884, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1802 = bf16[] convert(%reduce_sum.4561), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1803 = f32[] convert(%convert_element_type.1802), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1499 = f32[] add(%add.1498, %convert_element_type.1803), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.966 = bf16[7168,1,1536]{2,1,0} multiply(%add.1025, %add.1025), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1804 = f32[7168,1,1536]{2,1,0} convert(%square.966), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4562 = f32[] reduce(%convert_element_type.1804, %constant.712), dimensions={0,1,2}, to_apply=%region_794.885, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1805 = bf16[] convert(%reduce_sum.4562), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1806 = f32[] convert(%convert_element_type.1805), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1500 = f32[] add(%add.1499, %convert_element_type.1806), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.967 = bf16[1536,1,128,192]{3,2,1,0} multiply(%add.1026, %add.1026), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1807 = f32[1536,1,128,192]{3,2,1,0} convert(%square.967), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4563 = f32[] reduce(%convert_element_type.1807, %constant.712), dimensions={0,1,2,3}, to_apply=%region_795.886, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1808 = bf16[] convert(%reduce_sum.4563), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1809 = f32[] convert(%convert_element_type.1808), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1501 = f32[] add(%add.1500, %convert_element_type.1809), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.968 = bf16[7168,129280]{1,0} multiply(%add.1027, %add.1027), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1810 = f32[7168,129280]{1,0} convert(%square.968), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4564 = f32[] reduce(%convert_element_type.1810, %constant.712), dimensions={0,1}, to_apply=%region_796.887, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1811 = bf16[] convert(%reduce_sum.4564), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1812 = f32[] convert(%convert_element_type.1811), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1502 = f32[] add(%add.1501, %convert_element_type.1812), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.969 = bf16[64,2]{1,0} multiply(%add.1028, %add.1028), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1813 = f32[64,2]{1,0} convert(%square.969), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4565 = f32[] reduce(%convert_element_type.1813, %constant.712), dimensions={0,1}, to_apply=%region_797.888, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1814 = bf16[] convert(%reduce_sum.4565), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1815 = f32[] convert(%convert_element_type.1814), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1503 = f32[] add(%add.1502, %convert_element_type.1815), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.970 = bf16[7168,2,64]{2,1,0} multiply(%add.1029, %add.1029), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1816 = f32[7168,2,64]{2,1,0} convert(%square.970), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4566 = f32[] reduce(%convert_element_type.1816, %constant.712), dimensions={0,1,2}, to_apply=%region_798.889, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1817 = bf16[] convert(%reduce_sum.4566), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1818 = f32[] convert(%convert_element_type.1817), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1504 = f32[] add(%add.1503, %convert_element_type.1818), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.971 = bf16[64,2]{1,0} multiply(%add.1030, %add.1030), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1819 = f32[64,2]{1,0} convert(%square.971), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4567 = f32[] reduce(%convert_element_type.1819, %constant.712), dimensions={0,1}, to_apply=%region_799.890, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1820 = bf16[] convert(%reduce_sum.4567), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1821 = f32[] convert(%convert_element_type.1820), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1505 = f32[] add(%add.1504, %convert_element_type.1821), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.972 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%add.1031, %add.1031), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1822 = f32[64,2,7168,2048]{3,2,1,0} convert(%square.972), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4568 = f32[] reduce(%convert_element_type.1822, %constant.712), dimensions={0,1,2,3}, to_apply=%region_800.891, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1823 = bf16[] convert(%reduce_sum.4568), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1824 = f32[] convert(%convert_element_type.1823), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1506 = f32[] add(%add.1505, %convert_element_type.1824), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.973 = bf16[64,2,7168,2048]{3,2,1,0} multiply(%add.1032, %add.1032), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1825 = f32[64,2,7168,2048]{3,2,1,0} convert(%square.973), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4569 = f32[] reduce(%convert_element_type.1825, %constant.712), dimensions={0,1,2,3}, to_apply=%region_801.892, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1826 = bf16[] convert(%reduce_sum.4569), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1827 = f32[] convert(%convert_element_type.1826), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1507 = f32[] add(%add.1506, %convert_element_type.1827), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.974 = bf16[64,2,2048,7168]{3,2,1,0} multiply(%add.1033, %add.1033), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1828 = f32[64,2,2048,7168]{3,2,1,0} convert(%square.974), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4570 = f32[] reduce(%convert_element_type.1828, %constant.712), dimensions={0,1,2,3}, to_apply=%region_802.893, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1829 = bf16[] convert(%reduce_sum.4570), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1830 = f32[] convert(%convert_element_type.1829), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1508 = f32[] add(%add.1507, %convert_element_type.1830), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.975 = bf16[7168,2,2048]{2,1,0} multiply(%add.1034, %add.1034), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1831 = f32[7168,2,2048]{2,1,0} convert(%square.975), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4571 = f32[] reduce(%convert_element_type.1831, %constant.712), dimensions={0,1,2}, to_apply=%region_803.894, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1832 = bf16[] convert(%reduce_sum.4571), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1833 = f32[] convert(%convert_element_type.1832), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1509 = f32[] add(%add.1508, %convert_element_type.1833), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.976 = bf16[7168,2,2048]{2,1,0} multiply(%add.1035, %add.1035), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1834 = f32[7168,2,2048]{2,1,0} convert(%square.976), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4572 = f32[] reduce(%convert_element_type.1834, %constant.712), dimensions={0,1,2}, to_apply=%region_804.895, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1835 = bf16[] convert(%reduce_sum.4572), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1836 = f32[] convert(%convert_element_type.1835), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1510 = f32[] add(%add.1509, %convert_element_type.1836), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.977 = bf16[2048,2,7168]{2,1,0} multiply(%add.1036, %add.1036), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1837 = f32[2048,2,7168]{2,1,0} convert(%square.977), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4573 = f32[] reduce(%convert_element_type.1837, %constant.712), dimensions={0,1,2}, to_apply=%region_805.896, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1838 = bf16[] convert(%reduce_sum.4573), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1839 = f32[] convert(%convert_element_type.1838), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1511 = f32[] add(%add.1510, %convert_element_type.1839), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.978 = bf16[7168,2]{1,0} multiply(%add.1037, %add.1037), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1840 = f32[7168,2]{1,0} convert(%square.978), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4574 = f32[] reduce(%convert_element_type.1840, %constant.712), dimensions={0,1}, to_apply=%region_806.897, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1841 = bf16[] convert(%reduce_sum.4574), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1842 = f32[] convert(%convert_element_type.1841), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1512 = f32[] add(%add.1511, %convert_element_type.1842), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.979 = bf16[7168,2]{1,0} multiply(%add.1038, %add.1038), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1843 = f32[7168,2]{1,0} convert(%square.979), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4575 = f32[] reduce(%convert_element_type.1843, %constant.712), dimensions={0,1}, to_apply=%region_807.898, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1844 = bf16[] convert(%reduce_sum.4575), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1845 = f32[] convert(%convert_element_type.1844), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1513 = f32[] add(%add.1512, %convert_element_type.1845), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.980 = bf16[512,2]{1,0} multiply(%add.1039, %add.1039), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1846 = f32[512,2]{1,0} convert(%square.980), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4576 = f32[] reduce(%convert_element_type.1846, %constant.712), dimensions={0,1}, to_apply=%region_808.899, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1847 = bf16[] convert(%reduce_sum.4576), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1848 = f32[] convert(%convert_element_type.1847), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1514 = f32[] add(%add.1513, %convert_element_type.1848), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.981 = bf16[128,2,128,7168]{3,2,1,0} multiply(%add.1040, %add.1040), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1849 = f32[128,2,128,7168]{3,2,1,0} convert(%square.981), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4577 = f32[] reduce(%convert_element_type.1849, %constant.712), dimensions={0,1,2,3}, to_apply=%region_809.900, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1850 = bf16[] convert(%reduce_sum.4577), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1851 = f32[] convert(%convert_element_type.1850), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1515 = f32[] add(%add.1514, %convert_element_type.1851), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.982 = bf16[1536,2]{1,0} multiply(%add.1041, %add.1041), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1852 = f32[1536,2]{1,0} convert(%square.982), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4578 = f32[] reduce(%convert_element_type.1852, %constant.712), dimensions={0,1}, to_apply=%region_810.901, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1853 = bf16[] convert(%reduce_sum.4578), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1854 = f32[] convert(%convert_element_type.1853), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1516 = f32[] add(%add.1515, %convert_element_type.1854), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.983 = bf16[7168,2,576]{2,1,0} multiply(%add.1042, %add.1042), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1855 = f32[7168,2,576]{2,1,0} convert(%square.983), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4579 = f32[] reduce(%convert_element_type.1855, %constant.712), dimensions={0,1,2}, to_apply=%region_811.902, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1856 = bf16[] convert(%reduce_sum.4579), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1857 = f32[] convert(%convert_element_type.1856), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1517 = f32[] add(%add.1516, %convert_element_type.1857), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.984 = bf16[512,2,128,256]{3,2,1,0} multiply(%add.1043, %add.1043), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1858 = f32[512,2,128,256]{3,2,1,0} convert(%square.984), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4580 = f32[] reduce(%convert_element_type.1858, %constant.712), dimensions={0,1,2,3}, to_apply=%region_812.903, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1859 = bf16[] convert(%reduce_sum.4580), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1860 = f32[] convert(%convert_element_type.1859), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1518 = f32[] add(%add.1517, %convert_element_type.1860), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.985 = bf16[7168,2,1536]{2,1,0} multiply(%add.1044, %add.1044), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1861 = f32[7168,2,1536]{2,1,0} convert(%square.985), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4581 = f32[] reduce(%convert_element_type.1861, %constant.712), dimensions={0,1,2}, to_apply=%region_813.904, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1862 = bf16[] convert(%reduce_sum.4581), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1863 = f32[] convert(%convert_element_type.1862), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1519 = f32[] add(%add.1518, %convert_element_type.1863), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.986 = bf16[1536,2,128,192]{3,2,1,0} multiply(%add.1045, %add.1045), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1864 = f32[1536,2,128,192]{3,2,1,0} convert(%square.986), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4582 = f32[] reduce(%convert_element_type.1864, %constant.712), dimensions={0,1,2,3}, to_apply=%region_814.905, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1865 = bf16[] convert(%reduce_sum.4582), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1866 = f32[] convert(%convert_element_type.1865), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1520 = f32[] add(%add.1519, %convert_element_type.1866), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.987 = bf16[129280,7168]{1,0} multiply(%add.1046, %add.1046), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1867 = f32[129280,7168]{1,0} convert(%square.987), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4583 = f32[] reduce(%convert_element_type.1867, %constant.712), dimensions={0,1}, to_apply=%region_815.906, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1868 = bf16[] convert(%reduce_sum.4583), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1869 = f32[] convert(%convert_element_type.1868), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1521 = f32[] add(%add.1520, %convert_element_type.1869), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %sqrt.73 = f32[] sqrt(%add.1521), metadata={op_name="jit(train_step)/sqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=9 source_end_column=105}
  %reshape.529 = f32[] reshape(%sqrt.73)
  %square.671 = f32[1,1024]{1,0} multiply(%while.324, %while.324), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4266 = f32[] reduce(%square.671, %constant.712), dimensions={0,1}, to_apply=%region_498.589, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %square.672 = f32[1,1]{1,0} multiply(%while.325, %while.325), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4267 = f32[] reduce(%square.672, %constant.712), dimensions={0,1}, to_apply=%region_499.590, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1206 = f32[] add(%reduce_sum.4266, %reduce_sum.4267), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.673 = f32[1,1024]{1,0} multiply(%while.326, %while.326), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4268 = f32[] reduce(%square.673, %constant.712), dimensions={0,1}, to_apply=%region_500.591, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1207 = f32[] add(%add.1206, %reduce_sum.4268), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.674 = f32[1,1]{1,0} multiply(%while.327, %while.327), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4269 = f32[] reduce(%square.674, %constant.712), dimensions={0,1}, to_apply=%region_501.592, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1208 = f32[] add(%add.1207, %reduce_sum.4269), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.675 = f32[1,1024]{1,0} multiply(%while.328, %while.328), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4270 = f32[] reduce(%square.675, %constant.712), dimensions={0,1}, to_apply=%region_502.593, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1209 = f32[] add(%add.1208, %reduce_sum.4270), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.676 = f32[1,1]{1,0} multiply(%while.329, %while.329), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4271 = f32[] reduce(%square.676, %constant.712), dimensions={0,1}, to_apply=%region_503.594, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1210 = f32[] add(%add.1209, %reduce_sum.4271), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.677 = f32[1,1024]{1,0} multiply(%while.330, %while.330), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4272 = f32[] reduce(%square.677, %constant.712), dimensions={0,1}, to_apply=%region_504.595, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1211 = f32[] add(%add.1210, %reduce_sum.4272), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.678 = f32[1,1]{1,0} multiply(%while.331, %while.331), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4273 = f32[] reduce(%square.678, %constant.712), dimensions={0,1}, to_apply=%region_505.596, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1212 = f32[] add(%add.1211, %reduce_sum.4273), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.679 = f32[1,1024]{1,0} multiply(%while.332, %while.332), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4274 = f32[] reduce(%square.679, %constant.712), dimensions={0,1}, to_apply=%region_506.597, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1213 = f32[] add(%add.1212, %reduce_sum.4274), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.680 = f32[1,1]{1,0} multiply(%while.333, %while.333), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4275 = f32[] reduce(%square.680, %constant.712), dimensions={0,1}, to_apply=%region_507.598, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1214 = f32[] add(%add.1213, %reduce_sum.4275), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.681 = f32[1,1024]{1,0} multiply(%while.334, %while.334), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4276 = f32[] reduce(%square.681, %constant.712), dimensions={0,1}, to_apply=%region_508.599, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1215 = f32[] add(%add.1214, %reduce_sum.4276), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.682 = f32[1,1]{1,0} multiply(%while.335, %while.335), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4277 = f32[] reduce(%square.682, %constant.712), dimensions={0,1}, to_apply=%region_509.600, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1216 = f32[] add(%add.1215, %reduce_sum.4277), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.683 = f32[1,1024]{1,0} multiply(%while.336, %while.336), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4278 = f32[] reduce(%square.683, %constant.712), dimensions={0,1}, to_apply=%region_510.601, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1217 = f32[] add(%add.1216, %reduce_sum.4278), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.684 = f32[1,1]{1,0} multiply(%while.337, %while.337), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4279 = f32[] reduce(%square.684, %constant.712), dimensions={0,1}, to_apply=%region_511.602, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1218 = f32[] add(%add.1217, %reduce_sum.4279), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.685 = f32[1,1024]{1,0} multiply(%while.338, %while.338), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4280 = f32[] reduce(%square.685, %constant.712), dimensions={0,1}, to_apply=%region_512.603, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1219 = f32[] add(%add.1218, %reduce_sum.4280), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.686 = f32[1,1]{1,0} multiply(%while.339, %while.339), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4281 = f32[] reduce(%square.686, %constant.712), dimensions={0,1}, to_apply=%region_513.604, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1220 = f32[] add(%add.1219, %reduce_sum.4281), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.687 = f32[1,1024]{1,0} multiply(%while.340, %while.340), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4282 = f32[] reduce(%square.687, %constant.712), dimensions={0,1}, to_apply=%region_514.605, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1221 = f32[] add(%add.1220, %reduce_sum.4282), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.688 = f32[1,1]{1,0} multiply(%while.341, %while.341), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4283 = f32[] reduce(%square.688, %constant.712), dimensions={0,1}, to_apply=%region_515.606, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1222 = f32[] add(%add.1221, %reduce_sum.4283), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.689 = f32[1,1024]{1,0} multiply(%while.342, %while.342), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4284 = f32[] reduce(%square.689, %constant.712), dimensions={0,1}, to_apply=%region_516.607, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1223 = f32[] add(%add.1222, %reduce_sum.4284), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.690 = f32[1,1]{1,0} multiply(%while.343, %while.343), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4285 = f32[] reduce(%square.690, %constant.712), dimensions={0,1}, to_apply=%region_517.608, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1224 = f32[] add(%add.1223, %reduce_sum.4285), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.691 = f32[1,1024]{1,0} multiply(%while.344, %while.344), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4286 = f32[] reduce(%square.691, %constant.712), dimensions={0,1}, to_apply=%region_518.609, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1225 = f32[] add(%add.1224, %reduce_sum.4286), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.692 = f32[1,1024]{1,0} multiply(%while.345, %while.345), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4287 = f32[] reduce(%square.692, %constant.712), dimensions={0,1}, to_apply=%region_519.610, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1226 = f32[] add(%add.1225, %reduce_sum.4287), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.693 = f32[1,1]{1,0} multiply(%while.346, %while.346), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4288 = f32[] reduce(%square.693, %constant.712), dimensions={0,1}, to_apply=%region_520.611, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1227 = f32[] add(%add.1226, %reduce_sum.4288), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.694 = f32[1,1]{1,0} multiply(%while.347, %while.347), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4289 = f32[] reduce(%square.694, %constant.712), dimensions={0,1}, to_apply=%region_521.612, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1228 = f32[] add(%add.1227, %reduce_sum.4289), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.695 = f32[1,1024]{1,0} multiply(%while.348, %while.348), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4290 = f32[] reduce(%square.695, %constant.712), dimensions={0,1}, to_apply=%region_522.613, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1229 = f32[] add(%add.1228, %reduce_sum.4290), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.696 = f32[1,1024]{1,0} multiply(%while.349, %while.349), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4291 = f32[] reduce(%square.696, %constant.712), dimensions={0,1}, to_apply=%region_523.614, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1230 = f32[] add(%add.1229, %reduce_sum.4291), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.697 = f32[1,1]{1,0} multiply(%while.350, %while.350), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4292 = f32[] reduce(%square.697, %constant.712), dimensions={0,1}, to_apply=%region_524.615, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1231 = f32[] add(%add.1230, %reduce_sum.4292), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.698 = f32[1,1]{1,0} multiply(%while.351, %while.351), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4293 = f32[] reduce(%square.698, %constant.712), dimensions={0,1}, to_apply=%region_525.616, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1232 = f32[] add(%add.1231, %reduce_sum.4293), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.699 = f32[1,1024]{1,0} multiply(%while.352, %while.352), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4294 = f32[] reduce(%square.699, %constant.712), dimensions={0,1}, to_apply=%region_526.617, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1233 = f32[] add(%add.1232, %reduce_sum.4294), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.700 = f32[1,1]{1,0} multiply(%while.353, %while.353), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4295 = f32[] reduce(%square.700, %constant.712), dimensions={0,1}, to_apply=%region_527.618, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1234 = f32[] add(%add.1233, %reduce_sum.4295), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.701 = f32[1,1024]{1,0} multiply(%while.354, %while.354), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4296 = f32[] reduce(%square.701, %constant.712), dimensions={0,1}, to_apply=%region_528.619, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1235 = f32[] add(%add.1234, %reduce_sum.4296), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.702 = f32[1,1]{1,0} multiply(%while.355, %while.355), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4297 = f32[] reduce(%square.702, %constant.712), dimensions={0,1}, to_apply=%region_529.620, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1236 = f32[] add(%add.1235, %reduce_sum.4297), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.703 = f32[1,1024]{1,0} multiply(%while.356, %while.356), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4298 = f32[] reduce(%square.703, %constant.712), dimensions={0,1}, to_apply=%region_530.621, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1237 = f32[] add(%add.1236, %reduce_sum.4298), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.704 = f32[1,1]{1,0} multiply(%while.357, %while.357), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4299 = f32[] reduce(%square.704, %constant.712), dimensions={0,1}, to_apply=%region_531.622, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1238 = f32[] add(%add.1237, %reduce_sum.4299), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.705 = f32[1,1024]{1,0} multiply(%while.358, %while.358), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4300 = f32[] reduce(%square.705, %constant.712), dimensions={0,1}, to_apply=%region_532.623, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1239 = f32[] add(%add.1238, %reduce_sum.4300), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.706 = f32[1,1]{1,0} multiply(%while.359, %while.359), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4301 = f32[] reduce(%square.706, %constant.712), dimensions={0,1}, to_apply=%region_533.624, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1240 = f32[] add(%add.1239, %reduce_sum.4301), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.707 = f32[1,1024]{1,0} multiply(%while.360, %while.360), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4302 = f32[] reduce(%square.707, %constant.712), dimensions={0,1}, to_apply=%region_534.625, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1241 = f32[] add(%add.1240, %reduce_sum.4302), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.708 = f32[1,1]{1,0} multiply(%while.361, %while.361), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4303 = f32[] reduce(%square.708, %constant.712), dimensions={0,1}, to_apply=%region_535.626, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1242 = f32[] add(%add.1241, %reduce_sum.4303), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.709 = f32[1,1024]{1,0} multiply(%while.362, %while.362), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4304 = f32[] reduce(%square.709, %constant.712), dimensions={0,1}, to_apply=%region_536.627, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1243 = f32[] add(%add.1242, %reduce_sum.4304), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.710 = f32[1,1]{1,0} multiply(%while.363, %while.363), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4305 = f32[] reduce(%square.710, %constant.712), dimensions={0,1}, to_apply=%region_537.628, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1244 = f32[] add(%add.1243, %reduce_sum.4305), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.711 = f32[1,1024]{1,0} multiply(%while.364, %while.364), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4306 = f32[] reduce(%square.711, %constant.712), dimensions={0,1}, to_apply=%region_538.629, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1245 = f32[] add(%add.1244, %reduce_sum.4306), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.712 = f32[1,1]{1,0} multiply(%while.365, %while.365), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4307 = f32[] reduce(%square.712, %constant.712), dimensions={0,1}, to_apply=%region_539.630, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1246 = f32[] add(%add.1245, %reduce_sum.4307), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.713 = f32[1,1024]{1,0} multiply(%while.366, %while.366), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4308 = f32[] reduce(%square.713, %constant.712), dimensions={0,1}, to_apply=%region_540.631, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1247 = f32[] add(%add.1246, %reduce_sum.4308), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.714 = f32[1,1]{1,0} multiply(%while.367, %while.367), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4309 = f32[] reduce(%square.714, %constant.712), dimensions={0,1}, to_apply=%region_541.632, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1248 = f32[] add(%add.1247, %reduce_sum.4309), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.715 = f32[1,1024]{1,0} multiply(%while.368, %while.368), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4310 = f32[] reduce(%square.715, %constant.712), dimensions={0,1}, to_apply=%region_542.633, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1249 = f32[] add(%add.1248, %reduce_sum.4310), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.716 = f32[1,1]{1,0} multiply(%while.369, %while.369), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4311 = f32[] reduce(%square.716, %constant.712), dimensions={0,1}, to_apply=%region_543.634, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1250 = f32[] add(%add.1249, %reduce_sum.4311), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.717 = f32[2,1024]{1,0} multiply(%while.228, %while.228), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4312 = f32[] reduce(%square.717, %constant.712), dimensions={0,1}, to_apply=%region_544.635, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1251 = f32[] add(%add.1250, %reduce_sum.4312), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.718 = f32[2,1]{1,0} multiply(%while.229, %while.229), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4313 = f32[] reduce(%square.718, %constant.712), dimensions={0,1}, to_apply=%region_545.636, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1252 = f32[] add(%add.1251, %reduce_sum.4313), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.719 = f32[2,1024]{1,0} multiply(%while.230, %while.230), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4314 = f32[] reduce(%square.719, %constant.712), dimensions={0,1}, to_apply=%region_546.637, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1253 = f32[] add(%add.1252, %reduce_sum.4314), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.720 = f32[2,1]{1,0} multiply(%while.231, %while.231), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4315 = f32[] reduce(%square.720, %constant.712), dimensions={0,1}, to_apply=%region_547.638, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1254 = f32[] add(%add.1253, %reduce_sum.4315), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.721 = f32[2,1024]{1,0} multiply(%while.232, %while.232), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4316 = f32[] reduce(%square.721, %constant.712), dimensions={0,1}, to_apply=%region_548.639, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1255 = f32[] add(%add.1254, %reduce_sum.4316), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.722 = f32[2,1]{1,0} multiply(%while.233, %while.233), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4317 = f32[] reduce(%square.722, %constant.712), dimensions={0,1}, to_apply=%region_549.640, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1256 = f32[] add(%add.1255, %reduce_sum.4317), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.723 = f32[2,1024]{1,0} multiply(%while.234, %while.234), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4318 = f32[] reduce(%square.723, %constant.712), dimensions={0,1}, to_apply=%region_550.641, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1257 = f32[] add(%add.1256, %reduce_sum.4318), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.724 = f32[2,1]{1,0} multiply(%while.235, %while.235), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4319 = f32[] reduce(%square.724, %constant.712), dimensions={0,1}, to_apply=%region_551.642, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1258 = f32[] add(%add.1257, %reduce_sum.4319), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.725 = f32[2,1024]{1,0} multiply(%while.236, %while.236), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4320 = f32[] reduce(%square.725, %constant.712), dimensions={0,1}, to_apply=%region_552.643, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1259 = f32[] add(%add.1258, %reduce_sum.4320), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.726 = f32[2,1]{1,0} multiply(%while.237, %while.237), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4321 = f32[] reduce(%square.726, %constant.712), dimensions={0,1}, to_apply=%region_553.644, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1260 = f32[] add(%add.1259, %reduce_sum.4321), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.727 = f32[2,1024]{1,0} multiply(%while.238, %while.238), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4322 = f32[] reduce(%square.727, %constant.712), dimensions={0,1}, to_apply=%region_554.645, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1261 = f32[] add(%add.1260, %reduce_sum.4322), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.728 = f32[2,1]{1,0} multiply(%while.239, %while.239), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4323 = f32[] reduce(%square.728, %constant.712), dimensions={0,1}, to_apply=%region_555.646, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1262 = f32[] add(%add.1261, %reduce_sum.4323), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.729 = f32[2,1024]{1,0} multiply(%while.240, %while.240), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4324 = f32[] reduce(%square.729, %constant.712), dimensions={0,1}, to_apply=%region_556.647, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1263 = f32[] add(%add.1262, %reduce_sum.4324), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.730 = f32[2,1]{1,0} multiply(%while.241, %while.241), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4325 = f32[] reduce(%square.730, %constant.712), dimensions={0,1}, to_apply=%region_557.648, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1264 = f32[] add(%add.1263, %reduce_sum.4325), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.731 = f32[2,1024]{1,0} multiply(%while.242, %while.242), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4326 = f32[] reduce(%square.731, %constant.712), dimensions={0,1}, to_apply=%region_558.649, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1265 = f32[] add(%add.1264, %reduce_sum.4326), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.732 = f32[2,1024]{1,0} multiply(%while.243, %while.243), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4327 = f32[] reduce(%square.732, %constant.712), dimensions={0,1}, to_apply=%region_559.650, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1266 = f32[] add(%add.1265, %reduce_sum.4327), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.733 = f32[2,1]{1,0} multiply(%while.244, %while.244), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4328 = f32[] reduce(%square.733, %constant.712), dimensions={0,1}, to_apply=%region_560.651, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1267 = f32[] add(%add.1266, %reduce_sum.4328), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.734 = f32[2,1]{1,0} multiply(%while.245, %while.245), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4329 = f32[] reduce(%square.734, %constant.712), dimensions={0,1}, to_apply=%region_561.652, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1268 = f32[] add(%add.1267, %reduce_sum.4329), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.735 = f32[2,1024]{1,0} multiply(%while.246, %while.246), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4330 = f32[] reduce(%square.735, %constant.712), dimensions={0,1}, to_apply=%region_562.653, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1269 = f32[] add(%add.1268, %reduce_sum.4330), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.736 = f32[2,1024]{1,0} multiply(%while.247, %while.247), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4331 = f32[] reduce(%square.736, %constant.712), dimensions={0,1}, to_apply=%region_563.654, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1270 = f32[] add(%add.1269, %reduce_sum.4331), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.737 = f32[2,1]{1,0} multiply(%while.248, %while.248), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4332 = f32[] reduce(%square.737, %constant.712), dimensions={0,1}, to_apply=%region_564.655, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1271 = f32[] add(%add.1270, %reduce_sum.4332), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.738 = f32[2,1]{1,0} multiply(%while.249, %while.249), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4333 = f32[] reduce(%square.738, %constant.712), dimensions={0,1}, to_apply=%region_565.656, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1272 = f32[] add(%add.1271, %reduce_sum.4333), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.739 = f32[2,1024]{1,0} multiply(%while.250, %while.250), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4334 = f32[] reduce(%square.739, %constant.712), dimensions={0,1}, to_apply=%region_566.657, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1273 = f32[] add(%add.1272, %reduce_sum.4334), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.740 = f32[2,1]{1,0} multiply(%while.251, %while.251), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4335 = f32[] reduce(%square.740, %constant.712), dimensions={0,1}, to_apply=%region_567.658, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1274 = f32[] add(%add.1273, %reduce_sum.4335), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.741 = f32[2,1024]{1,0} multiply(%while.252, %while.252), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4336 = f32[] reduce(%square.741, %constant.712), dimensions={0,1}, to_apply=%region_568.659, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1275 = f32[] add(%add.1274, %reduce_sum.4336), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.742 = f32[2,1]{1,0} multiply(%while.253, %while.253), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4337 = f32[] reduce(%square.742, %constant.712), dimensions={0,1}, to_apply=%region_569.660, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1276 = f32[] add(%add.1275, %reduce_sum.4337), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.743 = f32[2,1024]{1,0} multiply(%while.254, %while.254), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4338 = f32[] reduce(%square.743, %constant.712), dimensions={0,1}, to_apply=%region_570.661, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1277 = f32[] add(%add.1276, %reduce_sum.4338), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.744 = f32[2,1]{1,0} multiply(%while.255, %while.255), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4339 = f32[] reduce(%square.744, %constant.712), dimensions={0,1}, to_apply=%region_571.662, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1278 = f32[] add(%add.1277, %reduce_sum.4339), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.745 = f32[2,1024]{1,0} multiply(%while.256, %while.256), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4340 = f32[] reduce(%square.745, %constant.712), dimensions={0,1}, to_apply=%region_572.663, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1279 = f32[] add(%add.1278, %reduce_sum.4340), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.746 = f32[2,1]{1,0} multiply(%while.257, %while.257), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4341 = f32[] reduce(%square.746, %constant.712), dimensions={0,1}, to_apply=%region_573.664, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1280 = f32[] add(%add.1279, %reduce_sum.4341), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.747 = f32[2,1024]{1,0} multiply(%while.258, %while.258), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4342 = f32[] reduce(%square.747, %constant.712), dimensions={0,1}, to_apply=%region_574.665, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1281 = f32[] add(%add.1280, %reduce_sum.4342), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.748 = f32[2,1]{1,0} multiply(%while.259, %while.259), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4343 = f32[] reduce(%square.748, %constant.712), dimensions={0,1}, to_apply=%region_575.666, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1282 = f32[] add(%add.1281, %reduce_sum.4343), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.749 = f32[2,1024]{1,0} multiply(%while.260, %while.260), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4344 = f32[] reduce(%square.749, %constant.712), dimensions={0,1}, to_apply=%region_576.667, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1283 = f32[] add(%add.1282, %reduce_sum.4344), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.750 = f32[2,1]{1,0} multiply(%while.261, %while.261), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4345 = f32[] reduce(%square.750, %constant.712), dimensions={0,1}, to_apply=%region_577.668, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1284 = f32[] add(%add.1283, %reduce_sum.4345), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.751 = f32[2,1024]{1,0} multiply(%while.262, %while.262), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4346 = f32[] reduce(%square.751, %constant.712), dimensions={0,1}, to_apply=%region_578.669, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1285 = f32[] add(%add.1284, %reduce_sum.4346), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.752 = f32[2,1]{1,0} multiply(%while.263, %while.263), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4347 = f32[] reduce(%square.752, %constant.712), dimensions={0,1}, to_apply=%region_579.670, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1286 = f32[] add(%add.1285, %reduce_sum.4347), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.753 = f32[2,1024]{1,0} multiply(%while.264, %while.264), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4348 = f32[] reduce(%square.753, %constant.712), dimensions={0,1}, to_apply=%region_580.671, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1287 = f32[] add(%add.1286, %reduce_sum.4348), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.754 = f32[2,1]{1,0} multiply(%while.265, %while.265), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4349 = f32[] reduce(%square.754, %constant.712), dimensions={0,1}, to_apply=%region_581.672, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1288 = f32[] add(%add.1287, %reduce_sum.4349), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.755 = f32[2,1024]{1,0} multiply(%while.266, %while.266), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4350 = f32[] reduce(%square.755, %constant.712), dimensions={0,1}, to_apply=%region_582.673, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1289 = f32[] add(%add.1288, %reduce_sum.4350), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.756 = f32[2,1]{1,0} multiply(%while.267, %while.267), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4351 = f32[] reduce(%square.756, %constant.712), dimensions={0,1}, to_apply=%region_583.674, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1290 = f32[] add(%add.1289, %reduce_sum.4351), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.757 = f32[2,1024]{1,0} multiply(%while.268, %while.268), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4352 = f32[] reduce(%square.757, %constant.712), dimensions={0,1}, to_apply=%region_584.675, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1291 = f32[] add(%add.1290, %reduce_sum.4352), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.758 = f32[2,1]{1,0} multiply(%while.269, %while.269), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4353 = f32[] reduce(%square.758, %constant.712), dimensions={0,1}, to_apply=%region_585.676, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1292 = f32[] add(%add.1291, %reduce_sum.4353), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.759 = f32[2,1024]{1,0} multiply(%while.270, %while.270), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4354 = f32[] reduce(%square.759, %constant.712), dimensions={0,1}, to_apply=%region_586.677, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1293 = f32[] add(%add.1292, %reduce_sum.4354), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.760 = f32[2,1]{1,0} multiply(%while.271, %while.271), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4355 = f32[] reduce(%square.760, %constant.712), dimensions={0,1}, to_apply=%region_587.678, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1294 = f32[] add(%add.1293, %reduce_sum.4355), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.761 = f32[2,1024]{1,0} multiply(%while.272, %while.272), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4356 = f32[] reduce(%square.761, %constant.712), dimensions={0,1}, to_apply=%region_588.679, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1295 = f32[] add(%add.1294, %reduce_sum.4356), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.762 = f32[2,1]{1,0} multiply(%while.273, %while.273), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4357 = f32[] reduce(%square.762, %constant.712), dimensions={0,1}, to_apply=%region_589.680, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1296 = f32[] add(%add.1295, %reduce_sum.4357), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.763 = f32[2,1024]{1,0} multiply(%while.274, %while.274), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4358 = f32[] reduce(%square.763, %constant.712), dimensions={0,1}, to_apply=%region_590.681, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1297 = f32[] add(%add.1296, %reduce_sum.4358), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.764 = f32[2,1]{1,0} multiply(%while.275, %while.275), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4359 = f32[] reduce(%square.764, %constant.712), dimensions={0,1}, to_apply=%region_591.682, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1298 = f32[] add(%add.1297, %reduce_sum.4359), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.765 = f32[2,1024]{1,0} multiply(%while.276, %while.276), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4360 = f32[] reduce(%square.765, %constant.712), dimensions={0,1}, to_apply=%region_592.683, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1299 = f32[] add(%add.1298, %reduce_sum.4360), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.766 = f32[2,1]{1,0} multiply(%while.277, %while.277), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4361 = f32[] reduce(%square.766, %constant.712), dimensions={0,1}, to_apply=%region_593.684, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1300 = f32[] add(%add.1299, %reduce_sum.4361), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.767 = f32[2,1024]{1,0} multiply(%while.278, %while.278), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4362 = f32[] reduce(%square.767, %constant.712), dimensions={0,1}, to_apply=%region_594.685, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1301 = f32[] add(%add.1300, %reduce_sum.4362), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.768 = f32[2,1]{1,0} multiply(%while.279, %while.279), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4363 = f32[] reduce(%square.768, %constant.712), dimensions={0,1}, to_apply=%region_595.686, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1302 = f32[] add(%add.1301, %reduce_sum.4363), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.769 = f32[2,1024]{1,0} multiply(%while.280, %while.280), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4364 = f32[] reduce(%square.769, %constant.712), dimensions={0,1}, to_apply=%region_596.687, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1303 = f32[] add(%add.1302, %reduce_sum.4364), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.770 = f32[2,1]{1,0} multiply(%while.281, %while.281), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4365 = f32[] reduce(%square.770, %constant.712), dimensions={0,1}, to_apply=%region_597.688, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1304 = f32[] add(%add.1303, %reduce_sum.4365), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.771 = f32[2,1024]{1,0} multiply(%while.282, %while.282), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4366 = f32[] reduce(%square.771, %constant.712), dimensions={0,1}, to_apply=%region_598.689, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1305 = f32[] add(%add.1304, %reduce_sum.4366), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.772 = f32[2,1024]{1,0} multiply(%while.283, %while.283), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4367 = f32[] reduce(%square.772, %constant.712), dimensions={0,1}, to_apply=%region_599.690, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1306 = f32[] add(%add.1305, %reduce_sum.4367), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.773 = f32[2,1]{1,0} multiply(%while.284, %while.284), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4368 = f32[] reduce(%square.773, %constant.712), dimensions={0,1}, to_apply=%region_600.691, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1307 = f32[] add(%add.1306, %reduce_sum.4368), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.774 = f32[2,1]{1,0} multiply(%while.285, %while.285), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4369 = f32[] reduce(%square.774, %constant.712), dimensions={0,1}, to_apply=%region_601.692, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1308 = f32[] add(%add.1307, %reduce_sum.4369), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.775 = f32[2,1024]{1,0} multiply(%while.286, %while.286), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4370 = f32[] reduce(%square.775, %constant.712), dimensions={0,1}, to_apply=%region_602.693, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1309 = f32[] add(%add.1308, %reduce_sum.4370), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.776 = f32[2,1024]{1,0} multiply(%while.287, %while.287), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4371 = f32[] reduce(%square.776, %constant.712), dimensions={0,1}, to_apply=%region_603.694, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1310 = f32[] add(%add.1309, %reduce_sum.4371), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.777 = f32[2,1]{1,0} multiply(%while.288, %while.288), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4372 = f32[] reduce(%square.777, %constant.712), dimensions={0,1}, to_apply=%region_604.695, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1311 = f32[] add(%add.1310, %reduce_sum.4372), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.778 = f32[2,1]{1,0} multiply(%while.289, %while.289), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4373 = f32[] reduce(%square.778, %constant.712), dimensions={0,1}, to_apply=%region_605.696, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1312 = f32[] add(%add.1311, %reduce_sum.4373), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.779 = f32[2,1024]{1,0} multiply(%while.290, %while.290), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4374 = f32[] reduce(%square.779, %constant.712), dimensions={0,1}, to_apply=%region_606.697, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1313 = f32[] add(%add.1312, %reduce_sum.4374), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.780 = f32[2,1]{1,0} multiply(%while.291, %while.291), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4375 = f32[] reduce(%square.780, %constant.712), dimensions={0,1}, to_apply=%region_607.698, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1314 = f32[] add(%add.1313, %reduce_sum.4375), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.781 = f32[2,1024]{1,0} multiply(%while.292, %while.292), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4376 = f32[] reduce(%square.781, %constant.712), dimensions={0,1}, to_apply=%region_608.699, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1315 = f32[] add(%add.1314, %reduce_sum.4376), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.782 = f32[2,1]{1,0} multiply(%while.293, %while.293), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4377 = f32[] reduce(%square.782, %constant.712), dimensions={0,1}, to_apply=%region_609.700, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1316 = f32[] add(%add.1315, %reduce_sum.4377), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.783 = f32[2,1024]{1,0} multiply(%while.294, %while.294), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4378 = f32[] reduce(%square.783, %constant.712), dimensions={0,1}, to_apply=%region_610.701, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1317 = f32[] add(%add.1316, %reduce_sum.4378), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.784 = f32[2,1]{1,0} multiply(%while.295, %while.295), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4379 = f32[] reduce(%square.784, %constant.712), dimensions={0,1}, to_apply=%region_611.702, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1318 = f32[] add(%add.1317, %reduce_sum.4379), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.785 = f32[2,1024]{1,0} multiply(%while.296, %while.296), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4380 = f32[] reduce(%square.785, %constant.712), dimensions={0,1}, to_apply=%region_612.703, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1319 = f32[] add(%add.1318, %reduce_sum.4380), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.786 = f32[2,1]{1,0} multiply(%while.297, %while.297), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4381 = f32[] reduce(%square.786, %constant.712), dimensions={0,1}, to_apply=%region_613.704, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1320 = f32[] add(%add.1319, %reduce_sum.4381), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.787 = f32[2,1024]{1,0} multiply(%while.298, %while.298), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4382 = f32[] reduce(%square.787, %constant.712), dimensions={0,1}, to_apply=%region_614.705, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1321 = f32[] add(%add.1320, %reduce_sum.4382), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.788 = f32[2,1]{1,0} multiply(%while.299, %while.299), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4383 = f32[] reduce(%square.788, %constant.712), dimensions={0,1}, to_apply=%region_615.706, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1322 = f32[] add(%add.1321, %reduce_sum.4383), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.789 = f32[2,1024]{1,0} multiply(%while.300, %while.300), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4384 = f32[] reduce(%square.789, %constant.712), dimensions={0,1}, to_apply=%region_616.707, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1323 = f32[] add(%add.1322, %reduce_sum.4384), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.790 = f32[2,1]{1,0} multiply(%while.301, %while.301), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4385 = f32[] reduce(%square.790, %constant.712), dimensions={0,1}, to_apply=%region_617.708, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1324 = f32[] add(%add.1323, %reduce_sum.4385), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.791 = f32[2,1024]{1,0} multiply(%while.302, %while.302), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4386 = f32[] reduce(%square.791, %constant.712), dimensions={0,1}, to_apply=%region_618.709, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1325 = f32[] add(%add.1324, %reduce_sum.4386), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.792 = f32[2,1]{1,0} multiply(%while.303, %while.303), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4387 = f32[] reduce(%square.792, %constant.712), dimensions={0,1}, to_apply=%region_619.710, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1326 = f32[] add(%add.1325, %reduce_sum.4387), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.793 = f32[2,1024]{1,0} multiply(%while.304, %while.304), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4388 = f32[] reduce(%square.793, %constant.712), dimensions={0,1}, to_apply=%region_620.711, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1327 = f32[] add(%add.1326, %reduce_sum.4388), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.794 = f32[2,1]{1,0} multiply(%while.305, %while.305), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4389 = f32[] reduce(%square.794, %constant.712), dimensions={0,1}, to_apply=%region_621.712, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1328 = f32[] add(%add.1327, %reduce_sum.4389), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.795 = f32[2,1024]{1,0} multiply(%while.306, %while.306), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4390 = f32[] reduce(%square.795, %constant.712), dimensions={0,1}, to_apply=%region_622.713, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1329 = f32[] add(%add.1328, %reduce_sum.4390), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.796 = f32[2,1]{1,0} multiply(%while.307, %while.307), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %reduce_sum.4391 = f32[] reduce(%square.796, %constant.712), dimensions={0,1}, to_apply=%region_623.714, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %add.1330 = f32[] add(%add.1329, %reduce_sum.4391), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.797 = bf16[7168]{0} multiply(%reduce_sum.4071, %reduce_sum.4071), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1673 = f32[7168]{0} convert(%square.797), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4392 = f32[] reduce(%convert_element_type.1673, %constant.712), dimensions={0}, to_apply=%region_624.715, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1674 = bf16[] convert(%reduce_sum.4392), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1675 = f32[] convert(%convert_element_type.1674), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1331 = f32[] add(%add.1330, %convert_element_type.1675), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.798 = bf16[7168,1,18432]{2,1,0} multiply(%transpose.167, %transpose.167), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1676 = f32[7168,1,18432]{2,1,0} convert(%square.798), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4393 = f32[] reduce(%convert_element_type.1676, %constant.712), dimensions={0,1,2}, to_apply=%region_625.716, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1677 = bf16[] convert(%reduce_sum.4393), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1678 = f32[] convert(%convert_element_type.1677), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1332 = f32[] add(%add.1331, %convert_element_type.1678), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.799 = bf16[7168,1,18432]{2,1,0} multiply(%transpose.166, %transpose.166), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1679 = f32[7168,1,18432]{2,1,0} convert(%square.799), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4394 = f32[] reduce(%convert_element_type.1679, %constant.712), dimensions={0,1,2}, to_apply=%region_626.717, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1680 = bf16[] convert(%reduce_sum.4394), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1681 = f32[] convert(%convert_element_type.1680), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1333 = f32[] add(%add.1332, %convert_element_type.1681), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.800 = bf16[18432,1,7168]{2,1,0} multiply(%transpose.165, %transpose.165), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1682 = f32[18432,1,7168]{2,1,0} convert(%square.800), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4395 = f32[] reduce(%convert_element_type.1682, %constant.712), dimensions={0,1,2}, to_apply=%region_627.718, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1683 = bf16[] convert(%reduce_sum.4395), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1684 = f32[] convert(%convert_element_type.1683), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1334 = f32[] add(%add.1333, %convert_element_type.1684), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.801 = bf16[7168,1]{1,0} multiply(%transpose.164, %transpose.164), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1685 = f32[7168,1]{1,0} convert(%square.801), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4396 = f32[] reduce(%convert_element_type.1685, %constant.712), dimensions={0,1}, to_apply=%region_628.719, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1686 = bf16[] convert(%reduce_sum.4396), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1687 = f32[] convert(%convert_element_type.1686), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1335 = f32[] add(%add.1334, %convert_element_type.1687), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.802 = bf16[7168,1]{1,0} multiply(%transpose.163, %transpose.163), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1688 = f32[7168,1]{1,0} convert(%square.802), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4397 = f32[] reduce(%convert_element_type.1688, %constant.712), dimensions={0,1}, to_apply=%region_629.720, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1689 = bf16[] convert(%reduce_sum.4397), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1690 = f32[] convert(%convert_element_type.1689), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1336 = f32[] add(%add.1335, %convert_element_type.1690), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.803 = bf16[512,1]{1,0} multiply(%transpose.162, %transpose.162), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1691 = f32[512,1]{1,0} convert(%square.803), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4398 = f32[] reduce(%convert_element_type.1691, %constant.712), dimensions={0,1}, to_apply=%region_630.721, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1692 = bf16[] convert(%reduce_sum.4398), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1693 = f32[] convert(%convert_element_type.1692), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1337 = f32[] add(%add.1336, %convert_element_type.1693), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.804 = bf16[128,1,128,7168]{3,2,1,0} multiply(%transpose.161, %transpose.161), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1694 = f32[128,1,128,7168]{3,2,1,0} convert(%square.804), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4399 = f32[] reduce(%convert_element_type.1694, %constant.712), dimensions={0,1,2,3}, to_apply=%region_631.722, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1695 = bf16[] convert(%reduce_sum.4399), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1696 = f32[] convert(%convert_element_type.1695), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1338 = f32[] add(%add.1337, %convert_element_type.1696), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.805 = bf16[1536,1]{1,0} multiply(%transpose.160, %transpose.160), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1697 = f32[1536,1]{1,0} convert(%square.805), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4400 = f32[] reduce(%convert_element_type.1697, %constant.712), dimensions={0,1}, to_apply=%region_632.723, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1698 = bf16[] convert(%reduce_sum.4400), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1699 = f32[] convert(%convert_element_type.1698), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1339 = f32[] add(%add.1338, %convert_element_type.1699), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.806 = bf16[7168,1,576]{2,1,0} multiply(%transpose.159, %transpose.159), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1700 = f32[7168,1,576]{2,1,0} convert(%square.806), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4401 = f32[] reduce(%convert_element_type.1700, %constant.712), dimensions={0,1,2}, to_apply=%region_633.724, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1701 = bf16[] convert(%reduce_sum.4401), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1702 = f32[] convert(%convert_element_type.1701), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1340 = f32[] add(%add.1339, %convert_element_type.1702), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.807 = bf16[512,1,128,256]{3,2,1,0} multiply(%transpose.158, %transpose.158), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1703 = f32[512,1,128,256]{3,2,1,0} convert(%square.807), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4402 = f32[] reduce(%convert_element_type.1703, %constant.712), dimensions={0,1,2,3}, to_apply=%region_634.725, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1704 = bf16[] convert(%reduce_sum.4402), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1705 = f32[] convert(%convert_element_type.1704), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1341 = f32[] add(%add.1340, %convert_element_type.1705), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.808 = bf16[7168,1,1536]{2,1,0} multiply(%transpose.157, %transpose.157), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1706 = f32[7168,1,1536]{2,1,0} convert(%square.808), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4403 = f32[] reduce(%convert_element_type.1706, %constant.712), dimensions={0,1,2}, to_apply=%region_635.726, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1707 = bf16[] convert(%reduce_sum.4403), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1708 = f32[] convert(%convert_element_type.1707), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1342 = f32[] add(%add.1341, %convert_element_type.1708), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.809 = bf16[1536,1,128,192]{3,2,1,0} multiply(%transpose.156, %transpose.156), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1709 = f32[1536,1,128,192]{3,2,1,0} convert(%square.809), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4404 = f32[] reduce(%convert_element_type.1709, %constant.712), dimensions={0,1,2,3}, to_apply=%region_636.727, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1710 = bf16[] convert(%reduce_sum.4404), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1711 = f32[] convert(%convert_element_type.1710), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1343 = f32[] add(%add.1342, %convert_element_type.1711), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.810 = bf16[7168,129280]{0,1} multiply(%transpose.138, %transpose.138), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1712 = f32[7168,129280]{0,1} convert(%square.810), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4405 = f32[] reduce(%convert_element_type.1712, %constant.712), dimensions={0,1}, to_apply=%region_637.728, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1713 = bf16[] convert(%reduce_sum.4405), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1714 = f32[] convert(%convert_element_type.1713), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1344 = f32[] add(%add.1343, %convert_element_type.1714), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %reduce_sum.4406 = f32[] reduce(%broadcast.238, %constant.712), dimensions={0,1}, to_apply=%region_638.729, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1715 = bf16[] convert(%reduce_sum.4406), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1716 = f32[] convert(%convert_element_type.1715), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1345 = f32[] add(%add.1344, %convert_element_type.1716), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.811 = bf16[7168,2,64]{2,0,1} multiply(%transpose.155, %transpose.155), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1717 = f32[7168,2,64]{2,0,1} convert(%square.811), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4407 = f32[] reduce(%convert_element_type.1717, %constant.712), dimensions={0,1,2}, to_apply=%region_639.730, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1718 = bf16[] convert(%reduce_sum.4407), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1719 = f32[] convert(%convert_element_type.1718), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1346 = f32[] add(%add.1345, %convert_element_type.1719), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.812 = bf16[64,2]{0,1} multiply(%transpose.154, %transpose.154), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1720 = f32[64,2]{0,1} convert(%square.812), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4408 = f32[] reduce(%convert_element_type.1720, %constant.712), dimensions={0,1}, to_apply=%region_640.731, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1721 = bf16[] convert(%reduce_sum.4408), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1722 = f32[] convert(%convert_element_type.1721), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1347 = f32[] add(%add.1346, %convert_element_type.1722), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.813 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%transpose.153, %transpose.153), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1723 = f32[64,2,7168,2048]{3,2,0,1} convert(%square.813), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4409 = f32[] reduce(%convert_element_type.1723, %constant.712), dimensions={0,1,2,3}, to_apply=%region_641.732, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1724 = bf16[] convert(%reduce_sum.4409), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1725 = f32[] convert(%convert_element_type.1724), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1348 = f32[] add(%add.1347, %convert_element_type.1725), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.814 = bf16[64,2,7168,2048]{3,2,0,1} multiply(%transpose.152, %transpose.152), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1726 = f32[64,2,7168,2048]{3,2,0,1} convert(%square.814), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4410 = f32[] reduce(%convert_element_type.1726, %constant.712), dimensions={0,1,2,3}, to_apply=%region_642.733, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1727 = bf16[] convert(%reduce_sum.4410), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1728 = f32[] convert(%convert_element_type.1727), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1349 = f32[] add(%add.1348, %convert_element_type.1728), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.815 = bf16[64,2,2048,7168]{3,2,0,1} multiply(%transpose.151, %transpose.151), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1729 = f32[64,2,2048,7168]{3,2,0,1} convert(%square.815), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4411 = f32[] reduce(%convert_element_type.1729, %constant.712), dimensions={0,1,2,3}, to_apply=%region_643.734, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1730 = bf16[] convert(%reduce_sum.4411), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1731 = f32[] convert(%convert_element_type.1730), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1350 = f32[] add(%add.1349, %convert_element_type.1731), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.816 = bf16[7168,2,2048]{2,0,1} multiply(%transpose.150, %transpose.150), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1732 = f32[7168,2,2048]{2,0,1} convert(%square.816), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4412 = f32[] reduce(%convert_element_type.1732, %constant.712), dimensions={0,1,2}, to_apply=%region_644.735, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1733 = bf16[] convert(%reduce_sum.4412), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1734 = f32[] convert(%convert_element_type.1733), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1351 = f32[] add(%add.1350, %convert_element_type.1734), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.817 = bf16[7168,2,2048]{2,0,1} multiply(%transpose.149, %transpose.149), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1735 = f32[7168,2,2048]{2,0,1} convert(%square.817), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4413 = f32[] reduce(%convert_element_type.1735, %constant.712), dimensions={0,1,2}, to_apply=%region_645.736, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1736 = bf16[] convert(%reduce_sum.4413), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1737 = f32[] convert(%convert_element_type.1736), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1352 = f32[] add(%add.1351, %convert_element_type.1737), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.818 = bf16[2048,2,7168]{2,0,1} multiply(%transpose.148, %transpose.148), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1738 = f32[2048,2,7168]{2,0,1} convert(%square.818), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4414 = f32[] reduce(%convert_element_type.1738, %constant.712), dimensions={0,1,2}, to_apply=%region_646.737, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1739 = bf16[] convert(%reduce_sum.4414), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1740 = f32[] convert(%convert_element_type.1739), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1353 = f32[] add(%add.1352, %convert_element_type.1740), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.819 = bf16[7168,2]{0,1} multiply(%transpose.147, %transpose.147), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1741 = f32[7168,2]{0,1} convert(%square.819), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4415 = f32[] reduce(%convert_element_type.1741, %constant.712), dimensions={0,1}, to_apply=%region_647.738, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1742 = bf16[] convert(%reduce_sum.4415), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1743 = f32[] convert(%convert_element_type.1742), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1354 = f32[] add(%add.1353, %convert_element_type.1743), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.820 = bf16[7168,2]{0,1} multiply(%transpose.146, %transpose.146), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1744 = f32[7168,2]{0,1} convert(%square.820), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4416 = f32[] reduce(%convert_element_type.1744, %constant.712), dimensions={0,1}, to_apply=%region_648.739, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1745 = bf16[] convert(%reduce_sum.4416), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1746 = f32[] convert(%convert_element_type.1745), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1355 = f32[] add(%add.1354, %convert_element_type.1746), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.821 = bf16[512,2]{0,1} multiply(%transpose.145, %transpose.145), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1747 = f32[512,2]{0,1} convert(%square.821), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4417 = f32[] reduce(%convert_element_type.1747, %constant.712), dimensions={0,1}, to_apply=%region_649.740, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1748 = bf16[] convert(%reduce_sum.4417), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1749 = f32[] convert(%convert_element_type.1748), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1356 = f32[] add(%add.1355, %convert_element_type.1749), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.822 = bf16[128,2,128,7168]{3,2,0,1} multiply(%transpose.144, %transpose.144), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1750 = f32[128,2,128,7168]{3,2,0,1} convert(%square.822), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4418 = f32[] reduce(%convert_element_type.1750, %constant.712), dimensions={0,1,2,3}, to_apply=%region_650.741, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1751 = bf16[] convert(%reduce_sum.4418), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1752 = f32[] convert(%convert_element_type.1751), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1357 = f32[] add(%add.1356, %convert_element_type.1752), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.823 = bf16[1536,2]{0,1} multiply(%transpose.143, %transpose.143), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1753 = f32[1536,2]{0,1} convert(%square.823), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4419 = f32[] reduce(%convert_element_type.1753, %constant.712), dimensions={0,1}, to_apply=%region_651.742, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1754 = bf16[] convert(%reduce_sum.4419), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1755 = f32[] convert(%convert_element_type.1754), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1358 = f32[] add(%add.1357, %convert_element_type.1755), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.824 = bf16[7168,2,576]{2,0,1} multiply(%transpose.142, %transpose.142), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1756 = f32[7168,2,576]{2,0,1} convert(%square.824), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4420 = f32[] reduce(%convert_element_type.1756, %constant.712), dimensions={0,1,2}, to_apply=%region_652.743, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1757 = bf16[] convert(%reduce_sum.4420), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1758 = f32[] convert(%convert_element_type.1757), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1359 = f32[] add(%add.1358, %convert_element_type.1758), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.825 = bf16[512,2,128,256]{3,2,0,1} multiply(%transpose.141, %transpose.141), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1759 = f32[512,2,128,256]{3,2,0,1} convert(%square.825), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4421 = f32[] reduce(%convert_element_type.1759, %constant.712), dimensions={0,1,2,3}, to_apply=%region_653.744, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1760 = bf16[] convert(%reduce_sum.4421), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1761 = f32[] convert(%convert_element_type.1760), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1360 = f32[] add(%add.1359, %convert_element_type.1761), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.826 = bf16[7168,2,1536]{2,0,1} multiply(%transpose.140, %transpose.140), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1762 = f32[7168,2,1536]{2,0,1} convert(%square.826), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4422 = f32[] reduce(%convert_element_type.1762, %constant.712), dimensions={0,1,2}, to_apply=%region_654.745, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1763 = bf16[] convert(%reduce_sum.4422), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1764 = f32[] convert(%convert_element_type.1763), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1361 = f32[] add(%add.1360, %convert_element_type.1764), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.827 = bf16[1536,2,128,192]{3,2,0,1} multiply(%transpose.139, %transpose.139), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1765 = f32[1536,2,128,192]{3,2,0,1} convert(%square.827), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4423 = f32[] reduce(%convert_element_type.1765, %constant.712), dimensions={0,1,2,3}, to_apply=%region_655.746, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1766 = bf16[] convert(%reduce_sum.4423), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1767 = f32[] convert(%convert_element_type.1766), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1362 = f32[] add(%add.1361, %convert_element_type.1767), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %square.828 = bf16[129280,7168]{1,0} multiply(%scatter-add.5, %scatter-add.5), metadata={op_name="jit(train_step)/square" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=69 source_end_column=82}
  %convert_element_type.1768 = f32[129280,7168]{1,0} convert(%square.828), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %reduce_sum.4424 = f32[] reduce(%convert_element_type.1768, %constant.712), dimensions={0,1}, to_apply=%region_656.747, metadata={op_name="jit(train_step)/reduce_sum" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1769 = bf16[] convert(%reduce_sum.4424), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=61 source_end_column=83}
  %convert_element_type.1770 = f32[] convert(%convert_element_type.1769), metadata={op_name="jit(train_step)/convert_element_type" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %add.1363 = f32[] add(%add.1362, %convert_element_type.1770), metadata={op_name="jit(train_step)/add" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=57 source_end_column=83}
  %sqrt.72 = f32[] sqrt(%add.1363), metadata={op_name="jit(train_step)/sqrt" source_file="/maxtext_workspace/maxtext/src/MaxText/max_utils.py" source_line=68 source_end_line=68 source_column=9 source_end_column=105}
  %reshape.530 = f32[] reshape(%sqrt.72)
  %reshape.531 = s32[] reshape(%reduce_sum.4069)
  ROOT %tuple.23 = (s32[], f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=5*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=10*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=15*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=20*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, /*index=25*/f32[1,1024]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=30*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=35*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, /*index=40*/f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[1,1024]{1,0}, f32[1,1]{1,0}, /*index=45*/f32[1,1024]{1,0}, f32[1,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=50*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=55*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=60*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=65*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=70*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=75*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=80*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=85*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=90*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=95*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=100*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, /*index=105*/f32[2,1024]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=110*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=115*/f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, /*index=120*/f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, f32[2,1024]{1,0}, f32[2,1]{1,0}, /*index=125*/f32[2,1024]{1,0}, f32[2,1]{1,0}, bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, /*index=130*/bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, /*index=135*/bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, /*index=140*/bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=145*/bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, /*index=150*/bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, /*index=155*/bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, /*index=160*/s32[], bf16[7168]{0}, bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, /*index=165*/bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, /*index=170*/bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, /*index=175*/bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, /*index=180*/bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, /*index=185*/bf16[7168,2]{1,0}, bf16[512,2]{1,0}, bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, /*index=190*/bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, bf16[7168]{0}, /*index=195*/bf16[7168,1,18432]{2,1,0}, bf16[7168,1,18432]{2,1,0}, bf16[18432,1,7168]{2,1,0}, bf16[7168,1]{1,0}, bf16[7168,1]{1,0}, /*index=200*/bf16[512,1]{1,0}, bf16[128,1,128,7168]{3,2,1,0}, bf16[1536,1]{1,0}, bf16[7168,1,576]{2,1,0}, bf16[512,1,128,256]{3,2,1,0}, /*index=205*/bf16[7168,1,1536]{2,1,0}, bf16[1536,1,128,192]{3,2,1,0}, bf16[7168,129280]{1,0}, bf16[64,2]{1,0}, bf16[7168,2,64]{2,1,0}, /*index=210*/bf16[64,2]{1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,7168,2048]{3,2,1,0}, bf16[64,2,2048,7168]{3,2,1,0}, bf16[7168,2,2048]{2,1,0}, /*index=215*/bf16[7168,2,2048]{2,1,0}, bf16[2048,2,7168]{2,1,0}, bf16[7168,2]{1,0}, bf16[7168,2]{1,0}, bf16[512,2]{1,0}, /*index=220*/bf16[128,2,128,7168]{3,2,1,0}, bf16[1536,2]{1,0}, bf16[7168,2,576]{2,1,0}, bf16[512,2,128,256]{3,2,1,0}, bf16[7168,2,1536]{2,1,0}, /*index=225*/bf16[1536,2,128,192]{3,2,1,0}, bf16[129280,7168]{1,0}, s32[], f32[], f32[], /*index=230*/f32[], f32[], f32[], f32[], s32[]) tuple(%custom-call.684, %custom-call.685, %custom-call.686, %custom-call.687, %custom-call.688, /*index=5*/%custom-call.689, %custom-call.690, %custom-call.691, %custom-call.692, %custom-call.693, /*index=10*/%custom-call.694, %custom-call.695, %custom-call.696, %custom-call.697, %custom-call.698, /*index=15*/%custom-call.699, %custom-call.700, %custom-call.701, %custom-call.702, %custom-call.703, /*index=20*/%custom-call.704, %custom-call.705, %custom-call.706, %custom-call.707, %custom-call.708, /*index=25*/%custom-call.709, %custom-call.710, %custom-call.711, %custom-call.712, %custom-call.713, /*index=30*/%custom-call.714, %custom-call.715, %custom-call.716, %custom-call.717, %custom-call.718, /*index=35*/%custom-call.719, %custom-call.720, %custom-call.721, %custom-call.722, %custom-call.723, /*index=40*/%custom-call.724, %custom-call.725, %custom-call.726, %custom-call.727, %custom-call.728, /*index=45*/%custom-call.729, %custom-call.730, %custom-call.731, %custom-call.732, %custom-call.733, /*index=50*/%custom-call.734, %custom-call.735, %custom-call.736, %custom-call.737, %custom-call.738, /*index=55*/%custom-call.739, %custom-call.740, %custom-call.741, %custom-call.742, %custom-call.743, /*index=60*/%custom-call.744, %custom-call.745, %custom-call.746, %custom-call.747, %custom-call.748, /*index=65*/%custom-call.749, %custom-call.750, %custom-call.751, %custom-call.752, %custom-call.753, /*index=70*/%custom-call.754, %custom-call.755, %custom-call.756, %custom-call.757, %custom-call.758, /*index=75*/%custom-call.759, %custom-call.760, %custom-call.761, %custom-call.762, %custom-call.763, /*index=80*/%custom-call.764, %custom-call.765, %custom-call.766, %custom-call.767, %custom-call.768, /*index=85*/%custom-call.769, %custom-call.770, %custom-call.771, %custom-call.772, %custom-call.773, /*index=90*/%custom-call.774, %custom-call.775, %custom-call.776, %custom-call.777, %custom-call.778, /*index=95*/%custom-call.779, %custom-call.780, %custom-call.781, %custom-call.782, %custom-call.783, /*index=100*/%custom-call.784, %custom-call.785, %custom-call.786, %custom-call.787, %custom-call.788, /*index=105*/%custom-call.789, %custom-call.790, %custom-call.791, %custom-call.792, %custom-call.793, /*index=110*/%custom-call.794, %custom-call.795, %custom-call.796, %custom-call.797, %custom-call.798, /*index=115*/%custom-call.799, %custom-call.800, %custom-call.801, %custom-call.802, %custom-call.803, /*index=120*/%custom-call.804, %custom-call.805, %custom-call.806, %custom-call.807, %custom-call.808, /*index=125*/%custom-call.809, %custom-call.810, %custom-call.811, %custom-call.812, %custom-call.813, /*index=130*/%custom-call.814, %custom-call.815, %custom-call.816, %custom-call.817, %custom-call.818, /*index=135*/%custom-call.819, %custom-call.820, %custom-call.821, %custom-call.822, %custom-call.823, /*index=140*/%custom-call.824, %custom-call.825, %custom-call.826, %custom-call.827, %custom-call.828, /*index=145*/%custom-call.829, %custom-call.830, %custom-call.831, %custom-call.832, %custom-call.833, /*index=150*/%custom-call.834, %custom-call.835, %custom-call.836, %custom-call.837, %custom-call.838, /*index=155*/%custom-call.839, %custom-call.840, %custom-call.841, %custom-call.842, %custom-call.843, /*index=160*/%custom-call.844, %custom-call.845, %custom-call.846, %custom-call.847, %custom-call.848, /*index=165*/%custom-call.849, %custom-call.850, %custom-call.851, %custom-call.852, %custom-call.853, /*index=170*/%custom-call.854, %custom-call.855, %custom-call.856, %custom-call.857, %custom-call.858, /*index=175*/%custom-call.859, %custom-call.860, %custom-call.861, %custom-call.862, %custom-call.863, /*index=180*/%custom-call.864, %custom-call.865, %custom-call.866, %custom-call.867, %custom-call.868, /*index=185*/%custom-call.869, %custom-call.870, %custom-call.871, %custom-call.872, %custom-call.873, /*index=190*/%custom-call.874, %custom-call.875, %custom-call.876, %custom-call.877, %custom-call.878, /*index=195*/%custom-call.879, %custom-call.880, %custom-call.881, %custom-call.882, %custom-call.883, /*index=200*/%custom-call.884, %custom-call.885, %custom-call.886, %custom-call.887, %custom-call.888, /*index=205*/%custom-call.889, %custom-call.890, %custom-call.891, %custom-call.892, %custom-call.893, /*index=210*/%custom-call.894, %custom-call.895, %custom-call.896, %custom-call.897, %custom-call.898, /*index=215*/%custom-call.899, %custom-call.900, %custom-call.901, %custom-call.902, %custom-call.903, /*index=220*/%custom-call.904, %custom-call.905, %custom-call.906, %custom-call.907, %custom-call.908, /*index=225*/%custom-call.909, %custom-call.910, %custom-call.911, %sqrt.71, %div.1432, /*index=230*/%constant.712, %constant.712, %sqrt.73, %sqrt.72, %reduce_sum.4069), sharding={{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=5*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=10*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=15*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=20*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=25*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=30*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=35*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=40*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=45*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=50*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=55*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=60*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=65*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=70*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=75*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=80*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=85*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=90*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=95*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=100*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=105*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=110*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=115*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=120*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}, /*index=125*/{replicated}, {replicated}, {replicated}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, /*index=130*/{devices=[1,1,4]<=[4]}, {replicated}, {replicated}, {replicated}, {devices=[1,1,1,4]<=[4]}, /*index=135*/{replicated}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, /*index=140*/{devices=[4,1]<=[4]}, {replicated}, {devices=[4,1,1]<=[4]}, {replicated}, {devices=[4,1,1,1]<=[4]}, /*index=145*/{devices=[4,1,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[1,1,4]<=[4]}, /*index=150*/{replicated}, {replicated}, {replicated}, {devices=[1,1,1,4]<=[4]}, {replicated}, /*index=155*/{devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[1,4]<=[4]}, /*index=160*/{replicated}, {replicated}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[1,1,4]<=[4]}, /*index=165*/{replicated}, {replicated}, {replicated}, {devices=[1,1,1,4]<=[4]}, {replicated}, /*index=170*/{devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1]<=[4]}, /*index=175*/{replicated}, {devices=[4,1,1]<=[4]}, {replicated}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, /*index=180*/{devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[1,1,4]<=[4]}, {replicated}, /*index=185*/{replicated}, {replicated}, {devices=[1,1,1,4]<=[4]}, {replicated}, {devices=[4,1,1]<=[4]}, /*index=190*/{devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[1,4]<=[4]}, {replicated}, /*index=195*/{devices=[4,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, {devices=[1,1,4]<=[4]}, {replicated}, {replicated}, /*index=200*/{replicated}, {devices=[1,1,1,4]<=[4]}, {replicated}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, /*index=205*/{devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1]<=[4]}, {replicated}, {devices=[4,1,1]<=[4]}, /*index=210*/{replicated}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, /*index=215*/{devices=[4,1,1]<=[4]}, {devices=[1,1,4]<=[4]}, {replicated}, {replicated}, {replicated}, /*index=220*/{devices=[1,1,1,4]<=[4]}, {replicated}, {devices=[4,1,1]<=[4]}, {devices=[4,1,1,1]<=[4]}, {devices=[4,1,1]<=[4]}, /*index=225*/{devices=[4,1,1,1]<=[4]}, {devices=[1,4]<=[4]}, {replicated}, {replicated}, {replicated}, /*index=230*/{replicated}, {replicated}, {replicated}, {replicated}, {replicated}}
}

