// RUN: gpu_fusion_to_mlir %s | emitters_opt -xla-test-optimize |\
// RUN:   FileCheck %s
// RUN: cpu_fusion_to_mlir %s | emitters_opt -xla-test-optimize |\
// RUN:   FileCheck %s
// RUN: gpu_test_correctness %s
// RUN: cpu_test_correctness %s

fusion {
  param0 = s4[200]{0:E(4)} parameter(0)
  param1 = s4[400]{0:E(4)} parameter(1)
  param2 = s4[300]{0:E(4)} parameter(2)
  ROOT concat = s4[900]{0:E(4)} concatenate(param0, param1, param2), dimensions={0}
}
// CHECK: xla.pure_call @fusion_param0
// CHECK: xla.pure_call @fusion_param1
// CHECK: xla.pure_call @fusion_param2
