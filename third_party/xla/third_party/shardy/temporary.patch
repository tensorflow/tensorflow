diff --git a/third_party/llvm/generated.patch b/third_party/llvm/generated.patch
index a6f7fe5..bc36ca5 100644
--- a/third_party/llvm/generated.patch
+++ b/third_party/llvm/generated.patch
@@ -1,89 +1,127 @@
 Auto generated patch. Do not edit or delete it, even if empty.
-diff -ruN --strip-trailing-cr a/llvm/lib/Target/BPF/BPFAsmPrinter.cpp b/llvm/lib/Target/BPF/BPFAsmPrinter.cpp
---- a/llvm/lib/Target/BPF/BPFAsmPrinter.cpp
-+++ b/llvm/lib/Target/BPF/BPFAsmPrinter.cpp
-@@ -176,10 +176,6 @@
-         if (const GlobalValue *GV = Op.getGlobal())
-           if (GV->getName() == BPF_TRAP)
-             SawTrapCall = true;
--      } else if (Op.isSymbol()) {
--        if (const MCSymbol *Sym = Op.getMCSymbol())
--          if (Sym->getName() == BPF_TRAP)
--            SawTrapCall = true;
+diff -ruN --strip-trailing-cr a/libc/src/stdio/printf_core/vfprintf_internal.h b/libc/src/stdio/printf_core/vfprintf_internal.h
+--- a/libc/src/stdio/printf_core/vfprintf_internal.h
++++ b/libc/src/stdio/printf_core/vfprintf_internal.h
+@@ -51,8 +51,11 @@
+ LIBC_INLINE FileIOResult fwrite_unlocked(const void *ptr, size_t size,
+                                          size_t nmemb, ::FILE *f) {
+   // Need to use system errno in this case, as system write will set this errno
+-  // which we need to propagate back into our code.
+-  return {::fwrite_unlocked(ptr, size, nmemb, f), errno};
++  // which we need to propagate back into our code. fwrite only modifies errno
++  // if there was an error, and errno may have previously been nonzero. Only
++  // return errno if there was an error.
++  size_t members_written = ::fwrite_unlocked(ptr, size, nmemb, f);
++  return {members_written, members_written == nmemb ? 0 : errno};
+ }
+ #endif // LIBC_COPT_STDIO_USE_SYSTEM_FILE
+ } // namespace internal
+diff -ruN --strip-trailing-cr a/libcxx/include/fstream b/libcxx/include/fstream
+--- a/libcxx/include/fstream
++++ b/libcxx/include/fstream
+@@ -315,8 +315,14 @@
+         traits_type::copy(__str, this->gptr(), __n);
+         this->__gbump_ptrdiff(__n);
        }
-     }
-   }
-diff -ruN --strip-trailing-cr a/llvm/test/Analysis/CostModel/AArch64/sincos.ll b/llvm/test/Analysis/CostModel/AArch64/sincos.ll
---- a/llvm/test/Analysis/CostModel/AArch64/sincos.ll
-+++ b/llvm/test/Analysis/CostModel/AArch64/sincos.ll
-@@ -38,14 +38,14 @@
- ;
- ; SINCOS_STRET-LABEL: 'sincos'
- ; SINCOS_STRET:  Cost Model: Found an estimated cost of 1 for instruction: %f16 = call { half, half } @llvm.sincos.f16(half poison)
--; SINCOS_STRET:  Cost Model: Found an estimated cost of 2 for instruction: %f32 = call { float, float } @llvm.sincos.f32(float poison)
--; SINCOS_STRET:  Cost Model: Found an estimated cost of 2 for instruction: %f64 = call { double, double } @llvm.sincos.f64(double poison)
-+; SINCOS_STRET:  Cost Model: Found an estimated cost of 10 for instruction: %f32 = call { float, float } @llvm.sincos.f32(float poison)
-+; SINCOS_STRET:  Cost Model: Found an estimated cost of 10 for instruction: %f64 = call { double, double } @llvm.sincos.f64(double poison)
- ; SINCOS_STRET:  Cost Model: Found an estimated cost of 10 for instruction: %f128 = call { fp128, fp128 } @llvm.sincos.f128(fp128 poison)
- ; SINCOS_STRET:  Cost Model: Found an estimated cost of 36 for instruction: %v8f16 = call { <8 x half>, <8 x half> } @llvm.sincos.v8f16(<8 x half> poison)
--; SINCOS_STRET:  Cost Model: Found an estimated cost of 20 for instruction: %v4f32 = call { <4 x float>, <4 x float> } @llvm.sincos.v4f32(<4 x float> poison)
--; SINCOS_STRET:  Cost Model: Found an estimated cost of 8 for instruction: %v2f64 = call { <2 x double>, <2 x double> } @llvm.sincos.v2f64(<2 x double> poison)
-+; SINCOS_STRET:  Cost Model: Found an estimated cost of 52 for instruction: %v4f32 = call { <4 x float>, <4 x float> } @llvm.sincos.v4f32(<4 x float> poison)
-+; SINCOS_STRET:  Cost Model: Found an estimated cost of 24 for instruction: %v2f64 = call { <2 x double>, <2 x double> } @llvm.sincos.v2f64(<2 x double> poison)
- ; SINCOS_STRET:  Cost Model: Found an estimated cost of 10 for instruction: %v1f128 = call { <1 x fp128>, <1 x fp128> } @llvm.sincos.v1f128(<1 x fp128> poison)
--; SINCOS_STRET:  Cost Model: Found an estimated cost of 40 for instruction: %v8f32 = call { <8 x float>, <8 x float> } @llvm.sincos.v8f32(<8 x float> poison)
-+; SINCOS_STRET:  Cost Model: Found an estimated cost of 104 for instruction: %v8f32 = call { <8 x float>, <8 x float> } @llvm.sincos.v8f32(<8 x float> poison)
- ; SINCOS_STRET:  Cost Model: Invalid cost for instruction: %nxv8f16 = call { <vscale x 8 x half>, <vscale x 8 x half> } @llvm.sincos.nxv8f16(<vscale x 8 x half> poison)
- ; SINCOS_STRET:  Cost Model: Invalid cost for instruction: %nxv4f32 = call { <vscale x 4 x float>, <vscale x 4 x float> } @llvm.sincos.nxv4f32(<vscale x 4 x float> poison)
- ; SINCOS_STRET:  Cost Model: Invalid cost for instruction: %nxv2f64 = call { <vscale x 2 x double>, <vscale x 2 x double> } @llvm.sincos.nxv2f64(<vscale x 2 x double> poison)
-diff -ruN --strip-trailing-cr a/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp b/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp
---- a/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp
-+++ b/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp
-@@ -2568,11 +2568,6 @@
-     auto trailingReassocs = ArrayRef<int64_t>(reassoc).drop_front();
-     auto stride = SaturatedInteger::wrap(resultStrides[resultStrideIndex--]);
-     for (int64_t idx : llvm::reverse(trailingReassocs)) {
--      // Dimensions of size 1 should be skipped, because their strides are
--      // meaningless and could have any arbitrary value.
--      if (srcShape[idx - 1] == 1)
--        continue;
--
-       stride = stride * SaturatedInteger::wrap(srcShape[idx]);
- 
-       // Both source and result stride must have the same static value. In that
-@@ -2587,6 +2582,11 @@
-       if (strict && (stride.saturated || srcStride.saturated))
-         return failure();
- 
-+      // Dimensions of size 1 should be skipped, because their strides are
-+      // meaningless and could have any arbitrary value.
-+      if (srcShape[idx - 1] == 1)
-+        continue;
+-      if (__len - __n >= this->egptr() - this->eback())
+-        return std::fread(__str + __n, sizeof(char_type), __len - __n, __file_);
++      const streamsize __remainder    = __len - __n;
++      const streamsize __buffer_space = this->egptr() - this->eback();
 +
-       if (!stride.saturated && !srcStride.saturated && stride != srcStride)
-         return failure();
++      if (__remainder >= __buffer_space)
++        return std::fread(__str + __n, sizeof(char_type), __remainder, __file_) + __n;
++      else if (__remainder > 0)
++        return basic_streambuf<_CharT, _Traits>::xsgetn(__str + __n, __remainder) + __n;
++      return __n;
      }
-diff -ruN --strip-trailing-cr a/mlir/test/Dialect/MemRef/ops.mlir b/mlir/test/Dialect/MemRef/ops.mlir
---- a/mlir/test/Dialect/MemRef/ops.mlir
-+++ b/mlir/test/Dialect/MemRef/ops.mlir
-@@ -440,8 +440,7 @@
-          %arg4: index,
-          %arg5: index,
-          %arg6: index,
--         %arg7: memref<4x?x4xf32>,
--         %arg8: memref<1x1x18x?xsi8, strided<[?, ?, ?, 1], offset: ?>>) {
-+         %arg7: memref<4x?x4xf32>) {
- //       CHECK:   memref.collapse_shape {{.*}} {{\[}}[0, 1], [2]]
- //  CHECK-SAME:     memref<?x?x?xf32> into memref<?x?xf32>
-   %0 = memref.collapse_shape %arg0 [[0, 1], [2]] :
-@@ -490,10 +489,6 @@
- //       CHECK:   memref.expand_shape {{.*}} {{\[}}[0, 1], [2], [3, 4]]
-   %4 = memref.expand_shape %arg7 [[0, 1], [2], [3, 4]] output_shape [2, 2, %arg4, 2, 2]
-         : memref<4x?x4xf32> into memref<2x2x?x2x2xf32>
--
--//       CHECK:   memref.collapse_shape {{.*}} {{\[}}[0, 1], [2], [3]]
--//  CHECK-SAME:     memref<1x1x18x?xsi8, strided<[?, ?, ?, 1], offset: ?>> into memref<1x18x?xsi8, strided<[?, ?, 1], offset: ?>>
--  %5 = memref.collapse_shape %arg8 [[0, 1], [2], [3]] : memref<1x1x18x?xsi8, strided<[?, ?, ?, 1], offset: ?>> into memref<1x18x?xsi8, strided<[?, ?, 1], offset: ?>>
-   return
- }
+     return basic_streambuf<_CharT, _Traits>::xsgetn(__str, __len);
+   }
+diff -ruN --strip-trailing-cr a/llvm/lib/Passes/PassBuilderPipelines.cpp b/llvm/lib/Passes/PassBuilderPipelines.cpp
+--- a/llvm/lib/Passes/PassBuilderPipelines.cpp
++++ b/llvm/lib/Passes/PassBuilderPipelines.cpp
+@@ -228,7 +228,7 @@
+ static cl::opt<bool>
+     EnableDFAJumpThreading("enable-dfa-jump-thread",
+                            cl::desc("Enable DFA jump threading"),
+-                           cl::init(true), cl::Hidden);
++                           cl::init(false), cl::Hidden);
  
+ static cl::opt<bool>
+     EnableHotColdSplit("hot-cold-split",
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-defaults.ll b/llvm/test/Other/new-pm-defaults.ll
+--- a/llvm/test/Other/new-pm-defaults.ll
++++ b/llvm/test/Other/new-pm-defaults.ll
+@@ -208,7 +208,6 @@
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+ ; CHECK-EP-PEEPHOLE-NEXT: Running pass: NoOpFunctionPass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-postlink-defaults.ll b/llvm/test/Other/new-pm-thinlto-postlink-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-postlink-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-postlink-defaults.ll
+@@ -133,7 +133,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-postlink-pgo-defaults.ll b/llvm/test/Other/new-pm-thinlto-postlink-pgo-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-postlink-pgo-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-postlink-pgo-defaults.ll
+@@ -118,7 +118,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-postlink-samplepgo-defaults.ll b/llvm/test/Other/new-pm-thinlto-postlink-samplepgo-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-postlink-samplepgo-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-postlink-samplepgo-defaults.ll
+@@ -127,7 +127,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-prelink-defaults.ll b/llvm/test/Other/new-pm-thinlto-prelink-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-prelink-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-prelink-defaults.ll
+@@ -165,7 +165,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-prelink-pgo-defaults.ll b/llvm/test/Other/new-pm-thinlto-prelink-pgo-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-prelink-pgo-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-prelink-pgo-defaults.ll
+@@ -167,7 +167,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
+diff -ruN --strip-trailing-cr a/llvm/test/Other/new-pm-thinlto-prelink-samplepgo-defaults.ll b/llvm/test/Other/new-pm-thinlto-prelink-samplepgo-defaults.ll
+--- a/llvm/test/Other/new-pm-thinlto-prelink-samplepgo-defaults.ll
++++ b/llvm/test/Other/new-pm-thinlto-prelink-samplepgo-defaults.ll
+@@ -131,7 +131,6 @@
+ ; CHECK-O-NEXT: Running pass: BDCEPass
+ ; CHECK-O-NEXT: Running analysis: DemandedBitsAnalysis
+ ; CHECK-O-NEXT: Running pass: InstCombinePass
+-; CHECK-O23SZ-NEXT: Running pass: DFAJumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running pass: JumpThreadingPass
+ ; CHECK-O23SZ-NEXT: Running analysis: LazyValueAnalysis
+ ; CHECK-O23SZ-NEXT: Running pass: CorrelatedValuePropagationPass
diff --git a/third_party/llvm/workspace.bzl b/third_party/llvm/workspace.bzl
index abdee76..0fec012 100644
--- a/third_party/llvm/workspace.bzl
+++ b/third_party/llvm/workspace.bzl
@@ -4,8 +4,8 @@ load("//third_party:repo.bzl", "tf_http_archive")
 
 def repo(name):
     """Imports LLVM."""
-    LLVM_COMMIT = "2bc22ea02edda5926f3e53f141def9bf212ac1db"
-    LLVM_SHA256 = "4a034eda852b3c2d448d38e8661cbac45ae2233a29defeb55913fa5205cd29f7"
+    LLVM_COMMIT = "9625cf6cc0e3e530ea0bed971d85b363f77c49d8"
+    LLVM_SHA256 = "48a0479efdde83a02ece6a168094aa14e6f819c829eb61a133ec124089643356"
 
     tf_http_archive(
         name = name,
