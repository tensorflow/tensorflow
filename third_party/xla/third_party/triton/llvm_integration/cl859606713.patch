
--- a/include/triton/Analysis/Alias.h	2025-04-25 05:19:43.000000000 -0700
+++ b/include/triton/Analysis/Alias.h	2026-01-22 07:55:47.000000000 -0800
@@ -91,8 +91,9 @@
                  ArrayRef<dataflow::Lattice<AliasInfo> *> results) override;
 
   void visitNonControlFlowArguments(
-      Operation *op, const RegionSuccessor &successor,
-      ArrayRef<dataflow::Lattice<AliasInfo> *> argLattices,
+      Operation* op, const RegionSuccessor& successor,
+      ValueRange successorInputs,
+      ArrayRef<dataflow::Lattice<AliasInfo>*> argLattices,
       unsigned firstIndex) override;
 };
 

--- a/include/triton/Analysis/BufferRegion.h	2026-01-21 01:19:21.000000000 -0800
+++ b/include/triton/Analysis/BufferRegion.h	2026-01-22 07:55:47.000000000 -0800
@@ -153,8 +153,9 @@
       llvm::ArrayRef<dataflow::Lattice<RegionInfo> *> results) override;
 
   void visitNonControlFlowArguments(
-      Operation *op, const RegionSuccessor &successor,
-      llvm::ArrayRef<dataflow::Lattice<RegionInfo> *> argLattices,
+      Operation* op, const RegionSuccessor& successor,
+      ValueRange successorInputs,
+      llvm::ArrayRef<dataflow::Lattice<RegionInfo>*> argLattices,
       unsigned firstIndex) override;
 
   LogicalResult initialize(Operation *top) override;

--- a/include/triton/Dialect/TritonGPU/IR/TritonGPUOps.td	2026-01-21 01:19:21.000000000 -0800
+++ b/include/triton/Dialect/TritonGPU/IR/TritonGPUOps.td	2026-01-22 07:55:48.000000000 -0800
@@ -455,7 +455,8 @@
 
 def TTG_WarpSpecializeOp : TTG_Op<"warp_specialize", [
   RecursiveMemoryEffects, RecursivelySpeculatable, AsyncRegions,
-  DeclareOpInterfaceMethods<RegionBranchOpInterface>
+  DeclareOpInterfaceMethods<RegionBranchOpInterface,
+    ["getSuccessorInputs"]>
 ]> {
   let summary = "asynchronously execute code on multiple warpgroups";
   let description = [{

--- a/lib/Analysis/Alias.cpp	2025-07-31 00:13:23.000000000 -0700
+++ b/lib/Analysis/Alias.cpp	2026-01-22 07:55:48.000000000 -0800
@@ -59,13 +59,13 @@
 }
 
 void SharedMemoryAliasAnalysis::visitNonControlFlowArguments(
-    Operation *op, const RegionSuccessor &successor,
-    ArrayRef<dataflow::Lattice<AliasInfo> *> argLattices, unsigned firstIndex) {
+    Operation* op, const RegionSuccessor& successor, ValueRange successorInputs,
+    ArrayRef<dataflow::Lattice<AliasInfo>*> argLattices, unsigned firstIndex) {
   auto wsOp = dyn_cast<triton::gpu::WarpSpecializePartitionsOp>(op);
   if (!wsOp) {
     setAllToEntryStates(argLattices.take_front(firstIndex));
-    setAllToEntryStates(argLattices.drop_front(
-        firstIndex + successor.getSuccessorInputs().size()));
+    setAllToEntryStates(
+        argLattices.drop_front(firstIndex + successorInputs.size()));
     return;
   }
 

--- a/lib/Analysis/AxisInfo.cpp	2026-01-21 01:19:21.000000000 -0800
+++ b/lib/Analysis/AxisInfo.cpp	2026-01-22 07:55:49.000000000 -0800
@@ -145,8 +145,9 @@
   }
 
   void visitNonControlFlowArguments(
-      Operation *op, const RegionSuccessor &successor,
-      ArrayRef<dataflow::Lattice<AxisInfo> *> argLattices,
+      Operation* op, const RegionSuccessor& successor,
+      ValueRange successorInputs,
+      ArrayRef<dataflow::Lattice<AxisInfo>*> argLattices,
       unsigned firstIndex) override {
     if (auto forOp = dyn_cast<scf::ForOp>(op)) {
       visitForOpInductionVar(forOp, argLattices);
@@ -154,8 +155,8 @@
       visitWarpSpecializeExplicitCaptures(ws, successor, argLattices);
     } else {
       setAllToEntryStates(argLattices.take_front(firstIndex));
-      setAllToEntryStates(argLattices.drop_front(
-          firstIndex + successor.getSuccessorInputs().size()));
+      setAllToEntryStates(
+          argLattices.drop_front(firstIndex + successorInputs.size()));
     }
   }
 

--- a/lib/Analysis/BufferRegion.cpp	2026-01-21 01:19:21.000000000 -0800
+++ b/lib/Analysis/BufferRegion.cpp	2026-01-22 07:55:49.000000000 -0800
@@ -297,14 +297,14 @@
 }
 
 void BufferRegionAnalysis::visitNonControlFlowArguments(
-    Operation *op, const RegionSuccessor &successor,
-    llvm::ArrayRef<dataflow::Lattice<RegionInfo> *> argLattices,
+    Operation* op, const RegionSuccessor& successor, ValueRange successorInputs,
+    llvm::ArrayRef<dataflow::Lattice<RegionInfo>*> argLattices,
     unsigned firstIndex) {
   auto wsOp = dyn_cast<triton::gpu::WarpSpecializePartitionsOp>(op);
   if (!wsOp) {
     setAllToEntryStates(argLattices.take_front(firstIndex));
-    setAllToEntryStates(argLattices.drop_front(
-        firstIndex + successor.getSuccessorInputs().size()));
+    setAllToEntryStates(
+        argLattices.drop_front(firstIndex + successorInputs.size()));
     return;
   }
 

--- a/lib/Dialect/TritonGPU/IR/Ops.cpp	2026-01-21 19:11:53.000000000 -0800
+++ b/lib/Dialect/TritonGPU/IR/Ops.cpp	2026-01-22 07:55:49.000000000 -0800
@@ -986,6 +986,12 @@
              getPartitionOpHolder().front().front())
       .getPartitionRegions();
 }
+
+::mlir::ValueRange WarpSpecializeOp::getSuccessorInputs(
+    ::mlir::RegionSuccessor successor) {
+  if (successor.isParent()) return getResults();
+  return successor.getSuccessor()->getArguments();
+}
 
 void WarpSpecializeOp::getSuccessorRegions(
     RegionBranchPoint src, SmallVectorImpl<RegionSuccessor> &successors) {
@@ -998,7 +1004,7 @@
   // And the default region branches transparently back to the parent.
   if (src.getTerminatorPredecessorOrNull()->getParentRegion() ==
       &getDefaultRegion())
-    successors.push_back(RegionSuccessor::parent(getResults()));
+    successors.push_back(RegionSuccessor::parent());
 }
 
 void WarpSpecializePartitionsOp::getSuccessorRegions(

--- a/third_party/amd/lib/Analysis/RangeAnalysis.cpp	2026-01-21 19:11:53.000000000 -0800
+++ b/third_party/amd/lib/Analysis/RangeAnalysis.cpp	2026-01-22 07:55:49.000000000 -0800
@@ -717,8 +717,8 @@
         }
         visitNonControlFlowArguments(
             branch,
-            RegionSuccessor::parent(
-                branch->getResults().slice(firstIndex, inputs.size())),
+            RegionSuccessor::parent(),
+            branch->getResults().slice(firstIndex, inputs.size()),
             lattices, firstIndex);
       } else {
         if (!inputs.empty()) {
@@ -727,8 +727,8 @@
         Region *region = point->getBlock()->getParent();
         visitNonControlFlowArguments(
             branch,
-            RegionSuccessor(region, region->getArguments().slice(
-                                        firstIndex, inputs.size())),
+            RegionSuccessor(region),
+            region->getArguments().slice(firstIndex, inputs.size()),
             lattices, firstIndex);
       }
     }
